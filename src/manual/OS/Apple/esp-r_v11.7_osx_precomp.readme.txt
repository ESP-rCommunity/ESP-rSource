
Notes for the self-extracting installer for a precompiled 
X11 or GTK version 11.7 of ESP-r to run on an OSX 10.4 (or newer)
Mac computer. Check the file name for the Intel or PPC version. The
PPC version should run in emulation on an Intel computer. The Intel
version should run natively on Intel based Macs. It assumes that
you have the X11 environment installed as well as the development
tools.

This installer is intended to be used via either the OSX terminal 
(which supports text interactions) or within an OSX X11 graphics terminal.

Typically the `run` file you downloaded
should be placed in /opt and run via a sudo command from 
that folder via the command 
  sudo ./esp-r_v11.7_osx_precomp.run

On most OSX machines a file ending in .run will be
treated as an executable. If the installer does not 
execute you may have to issue the following command 
to change its permissions:

  sudo chmod a+x ./esp-r_v11.7_osx_precomp.run

There are two versions of ESP-r which can be installed. The
so-called X11 version is the legacy version and the GTK version
is an almost complete port of ESP-r using the GTK libary. There
are a few functions which are not available in the GTK version
so this is generally viewed as BETA software.  The GTK version also
has a number of library dependencies which are not required of
the X11 version.

The installer will ask you a number of yes/no questions and, if
successful it will place an ESP-r distribution
in the folders:
  /opt/esru/esp-r/
        bin
	climate
	databases
	manual
	training
	validation
	
and it will create a link from /usr/esru to /opt/esru

During the install process LOOK FOR DIRECTIONS for
adapting your PATH environment variable (if required). A
sample .cshrc file will be placed in /tmp. Once you
have checked that ESP-r modules run you can remove
the installer.

Once you have installed ESP-r:

To start up the ESP-r Project Manger, log into your computer
as normal, start up an X11 command window and give the 
following command sequence:

 tcsh
 esp-r
 
To find out what command line options are available
for an ESP-r module use the -help option with
the module name e.g. 'espvwf -help' (without the quotes).

Note: the ESP-r executables were created on a Intel MacBook
computer running a OSX 10.5. It should run on most OSX machines 
which have X11 and the developer tools installed. The
GTK version will require libgtk-x11-2.0 libgdk-x11-2.0 libatk-1.0
libgdk_pixbuf-2.0 libpangoxfg-1.0 libpangox-1.0 libpango-1.0
libgobject-2.0 libglib-2.0 libintl libiconv. 

If ESP-r refuses to run you might have to download a few 
packages via the fink environment (more about that in
setting_up_osx.txt). On Intel based machines it reportedly
runs in emulation mode but you may need to put libgfortran
libraries into /usr/local/lib.

On Macs with older versions of OSX you may get warnings
about undefined symbols. If this happens you are probably
going to have to compile ESP-r on your machine.

Full instructions for setting up your Mac prior to using
this installer are found in the file setting_up_osx.txt

Check the ESRU web site <http://www.esru.strath.ac.uk>
for tutorials, publications and the ESP-r Cookbook and
Cookbook exercises as well as for information on how to 
join the ESP-r discussion list.



Notes for the compressed tar file install process

As an alternative for OSX machines do not work well with self-extractor. 
In this case the gzipped tar files can be used to install ESP-r. The 
following is a list of steps that users should take in order to install 
via a tar file.

The first step is to prepare a folder to install the ESP-r distribution. The
usual location is /opt/esru.  If you already have an /opt folder then skip
to `section two`. Because /opt is a protected folder it prevents normal users
from writing files in it and that ensures that the `corporate` databases ESP-r
uses cannot be casually modified. Installing an application in /opt requires
that you use the `sudo` command to preface your commands.

ESP-r requires an X11 environment to be installed on your OSX box. 
This is an optional set of packages which will be located on your 
operating system install DVD. If you see the X11 logo icon in your 
doc you probably have X11 installed. If you do not see it check in the 
Applications folder.  If it is not there then you need to install X11 from 
the DVD before proceeding.

There is some information you will need. Start up either a terminal 
or and X11 window. Issue the following commands

  cd
  ls -l

You are looking for your user name and your group name. E.g.

drwxr-xr-x    60 jon  jon       2040 Jul 15 06:49 testing

the first jon is the user name and the second instance is the 
name of the group. In some cases the second instance might 
be staff or users.

There are two version of ESP-r for OSX. One is based on 
the X11 graphics library and is a complete version of ESP-r 
but is an older style of interaction. The other version of 
ESP-r uses the GTK graphics library with a modern style of 
interaction (but it is not quite a complete port of ESP-r). 
The web page gives more information on the specific differences.

To determine if it is necessary to create the /opt folder start
up either a terminal or and X11 terminal. In the terminal
give the following command:

  ls -l /

in the listing given look for the following line:

drwxr-xr-x    15 root  admin      510 Aug 31 12:38 opt

If you find this entry then there exists a /opt folder and
you should skip down to Section Two.

To create a new /opt folder give the following commands. Lets
assume that your login name is fred and your group is staff.

  cd /
  sudo mkdir opt
  sudo chmod a+x opt
  sudo chmod a+r opt
  cd /opt
  sudo mkdir esru
  sudo chown fred esru
  sudo chgrp staff esru
  sudo chmod a+x esru
  sudo chmod a+r esru
  sudo chmod u+w esru


Section two

This section assumes that a /opt folder exists. As a standard
user you probably do not have permission to write new files and
folders in /opt so you will have to use the 'sudo' command.
The following commands create a folder /opt/esru

  cd /opt
  sudo mkdir esru
  sudo chown fred esru
  sudo chgrp staff esru
  sudo chmod a+x esru
  sudo chmod a+r esru
  sudo chmod u+w esru

Copy the the_file_name_tar.gz file (the_file_name represents 
the name of the file that you downloaded or was created in in 
the procedures above) to the / folder via the following commands 
(depending on which version of ESP-r you want:

 cd to_the_folder_with_the_tar.gz file
 sudo cp the_file_name.tar.gz /
 cd /
 sudo gzip -d the_file_name.tar.gz
 
 sudo tar xf the_file_name.tar

This will create the ESP-r folder structure within /opt/esru
but it will be owned by the root user.  You now need to
alter the ownership of the /opt/esru folder structure.

Now lets make sure that everything in the folder /opt/esru
is available to be owned
  cd /opt/esru

  ls -l

And you should see
total 0
drwxr-xr-x   14 fred  staff  476 Aug 27 02:46 esp-r

If you see that the user is root and the user is admin
then we need to alter this via the following commands:

  cd /opt
  sudo chown -R fred esru
  sudo chgrp -R staff esru

You will need to set an environment variable PATH as explained above.
You will probably also need to log out and then back in again to
have the new environment variables established.

To check and see if ESP-r can be found try typing in the 
following command(s) in an X11 terminal (the OSX terminal
is only suitable for text based applications).

  which prj
  which bps

If there is a response then you should be able to start up the
ESP-r project manager via the command 'prj'.  If the application
does start up then the environment variables have been set
correctly.  

If you are working with existing models you should change the
folder focus in the X11 terminal to the model configuration folder
and start the project manager with the pattern:

  prj -model my_model.cfg

Once ESP-r is working you can remove the_file_name.tar

