*help_text prj
*subroutine Initialise
*subroutine Deallocate
*item Deallocate
*enditem
*item AIM2_Inputs AIM2_main_menu
'This is the main menu for the empirical air '
'Alberta Infiltration Model (AIM2).  This model applies'
'only to low rise (up to 3 storey) detatched single family'
'residendial buildings.'
' '
'  a. Blower door test data to describe leakage or'
'     defined by air tightness type.'
'  b. Leakage distribution to ceiling, wall and'
'     floor.'
'  c. Terrain at weather station and building site,'
'     shielding at walls and flue, and anemometer height'
'     are all used to calculate the wind speed correction'
'     factor.'
'  d. Height of building eves is used to define the height'
'     of the eaves. The height of the building eaves'
'     defaults to 2.5m*(# of storeys) + 0.5m, based on the'
'     number of storeys indicated in the house '
'     specifications description. This value may be '
'     overwritten. If the number of storeys is '
'     subsequently changed, esp-r defaults the eaves'
'     height accordingly. '
'  e. Fireplace and DHW flue diameters are used to specify'
'     the diameter of the flue on a combustion type water '
'     heater. Esp-r will assign a default value based on '
'     the tank type. This default value can be overwritten'
'     at any time.'
'  f. Reference zone for infiltration calculation,'
'     and zone indexing of zones receiving '
'     infiltration.'
*enditem
        CALL PHELPD('AIM2 model menu',30,'-',0,0,IER)
*subroutine AIM2_Interface
*item AIM2_Interface AIM2_attributes_a
'A number of attributes are needed to carry out an assessment'
'based on the AIM method. You are asked about the following:'
'  '
' Anemometer Height is the height at which the wind speed'
'   was measured at the weather station.  A default of 10m'
'   is assumed, and should not be changed unless a user-'
'   defined weather file is used and the anemometer was at'
'   a different height.'
'  '
' Flue diameters (mm) may be required for the furnace flue'
'   as well as up to two fireplaces.'
'  '
' If there is a primary DHW system that has a flue then its'
'   flue diameter in mm is requested. If there is a secondary'
'   DHW system supply the data for that as well.'
'  '
' Height of the building eaves (m). Values betwen 1 and 10'
'   are allowed. A building can only have one eves height.'
'  '
'If you change any of the parameters please remember to save'
'these changes to the file of the information will be lost.'
*enditem
           CALL EASKR(Temp,' ',
           CALL EASKR(Temp,' ',
           CALL EASKR(Temp,' ','Diameter of furnace flue (mm)?'
           CALL EASKR(Temp,' ','Diameter of #1 fireplace flue (mm)?'
           CALL EASKR(Temp,' ','Diameter of #2 fireplace flue (mm)?'
           CALL EASKR(Temp,' ',
           CALL EASKR(Temp,' ',
           CALL ASKOK(' Do you wish to save your changes?',' ',OK,
*subroutine LeakageMenu
*item LeakageMenu AIM_leakage_menu
'The Air Tightness Type is used to indicate the natural'
'infiltration rate. Air tightness is measured in air '
'changes per hour (ACH). The user has the option of '
'entering blower door test values to determine the flow'
'coefficient or specifying an air tightness category where'
'air change rate and the equivalent leakage area are '
'automatically calculated by esp-r.'
' '
'For further information on the blower door tests see'
'1. Canadian General Standards Board (CGSB) standard'
'   Determination of the Airtightness of Building '
'    Envelopes by the Fan Depressurization Method '
'2.  Airtightness tested in accordance with the EnerGuide'
'    for Houses <as operated> airtightness test procedure'
'    in EnerGuide for Houses: Energy Advisor Workshop'
'    Manual, Module 3 Conducting a Blower Door Test. '
*enditem
        CALL PHELPD('Leakage description',16,'-',0,0,IER)
*subroutine AirTightnessTypeMenu
*item AirTightnessTypeMenu AIM_tightness_menu
'The Air Tightness Type is used to indicate the natural'
'infiltration rate. Air tightness is measured in air '
'changes per hour (ACH). The options are:'
'  Loose (10.35 ACH @ 50 Pa)       '
'  Average (4.55 ACH @ 50 Pa)      '
'  Present (3.57 ACH @ 50 Pa)      '
'  Energy Tight (1.5 ACH @ 50 Pa)  '
'  '
'By specifying one of these air tightness categories, the'
' air change rate and the equivalent leakage area are '
 'automatically calculated by esp-r.'
*enditem
        CALL PHELPD('Leakage description',10,'-',0,0,IER)
*subroutine BlowerDoorInputMenu
*item BlowerDoorInputMenu AIM_blower_door_menu
'The blower door test values entered determine the flow'
'coefficient.  The blower door test results consist of the'
'Air Change Rate @ 50 Pa. and the Equivalent Leakage Area'
'(ELA). These results are used to determine the amount of'
'air leaking through the envelope when an interior/'
'exterior air pressure differential of 50 Pa air pressure'
'is applied. Esp-r uses the blower door test data to '
'generate an air infiltration rate, which provides a '
'relatively accurate indication of the air leakage '
'characteristics of the building. The ELA may be specified'
'at either 10 Pa. or 4 Pa. If the ELA is set to zero (0),'
'the program estimates the ELA at the specified pressure '
'based on the ACH @50, and an assumed flow exponent of '
'  '
'You are asked to provide information on:'
'  building fabric flow coef [m^3/(s Pa^n)]'
'  building flow exponent [-]'
'  '
'You may be asked about:'
'  Air change rate @50 Pa (between 1 and 30).'
'  The pressure difference in Pa'
'  The equivalent leakage area (ELA) in cm^2 (between 0.1 and'
'    7999.).
'  The discharge coefficient for the ELA (between 0. and 1.)'
'  '
'If you have had a blower door test these information are'
'usually supplied.'
*enditem
        CALL EASKR(Temp,' ',
        CALL EASKR(Temp,' ',
        CALL EASKR(Temp,' ',
        CALL EASKR(Temp,' ','Pressure difference (Pa)?',
        CALL EASKR(Temp,' ',
        CALL EASKR(Temp,' ',
        CALL PHELPD('Leakage description',14,'-',0,0,IER)
*subroutine LeakageDistribution
*item LeakageDistribution AIM_leak_distr_menu
'Leakage Fraction for Ceilings, Walls, and Floors'
'The leakage fractions are used to define the fraction of'
'the total building air leakage to attribute to the '
'ceilings, walls and floors.'
'  '
'If use defaults is selected, the default values are set '
'by esp-r and are based on the house type, number of'
'storeys, and the type of foundation (crawl space, '
'basement) specified for the house.'
'  '
'Otherwise the user must specify the leakage fractions '
'to ceilings, walls, and floors. The desired leakage '
'fractions must be entered as decimal values, and must '
'total 1.0.'
*enditem
      CALL EASKAB(
      CALL EASKR(Temp,' ',
      CALL EASKR(Temp,' ',
      CALL EASKR(Temp,' ',
*subroutine ShieldingAndTerrainMenu
*item ShieldingAndTerrainMenu AIM_terrain_menu
'The weather station terrain is used to specify the '
'terrain at the weather station and the building site'
'terrain is used to specify the local terrain for the'
'building.  The default for the weather station is'
' opton c) Open Flat terrain, grass.'
'  '
'The two terrains are used to calculate the wind speed'
'correction factor. This is a function of the surface'
'roughness lengths at the building site and weather '
'station, the height of the eaves, and the height of '
'the anemometer at the weather station. '
'This is equation 27 from Bradley (1993, p8).'
*enditem
        CALL PHELPD('Shielding and terrain description',11,'-',0,0,IER)
*subroutine TerrainMenu
*item TerrainMenu AIM_terrain_options
'The weather station terrain is used to specify the '
'terrain at the weather station and the building site'
'terrain is used to specify the local terrain for the'
'building.  The default for the weather station is'
' option c) Open Flat terrain, grass.'
'  '
'The two terrains are used to calculate the wind speed'
'correction factor. This is a function of the surface'
'roughness lengths at the building site and weather '
'station, the height of the eaves, and the height of '
'the anemometer at the weather station. '
'This is equation 27 from Bradley (1993, p8).'
*enditem
        CALL PHELPD('Terrain selection',11,'-',0,0,IER)
*subroutine ShieldingMenu
*item ShieldingMenu AIM_shielding_options
'Local Shielding Walls and Flue'
'The Local Shielding Walls and Flue fields are used to '
'specify how well both the walls and the flue are shielded'
'from the wind.  The options are:'
'1. None: no local shielding (i.e. no obstructions)'
'2. Light: local shielding having few obstructions within '
'   two house heights'
'3. Heavy: local shielding having many large obstructions'
'   within two house heights'
'4. Very Heavy: local shielding having many large '
'   obstructions within one house height'
'5. Complete (by large buildings): local shielding having'
'   large buildings immediately adjacent'
*enditem
        CALL PHELPD('Shielding selection',13,'-',0,0,IER)
*subroutine InfiltrationZonesMenu
*item InfiltrationZonesMenu AIM_zone_for_infil
'The reference zone is the number of the zone whose '
'temperature is used as reference for infiltration '
'calculations.'
' '
'The infiltration zones are the zone numbers of zones '
'that receive infiltration.'
' '
'The basement zone is the ESP-r zone describing '
'the basement as basements have different infiltration '
'air flow allocations to that of living space. If no '
'basement is selected from the list, it is assumed that '
'there is no basement.'
' '
'The crawlspace zone is an ESP-r zone describing'
'the crawlspace as crawlspaces are not included in the'
'house volume for infiltration calculations.  If no crawl'
'space is selected from the list, it is assumed that there'
'is no crawl space.'
' '
'The attic zone is an ESP-r zone describing the'
'attic as infiltration to attics is not calculated'
'with AIM-2 model. If no attic is selected from the list,'
'it is assumed that there is no attic.  '
*enditem
          CALL ASKZONE(Zone,Zone,
          CALL ASKMULTIZONE(AIM2_num_zones_infil,InfilZones,
          CALL ASKOK('Do you wish to revert to having no basement?',
          CALL EPICKS(1,IVALS,' ','Basement Zone?',
          CALL ASKOK('Do you wish to revert to having no crawlspace?',
          CALL EPICKS(1,IVALS,' ','Crawl space Zone?',
          CALL ASKOK('Do you wish to revert to having no attic?',
          CALL EPICKS(1,IVALS,' ','Attic Zone?',
          CALL PHELPD('Infiltration Zones',23,'-',0,0,IER)
*subroutine SAVE_AIM2
*item SAVE_AIM2 AIM_file_name
'You are asked for a file name. The suggested name is related to'
'the root name of the model. If this is ok, just accept it.'
*enditem
      CALL EASKF(LAIM2,' What is the AIM2 file name?',' ',
*subroutine BASESIMP_INPUTS
*item BASESIMP_INPUTS basesimp_opening
'One or more surfaces in the current zone may have been'
'attributed with the boundary condition BASESIMP. Or you'
'may wish to define the basement criteria and then attribute'
'the surfaces in the zone.'
'  '
'A .bsm file must be created or referenced.'
'You may select one from a list, create a new one, or'
'de-reference an exising definition (the file will be'
'kept for use later). '
'  '
'If a file exists in the model ../bsm directory, you may'
'select and use this file. Otherwise, create a new  '
'file and input the parameters or use the defaults. '
'                                                   '
'For the current .bsm file you have several options:'
' - You may use the values in the file as is (so no '
'   further actions are taken).'
' - You may choose to edit it and save the changes.'
' - You can defererence the BASESIMP definition (in'
'   which case the file is preserved for later use).'
'  '
'The following types of information are needed:'
'  Depth: distance from the top of the floor slab to'
'    the grade level. Must be between 0.05 and 2.4m '
'  '
'  Height: distance from the top of the floor slab to '
'    the top of the basement structural wall.'
'    Must be at least 0.1m greater than the depth.'
'    Must also be between 1.0 and 2.5m'
'  '
'  Width: exterior-of-structural-wall to exterior-of- '
'    structural-wall distance. Must be less than or equal'
'    to the length. Value must be between 2.0 and 20m.'
'  '
'  Length: exterior-of-structural-wall to exterior-of-'
'    structural-wall distance. Must be greater than or'
'    equal to the width.'
'  '
'  Insulation overlap: value must be given but only'
'    used for BCCN_1 and BCCN_2 combination cases.'
'    Height of the wall covered by both interior and'
'    exterior wall insulation (between 0 and 2.4m). '
'  '
'  Insulation thermal resistance:  enter the rsi '
'    value (m2K/W). (must be between 0 and 20 m2K/W.)'
'  '
'  Thermal conductivity of soil surrounding the foundation'
'    (W/mK). Must be between 0.1 and 10 W/mK.'
'  '
'  Water table depth: defines location of horizontal thermal '
'    boundary. The deeper the water table, the lower the '
'    foundation heat loss will be. Must be between 5 and 20m.'
*enditem
      CALL EASKABCD('Edit existing *.bsm?',' ','yes','no ',
      CALL EASKABCD('Create new *.bsm?',' ','yes','no ',
      CALL EASKABC('Use current .bsm values or edit? ',' ',
      CALL EASKR(bsmtDepth,' ',' Depth of the basement (m) ? ',
      CALL EASKR(bsmtHeight,' ',' Height of the basement (m) ? ',
      CALL EASKR(bsmtWidth,' ',' Width of the basement (m) ? ',
      CALL EASKR(bsmtLength,' ',' Length of the basement (m) ? ',
      CALL EASKR(Insul_Overlap,' ',' Insulation overlap (m)? ',
      CALL EASKR(Insul_rsi,' ',' Insulation rsi (m2K/W)? ',
      CALL EASKR(Soil_Cond,' ',' Soil conductivity (W/mK) ? ',
      CALL EASKR(Water_Table,' ',' Water table depth (m) ? ',
*item BASESIMP_INPUTS basesimp_moore_method
'If you choose to use the Moore Method,'
'TGavg, TGamp, TGps ground temperature parameters'
'will be calculated. Otherwise, you must enter'
'values for these parameters or use the defaults.'
' '
' TGavg: Average ground temperature (degC) (between -10 and'
'   20 (degC)'
'  '
' TGamp: Amplitude of the ground temperature (degC) (between'
'   0 and 25(degC)'
'  '
' TGps: Phase lag of ground temperature (radians) (between'
'  0 and 1 radians).'
'  '
'If you alter any information you will be asked to confirm'
'the name of the BASESMP .BSM file. If your project contains'
'the standard folder set, the file will be stored in a new '
'folder ../bsm '
*enditem
      CALL EASKABC('Method for handling ground temp:',' ',
      CALL EASKR(TGavg,' ',' TGavg (degC) ?',
      CALL EASKR(TGamp,' ',' TGamp (degC) ?',
      CALL EASKR(TGps,' ',' TGps (radians) ?',
      CALL EASKF(bsmFile,'Confirm filename:',' ',72,bsmFile,
*subroutine LKMENU
*item LKMENU adjustable_thermal_cond
'The menu options allow the definition of construction'
'layers whose thermal conductivity is of the nominated'
'type.  By default the thermal conductivity of all'
'construction layers is type CONSTANT.'
'  '
'The menu options are:'
' a constant thermal conductivity'
' b thermal conductivity determined as a funtion of'
'   layer temperature'
' c thermal conductivity determined as a funtion of'
'   layer moisture content'
' d thermal conductivity determined as a funtion of'
'   layer temperature and moisture content'
' < thermal conductivity of all layers set to constant'
' ! list conductivity of construction layers'
' ? display this help message'
' - return to calling menu.'
'  '
'   Note: when exiting this facility, if there are potential'
'   problems you will be warned. Best to fix these so that'
'   subsequent simulations run smoothly.'
*enditem
        CALL PHELPD('Thermal Conductivity',17,'-',0,0,IER)
        CALL ASKOK(' WARNING messages were detected',
*subroutine DFNMNU
*item DFNMNU focus_of_thermal_cond
'You can focus where thermal conductivity is adjusted at'
'from within the current zone or a specific surface or'
'within a specific surface.'
*enditem
        CALL PHELPD('conductivity focus',2,'-',0,0,IER)
*subroutine SURFMN
*item SURFMN focus_of_surf_cond
'You are presented with a list of surfaces from which'
'the conductivity will be adjusted.'
*enditem
      CALL EPICKS(INPICK,IVALS,' ',' ',20,NZSUR(icomp),ITEM,
*subroutine LAYRMN
*item LAYRMN focus_of_layer_cond
'You are presented with a list of layers in which'
'the conductivity will be adjusted.'
*enditem
      CALL EPICKS(INPICK,IVALL,' ',' ',20,NE(I), ITEM,'Layers',IER,2)
*subroutine TRMMSG
*item TRMMSG surf_cond_warning
'This message was presented because of prior warnings '
'or confusion about the model. If you do not want to '
'proceed agree to terminate. '
'  '
'You will be asked for the number of the warning messages'
'after which the termination option will be available.'
'If you cancel the value will not be altered. '
*enditem
      CALL ASKOK('There might be a problem...',
      CALL EASKI(ICNTMT,'After how many re_defining warning messages',
*subroutine KCHKMN
*item KCHKMN message_for_surf_cond
'Changing this will remove the temperature or moisture'
'dependency.'
*enditem
      CALL ASKOK(MSG1,MSG2,OK,dok,2)
*subroutine THMENU
*item THMENU non_linear_thrm_prop
'ESP_r allows defining the thermal properties of'
'materials to be linearly or non-linearly temperature'
'dependent .'
'For defining linear dependency of thermal conductivity:'
'option (k) of simulator menu is recommended du to its'
'flixibility .    '
'       '
'Via this menu you can descripe the variation (or'
'change) of the thermal properties (1: conductivity, '
'2:density, 3:heat capacity) of any layer (except air'
'gaps) as a function of temperature.  You can also '
'describe the variation of any thermal property of a '
'layer by more than one thermal functions (i.e. each'
'thermal function will be valid only for the temperature'
'range associated with it). Show me more has details. '
'  '
' The available options are :'
'  (a)  Show the next available thermal function'
'  (b)  Define the actuator location for displayed '
'       thermal function (via  other menues )'
'       The actuator location is required to define the'
'       range of layers for which the thermal equations,'
'       of the same thermal function, are applied.'
'       options are:'
'         complete building, selected zone, seleted construction'
          or selected layer'
'  '
'  (c)  define the thermal equation for  displayed '
'       thermal function  (via  other menues )'
'  '
'  (d)  creat a new thermal function which will be'
'       displayed in  NON-LINEAR PROPERTIES  menu'
'  '
'  (e)  delete the displayed thermal function and all'
'       data associated with it '
'  '
'  (f/g/h) manage the thermal configuration file which'
'       holds the user directives for these properties.'
'  '
'  (!)  list the complete  description of  thermal'
'       configuration defined so far '
'  (?)  display this window'
'  (-)  exit from then menu.'
'  '
'Note, when exiting from this facility if there have been'
'warnings or errors reported you should fix them if possible'
'so subsequent simulations run cleanly.'
*enditem
        CALL EPICKS(INPICK,IVAL2,' ',' ',24,4,ITEM2,
        CALL EPICKS(INPICK,IVAL3,' ',' ', 20,NCOMP,ITEM3,
        CALL EPICKS(INPICK,IVAL4,' ',' ',20,NC,ITEM4,
        CALL EPICKS(INPICK,IVAL5,' ',' ',20,NEL,ITEM5,
        CALL EASKS(ltmp,' Thermal configuration file name ?',' ',
        CALL EASKS(ltmp,' Thermal configuration file name ?',' ',
        CALL PHELPD('non-linear',30,'non-linear  ',0,0,IER)
        CALL ASKOK(' WARNING messages were detected',
        CALL ASKOK(' ',
*subroutine THRMEQ
*item THRMEQ thermal_equation_edit
'This menu is used to creat and/ or modify the thermal'
'equations of the thermal functions.  Modifying a'
'thermal equation is acheived by selecting it.'
'The available thermo-physical property types are:'
' '
'1 thermal conductivity'
'2 density'
'3 thermal capacity.'
' '
'The thermal equation is defined by:'
'               b       c       d       e'
'   P = A + B * T + C * T + D * T + E * T'
'   '
'where each thermal equation defines the dependence of'
'the property for the temperature range provided.'
'  '
' option c provides a list of the current equations.'
'  '
' options d/e/f/g are used to manage the thermal file which'
'   holds the user directives on linear/non-linear thermal'
'   properties.'
'  '
'When you create or edit an equation you are asked to give'
'it a title (up to 72 characters). It is recommended that'
'this title includes the material and thermo-physical'
'property names.'
*enditem
        CALL EASKS(EQNTXT,EQNMSG,' ',72,' ','thermal data',IER,12)
        CALL EASKS(EQNTXT,EQNMSG,' ',72,' ',' data ',IER,13)
        CALL EASKS(THFIL,' Thermal data file name ?',' ',72,' ',
        CALL EASKI(INUM,
        CALL EASKS(TITLE,' Title for this thermal equation?',' ',
        CALL PHELPD('equation mods',3,'-',0,0,IER)
*subroutine ADDCNTL
*item ADDCNTL ctl_manage_loops
'Controls are referenced by their index. '
'If you select cancel then you will be returned to '
'control menu. '
*enditem
        CALL EASKI(ID,' ',' Which control index to delete? ',
*item ADDCNTL ctl_add_loops
'Control day types allows different control patterns '
'on different days. Days are allotted to be weekdays, '
'saturdays and sundays by default. New day types (e.g.'
'holidays) can be defined and days linked to these new'
'day types via the calendar option in the Model Context'
'Menu. '
'  '
'If you choose to follow calendar day types you will have'
'the choice of imposing different control regimes on '
'different day types as default week/sat/sunday or as '
'defined from the calendar in the Model Context Menu. '
'If you choose "just one day type" then the '
'same control regime will be used for all day types.'
'If you choose "calendar day types" or "just one day'
'type" then these day types are assumed to be valid all '
'year long. '
'  '
'If you choose "dates of validity" you will be asked to'
'define periods in which control will be valid e.g.'
'you may have a different control for summer and winter.'
'Dates of validity should cover the whole year and be'
'continuous. If you do not intend to control during any'
'dates add a free floating controller.'
'If you cancel when specifying the day types the control'
'loop will not be added (and please confirm the details '
'in case an error crept in) '
'  '
'When adding a control loop you are asked for the number'
'of periods for each day type. The default is one period'
'starting at midnight and a free-float control.'
'You can specify that there will be several periods in'
'the day and then supply details later or add or delete'
'periods or adapt the timing.'
'If you cancel when specifying periods in the day type'
'the control loop will be removed. '
*enditem
          CALL EASKABC(outs,'(see help)',
	  CALL EASKI(IVP,'No of user defined control periods ',
          CALL EASKPER('Dates of validity:',IBDY,IEDY,IFDY,IER)
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
          CALL EASKABC(outs,'(see help)',
	  CALL EASKI(IVP,'No of user defined control periods ',
          CALL EASKPER('Dates of validity:',IBDY,IEDY,IFDY,IER)
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
          CALL EASKABC(outs,'(see help)',
          CALL EASKI(IVP,'No of user defined control periods ',
          CALL EASKPER('Dates of validity:',IBDY,IEDY,IFDY,IER)
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
          CALL EASKABC(outs,'(see help)',
          CALL EASKABC(outs,'(see help)',
	  CALL EASKI(IVP,'No of user defined control periods ',
          CALL EASKPER('Dates of validity:',IBDY,IEDY,IFDY,IER)
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
          CALL EASKABC(outs,' ',
          CALL EASKI(IV,'No of user defined control day types',' ',
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
*item ADDCNTL ctl_copy_loops
'Control functions are referenced by their index. You are asked'
'to identify which existing control loop to copy.'
'A cancel returns you to the main control menu. '
*enditem
        CALL EASKI(ICC,' ',' Which control function index to copy? ',
*subroutine ADDCTLD
*item ADDCTLD ctl_add_day_type
'You can modify the existing control day types in the model'
'by deleting a day type or adding a day type or copying a day'
'type.'
'  '
'If you ask to delete you are asked to provide the index of the day'
'type to act on.'
'  '
'If you ask to add a day type the default treatment is to'
'create one period in that day and set the control logic to'
'free-float. However you can specify several periods in the'
'new day type and period details that you can later change.'
'  '
'If you ask to copy a day type you are asked to identify which'
'one to copy. This is a rarely used option.'
'  '
'If you select continue then you will be returned to'
'the main control menu without any changes. '
*enditem
      CALL EASKABCD('Options: ',' ','delete day type',
      CALL EASKI(ID,' ',' Which day type (index)? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IDC,' ',' Which day type to copy ? ',
*subroutine ADDCTLDP
*item ADDCTLDP ctl_period_manage
'You can modify the existing control period in the model'
'by deleting a period or adding a period.'
'  '
'If you ask to delete you are asked to provide the index of the'
'period to act on.'
'  '
'If you ask to add a period you are asked its start time'
'and the initial assumption is for a free-float control law.'
'New periods are added at the end of the list (there is no'
'insert period function).
'  '
'It saves time if you set the time carefully when you are'
'first asked for it rather than attempting to edit it later.'
*enditem
      CALL EASKI(IP,' ',' Which period to delete ? ',
*subroutine initperi
*item initperi period_start_hour
'If you edit in actual start times acurately the subsequent '
'editing tasks will be easier. Currently the facility'
'does not support more than 24 periods. '
*enditem
      CALL EASKS(CSTR,' Start hour of each period',
*subroutine initperr
*item initperr period_start_hour
'If you edit in actual start times the subsequent '
'editing tasks will be easier. Currently the facility'
'does not support more than 24 periods. '
*enditem
      CALL EASKS248(CSTR,' Start time of each period',
*subroutine CONTRL
*item CONTRL sys_ctl_file_name
'The system control file holds the definition of the'
'building/plant control systems. The file is optional.'
'  '
'If your model already includes a control file then the'
'dereference option removes knowledge of the file without'
'removing the file.'
'  '
'The browse option presents a list of files in the'
'project `ctl` folder. If you do not select one then'
'it is assumed that you do not want any control.'
'If you cancel then nothing will be changed.'
*enditem
        CALL EASKS2CMD(LASCI,'Control file? (suggested name)',' ',
        CALL EASKS2CMD(LASCI,'Control file? (see help)',
        CALL EASKAB(' File not found.','Options:',
*item CONTRL sys_ctl_overview
'In order to provide realistic controls for zones,'
'plant systems and flow networks, a configuration'
'control file must be created. If this is not done'
'then the simulation will free float.'
' '
'Toggle the control focus to switch between controlled'
'entities. Select a control definition to edit it.'
' '
'The required data  are as follows.'
' + control system title; then for each sub-system'
'   (zones, plant, flow & global):'
'     + title & number of control loops; then for'
'       each loop:'
'         + sensor & actuator location, number of'
'           day types; then for each day type:'
'             + start & finish dates of validity,'
'               number of control periods; then for'
'               each period:'
'                + controller type, control law,'
'                  start time, number of data items'
'                  associated with control law and'
'                  value of each data item.'
'  '
'To edit a control loop select it.'
'  '
' option b: description of the overall control (<248 characters)'
'   for the model
'  '
' option c: documentation of the current domain control '
'   (<248 characters) so in combination there is space for recording'
'   the intent of control within the model.'
'  '
' option d: if zone control this creates associations between'
'   the zones in the model and the control loops. A zone with'
'   no associated control loop is assumed to free-float. A loop'
'   which is not used just takes up space but otherwise does no'
'   harm - so it is ok to create control loops for future use.'
'   You are asked for an index of the control loop that you want'
'   to associate with each zone. A zero specifies no control.'
'  '
' control loops: each control loop is defined by a number of'
'   attributes - which define where the sensor is located, where'
'   the actuator is located, periods when the control is valid'
'   as well as period data. Each of these can be edited separately.'
'  '
' option +:  manages control loops so you can add new controls'
'   delete control loops and copy control loops. You will be'
'   asked for the index of the control you want to act on.'
'  '
' option !: list the current contents of the control loops. The'
'   indicies are decoded into descriptive phrases.'
'  '
' option >: save control data THIS IS IMPORTANT because any'
'  changes are only held in memory until you write to file.'
'  '
'When you exit this facility if you have not specified any links'
'between zones and control loops you are warned (so you can change'
'this if required.'
'  '
*enditem
        CALL EASKS248(t248,' ','Control system description?',
        CALL EASKS248(t248,' ','Zone control description?',
        CALL EASKS248(t248,' ','Plant control description?',
        CALL EASKS248(t248,' ','Flow control description?',
        CALL EASKS248(t248,' ','Global control description?',
        CALL EASKS248(t248,' ','Electrical control description?',
        CALL EASKS248(t248,' ',' Optical control description?',
        CALL EASKS248(t248,' ',' Complex fen. control description?',
        CALL EASKI(ICA,'Associated control function',
        CALL EASKI(ICA,'Associated control function',outs,
        CALL ASKOK('Control functions have not yet been',
        CALL ASKOK(' ','Save changes to control file?',OK,dok,2)
        CALL PHELPD('control help',24,'-',0,0,IER)
        CALL EASKS(LASCI,'Control file?',' ',72,' ','Control file',
        CALL EASKABC(' ','Options:',
        CALL EASKATOG(' ','Options:','delete control loop',
        call MENUATOL(outs,'Editing Options',
        call MENUATOL(outs,'Editing Options',
*subroutine totctlper
*subroutine EBCNTRL
*item EBCNTRL sys_bctl_periods
'A number of control periods can be defined for each'
'control day type. Each period has a start time (N.B'
'periods may not overlap), a sensed property, an actuated'
'property, a control law and miscellaneous data items'
'defining available capacity, set-points etc.'
'  '
' editing common control period data: '
'   start time - a hour plus fraction 10h30 is 10.5'
'     the initial period of a control loop must start at'
'     midnight e.g. 0.0 hours.'
'  '
' option * control periods can be managed by adding a period'
'   at the end of the list of periods (there is no insert'
'   function) or a control loop can be deleted. The only'
'   way to insert a period is to add at the end and then'
'   redefine the earlier priods.'
'   Next time plan your control periods carefully so as to'
'   avoid the need to insert a period.'
*enditem
       CALL PHELPD('control period help',5,'-',0,0,IER)
       CALL EASKABC(' ','Options:',
*item EBCNTRL sys_bctl_types
'The basic zone controller is an ideal controller that'
'will inject or extract sufficient flux (subject to'
'the defined heating and cooling capacities) to ensure'
'the heating and/or cooling set point is reached. It is'
'a good initial controller for use in establishing demand'
'patterns without the need for tuning of PID controllers.'
' '
'A free float controller allows the zone temperature'
'to reach whatever temperature is consistent with the '
'heat gains and losses in the zone. No environmental'
'control is applied. A typical free float might be used'
'in the evening if no frost protection is required.'
' '
'The ideal fixed injection controller represents'
'systems which operate with a fixed input when heating'
'and/or cooling is requested. '
' '
'An ideal proportional controller with optional'
'integral and/or derivative action time allowing'
'full PID control.'
' '
'A control which links a zone with a system network'
' '
'A multi-stage controller with hysteresis allows'
'the specification of heating and cooling capacities'
'for different stages.'
' '
'Variable supply temperature with limit constraints '
'is an idealised air based control that delivers air'
'at a fixed flow rate (same for heating & cooling '
'operation). The heating supply temperature varies '
'up to a maximum setpoint and the cooling supply '
'temperature varies down to a minimum setpoint. '
' '
'Control with separate on/off setpoints allows '
'separate flux ON and flux OFF set points for '
'heating and cooling via ON until OFF point logic.'
' '
'Time proportioning control with separate on/off '
'setpoints for heating and cooling extends the '
'functionality with cycle time limits. '
' '
'The floating action (three-position) controller'
'uses an open switch and shut switch differential (C)'
'for heating and cooling as well as timestep rate of '
'change for heating and cooling.'
' '
'The optimum start controller allows for three modes'
'of operation (each with rewind): '
' (1) default start at 4:00;'
' (2) start at user defined time;'
' (3) time estimate using Birtles & John equation.'
' '
'Proportional capacity slave controller. Typically a'
'slave control is used to represent an environmental'
'control with a thermostat in one zone and actions in'
'a number of zones.'
' '
'Match sensed values (ideal:2 setpoints) control law:'
'this is a combination of the ideal controller and'
'control law 11 where values from the temporal file'
'are taken to set the setpoints for heating and cooling'
*enditem
  63    CALL EPICKS(IX,IVALS,' ','Control law:',
        CALL EASKR(tcps,' ','Period start time?',
*item EBCNTRL sys_bctl_thermo_sub
'One specialized control (which is usually a nested control)'
'allows up to three surfaces in a zone to have alternative MLC'
'used as long as the alternative has the same number of layers.'
'These are the indices of the multi-layer constructions'
'for the 1st, 2nd and 3rd surfacesmto which substitutions'
'are to be made. If less than 3 surfaces then assign zero to'
'the remaining slots.'
*enditem
          CALL EASKR(cm(2),outs,' Substitution: 0) off, 1) on?',
          CALL EASKS(HOLD,' ','MLC index for 1st/2nd/3rd surfaces?',
*item EBCNTRL
'The number of data items required is either'
'5 or 7 and depends on whether there is an'
'extract component (e.g fan).'
' data are:'
'   supply component (select from list) and node index'
'  '
'   coupling type index depends upon the component that'
'   connects the plant to the building zone.'
'     For warm/cool air-based systems use type 1.'
'     While the ESP-r simulator can use an iterative'
'     method to solve the combined buidling and'
'     plant systems, it is often acceptable to solve'
'     the two domains sequentially. IN this case the'
'     building domain is solved first. The results'
'     are then saved and the simulation moves on to'
'     the next time step.'
' '
'     Since the plant domain is solved after the'
'     building domain, the building domain solver'
'     must use the plant injection temperature from'
'     the previous time step when calculating the'
'     amount of heat injected into the zone. Two'
'     methods are offered for calculating the amount'
'     of heat injection/extraction:'
' '
'     1) Sequential boundry conditions: the Simulator'
'       uses the plant boundary conditions from '
'       the previous time step but zone boundary'
'       conditions from the present time step (to'
'       solve the zone-side energy balance). This'
'       approach can lead to inequality between'
'       the heat flux injected into the zone and '
'       the amount extracted from the plant, '
'       especially at large time steps.'
'     2) Concurrent boundary conditions: the'
'       Simulator uses the zone and plant conditions'
'       from the pervious time step to calcuate '
'       the heat injection that prevailed over '
'       the previous timestep, and injects this '
'       into the zone at the current time step. '
'       This approach ensures that the heat flows'
'       calculated in the building and plant '
'       domains can be reconciled over the '
'       sumulation period'
' '
'     For radiators, heated floors, etc. use type 2. '
'  '
'   max heating (W) to roughly match component capacity'
'   max cooling (W) to roughly match component capacity'
'   extract component index and variable type
*enditem
          CALL EASKR(cm(1),'Number of miscellaneous','data items?',
          CALL ASKPCMP(' Supply plant component ? ',
          CALL EASKR(cm(4),'  Coupling type',
          CALL EASKAB(
          CALL EASKR(cm(5),' ','Maximum heating flux (W)?',
          CALL EASKR(cm(6),' ','Maximum cooling flux (W)?',
          CALL ASKPCMP(' Extract plant component ? ',
          CALL EASKR(cm(2),' Iteration index',
*item EBCNTRL sys_bctl_heat_pipe
'A specialized control approximates the heat transfer of'
'a heat pipe buried within a construction. You are asked for:'
'  iteration index - zero is none, one allows iteration'
'  index of surface in the zone'
'  index of outer node of heatpipe'
'  index of inner node of heatpipe'
'  critical temperature degrees C'
'  maximum number of iterations'
'  flux difference tollerance to meet (W)'
'  flag for trace zero is none, one is trace on'
*enditem
          CALL EASKR(cm(3),' ',' Surface no with heat pipe ? ',
          CALL EASKR(cm(4),' ',' Outer node for heatpipe ? ',
          CALL EASKR(cm(5),' ',' Inner node for heatpipe ? ',
          CALL EASKR(cm(6),' ',' Critical temperature ? ',
          CALL EASKR(cm(7),' ',' Maximum no of iterations ? ',
          CALL EASKR(cm(8),' ',' Flux difference tolerance ? ',
          CALL EASKR(cm(9),' Trace flag...',
*item EBCNTRL sys_bctl_11
'ESP-r allows you to control to a temperature based on'
'one or two sensor locations (defined as triplets) or'
'from a column of timestep information in a temporal'
'file.'
'This is an ideal controller (there is a separate ON/OFF'
'multi-sensor controller as control 12).'
' '
' The number of data items required is in the range'
' 10 to 16 and depends on the auxiliary sensor mode'
' selected.'
'                                   |no. of| |no. of|'
'          Function                 |aux sn| |items |'
 '---------------------------------------------------'
' greatest val of aux`y sensors         1       10 '
'   `      `  `    `     `              2       14 '
' least val of aux`y sensors            1       10 '
'   `    `  `    `     `               2       14 '
' mean val of aux`y sensors            1       10 '
'   `   `  `    `     `                2       14 '
' weighting of aux`y sensors           2       16 '
' '
'PLUS 1 item for scaling factor (i.e. a % offset)'
'PLUS 1 item for offset factor (absolute offset) '
' '
'NOTE: if you are using this control to get a setpoint'
'from a temporal file a zone control might already have'
'created within the model context->temporal data menu.'
' '
'Heat delivery is normally set high so that the '
'target temperature is attained. The heating minimum '
'is normally 0 but if > 0 then heating will continue'
'at the minimum even when the temperature is'
'reached. '
'In the unlikely event that you want to control to'
'another temperature but allow no cooling capacity '
'the control may not work properly.'
' '
'At present, this control is limited to 2 auxiliary sensors'
'which may be located outside or in other zone(s).'
'If just one sensor it is assumed to be the mean condition.'
'If multiple sensors then you have the option of:'
' 1: (ref sensor)-(greatest value of aux sensors)'
' 2: (ref sensor)-(least value of aux sensors)'
' 3: (ref sensor)-(mean value of aux sensors)'
' 4: (ref sensor)-(weighting of aux sensors)'
*enditem
        CALL EASKR(cm(1),' ','Number of misc data items (see help)',
        CALL EASKS(HOLD,
        CALL EASKR(cm(6),' ','No of auxiliary sensors?',
        CALL EASKR(cm(7),' ','Multi-sensor mode (see help)?',
*item EBCNTRL bctl_11_aux_sens
'The sensor details are essentially the same as '
'required in a control point sensor ie. '
' 1st aux item >0 is a zone and or surface, =0 any zone,'
'   = -1 measuring plant component,  '
'   = -2 measuring mix air:radiant,'
'   = -3 ambient where the 2nd item is:'
'        0 = db, 1 = sol-air, 2 = wind velo, '
'        3 = wind dir, 4 = diffuse rad, '
'        5 = direc norm rad, 6 = RH'
'  = -5 an item in a temporal file AND the 2nd aux item'
'       is the column of the temporal item.'
'       NOTE: these would already be set for you if'
'       you used the context->temporal data menu'
'       option to associate a temporal setpoint item'
'       with a model.'
' '
' 2nd item is used to further specify the location '
' 3rd item is used to further specify the location '
' 4th item is always zero '
'  '
'The sensor weightings must total exactly 100.0'
'This allows you to discount one of the sensors.'
'  '
'Lastly you can apply a scaling factor to the sensed value'
'derived from the weighted multiple sensors:'
'  sensor scaling factor is applied to the sensed'
'    value at each timestep e.g. (20C sensed x 1.1) would'
'    request a 10% rise over measured.'
'  sensor offset allows you to modify the sensed'
'    value by a fixed amount. '
*enditem
          CALL EASKR(cm(ndx),' ',
          CALL EASKR(cm(ndx+1),' ',' Aux sensor detail 2nd item?',
          CALL EASKR(cm(ndx+2),' ',' Aux sensor detail 3rd item?',
          CALL EASKR(cm(ndx+3),' ',
          CALL EASKR(cm(ndx),' ',
          CALL EASKR(cm(ndx),' ',' Scaling factor?',
          CALL EASKR(cm(ndx+1),' ',' Offset factor?',
*item EBCNTRL sys_bctl_12
'ESP-r allows you to control to a temperature based on'
'one or two sensor locations (defined as triplets) or'
'from a column of timestep information in a temporal'
'file.'
'This is an On/Off controller (there is a separate ideal'
'multi-sensor controller as control 11).'
' '
' The number of data items required is in the range'
' 10 to 16 and depends on the auxiliary sensor mode'
' selected.'
'                                   |no. of| |no. of|'
'          Function                 |aux sn| |items |'
 '---------------------------------------------------'
' greatest val of aux`y sensors         1       10 '
'   `      `  `    `     `              2       14 '
' least val of aux`y sensors            1       10 '
'   `    `  `    `     `               2       14 '
' mean val of aux`y sensors            1       10 '
'   `   `  `    `     `                2       14 '
' weighting of aux`y sensors           2       16 '
'  '
'Heat delivery is normally set high so that the '
'target temperature is attained. The heating minimum '
'is normally 0 but if > 0 then heating will continue'
'at the minimum even when the temperature is'
'reached. '
'In the unlikely event that you want to control to'
'another temperature but allow no cooling capacity '
'the control may not work properly.'
' '
'At present, this control is limited to 2 auxiliary sensors'
'which may be located outside or in other zone(s).'
'If just one sensor it is assumed to be the mean condition.'
'If multiple sensors then you have the option of:'
' 1: (ref sensor)-(greatest value of aux sensors)'
' 2: (ref sensor)-(least value of aux sensors)'
' 3: (ref sensor)-(mean value of aux sensors)'
' 4: (ref sensor)-(weighting of aux sensors)'
*enditem
          CALL EASKR(cm(1),' ',' No. of misc data items ',
          CALL EASKS(HOLD,
          CALL EASKR(cm(6),' ',' No of auxiliary sensors ? ',
          CALL EASKR(cm(7),' ',' Multi-sensor mode ? ',
*item EBCNTRL bctl_12_aux_sens
'The sensor details are essentially the same as '
'required in a control point sensor ie. '
' 1st item >0 is a zone and or surface, =0 any zone,'
'   = -1 measuring plant component,  '
'   = -2 measuring mix air:radiant,'
'   = -3 ambient where the 2nd item is:'
'        0 = db, 1 = sol-air, 2 = wind velo, '
'        3 = wind dir, 4 = diffuse rad, '
'        5 = direc norm rad, 6 = RH'
' '
' 2nd item is used to further specify the location '
' 3rd item is used to further specify the location '
' 4th item is always zero '
'  '
'The sensor weightings must total exactly 100.0'
'This allows you to discount one of the sensors.'
*enditem
            CALL EASKR(cm(ndx),' ',' Aux sen detail 1st item ?',
            CALL EASKR(cm(ndx+1),' ',' Aux sen detail 2nd item ?',
            CALL EASKR(cm(ndx+2),' ',' Aux sen detail 3rd item ?',
            CALL EASKR(cm(ndx+3),' ',
            CALL EASKR(cm(ndx),' ',' Aux sensor weighting ? ',
*item EBCNTRL sys_bctl_opt_stop
'An optimal stop controller is implemented which requires'
'the following data:'
'  maximum heating capacity (W)'
'  maximum cooling capacity (W)'
'  heating setpoint (C)'
'  cooling setpoint (C)'
'  desired temperature when occupants depart (C)'
'  throttling range (C)'
'  occupancy departure time (hour.fraction)'
'  minimum time difference (fraction of hour)'
'  initial guess for optimal stop time (hour.fraction)'
'  '
'If the difference between successive estimates is'
'less then the `Min. Time Diff`, then the latest'
'time is accepted as the `Optimum Stop Time`.'
*enditem
          CALL EASKR(cm(2),' ',' Maximum heating capacity (W) ? ',
          CALL EASKR(cm(3),' ',' Maximum cooling capacity (W) ? ',
          CALL EASKR(cm(4),' ',' Htg Set pt ? ',
          CALL EASKR(cm(5),' ',' Clg Set pt ? ',
          CALL EASKR(cm(6),' ',' Desired temp ? ',
          CALL EASKR(cm(7),' ',' Throtl range ? ',
          CALL EASKR(cm(8),' ',' Occpy dept time ? ',
          CALL EASKR(cm(9),' ',' Min time diff ? ',
          CALL EASKR(cm(10),' ',' Initial guess ? ',
*item EBCNTRL sys_bctl_fuzzy
'ESP-r implements two types of fuzzy logic controls.'
'The control attributes holds all the information about'
'the fuzzy membership functions. At least one such '
'set MUST exist if this control law is to used.'
' '
' The control mode may be one of the following:'
' 1:= Fuzzy logic PI control;'
' 2:= Fuzzy logic PD control.'
'  '
' You are asked for a single set point temperature (C).
'  '
' There is a choice of two defuzzification methods:'
' 1:= Mean-of-Max method;'
' 2:= Centre-of-Area method.'
'  '
' Error scale and a change of error scale are used to tune'
' the fuzzy controller.'
'  '
' Lastly there is a output scale value required.'
*enditem
          CALL EASKR(cm(2),' ',' Referenced data set ? ',
          CALL EASKR(cm(3),' ',' Control Mode ? ',
          CALL EASKR(cm(4),' ',' Set point ? ',
          CALL EASKR(cm(5),' ',' Defuzzification method ? ',
          CALL EASKR(cm(6),' ',' Error scale ? ',
          CALL EASKR(cm(7),' ',' Change of Error scale ? ',
          CALL EASKR(cm(8),' ',' Output scale ? ',
*item EBCNTRL sys_bctl_multi_sensor
'A multi-sensor control is used to inject/extract heat in one zone'
'(termed source) based on conditions in other locations (termed'
'auxilliary sensors).'
' '
'If any of the auxilliary sensors demands heat then heat will be'
'injected in the source zone. For cooling heat will be extracted'
'from the source. If there are simultaneous demands for heating'
'and cooling nothing will happen.'
' '
'A classic use is to condition a mixing box/air handler used'
'within an air flow network to deliver heating or cooling to'
'an occupied space. '
' '
'If you are using a multi-sensor controller to enable a chilled'
'ceiling (represented as a zone) or a radiant heating panel'
'or a Korean Ondol thin floor heater (represented as a zone)'
'then these set  points are the temperature of the working fluid in'
'the radiant panel. Later you will be asked for the set points'
'for the occupied space(s). '
' '
'If you do not wish cooling use a high set point such as 100C'
'A 0 deg C cooling setpoint does not turn cooling off. '
' '
'Example: to heat a radiant panel to 70C in order to get a'
'temperature of 21C in adjacent room(s).'
' '
'Heat delivery may be less than the max. If minimium'
'heating > 0 then heating will continue at a reduced level'
'even when the setpoint is reached. If there is no cooling'
'then use zero values in conjunction with a high cooling setpoint.'
' '
'Note this type of control is an ON/OFF control and thus you'
'should use an appropriately short timestep of one or two minutes'
'if there is not much mass in the radiant panel or if there is a'
'considerable air air flow rate. '
' '
'Note: set the sensor at the air node rather than mixed rad/conv.'
' '
'Also for both heating and cooling panels it is common to inject'
'at the air node and to use a heat transfer coefficient regime '
'at the surfaces to ensure flux is transferred to the panel. '
'For a mixing box it is usually not necessary to use a hc regime.'
' '
'The aux sensor details are the usual 4 values:'
'  Example: to sense air temperature is 3rd zone'
'    3.0  0.0  0.0  0.0'
' '
'This data is followed - per sensor - by the heating set-point'
'and cooling set-point for that auxiliary sensor.'
' '
'Thus the number of control data items is thus 7 + 6 * no. of sensors'
' '
' Example: to sense air temperature in 3rd zone which'
'    needs to be heated to 21.1C and no cooling'
'    3.0 0.0 0.0 0.0 21.1 100.0 '
'  '
'It is worth gathering information on sensor locations and carefully'
'checking the data/QA report afterwards.'
*enditem
          CALL EASKS(HOLD,' Max & Min heat capacity, Max & Min cool ',
          CALL EASKS(HOLD,
          CALL EASKI(I8,' ',' Number of aux sensors (see help)',
          CALL EASKR(cm(ndx),' ',' Aux sensor detail 1st item ?',
          CALL EASKR(cm(ndx+1),' ',' Aux sensor detail 2nd item ?',
          CALL EASKR(cm(ndx+2),' ',' Aux sensor detail 3rd item ?',
          CALL EASKR(cm(ndx+3),' ',
          CALL EASKR(cm(ndx+4),' ',' Aux sensor heating set-point ?',
          CALL EASKR(cm(ndx+5),' ',' Aux sensor cooling set-point ?',
*item EBCNTRL sys_bctl_wetted_surf
'A wetted surface can either be a wet opaque surface '
'in the zone or the floor of the zone can'
'contain a swimming pool, some additional data is '
'required from user for this option.'
'  '
'If you choose to incorporate a swimming pool model into this'
'zone 1) the floor internal convective heat transfer coefficient and'
'emissivity are set to small values (i.e. 0.001) and that'
' 2) the external boundary condition is set to adiabatic.'
'Please do this after defining the pool controller.'
'  '
'Data requirements: '
' 1) pool surface area m^2'
' 2) pool surface convective htc W/m^2K'
' 3) pool surface radiative htc W/m^2K'
' 4) pool set point temperature degC'
' 5) surrounding ground temperature degC'
' 6) pool water supply rate kg/s'
' 7) pool water supply temperature degC'
' 8) submerged wall surface area m^2'
' 9) submerged wall surface U-value W/m^2'
' '
'If you choose cancel the controller data will not be'
'altered and you will be returned to the main menu. '
*enditem
          CALL EASKAB('Wetted surface options:',' ',
          call phelpd('pool control help',7,'-',0,0,IER)
          CALL EASKS(HOLD,'Pool surface area(m^2), convective and',
          CALL EASKS(HOLD,'Pool temperature and ground temperature',
          CALL EASKS(HOLD,'water supply rate (kg/s), water supply ',
          CALL EASKS(HOLD,'submerged wall surface area (m^2), ',
*item EBCNTRL sys_bctl_fall_through
'You have selected an unknown controller. So supply the number of'
'control data that you will type in followed by the data values.'
' '
'If you choose cancel the controller data will not be'
'altered and you will be returned to the main menu. '
*enditem
          CALL EASKI(NITEMS,' ',' No of control law data items ?',
          CALL EASKR(cm(MM),outs,' value: ',
*subroutine EOCNTRL
*item EOCNTRL optical_ctl_menu
'ESP-r will in the future implement an optical controller.'
'This facility is work-in-progress...'
'  '
'A number of control periods can be defined for each'
'control day type. Each period has a start time (i.e.'
'they do not overlap), a sensed property, an actuated'
'property, a control law and miscel. data which defines'
'capacity, setpoints, etc.'
'  '
'Periods are added to the end of the list. '
'  '
'Optical controls act as a staged controller - it changes to'
'another stage if sensed value is greater than '
'a set point. Other laws may be added in the future.'
'  '
'Help text for commented out sections of the optical control:'
'  Sensor setpoint (between -1000 and 1000) relative to the'
'  type of sensor.'
'  '
'You will be asked to select the optical property if the sensed'
'value is exceeded.'
'  '
'Bidirectional data is held as sets and you are asked which'
'of these sets to use if the sensed value is exceeded.'
'  '
'You can provide the set-point and the bidirectional'
'dataset (e.g. at a specific slat angle) that will be '
'used above the set-point. The order of the set-points'
'here does not matter as they will be sorted when they '
'will be processed. It is, however, recommended for QA'
'purposes to start from the top using the higher '
'setpoint and carry on following a descending order.'
'Dataset 1 will always be used unless the control '
'condition is met.'
'The value given should relate to the type of sensor'
'(e.g. in oC for temperature sensor, in W/m2 for'
'radiation sensor, etc.).'
'  '
'The value given should relate to the bidirectional'
'dataset that will be used above the specified setpoint.'
'  '
'Note: if no change required in an item then accept the'
'current value.'
*enditem
        CALL PHELPD('control period help',8,'-',0,0,IER)
        CALL EASKABC('Options:',' ',
        call MENUATOL(outs,' Available laws',
        CALL EASKR(tcps,' ',' Period start time ? ',
C          CALL EASKR(cm(2),' Set point:',' ',
C          CALL EPICKS(IX,IGVAL,' ',' Glazing types: ',
C          CALL EASKR(cm(2),' Set point:',' ',
C          CALL EASKI(I3,' ','Which bidirectional set to use (1-40)?',
        CALL EASKR(cmlocal(ivert*2),' Set-point:',' ',
        CALL EASKI(I3,' ','Which bidirectional set to use (1-40)?',
        CALL PHELPD('bidirectional control help',9,'-',0,0,IER)
*subroutine edit_CFC_control
*item edit_CFC_control optical_CFC_ctl_menu
'Zones which make use of CFC representations of glazing have'
'control options which are defined in the current facility.'
'  '
'A number of control periods can be defined for each'
'control day type. Each period has a start time (N.B'
'periods may not overlap), a sensed property, an actuated'
'property, a control law and miscellaneous data items'
'defining available capacity, set-points etc.'
'  '
' editing a period control law: select a controller type based'
'   on the nature of the sensor and actuator you will be using.'
'   After you select the controller type you will be asked for'
'   its attributes during the current period.'
'  '
'   The current control types are:'
'     senses temp.      actuates shade ON/OFF'
'     senses temp.      actuates slat angle'
'     senses sol-rad    actuates shade ON/OFF'
'     senses sol-rad    actuates slat angle'
'     senses wind speed actuates shade ON/OFF'
'     senses wind dir.  actuates shade ON/OFF'
'     no sensor (schedule only)'
'  '
'   The current control laws are: basic control or schedule.'
'   If you select no sensor then also select schedule.'
'  '
' option * to add or delete a period. New periods are added'
'   to the end of the list (there is no insert facility). If'
'   you delete a period the list is compacted.'
'  '
*enditem
       CALL PHELPD('control period help',5,'-',0,0,IER)
        CALL EASKABC(' ','Options:',
  64    CALL EPICKS(IX,IVALS,' ',' Controller type: (see help)',
  65    CALL EPICKS(IX,IPVALS,' ',' Complex fen. control law: ',
  62    CALL EASKR(tcps,' ','Period start time?',
*subroutine EPCNTRL
*item EPCNTRL plant_ctl_menu
'ESP-r allows you to specify controls for detailed system'
'components in a plant network. The pattern for setting'
'up control loops is similar to that used for other domains.'
'  '
'A number of control periods can be defined for each'
'control day type. Each period has a start time (i.e.'
'they do not overlap), a sensed property, an actuated'
'property, a control law and miscel. data which defines'
'capacity, setpoints, etc.'
'  '
' editing common control period data: '
'   start time - a hour plus fraction 10h30 is 10.5'
'     the initial period of a control loop must start at'
'     midnight e.g. 0.0 hours.'
'  '
'   control types: Broadly, you want to select based on what is'
'     to be actuated and what is being sensed. There are 42'
'     combinations which can be selected.
'     Sensor choices:'
'       dry bulb temperature, enthalph, 1st phase mass flow,'
'       2nd phase mass flow, additional plant output data (depends'
'       on the specific component) pressure in flow networks,'
'       mass flow, solar radiation, wind speed, wind direction,'
'       and relative humidity in zones and outside. Plus'
'       the DIFFERENCE in temperature, pressure and absolute'
'       pressure'
'     Actuator choices:'
'       flux, flow, variable within a component, mass (diversion)'
'       ratios and other control loops.'
'  '
'This control type information will be used later when setting the'
'control actions as well as the control logic that can applied.'
'  '
' option * control periods can be managed by adding a period'
'   at the end of the list of periods (there is no insert'
'   function) or a control loop can be deleted. The only'
'   way to insert a period is to add at the end and then'
'   redefine the earlier priods.'
'   Next time plan your control periods carefully so as to'
'   avoid the need to insert a period.'
'  '
'Note: if no change required in an item then accept the'
'current value.'
*enditem
        CALL PHELPD('control period help',8,'-',0,0,IER)
        CALL EASKABC('Options:',' ',
        CALL EPICKS(IX,IVALS,' ',' Controller type: (see help)',
*item EPCNTRL sys_plant_types
'The `type` numbers relate to the selection you made'
'in the previouos step. Here is a reminder: '
' '
' type 0 is senses dry bulb actuates flux'
' type 1 is senses dry bulb actuates flow'
' type 2 is senses enthalpy actuates flux'
' type 3 is senses enthalpy actuates flow'
' type 4 is senses 1st ph mass flow actuates flux'
' type 5 is senses 1st ph mass flow actuates flow'
' type 6 is senses 2nd ph mass flow actuates flux'
' type 7 is senses 2nd ph mass flow actuates flow'
' type 8 is senses adl plant output actuates flux'
' type 9 is senses adl plant output actuates flow'
' type 10 is senses RH actuates flux'
' type 11 is senses RH actuates flow'
' type 12 is senses dry bulb actuates variable'
' type 13 is senses enthalpy actuates variable'
' type 14 is senses 1st ph flow actuates variable'
' type 15 is senses 2nd ph flow actuates variable'
' type 16 is senses plant output actuates variable'
' type 17 is senses RH actuates variable'
' type 18 is senses dry bulb actuates mass ratio'
' type 19 is senses enthalpy actuates mass ratio'
' type 20 is senses 1st ph flow actuates mass ratio'
' type 21 is senses 1st ph flow actuates mass ratio'
' type 22 is senses plant o/p actuates mass ratio'
' type 23 is senses RH actuates mass ratio'
' type 24 is senses temp diff actuates flow'
' type 25 is senses abs temp diff actuates flow'
' type 26 is senses pressure actuates flow'
' type 27 is senses press diff actuates flow'
' type 28 is senses abs press diff actuates flow'
' type 29 is senses abs mass flow actuates flow'
' type 30 is senses wind speed actuates flow'
' type 31 is senses wind direction actuates flow'
' type 32 is senses dir nor sol rad actuates flow'
' type 33 is senses dif hor sol rad actuates flow'
' type 34 is senses ext rel hum actuates flow'
' type 35 is senses wind speed actuates flux'
' type 36 is senses wind direction actuates flux'
' type 37 is senses dir nor sol rad actuates flux'
' type 38 is senses dif hor sol rad actuates flux'
' type 39 is senses ext rel hum actuates flux'
' type 33 is senses contaminant conc actuates flow'
' type 41 is senses other loops actuates either'
*enditem
        CALL EPICKS(IX,IPVALS,' ',' Plant control law: ',
        CALL EASKR(tcps,' ',' Period start time ? ',
*item EPCNTRL plant_must_be_multi
'This control type only works with multisensing of'
'control loops. The control type will be set to '
'sensing other control loops action (type 41) '
*enditem
          CALL PHELPD('control type help',3,'-',0,0,IER)
*item EPCNTRL plant_ctl_pid_flux
' Mode options are:'
' 1: P, PI, PD, PID non-recursive positional control'
' 2: P, PI, PD, PID recursive positional control'
' 3: PI recursive vel`y control (rect. integration)'
' 4: PID recursive vel`y control (rect. integration)'
' 5: PID recursive vel`y control(trapez integration)'
' Note: negate mode number for cooling'
'  '
' The PID flux control data items are in the range'
' 6 to 9 and depends on the PID mode selected, i.e.,'
' For modes 1, -1 , 2, -2 :- '
'     Positional P              -   7 items required,'
'     Positional PI             -   8 items required,'
'     Positional PD             -   8 items required,'
'     Positional PID            -   9 items required,'
' For mode 3, -3:-'
'     Rect. Velocity PID        -   6 items required,'
' For mode 4, -4, 5, -5:-'
'    Trap. Velocity PID        -   7 items required,'
' NOTE: if `AHU dynamic set point` option '
' selected (set point = -1001) then add 7 data'
' items to above.'
' '
'The next questions relate to heating and cooling capacity.'
'Htg/clg delivery may be less than the max. If min'
'htg/clg > 0 then htg/clg will continue at a re- '
'duced level even when the setpoint is reached. '
' '
'The set point may be specified to be :-'
'(a) a fixed constant value;'
' or'
'(b) determined automatically, in a dynamic manner,'
'    at each simulation times-step, by means of a '
'   psychometric-based algorithm within the program.'
'The latter method (denoted by a setpoint of -1001)'
'should be used when simulating air conditioning '
' Refer ...../esp-r/training/plant/AHU/humidity_ctl'
' training folder.'
'  '
'The integral action flag must be specified: 1 if'
'required; 0 if not required. The integral action'
'time [sec] and derivitive action time [sec] may also'
'be requested. A derivitive action flag must be set: 1 if'
'required; 0 if not required.'
'  '
*enditem
          CALL EASKR(cm(2),' ',' PID mode ? ',
          CALL EASKR(cm(1),' ',' No. of misc data items ?',
          CALL EASKS(HOLD,
          CALL EASKR(cm(7),' ',' Integral action flag?',
          CALL EASKR(cm(8),' ',' Integral action time [sec]?',
          CALL EASKR(cm(9),' ',' derivative action flag?',
          CALL EASKR(cm(10),' ',' Derivative action time [sec]?',
          CALL EASKR(cm(8),' ',' derivative action flag?',
          CALL EASKR(cm(9),' ',' Derivative action time [sec]?',
          CALL EASKR(cm(7),' ',' Integral action time [secs]?',
          CALL EASKR(cm(8),' ',' Integral action time [secs]?',
          CALL EASKR(cm(11),' ',' Derivative action time [secs]?',
*item EPCNTRL plant_ctl_pid_flow
' Mode options are:'
' 1: P, PI, PD, PID non-recursive positional control'
' 2: P, PI, PD, PID recursive positional control'
' 3: PI recursive vel`y control (rect. integration)'
' 4: PID recursive vel`y control (rect. integration)'
' 5: PID recursive vel`y control(trapez integration)'
' Note: negate mode number for cooling'
'  '
' The PID flow control data items are in the range'
' 6 to 9 and depends on the PID mode selected, i.e.,'
' For modes 1, -1 , 2, -2 :- '
'     Positional P              -   7 items required,'
'     Positional PI             -   8 items required,'
'     Positional PD             -   8 items required,'
'     Positional PID            -   9 items required,'
' For mode 3, -3:-'
'     Rect. Velocity PID        -   6 items required,'
' For mode 4, -4, 5, -5:-'
'    Trap. Velocity PID        -   7 items required,'
' NOTE: if `AHU dynamic set point` option '
' selected (set point = -1001) then add 7 data'
' items to above.'
'  '
'The set point may be specified to be :-'
'(a) a fixed constant value;'
' or'
'(b) determined automatically, in a dynamic manner,'
'    at each simulation times-step, by means of a '
'    psychometric-based algorithm within the program.'
'The latter method (indicated by a setpoint of -1001)'
'should be used when simulating air conditioning '
' Refer ...../esp-r/training/plant/AHU/humidity_ctl'
' training folder.'
'  '
'The integral action flag must be specified: 1 if'
'required; 0 if not required. The integral action'
'time [sec] and derivitive action time [sec] may also'
'be requested. A derivitive action flag must be set: 1 if'
'required; 0 if not required.'
'  '
'  '
*enditem
          CALL EASKR(cm(2),' ',' PID mode? ',
          CALL EASKR(cm(1),' ',' No. of misc data items ?',
          CALL EASKS(HOLD,
          CALL EASKR(cm(7),' ',' Integral action flag?',
          CALL EASKR(cm(8),' ',' Integral action time [seconds]?',
          CALL EASKR(cm(9),' ',' derivative action flag?',
          CALL EASKR(cm(10),' ',' Derivative action time [sec]?',
          CALL EASKR(cm(8),' ',' derivative action flag?',
          CALL EASKR(cm(9),' ',' Derivative action time [sec]?',
          CALL EASKR(cm(7),' ',' Integral action time [seconds]?',
          CALL EASKR(cm(8),' ',' Integral action time [seconds]?',
          CALL EASKR(cm(11),' ',' Derivative action time [secs]?',
*item EPCNTRL plant_ctl_numeric_prop
'ESP-r implemnts a so-called numerical proprotional controller.'
'Attributes are:  '
'  Maximum and minimum output, upper and lower setpoints'
'  and output to overcome hysteresis'
'  '
'No other information is available about this controller.'
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_ctl_opti_start
'ESP-r implements an optimal start controller for system '
'components. Its attributes are:'
'  Maximum output, desired time of arrival, desired temperature,'
'  first second and thrid B&J coefficients
'  '
'No other information is available about this controller.'
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_ctl_prop_damper
'ESP-r implements a proportional damper controller. Its '
'attributes are:'
'  Maximum and minimum damper position'
'  Flox at maximum and minimum positions'
'  1st and 2nd connection indicies.'
'  '
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_ctl_duty_cycle
'ESP-r implements a duty cycle controller for system '
'components. Its attributes are:'
'  Duty cycle period, time steps off, first off time-step'
'  in the cycle period.'
'  '
'All time-steps are in terms of plant time-steps. '
' For example, for a cycle period of, say, 5 '
' time-steps, there could be, say, 2 off, with, e.g'
' the 1st off at the 3rd time-step, and thus the '
' 2nd off at the 4th time-step.'
'  '
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_ctl_on_off
'ESP-r implements a simple ON/OFF controller for plant'
'components. Its attributes are:'
'  mode of operation:'
'                            OUTLO'
' MODE = +1        SPTOFF ----------'
'                  SPTON  ----------'
'                            OUTHI'
'  '
'                            OUTHI'
' MODE = -1        SPTON  ----------'
'                  SPTOFF ----------'
'                            OUTLO'

'  on set point (units depends on control type)'
'  off setpoint (units depends on control type)'
'  output at hi, output at lo'
'  '
'  sensor lag (in plant-timesteps)'
'  actuator lag (in plant-timesteps)'
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_multi_on_off
'ESP-r implements an ON/OFF controller which is linked to'
'multiple auxilary sensors. Attributes of the controller:'
'  Output at high status'
'  Output at low status'
'  Mode of operation:'
'    Mode = +1 for `ON` if control point is less than '
'           specified function of aux`y sensor(s). '
'    Mode = -1 for `ON` if control point is greater than'
'           specified function of aux`y sensor(s). '
'  '
'At present, the control is limited to 2 auxiliary sensors.'
'The following combinations of sensors are supported:'
' 1: greatest value of aux sensors '
' 2: least value of aux sensors '
' 3: mean value of aux sensors '
' 4: weighting of aux sensors '
'  '
'   Sensor lag (in plant-timesteps)'
'   Actuator lag (in plant-timesteps)'
'  '
' The number of data items required is in the range'
' 10 to 16 and depends on: (1) number of auxiliary '
' sensors (ns); (2) the auxiliary sensor function '
' mode selected:- '
' '
'                                   |no. of| |no. of|'
'          Function                 |aux sn| |items |'
 '---------------------------------------------------'
' greatest val of aux`y sensors        1       10 '
'   `      `  `    `     `             2       14 '
' least val of aux`y sensors           1       10 '
'   `    `  `    `     `               2       14 '
' mean val of aux`y sensors            1       10 '
'   `   `  `    `     `                2       14 '
' weighting of aux`y sensors           2       16 '
'  '
'The description of an aux sensor is essentially the same as'
'required in a control point sensor: three indices denoting'
'the location of the sensor.'
'  '
'Weightings for the aux sensors must be supplied. The total'
'must add up to 100.'
*enditem
          CALL EASKR(cm(1),' ',' No. of misc data items ',
          CALL EASKR(cm(2),' ',' Output at `hi` status ? ',
          CALL EASKR(cm(3),' ',' Output at `lo` status ? ',
          CALL EASKR(cm(4),' ',' Output mode ? ',
          CALL EASKR(cm(5),' ',' No of auxiliary sensors ? ',
          CALL EASKR(cm(6),' ',' Multi-sensor auxy function ? ',
          CALL EASKR(cm(7),' ',' Sensor lag? ',
          CALL EASKR(cm(8),' ',' Actuator lag ? ',
          CALL EASKR(cm(ndx),' ',' Aux sen detail 1st item ? ',
          CALL EASKR(cm(ndx+1),' ',' Aux sen detail 2nd item ? ',
          CALL EASKR(cm(ndx+2),' ',' Aux sen detail 3rd item ? ',
          CALL EASKR(cm(ndx+3),' ',
          CALL EASKR(cm(ndx),' ',' Aux sensor weighting ? ',
*item EPCNTRL plant_multi_loops
'ESP-r implements a controller which evaluates the state'
'of other plant control loops.'
'  '
'You will be asked to state how many control loops you'
'want to sense for this controller. For each loop that'
'you specify you will asked a logical relationship'
'with the next loop (.AND. or .OR.) e.g. loop 4 .AND.'
'loop 7 will give the logical outcome of loop4 and 7'
'based on their states at that time.'
'  '
'You are asked to a signal ON and signal OFF value for'
'each control loop.
'  '
'The actuator for this component will have its control'
'data modified at run time if the multisensor gives'
'an ON signal. The value of this signal must be given'
'alongwith the index of the control data item e.g.'
'whether control data item no. 1 or 2 is being set'
' '
'Additionally there is provision to set an overrun'
'time (minutes). This is the time for which the component / '
'parameter actuated by this loop will be on after'
'the control loop sensor goes off.'
*enditem
          CALL EASKI(NCLP,' ',' No. of control loops to sense ',
          CALL EASKI(ICLN,' ',' Select control loops number',
          CALL EASKAB('Logical relationship with next loop',' ',
          CALL EASKR(TONV,' ',' Signal value at ON ',
          CALL EASKR(TONV,' ',' Signal value at OFF ',
          CALL EASKI(ICDAT,' ','Which control item to set at ON'
          CALL EASKR(TONV,' ',' Overrun time (min)',
*item EPCNTRL plant_wch_simple_PI
'This control law is a simplified PI controller '
'specially adapted to room control of wet central'
'heating (WCH) systems. It can be used to control the'
'BDATA items of a plant component using PI action.'
'  '
'Alternately it can be used in TPMPI (time proportional'
'modulating proportional integral) mode. In this mode '
'BDATA items are not modified but ON time is controlled'
'  '
'For the implementation it was developed it was used'
'to control the upper boiler temperature limit of a'
'WCH boiler depending on the output temperature of a'
'  '
'Control inputs are: '
'  Setpoint nominal T_st (default value 21)'
'  Sensed condition T_sen (from sensor definition)'
'  Setpoint max T_max (default value 90)'
'  Setpoint min T_min (default value 20)'
'  Proportional band PB (default value 1)'
'  Bdata item number of actuated plant component, the'
'    value of this parameter will be changed by this '
'    controller index BDATA (default value 10)'
'  Integral reset time AIRT (default value 1)'
'  Integral summation of delta SDELTA'
'  '
'At simulation run time BDATA value will be '
'modified according to the following logic:'
'BDATA=(T_max-T_min)*(DELTA/PB+SDELTA/(PB*AIRT)'
'       + 0.5*(T_max+T_min)'
'If BDATA is bigger than T_max it is reset to T_max or'
'If BDATA is smaller than T_min it is reset to T_min'
'  '
'Optionally an additional control loop can be specified'
'it this loop is active then BDATA item number is '
'reset to a user defined static value, if you dont'
'want to specify an optional loop leave its value = 0'
' '
'The TPMPI mode of operation becomes active if cycle'
'time is stated to be more than zero.'
' '
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_outside_comp
'ESP-r implements a control which can be used to compensate'
'for outside conditions. It does this by modifying the
'BDATA parameters of a plant component at simulation runtime.'
' '
'It was originally used to control boiler upper temperature '
'limit for wet central heating systems.'
'  '
'The following parameters are used:'
'  Coefficients alpha, beta, gamma with default values'
'   (3.5 2. and 0. respectively)'
'  Nominal temperature 1 = T_st1 (default value 20)'
'  Nominal temperature = T_st (default value 21)'
'  Setpoint max T_max (default value 90)'
'  Setpoint min T_min (default value 20)'
'  ambient temperature T_amb (from climate file)'
'  Sensed condition T_sen (from sensor definition)'
'  Bdata item number of actuated plant component, the'
'    value of this parameter will be changed by this '
'    controller index BDATA (default value 10)'
'  '
'At simulation run time the BDATA value will be'
'If BDATA is bigger than T_max it is reset to T_max or'
'If BDATA is smaller than T_min it is reset to T_min'
'Optionally an additional control loop can be specified'
'it this loop is active then BDATA item number is '
'reset to a user defined static value, if you dont'
'want to specify an optional loop leave its value = 0'
*enditem
          CALL EASKS(HOLD,'alpha, beta, gamma',
          CALL EASKS(HOLD,'nominal1, nominal, max, min, BDATA',
*subroutine EFCNTRL
*item EFCNTRL flow_ctl_menu
'ESP-r allows you to specify controls for components in a'
'flow network (mostly commonly in terms of a component within'
'a specific flow path in the network). The pattern for setting'
'up control loops is similar to that used for other domains.'
'  '
'Control within flow networks is optional. If you have no control'
'then the nominal characteristics of the flow components are'
'used throughout the assessment. If you want doors or windows to'
'open and close or fans to turn off under specific circumstances'
'then you need to define controls.'
'  '
'Flow controls can be used in combinations to approximate almost'
'any situation or logic combination. Planning of networks is'
'essential so that control actions in parallel and in sequence'
'can be implemented.'
'  '
'A number of control periods can be defined for each'
'control day type. Each period has a start time (i.e.'
'they do not overlap), a sensed property, an actuated'
'property (e.g. flow rate or opening area), a control law'
'and miscel. data which defines setpoints, etc.'
'  '
'Periods are added to the end of the list. There is no insert'
'option. Plan your periods before you define the control loop!'
'  '
' editing common control period data: '
'   start time - a hour plus fraction 10h30 is 10.5'
'     the initial period of a control loop must start at'
'     midnight e.g. 0.0 hours.'
'  '
'Available flow control laws:'
'  on/off/fractional controller - turns a component on or'
'    off based on a sensed condition. It can work directly'
'    (on above setpoint) or indirectly (on below setpoint)'
'    and you can specify that ON is some fraction of the'
'    nominal size and/or flow rate of the component.'
'  '
'  proportional with hysteresis - signal lower limit and valve'
'    position, signal upper limit and vale position, delta'
'    signal to overcome hysteresis.'
'  '
'  range based controller which is based on three temperatures'
'    and three flow rates. E.g. flow rate 1 if below 1st temp'
'    and flow rate 2 if above 2nd temp and flor rate 3 if above'
'    3rd temp.' 
'  '
'  multi-sensor on/off to implement complex control logic'
'  '
'  human behaviour algorithm controlling windows and fans'
'  '
'  proportional and integral controller without hysterisis'
'  '
'Note: if no change required in an item then accept the'
'current value.'
*enditem
        CALL PHELPD('control period help',8,'-',0,0,IER)
        CALL EASKABC('Options:',' ',
        call MENUATOL(outs,' Available laws','a on/off',
        CALL EASKR(tcps,' ',' Period start time ? ',
*item EFCNTRL flow_ctl_on_off
'Number of items for on/off controller = 3 '
' 1st is setpoint, '
' 2nd is action index 1=direct, -1=inverse'
'   where direct is ON above setpoint.'
'   and inverse  is ON below setpoint.'
' 3rd is fraction of capacity (e.g. if set to 0.5'
'   of the area, door width or flow rate of the'
'   component is 0.5 x its stated value) valid  '
'   fractions are between 0.0 and 1.0 for area based'
'   components and 0.1 to 1.0 for door width. A value'
'   of 1.0 is equivalent to a simple ON:OFF control.'
'   If a door control action would cause it to be less'
'   than 10mm wide it is reset to 10mm.'
*enditem
          CALL EASKS(HOLD,
*item EFCNTRL flow_ctl_prop_hyster
'Number of items for proportional controller = 5 '
'  1st is signal (what is sensed for this control)'
'      lower limit,'
'  2nd is valve position at lower limit (0-100 %),'
'  3rd is signal (what is sensed for this control)'
'      upper limit, '
'  4th is valve position at upper limit (0-100 %),'
'  5th delta signal to overcome hysteresis.'
*enditem
          CALL EASKS(HOLD,
*item EFCNTRL flow_ctl_range_based
'The range based controller acts in the same way as the'
'range based control which can be imposed in scheduled'
'infiltration in the zone operations file.'
'  '
'This could close a window if it is cold outside'
'open it a bit more than normal if the temperature rises'
'and then close the window if it is really hot outside.'
'  '
'Or it could be used to allow a fan to boost in stages'
'based on the temperature.'
'  '
'Number of items for range controller = 6 '
' 1st is low setpoint, '
' 2nd is mid setpint'
' 3nd is high setpint'
' which yields 4 ranges as follows:'
'   low range - below low setpoint, '
'   default range - (nominal area or rate of the'
'      component) between low and mid setpoints,'
'   mid range - between mid and hi setpoints,'
'   high range - above high setpoint. '
' 4th is low range ratio (of rate or area), '
' 5th is mid range ratio (of rate or area),'
' 6th is high range ratio (of rate or area)'
' '
'If within default range then the nominal rate or '
'area is used. '
' '
'NOTE: this controller works with sensed conditions'
'such as node temperature and can be used with '
'components 30 (constant vol) 35 (constant mass)'
'40 (common orifice) 110 (specific air opening)'
'and 130 (bi-directional flow). '
'  '
'The range controler should sense a node temperature '
'or outside db temperature. It returns a ratio of the'
'nominal rate or area associated with each range. '
*enditem
          CALL EASKS(HOLD,
          CALL EASKS(HOLD,
*item EFCNTRL flow_ctl_multi_sensing
'Some types of flow control require complex logic - e.g.'
'opening a window if the inside temperature is within'
'particular limits and the outside temperature is within'
'particular limits. This can be done with several components'
'in sequence, each with its on logic. Or you can use a '
'multi-sensor flow control applied to a single component.'
'  ' 
'Number of items is = 2 + 8 * no. of sensors'
'  1st is default position: (1=open,0=closed)'
'  2nd is number of auxiliary sensors. Then'
'  for each auxiliary sensor 8 items are needed:'
'    4 items for the sensor location followed by'
'    1 item for the set point temperature'
'    1 item for action flag (1=direct, -1=inverse)'
'    1 item for fraction ON (currently not implemented)'
'    1 item for logical action (AND/OR/NOT/SLAVE)'
'The connection/component will CHANGE from the default'
'position when the sensed value is above the set-point'
'if action flag is DIRECT. In case the action flag is'
'set to INVERSE, the CHANGE will take place when the'
'sensed value is below the set-point.'
' '
'This CHANGE when it takes place will switch the connection'
'from its default position (open or closed) to the inverse.'
' '
'Any sensor defined in the sensor location menu will be'
'overridden. But sensor needs to be defined to pass though'
'error traps therefore define sensor location as usual. '
' '
'The logical action is a means to combine logically'
'the outcomes of the multiple sensors. e.g. if in a'
'multisensor control comprising 3 sensors the  '
'logical action of sensor1 is AND, sensor2 is OR '
'and sensor3 is AND then the outcome of the multisensor'
'will be sensor1 AND sensor2 OR sensor3 '
'Note that logical action of sensor3 is irrelevant'
' '
'If the NOT/SLAVE option is selected the output of this'
'control loop will be inverse/same of flow connection'
'defined. Any controls on this flow connection must be'
'defined before the NOT/SLAVE loop (i.e. this loop) '
' '
'The sensor details are essentially the same as '
'required in a control point sensor ie. '
' 1st item >0 is a zone and or surface, =0 any zone,'
'   = -1 measuring a plant component node,'
'   = -2 measuring mix air:radiant,'
'   = -3 ambient where the 2nd item is:'
'      0 = db,       2 = wind velocity, '
'      3 = wind dir, 4 = diffuse radiation, '
'      5 = direc norm rad, 6 = RH'
'   = -4 measuring a flow side condition.'
' '
'Currently only option -3 and -4 are supported and'
'only node temperature is supported for option -4'
'Therefore the four items for sensor location are'
'-3 ? 0 0 where ?=0 or 2 to 6 depending upon climate'
'variable. OR. -4 ? 0 0 where ?= node number to'
'be sensed.'
*enditem
          CALL EASKI(NSEN,' ',OUTS,
     &    CALL ASKOK('You have chosen just one sensor, the only option',
          CALL EASKAB('Choose whether NOT or SLAVE',' ','NOT','SLAVE'
          CALL EASKAB('Default position? ',' ','closed','open',IW,56)
          CALL EASKAB(OUTS,' ','Climate variable','Node temperature'
          call MENUATOL(' ',' Climate variables','a temperature',
          call ASKRNOD('  sensed flow node','-',INOD,IER)
          CALL EASKR(cm(ndx+4),' ',' Aux sensor set-point ? ',
          CALL EASKAB('Action Flag (see help)',' ','Direct',
C         CALL EASKR(cm(ndx+6),' ',' Aux sensor "fraction ON"? ',
     &    CALL EASKABC('Logical action variable',
          CALL ASKMFCON(INODE,NNPK,ICPK,prmpt1,prmpt2)
*item EFCNTRL flow_ctl_adaptive
'The windowfan algorithm models occupant behaviour'
'and operates windows and fans based on mean operative'
'and outdoor mean temperatures automatically.'
'Users need to input the running mean response'
'parameter to outside temperature for the building'
'which is a constant from 0-0.99 (Default value 0.8)'
'The operative (resultant=0.5mean radiant + 0.5dry bulb)'
'temperature is required for this algorithm. User has '
'to specify internal flow node to be used to calculate this.'
'  '
'If you want to use this controller you probably should read'
'the conference paper by Tuohy, Rijal, Humphreys, Nicol,'
'Samuel and Clarke of IBPSA BS 2007.'
*enditem
          CALL EASKR(cm(2),' ',' Running mean response parameter ? ',
          CALL EASKR(cm(3),'  ','Fraction window openable in day ? ',
          CALL EASKR(cm(4),' ','Fraction fan available for day use?',
          CALL EASKR(cm(5),' ','Fraction window openable in night ? ',
          CALL EASKR(cm(6),' ','Fraction AC available for day use?',
          CALL EASKR(cm(7),' ','Fraction heating available ?',
          CALL EASKR(cm(8),' ','Fraction daylight available?',
          CALL EASKR(cm(9),' ','Power rating of the fan W/m2?',
          CALL EASKR(cm(10),' ','Power rating of the lights W/m2?',
          CALL EASKR(cm(11),' ','Fan comfort temperature adjustment?',
          CALL EASKR(cm(12),' ','Deadband for window open?',
          CALL EASKR(cm(13),' ','Deadband for fan on?',
          CALL EASKR(cm(14),' ','Air intake surface ID?',
 545      call ASKMFNOD(INOPT,NNPK,INPK,prmpt1,prmpt2,9)
          CALL PHELPD('node selection help',2,'-',0,0,IER)
*item EFCNTRL
'This control law is a simplified PI controller (it does not'
'include hysterisis).'
'  '
'Control inputs are: '
'  Setpoint nominal T_st (default value 21)'
'  Sensed condition T_sen (from sensor definition)'
'  max flow fraction Q_max (default value 1)'
'  min flow fraction Q_min (default value 0.3)'
'  Proportional band PB (default value 1)'
'  Integral reset time AIRT (default value 1000)'
' '
'At simulation run time controlled value will be '
'modified according to the following logic:'
'VALUE=(Q_max-Q_min)*(DELTA/PB+SDELTA/(PB*AIRT))'
'       + 0.5*(Q_max+Q_min)'
'Where DELTA=T_sen-T_st and SDELTA is the '
'Integral summation of DELTA '
'If VALUE is bigger than Q_max it is reset to Q_max or'
'If VALUE is smaller than Q_min it is reset to Q_min'
' '
'The action flag may be set to direct acting (default) '
'or inverse acting (action of PI will be inverted e.g.'
'instead of closing it will open a valve) '
' '
'Optionally there is capability to sense using a'
'previously defined multisensing loop. When using '
'this option the usual definition of sensor will be'
'overridden and the output of the multi sensor control'
'loop will be used as the sensed parameter'
*enditem
          CALL EASKS(HOLD,
          CALL EASKAB('Action flag (see help)',' ',
          CALL EASKABC('Which sensor to use',' ',
          CALL EASKR(ocli,' ',' control loop index ',
*subroutine EGCNTRL
*item EGCNTRL
'ESP-r allows you to specify global controls which ?'
'The pattern for setting up global control loops is rather'
'different to that used for other domains.'
'  '
'A number of control periods can be defined for each'
'control day type. Each period has a start time (i.e.'
'they do not overlap), a sensed property, an actuated'
'property, a control law and miscel. data.'
'  '
' editing common control period data: '
'   start time - a hour plus fraction 10h30 is 10.5'
'     the initial period of a control loop must start at'
'     midnight e.g. 0.0 hours.'
'  '
'The following control laws are offered:'
'  global on-off has an operational mode [definition?]'
'    and a minimum loops on or a setpoint
'  '
'  global capacity controller is based on a global heating and'
'    cooling capacity and a no shed value.'
'  '
'  global schedule on controller asks for a number of scheduled'
'    control loops.'
'  '
'  global multi-sensor controller senses the state of mass flow'
'    and plant control loops and actuates one named control'
'    loop.'
'  '
'Note: if no change required in an item then accept the'
'current value.'
*enditem
        CALL PHELPD('control period help',8,'-',0,0,IER)
        CALL EASKABC('Options:',' ',
        call MENUATOL(outs,' Available laws',
        CALL EASKS(HOLD,' Mode; Min ON [mode_1] or stpt [mode_2]',
        CALL EASKS(HOLD,'Glb htg capy, Glb clg capy, No shed ',
        CALL EASKS(HOLD,'No. of scheduled loops',
*item EGCNTRL global_ctl_multi_sens
'This control senses the state of other control loops'
'and actuates one named control loop -- overriding the '
'original actuation state of the actuated loop. '
'These are termed sensed & actuated loop respectively'
'Currently it supports the mass flow and plant domains '
' '
'A logical relationship amongst the sensed loops exists'
'of one of the following forms:'
'AND or OR: Acts on more than one sensed loops and '
'   controls the actuated loop to ON/OFF based on '
'   logical output of the AND/OR relationship'
'NOT: Acts on one or more loops. The actuated loop '
'   is OFF if any one of the sensed loops is ON and '
'   vice versa.'
'SLAVE: Acts on one or more loops. The actuated loop'
'   is OFF if any one of the sensed loops is OFF and '
'   vice versa.'
'For sensed loops that control fractionally between ON/'
'OFF. The above logical relationships assume ON to be '
'anything that is not OFF. Two mechanisms of fractional'
'control are also provided.'
'MAX or MIN: Acts on more than one sensed loops and'
'   controls the actuated loop to maximum/minimum of '
'   sensed loops.'
'NOTE that MAX/MIN is only applicable to flow domain'
'because control is in terms of relative values.'
'(Control in plant may be in terms of absolute or '
'relative values hence MAX/MIN should not be used here)'
*enditem
          CALL EASKI(nClp,' ','Number of loops to sense ?',
          call MENUATOL(outs(1:iotsl),outs(1:iotsl),
          CALL EASKI(NLPS,' ','Loop number to sense ?',
          CALL EASKATOG('Logical action variable',
          call MENUATOL(outs(1:iotsl),'select actuation domain',
          CALL EASKI(IAPS,' ','Loop number to actuate ?',
*subroutine senloc
*item senloc senslocation_bld
'In the building solution domain sensors for ideal controls can'
'be placed in the locations listed in the menu. This list is'
'similar to but not identical to that of the other domains.'
'  '
'The variety of locations is broad so as to give you maximum'
'flexibility. The location you select tends to define the nature'
'of what is sensed.'
'  '
'Note option a allows you to define a controller which can be'
'  applied to almost any zone in your model.' 
'  '
'Option b needs a more specific location and you will be asked'
'  to identify which zone and where in the zone.'
'  '
'Options c-i use data in the climate file as sensed conditions'
'  the most common is ambient drybulb.'
'  '
'Option j allows you to read in timestep values (setpoints)'
'  in a model temporal file. You are asked for the index of'
'  the temporal item (so best look this up first).'
'  '
'Option k takes its output from a function generator so that'
'  standard test patterns can be implemented.'
'  The available functions are:'
' '
'   Function          supp1    supp2    supp3   supp4'
'   ================================================ '
'   1. Step:          start    finish   max     min  '
'   2. Ramp:          start    finish   max     min  '
'   3. Square sine:   max      min      freq    ---  '
'   4. Square cosine: max      min      freq    ---  '
'   5: Triangular:    max      min      freq    ---  '
'   6: Saw-tooth:     max      min      freq    ---  '
'   7: Sine:          max      min      freq    shift'
'   8: Cosine:        max      min      freq    shift'
'   9: Sensed prop`y: inc/dec  ---      ---     ---  '
'  '
'Option l implements switching multi-layer constructions'
'  and the data is overloaded to identify which surfaces'
'  the switching will be applied to.  You are asked for the'
'  Upper zone air temperature limit above which substitution'
'  occurs and the lower zone air temperature below which'
'  substitution occurs.'
'  '
'Senses temperature in specific zone - this allows you to be'
'  specific about where in a zone temperatures are sensed. You'
'  will be asked to sepcify the zone and then whether the sensor'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node in the surface.'
'  '
'NESTED CONTROLS - if a question pops up about whether you want'
'nested controls use the default NO. This only applies if you'
'have previously defined a MLC switching controller. And if so'
'you will be asked to idenfity the index of the switching control.'   
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_plant
'In the plant solution domain sensors for control loops can'
'be placed in the locations listed in the menu. This list is'
'similar to but not identical to that of the other domains.'
'  '
'The variety of locations is broad so as to give you maximum'
'flexibility. The location you select tends to define the nature'
'of what is sensed.'
'  '
'Option a allows you to sense one of the output variables in'
'  a plant component - you need to research the component'
'  prior to using this. You are asked for the plant component'
'  index as well as the output type.' 
'  '
'Option b needs a more specific location and you will be asked'
'  to identify which zone and you are asked for a'
'  radiant and convective weighting.'
'  '
'Options c-i use data in the climate file as sensed conditions'
'  the most common is ambient drybulb.'
'  '
'Option j allows you to read in timestep values (setpoints)'
'  in a model temporal file. You are asked for the index of'
'  the temporal item (so best look this up first).'
'  '
'Option k takes its output from a function generator so that'
'  standard test patterns can be implemented.'
'  The available functions are:'
' '
'   Function          supp1    supp2    supp3   supp4'
'   ================================================ '
'   1. Step:          start    finish   max     min  '
'   2. Ramp:          start    finish   max     min  '
'   3. Square sine:   max      min      freq    ---  '
'   4. Square cosine: max      min      freq    ---  '
'   5: Triangular:    max      min      freq    ---  '
'   6: Saw-tooth:     max      min      freq    ---  '
'   7: Sine:          max      min      freq    shift'
'   8: Cosine:        max      min      freq    shift'
'   9: Sensed prop`y: inc/dec  ---      ---     ---  '
'  '
'Senses temperature in specific zone - this allows you to be'
'  specific about where in a zone temperatures are sensed. You'
'  will be asked to sepcify the zone and then whether the sensor'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node in the surface.'
'  '   
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_flow
'In the mass flow solution domain sensors for control loops can'
'be placed in the locations listed in the menu. This list is'
'similar to but not identical to that of the other domains.'
'  '
'The variety of locations is broad so as to give you maximum'
'flexibility. The location you select tends to define the nature'
'of what is sensed.'
'  '
'Option a allows you to sense the temperature of a node in'
'  a plant component - you need to research the component'
'  prior to using this. You are asked for the plant component'
'  index as well as the node index. Optionally you can measure'
'  the difference in temperature between two nodes.' 
'  '
'Option b needs a more specific location and you will be asked'
'  to identify which zone and you are asked for a radiant and'
'  convective weighting. Take care when using this. Most users'
'  should use option j.'
'  '
'Options c-i use data in the climate file as sensed conditions'
'  the most common is ambient drybulb.'
'  '
'Option j is the most common choice - sensing flow nodes is'
'  more robust than sensing a zone temperature. In almost all'
'  cases you will be sensing conditions at a flow node rather'
'  than at a specific flow connection (the latter is only used'
'  when the sensed value is to be  1st or 2nd phase mass flow.'
'  Synopsis of sensed properties: '
'  a) Nodes linked to thermal zones will take their'
'     temperature the last know temperature of the zone.'
'     Many users prefer to sense flow node temperatures'
'     rather than sense the thermal thermal zones directly.'
' '
'  b) enthalpy is know at each node and can be sensed.'
' '
'  c) additional plant output might be something like'
'     the demand (W) of the component.'
' '
'  d/e/g/h) the Delta selections are in the form of'
'     the value at the 1st node of the connection minus'
'     the value at the 2nd node of the connection.'
'     For example: if a window should open if the ambient'
'     temperature is less than a room node temperature and'
'     the connection was defined from ambient to room then'
'     the delta T should be negative for an ON state.'
' '
'  i) contanimate concentration - the units are in g/kg'
'     (in other places you will have used kg/kg)'
'  '
'Senses temperature in specific zone - this allows you to be'
'  specific about where in a zone temperatures are sensed. You'
'  will be asked to sepcify the zone and then whether the sensor'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node in the surface.'
'  '   
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_optical
'In the optical controller sensors for control loops can'
'be placed in the locations listed in the menu. This list is'
'less extensive than other domains.'
'  '
'Note option a allows you to define a controller which can be'
'  applied to almost any zone in your model.' 
'  '
'Option b use data in the climate file'
'  '
'Option c tests the radiation at a specific outside surface.'
'  '
'Option d senses lux. Two methods are available: Light'
' Switch (manual blind control) or Lux level. However, only the '
' second for Lux level is active here. This should'
' be used with care. A tested implementation of both'
' methods is available through the Tranparent Multilayer'
' Control (TMC) files. '
'  '
'Senses temperature in specific zone - this allows you to be'
'  specific about where in a zone temperatures are sensed. You'
'  will be asked to sepcify the zone and then whether the sensor'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node in the surface.'
'  '   
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_CFC
'In the CFC optical controller sensors for control loops can'
'be placed in the locations listed in the menu. This list is'
'less extensive than other domains.'
'  '
'Option b appproximates a comfort sensor and you are asked for'
'  a radiant and convective weighting.' 
'  '
'Option c-h use data in the climate file'
'  '
'Option i tests the radiation at a specific outside surface.'
'  '
'Option j senses lux levels. Two methods are available: Light'
' Switch (manual blind control) or Lux level. However, only the '
' second for Lux level is active here. This should'
' be used with care. A tested implementation of both'
' methods is available through the Tranparent Multilayer'
' Control (TMC) files. '
'  '   
'Depending on the control domain a sensor can be located'
'at one of many places to measure specified parameters of'
'the model.'
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_nothing
'In the global and power domains sensors are not used.'
'There is nothing much for you to do!'
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
        call askzone(isn1,idef,
        CALL EASKABC('Specific location: ',' ','zone air point',
        call EASKSUR(isn1,isn2,'-','Available surfaces.',' ',IER)
        CALL EASKABC('Specific location in surface: ',' ',
        call asksnode(isn1,isn2,ilayt,isn3t,ier)
        CALL ASKPCMP('Plant component for sensor ? ','-',IP,IER)
        CALL ASKPCMP('Plant component for sensor ? ','-',IP,IER)
        call askzone(isn2T,idef,'Zone for sensor','Select zone','-',
        CALL EASKI(isn3T,' ',' Convective weighting factor (%) ?',
        call askzone(isn1,idef,
        call EASKSUR(isn1,isn2,'-','Available surfaces.',' ',IER)
        call askzone(isn2,idef,
        call EASKSUR(isn2,isn3,'-','Available surfaces.',' ',IER)
        call EASKAB(' ','Available lux level controls:',
        call askzone(isn2,idef,
        call EASKSUR(isn2,isn3,'-','Available surfaces.',' ',IER)
        CALL EASKI(isn2T,'Index of the temporal item to associate with',
        CALL EASKABC(' ',' Flow sensor at:',' flow node (typical) ',
        call MENUATOL(outs,' Sensed Property',
        CALL ASKMFCTM(NCPK,ICPK,'choose','contaminant',NH)
        CALL PHELPD(' ',2,'-',0,0,IER)
        CALL EPICKS(IX,IVALS,' ',' Controller type: ',
        call ASKCON('  flow connections','-',INS,INE,IC,IER)
        CALL EASKI(isn2T,' ',' Required mathematical function ?',
        CALL EASKI(isn2T,' Upper zone air temperature limit',
        CALL EASKI(isn3T,' Lower zone air temperature limit',
        CALL ASKOK(' Are there any nested control functions ?',
        CALL EASKI(isn4T,' ',
*subroutine actloc
*item actloc actlocation_prop_sub
'Up to three surfaces may have substitute properties.'
'The number required is the index in the surface.'
'A zero signals no substitution as follows: '
' three non-zero indicies will switcheds three'
' two non-zero followed by a zero switches two'
' one non-zero followed by two zeros switches one'
'If you cancel then data will revert to previous vlues.'
*enditem
        CALL EASKI(ian1T,' ',' First surface index (see help)?',
        CALL EASKI(ian2T,' ',' Second surface index (see help)?',
        CALL EASKI(ian3T,' ',' Third surface index (see help)?',
*item actloc actlocation_bld
'In the ideal building control domain actuation can be located'
'at one of many locations within the zones of the model.'
' Available actuation locations:'
' option a - current zone air point. The controller can be applied'
'   to any zone. The action is pure convective.
' option b - this requires a specific location and a split between'
'   the radiant and convective injections. The radiant flux will'
'   be distributed to the surfaces in the zone on an area and'
'   emissivity basis. For example, a WCH radiator is really a'
'   mixed radiant and convective source. Depending on its design'
'   it may have up to 60% convective delivery.'
'  '
' actuates specific location - this allows you to be'
'  specific about where in a zone flux is applied. You'
'  will be asked to sepcify the zone and then whether the actuator'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node within the surface.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_plant
'In the plant control domain actuation can be located'
'at one of the nodes within the plant network. You are asked'
'to supply the index of the component as well as the index of'
'the plant node. Do a bit of research on your plant network'
'and components prior to selecting this option.'
'  '
' actuates specific location - this allows you to be'
'  specific about where in a zone flux is applied. You'
'  will be asked to sepcify the zone and then whether the actuator'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node within the surface.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_flow
'In the flow control domain actuation can be located at a'
'specific flow connection (e.g. the control is applied to the'
'specific component associated with that connection). There is'
'also an option to apply control to a component type and all'
'of the places that that component is used. This later option'
'is somewhat more compact but has not been tested recently.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_nothing
'The global control domain and power control domains do not'
'rely on actuation specifications.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_optical
'The optical control domain actuation is focused on the optical'
'properties of surfaces within the model.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_CFC
'The complex fenistration control domain actuation can cause'
'a change of state in shading layers of a CFC or the slat angle'
'of a slat-type shade within a CFC or schecedule shading and'
'slat angles within a CFC.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
        CALL EASKABC('Specific location: ',' ','zone air point',
        call EASKSUR(ian1,ian2,'-','Available surfaces.',' ',IER)
        CALL EASKABC('Specific location in surface: ',' ',
        call asksnode(ian1,ian2,ilayt,ian3t,ier)
        CALL ASKPCMP('Plant component for actuator ? ','-',IP,IER)
        call ASKCON(' Flow connection?','-',INS,INE,IC,IER)
        call ASKRNOD('  sensed flow node','-',INOD,IER)
        call ASKRNOD(' 2nd sensed flow node','-',INOD,IER)
        call askzone(ian2,idef,
        call askCFCtype(ian2,ian3,IER)
        call askzone(ian2T,idef,'Zone for actuation','Select zone','-',
        CALL EASKI(ian3T,' ',' Convective weighting factor (%) ?',
        call ASKRCMP(' Flow component?','-',ICMP,IER)
        call ASKRNOD('control on node','-',iv,IER)
        call ASKRNOD(' 1st sensed node name','-',iv,IER)
        call ASKRNOD(' 2nd sensed node name','-',iv,IER)
        call askzone(ian2,idef,
        call askCFCtype(ian2,ian3,IER)
        call askzone(ian2,idef,
        call askCFCtype(ian2,ian3,IER)
*subroutine editctlperiod
*item editctlperiod
*enditem
          CALL ASKOK(' The control period data has changed.',
*item editctlperiod
*enditem
        CALL PHELPD('period control',nctlhelp,'-',0,0,IER)
*item editctlperiod
*enditem
  62    CALL EASKR(tcpst,' ',' Period start time ? ',
*item editctlperiod bld_ctl_period_data
'The zone basic controller is an ideal controller which'
'will inject or extract sufficient heat (subject to '
'the defined heating and cooling capacity) to meet a '
'heating and/or cooling setpoint.  '
' '
'A free float controller allows the zone temperature to'
'reach whatever temperature is consistent with the '
'heat gains and losses in the zone. No environmental '
'control is applied. '
' '
'The ideal fixed injection controller represents '
'systems which operate at a fixed rate if heating '
'or cooling is requested. '
' '
'An ideal proportional controller with optional'
'integral (reset) action and/or derivative (rate)'
'action time or to represent full PID. '
' '
'A control which links a zone with a detailed system'
'network component.'
' '
'A multi-stage controller with hysteresis has a '
'base heating and cooling capacity and, for each '
'three stages of increating capacity.'
' '
'Variable supply temperature with limit constraints '
'is an idealised air based control that delivers air'
'at a fixed flow rate (same for heating & cooling '
'operation). The heating supply temperature varies '
'up to a maximum setpoint and the cooling supply '
'temperature varies down to a minimum setpoint. '
' '
'Control with separate on/off setpoints allows '
'separate flux ON and flux OFF set points for '
'heating and cooling via ON until OFF point logic.'
' '
'Time proportioning control with separate on/off '
'setpoints for heating and cooling extends the'
'functionality with cycle time limits.'
' '
'The floating action (three-position) controller'
'uses an open switch and shut switch differential (C)'
'for heating and cooling as well as timestep rate of'
'change for heating and cooling.'
' '
'The optimum start controller allows for three modes'
'of operation (each with rewind): '
' (1) Default start at 4AM '
' (2) Start at user defined time '
' (3) Birtles & John equation time estimate'
' '
'Proportional capacity slave controller. Typically a'
'slave control is used to represent an environmental'
'control with a thermostat in one zone and actions in'
'a number of zones. '
' '
'Match sensed values (ideal:2 setpoints) control law:'
'is a combination of ideal controller and ctrl law 11.'
'Values from the temporal file are taken to set setpnts'
'Further details within each control law interface. '
*enditem
  63    CALL EPICKS(IX,IVALS,' ',' Control law option:',
  64    CALL EPICKS(IX,IVALS,' ',' Control law option:',
        CALL EASKI(ivalue,prompt1(ifoc),prompt2(ifoc),
        CALL EASKR(cmlocal(ifoc),prompt1(ifoc),prompt2(ifoc),
*subroutine stfmenu
*item stfmenu sys_bctl_01_03
'A basic zone controller is an ideal controller that'
'will inject or extract heat (subject to the available'
'heating and cooling capacity) to maintain a given'
'set-point temperature.'
' '
'If there is a deadband then the temperature will float'
'when the sensed condition is between lower and upper'
' '
'If the minimium heating (or cooling) capacity is > 0'
'then heating (or cooling) will persist even when'
' none is called for.'
' '
'A heating only (or cooling only) scheme may be'
'defined by setting a high cooling (or low heating)'
'temperature set-point or by defining a zero cooling'
'or heating) capacity.'
' '
'In addition to temperature control, it is possible'
'to activate relative humidity (RH) control by:'
' '
'(1) Injection or extraction of moisture (g/s) to the'
'    zone. Humidification and dehumidification'
'    capacities are specified in g/s where 1 g/s of'
'    moisture equates to a latent gain/loss of'
'    approximately +/-2.5kW.'
' '
'(2) Heating & cooling the zone. Note however that'
'    this approach will over-ride any temperature'
'    control although the defined heating and cooling'
'    capacities will be used. This approach could be'
'    used to check whether a system which is not'
'    capable of moisture injection/extraction can'
'    still limit RH swings.'
' '
'Depending on the control method selected, heating or'
'dehumidification will commence if the RH rises above'
'the upper set-point. Likewise, humidification or'
'cooling commences if the RH falls below the lower RH'
' '
'With large thermal capacity system the simulation'
'time step should be constrained to a maximum of'
'15 minutes to give sufficient control regulation'
'decision points'
*enditem
*item stfmenu sys_bctl_02
'A free float controller allows the zone temperature'
'to reach whatever value is consistent with the heat'
'gains and losses to the zone. No heating or cooling'
'is applied. '
*enditem
*item stfmenu sys_bctl_04
'The ideal fixed injection controller injects a given'
'flux when heating or cooling is requested.'
' '
'This control is best used with a short simulation time'
'step to avoid temperature oscillation.'
' '
'Heating (or cooling) may be disabled by setting a'
'correspondingly low (or high) set point or by setting'
'the corresponding capacity to zero.'
*enditem
*item stfmenu sys_bctl_05
'This implements an ideal proportional (P) controller'
'with optional integral (I) and/or derivative (D)'
' '
'P action produces an output that is proportional to '
'the sensed deviation from the set point. This can.'
'result in an offset.'
' '
'P+I action may be used to elimitate this offset.'
' '
'P+D action is typically used where the heating or'
'cooling system has a fast response. This helps to'
'avoid overshoot.'
' '
'PID action combines all the above. As with real PID'
'controllers, this controllerneeds to be tuned to the'
'  * overshoots can be caused by excessive integral'
'    action;'
'  * continuous oscillations can be caused by'
'    excessive derivitive action.'
' '
'These controls are best used in association with'
'short simulation time steps.'
' '
'If the minimium heating (or cooling) capacity is > 0'
'then heating (or cooling) will persist even when'
'none is called for.'
' '
'Heating (or cooling) may be disabled by setting a'
'correspondingly low (or high) set point or by setting'
'the corresponding capacity to zero.'
*enditem
*item stfmenu sys_bctl_07
'A multi-stage controller (with hysteresis) has'
'increasing (or equal) heating and cooling capacities'
'defined for several stages. Stage set-points are'
'then defined.'
' '
'The control logic switches to the least stage that'
'will maintain the desired temperature, stepping up'
'and down between stages as appropriate.'
*enditem
*item stfmenu sys_bctl_08
'This control represents an idealised, air based'
'system that delivers air at a fixed flow rate (same'
'for heating & cooling). The heating supply temperature'
'varies up to a maximum set-point and the cooling'
'supply temperature varies down to a minimum set-point.'
' '
'The room heating and cooling set-points (typically'
'defined so that there is a deadband) are met on the'
'basis of the heating and/or cooling implicit at the'
'defined flow rate and supply temperature, i.e. the'
'capacity and efficiency of the supply is not defined.'
' '
'This control can be used to check whether an air'
'based system is able to meet demand patterns in a'
'room prior to specification of a detailed component'
'model.'
*enditem
*item stfmenu sys_bctl_10'
'This control allows separate flux ON and flux OFF'
'set points to be specified for heating and cooling.'
' '
'During ON periods the specified flux is applied'
'until the OFF setpoint is reached. When the OFF'
'condition has been reached the flux input is not'
'reactivated until and ON state is agsin reached.'
' '
 'Example: if the temperature goes below 18C turn on'
'  heating until 22C is reached and keep off until'
'  the temperature falls below 18C again.'
' '
'Example: if the temperature goes above 26C turn on'
'  cooling until 24C is reached and keep off until'
'  the temperature rises to 26C.'
' '
'If the heating OFF and the cooling OFF setpoints'
'overlap then heating and cooling are both ON. '
' '
'Note because the full heating or cooling capacity'
'is used when an ON state is called for a shorter'
'timestep should be used (typically 5 minutes or'
'less). Also the heating and cooling capacity should'
'match the demands of the room otherwise poor temp-'
'erature control will be obtained. '
' '
'This control is an alternative to the basic ideal'
'controller which only has a single setpoint for '
'heating and cooling. '
' '
'You are given the option to discard changes when you'
'exit the period. '
*enditem
*item stfmenu sys_bctl_13
'This control allows separate flux ON and flux OFF'
'set points to be specified for heating and cooling'
'and extends the functionality of the basic separate '
'ON OFF controller by constraining the heating and '
'cooling cycle times. '
' '
'During ON periods the specified flux is applied'
'until the OFF setpoint is reached. When the OFF'
'condition has been reached the flux input is not'
'reactivated until and ON state is agsin reached.'
' '
 'Example: if the temperature goes below 18C turn on'
'  heating until 22C is reached and keep off until'
'  the temperature falls below 18C again.'
' '
'Example: if the temperature goes above 26C turn on'
'  cooling until 24C is reached and keep off until'
'  the temperature rises to 26C.'
' '
'Warning: if heating OFF and the cooling OFF setpoints'
'overlap there will be simultaneous operation.'
' '
'This control represents equipment which is constrained'
'by minimum ON and OFF cycle times (minutes) as well as'
'a total cycle period. For example a heating battery'
'which must be on for at least 5 minutes and then must'
'be off for 10 minutes before it can be re-stared and'
'the mfg recommends the heating system only go through'
'three cycles (20 minutes) each hour. '
' '
'The ON and OFF and total cycle times in minutes are'
'defined for heating and then for cooling. The number'
'of minutes of ON and OFF must not exceed the total'
'cycle minutes. '
' '
'Note because the full heating or cooling capacity'
'is used when an ON state is called for a shorter'
'timestep should be used (typically 5 minutes or'
'less). Also the heating and cooling capacity should'
'match the demands of the room otherwise poor temp-'
'erature control will be obtained. '
' '
'If the simulation timestep can be longer than the '
'cycle times then the heating and cooling capacity is'
'reduced to compensate. If the simulation timestep is'
'shorter than the ON OFF cycle times then it is easier'
'to see the control action. '
' '
'IT IS UP TO YOU to set an appropriate simulation'
'timestep. '
' '
'You are given the option to discard changes when you'
'exit the period. '
*enditem
*item stfmenu sys_bctl_14
'BCL14 is a floating action (three-position) controller'
'which supports the definition of an open switch and'
'shut switch differential (C) for heating and cooling'
'as well as timestep rate of change for heating and '
'cooling. '
' '
'This is one of the so-called obscure zone controllers'
'and there might be dragons in the code so take your '
'time and be prepaired for some iteration. '
' '
'The simulation timestep probably should be short e.g.'
'a few minutes.  The simulation trace facility will'
'report the current state and the prior state for'
'heating and cooling.'
' '
'You are given the option to discard changes when you'
'exit the period. '
*enditem
*item stfmenu sys_bctl_15
'The optimum start controller allows for three modes '
'of operation: '
' (1) Default start at 4AM'
' (2) Start at user defined time'
' (3) Birtles & John equationq estimate which is '
'     based on A New Optimum Start Control Algorithm'
'     in Proceedings of International Symposium'
'     on Control and Operation of Building HVAC'
'     Systems in 1985 Trondheim, Norway'
' '
'Note this control is designed for optimum start '
'of heating only. It is one of the lesser used '
'controls - pay attention to the predicted performance.'
' '
'Heating capacity is in W to be used during the'
'optimum startup period. '
' '
'The heating setpoint (C) is the desired temperature'
'at the desired-time-of-arrival. '
' '
'The band of acceptable temperatures (C) is applied'
'to the heating setpoint to provide an upper and '
'lower setpoints. A small band will force tighter'
'control. '
' '
'If the optimal control does not reach the band of'
'acceptable temps at the desired-time-of-arrival '
'then it will rewind and try again. You can control '
'the time difference between successive trails by '
'setting a minimum-time-difference. '
' '
'The Birtles & John Eqn. asks for three coefficients '
'the first is a heating constant, the second is a '
'building constant and the third is an exterior '
'temperature constant. Please review the paper '
'in order to understand these coefficients. '
' '
'This control uses a rewind action that resets the'
'simulation timestep and `tries again`. During the'
'simulation the `monitor` facility will get confused'
'and some graphs in the results module might not '
'plot correctly.  Use this control with care. '
' '
'You are given the option to discard changes when you'
'exit the period. '
*enditem
*item stfmenu sys_bctl_21
'Proportional capacity slave controller. Typically a'
'slave control is used to represent an environmental'
'control with a thermostat in one zone and actions in'
'a number of zones. Example: a residentail AC system'
'with a central fan delivering to several zones.'
' '
'Flux is delivered to slave control when required by'
'master control, at same % of base (max) capacity.'
' '
'You are asked for three values:'
'  - index of control loop associated with the'
'    master control (which MUST use a basic ideal'
'    controller or a free float control and the master'
'    MUST also sense a specific zone in the model).'
' '
'  - base (maximum) heating capacity for slave'
'  - base (maximum  cooling capacity for slave.'
' '
'Procedure - first create the master control loop'
'and then create a slave loop for each other zone'
'in the model which acts as a slave. If the master'
'control loop is for weekday Saturday Sunday then'
'each slave control should follow this pattern and'
'the number of periods should also match. '
' '
'The sensor of each slave controller MUST point to'
'the SAME zone that the master controller senses.'
' '
'The actuator of each slave controller MUST point to'
'the slave zone. '
' '
'The simulation timestep should typically be short '
'enough to reflect the cycling of the environmental'
'control system. '
' '
'Example: in a house there is 4kW of heating and the'
'thermostat is in the lounge which has 1kW of heating'
'so the slave capacity in the other zones should'
'total to 3kW. Setting the capacity in each slave'
'zone can be done via different methods:'
' a) as a proportion of the duct flow or radiator'
'    size in each zone'
' b) by doing an initial simulation with each zone'
'    ideally controlled and noticing the ratio of'
'    the peak demands in each room'
' c) (roughly) as a function of zone volume or floor'
'    area.'
' '
'You are given the option to discard changes when you'
'exit the period. '
*enditem
*item stfmenu sys_bctl_22
'This control represents an ideal air based '
'environmental control system that delivers air '
'at a variable flow rate and a fixed supply temp'
'for cooling to a desired setpoint.'
' '
'In heating mode it reverts to a CAV system at the'
'minimal supply flow rate with reheat applied up to a '
'maximum flux to reach the desired setpoint.'
' '
'There is a single desired room setpoint (C) so'
'the control law will cycle between VAV and CAV '
'model under low-load conditions. '
' '
'It is recommended that a short timestep be used with'
'this control ( 1 - 5 minutes). '
' '
'This control law can be used to check whether an '
'air based system is able to meet demand patterns in '
'a room prior to specification of a detailed component'
'model. If flow rates or supply temperature are not '
'well sepecified then the room temperature will drift '
'as expected. '
' '
'Specification of minimum flow rate is a compromise '
'between what is required for CAV heating and excess '
'cooling in low-load conditions. '
' '
'Typically the maximum flow rate would be equivalent '
'to 12-20ach in the zone. Low max flow rates can result'
'in failure to meet the desired temperature. And high'
'minimum flow rates can result in overcooling in mild '
'conditions. '
' '
'Additional performance data (e.g. flow rates, reheat)'
'if you invoke control trace at simulation time.'
' '
'NOTE: THIS LAW SHOULD BE CONSIDERED BETA version.'
' '
'You are given the option to discard changes when you '
'exit the period. '
*enditem
*item stfmenu sys_bctl_23
'This control law sets the setpoints based on heating'
'and cooling temperatures as read from a temporal file'
'defined in the model context > impose measured data'
'section of the project manager interface. Any amount'
'of heating and cooling is added so that the setpoints'
'are met.'
*enditem
*item stfmenu sys_bctl_24
'Adaptive comfort algorithm models occupant behaviour'
'and operates heating/cooling based on mean operative'
'and outdoor mean temperatures automatically.'
'A comfort temperature is calculated based on the  '
'running mean response parameter that governs how'
'running mean temperature is calculated. This parameter'
'is a constant from 0-0.99 (Default value 0.8)'
'The comfort band also needs to be entered, this is the'
'tolerance from calculated comfort temperature and  '
'has a default value of 2degC '
'This essentially creates a heating and cooling  '
'set point of magnitude of comfort band on both sides'
'of the comfort temperature and controls to that '
'temperature based on probability that heating/ccoling '
'will be switched on. '
'The statically entered set points are currently not  '
'used in the calculation but are retained for possible '
'future use. '
*enditem
*item stfmenu sys_bctl_other
'Nothing '
'written '
'yet about '
'this control '
*enditem
*item stfmenu sys_bctl_CFC
'Add explanation about CFC basic shading control here'
'  '
*enditem
*subroutine exportcad
*item exportcad
'This facility allows you to export the current model'
'in a format as required by one of the following'
'3rd party applications.'
' '
'VIEWER, a hidden line perspective program from ABACUS;'
'DXF (version 12) file (see the note below);'
'XZIP, a CAD program from IES;'
'RADIANCE, a lighting simulation program from LBL;'
'XFIG, a vector plotting program (available on Linux and'
'OSX and Cygwin) so that wire-frame images can be exported'
'in high resolution.'
'MicroGDS, a CAD program;'
'EnergyPlus, a building thermal simulation program from'
'       North America'
'VRML Version 2.0, with a matching html file containing'
'     surface attributes.'
' '
'General rules assumed in DXF export: '
'* Each thermal zone has a separate layer and the'
'  layer name is the zone name (<12 char without blanks).'
' '
'* If a zone includes shading obstruction blocks then'
'  these should be on a separate layer and the name of'
'  the layer should be OBS_ followed by the characters'
'  in the zone layer name. Example the obstructions for'
'  layer MANAGER_A are in OBS_MANAGER_A'
' '
'* If you want to identify particular surfaces in a zone'
'  as transparent then create and additional layer with'
'  the layer name starting with TRN_. Example transparent'
'  surfaces in MANAGER_A are in TRN_MANAGER_A. If you do'
'  not create this separate layer then you will have to'
'  manually attribute the glass surfaces in ESP-r.'
' '
'* Shading obstructions are represented via DXF BLOCK'
'  entities. Typically a set of 6 3DFACE objects within'
'  each BLOCK. You could probably also use POLYLINE '
'  entities within a BLOCK.'
' '
' * Zone surfaces which are polygons of 4 sides used the'
'   3DFACE entity. Zone surfaces which are triangles or'
'   are > 4 sides use POLYLINE entities.  Or you could use'
'   POLYLINE entities for all zone surfaces.'
' '
'NOTE: if you need to debug the import of CAD data turn'
'the reporting level from silent or standard to detailed.'
' '
'NOTE: if you are useing Native Windows version the paths'
'to the exported files may not work correctly. '
' '
'The option for ESP-r meta file creates a compact'
'description of a model in a single file. This file'
'is typically created by 3rd party applications and'
'used by prj to expand to a standard ESP-r model.'
'This export facility supports testing of this file'
'format and data structures.'
' '
*enditem
         CALL EASKAB('The model is in a remote folder.',
*item exportcad
'Input the name of the VIEWER input file.'
*enditem
        CALL EASKS(LFIL,' ','VIEWER file name?',
*item exportcad
'A DXF file may be passed to some CAD packages'
'such as AutoCAD V12.'
*enditem
        CALL EASKS(LFIL,' ','DXF file name?',
*item exportcad
'A ZIP file may be passed to the XZIP CAD package'
'from IES.'
*enditem
        CALL EASKS(LFIL,' ','ZIP file name?',
*item exportcad
'If your model includes zone, ground and/or solar'
'obstructions geometry you can visualise them using'
'the RADIANCE program. It is assumed that your computer'
'has the RADIANCE modules installed and their location'
'defined in your PATH environment variable. The actual'
'model convertion is achieved using ESP-r`s e2r module.'
*enditem
        CALL ASKOK(' ','Run RADIANCE conversion tool?',OK,dok,6)
*item exportcad
'It is possible to write a wireframe image of the model'
'to a vetor file for use with the xfig application.'
'Before exporting adjust the model view and resize'
'the graphics window to force a redraw.'
*enditem
        call askok(' ','Is wireframe composition ok?',oke,dok,4)
*item exportcad
'Assuming the export was sucessful you can proceed.'
*enditem
          call askok(' ','Convert output to xfig format?',ok,dok,1)
*item exportcad
'A THINGS file is used with the CAD package MicroGDS.'
'Note that obstructions are treated as clusters of'
*enditem
        CALL EASKS(LFIL,' ','MicroGDS THINGS file name?'
*item exportcad
'This file is input to the EnergyPlus system.'
*enditem
        CALL EASKS(LFIL,' ','EnergyPlus input file name?',
*item exportcad
'EnergyPlus input files have several versions.'
'Version 3.0 is the current'
'Version 4.0 is in testing.'
*enditem
        CALL EASKR(evert,'EnergyPlus IDF file version?','(3.0)',
*item exportcad
'A VRML format file may be used with a number of'
'3rd party packages and web browser plug-ins to'
'visually explore a model.'
*enditem
        CALL EASKS(LFIL,' ','VRML file name?',
*item exportcad
'The option for ESP-r meta file creates a compact'
'description of a model in a single file. This file'
'is typically created by 3rd party applications and'
'used by prj to expand to a standard ESP-r model.'
'This export facility supports testing of this file'
'format and data structures.'
*enditem
        CALL EASKS(LFIL,' ','ESP-r meta file name?',
*item exportcad
*enditem
       CALL PHELPD('export menu',55,'-',0,0,IER)
*subroutine cadin
*item cadin
'Executing CAD program by which the zone geometry'
'may be defined.  The file created will be requested'
'later for model importing.'
' '
'If the CAD program creates DXF files then PLEASE READ'
'the following section for hints and notes on current'
' '
'If the CAD program is able to create ESP compatable'
'files then please assign zone names so that the'
'conversion process will proceed smoothly.'
' '
'ESP-r currently exports and imports a subset of DXF'
'version 12 entities. ESP-r only deals with 3D entities.'
'The import process will skip most 2D entities because'
'2D has no meaning within simulation. '
' '
'For a quick exploration of the entity types that ESP-r'
'works with take an existing ESP-r model, export it to'
'DXF and look at the file or import it into a CAD tool.'
' '
'The import facility assumes that you have registered'
'an initial ESP-r model and that there no thermal'
'zones in the model.  If your current model has zones'
'you are advised to create a new model and add the'
'existing zones after you have imported the CAD data.'
' '
'General rules: '
'* Each thermal zone has a separate layer and the'
'  layer name is the zone name (<12 char without blanks).'
' '
'* If a zone includes shading obstruction blocks then'
'  these should be on a separate layer and the name of'
'  the layer should be OBS_ followed by the characters'
'  in the zone layer name. Example the obstructions for'
'  layer MANAGER_A are in OBS_MANAGER_A'
' '
'* If you want to identify particular surfaces in a zone'
'  as transparent then create and additional layer with'
'  the layer name starting with TRN_. Example transparent'
'  surfaces in MANAGER_A are in TRN_MANAGER_A. If you do'
'  not create this separate layer then you will have to'
'  manually attribute the glass surfaces in ESP-r.'
' '
'* Shading obstructions are represented via DXF BLOCK'
'  entities. Typically a set of 6 3DFACE objects within'
'  each BLOCK. You could probably also use POLYLINE '
'  entities within a BLOCK.'
' '
' * Zone surfaces which are polygons of 4 sides used the'
'   3DFACE entity. Zone surfaces which are triangles or'
'   are > 4 sides use POLYLINE entities.  Or you could use'
'   POLYLINE entities for all zone surfaces.'
' '
'The current model includes zones.  Please make'
'careful note of any changes you make to the model'
'so that you can restore contiguity when importing'
'from the CAD package.'
*enditem
        CALL PHELPD('CAD warning',58,'-',0,0,IER)
*item cadin
*enditem
        CALL PHELPD('CAD warning',53,'-',0,0,IER)
*item cadin
'Current import options are DXF files and so-called'
'ZIP files (from a Scottish CAD company).'
*enditem
      CALL EASKABC('Specify which CAD format to work with',
*item cadin
'A DXF file is required by this CAD package please,'
'supply a name.'
*enditem
        CALL EASKS(LFIL,' Put current model into DXF file named: ',
*item cadin
'A ZIP file may be passed to the XZIP CAD package.'
*enditem
        CALL EASKS(LFIL,' Put current model into ZIP file named: ',
*item cadin
'Assuming that the 3rd party tool is installed on your '
'machine it should be ok to proceed. If you just want to'
'generate the file for the tool say no at this point. '
*enditem
      CALL ASKOK(' ',outs,OK,dok,3)
*item cadin
'Assuming that the 3rd party tool generated a file and you'
'know the location of that files it should be ok to proceed.'
*enditem
      CALL ASKOK(' ','Import the CAD transfer file?',OK,dok,2)
*item cadin
'A DXF format file may be converted if it has been'
'created using layer and entity constraints.'
' '
'If the file is from `xzip` supply its name (if you'
'saved the zip file in the folder that the CAD tool'
'suggested you will not need to give the path). '
*enditem
        CALL EASKS(LFIL,' File to import ? ',
*item cadin
'Coud not find the file in the location you'
'specified. Double check and perhaps try again.'
*enditem
          call askok(outs,'Try again?',OK,dok,2)
*subroutine rexmpl
*item rexmpl
'These exemplar model sets are available for browsing.'
'Each set comprises a family of models relating to'
'different possible uses of ESP-r.'
' '
'Exemplar models may be used for training purposes or'
'as a record of interesting past projects that might'
'serve as the starting point in some future project.'
' '
'Note to ESP-r Administrators: the `exemplars` file'
'located in directory ~esp-r/training should be kept'
'up-to-date by appending new models using the key'
'word syntax as explained in the exemplars file.'
*enditem
        CALL PHELPD('exemplar menu',12,'-',0,0,IER)
*item rexmpl
'To browse one of the exemplar designs, simply'
'select it.  If you wish to modify the model'
'then you must first copy it into your folder.'
' '
'The current set of exemplars: '
*enditem
          CALL PHELPD('exemplar menu',5+nghelp,'-',0,0,IER)
*item rexmpl
*enditem
          CALL PHELPD('exemplar menu',3,'-',0,0,IER)
*item rexmpl
'When browsing a model you are prevented from'
'altering its data although you can use it to run'
'simulations. If you want to modify the model'
'then you must firstly copy it to your own folder'
'by selecting the `own it` option.'
*enditem
              CALL EASKABCD(exdescr,'Actions:','browse',
*subroutine clickonbitmap
*item clickonbitmap
'You can describe a thermal zone as an rectangle, a floor'
'plan extrusion or a general polyhedra. Use only as much'
'details as required to simplify attribution tasks, QA'
'and interpretation tasks.'
' '
'Points from a bitmap:                  '
' Zones, ground topology and obstructions can be defined'
' via points from a scanned image of a site plan or floor'
' plan or elevation or one of several predefined grids.'
'                  '
' First scan the relevant source and convert it to an'
' XBM (X11 monochrome bitmap) file and place this in'
' the project `cfg` folder.'
' '
' Ensure that the bitmap is large enough to allow for'
' accurate positioning of the mouse. The bitmap can be'
' larger than the graphic display area (you can pan left'
' and right and up and down within it).'
' '
' The source image should indicate an origin (X=0.0'
' Y=0.0), the direction north (optional), and a'
' line of known length (to get scaling from).'
'                  '
'Menu options:     '
' Pan: if bitmap larger then display then you can show'
'      a portion of the bitmap and pan around'
' Origin: identifies X=0.0 and Y=0.0 on the bitmap  '
' North: identifies angle between North and Y axis'
'        (no translation/rotation is currently done!)'
' Scaling: select two points a known distance apart '
'          (for best results pick a longer line).'
' Gridding: impose a grid and a `snap-to-grid` function.'
'           '
'Input modes:'
'  Adding vertices (with same Z value or different Z) is'
'  useful if you want to gather points and later link'
'  the vertices to form surfaces.'
'                  '
'  Adding walls is the same as a floor plan extrusion.'
'  You can input many zones in sequence. Note:'
'  the snap to grid option is useful here.'
'                  '
'  Adding vertices for a south or east elevation is'
'  supported. Later you can link them together to form'
'  surfaces.'
'                  '
'  Adding vertices to the project ground topology is'
'  supported. Later you can link them together to form'
'  surfaces.'
' '
'  Adding obstructions for the zones you have created'
'  can save time. You will probably want to set the'
'  gridding small before you start this.'
' '
'Zones and obstructions can be saved or discarded after'
'you type `e` but you must manually save ground topol.'
' '
'HINT: this facility is designed for doing zones then'
'obstructions in one session. '
'You were defining ground topology. This information'
'might be lost if you exit without having saved first.'
*enditem
          call askok('Have you saved the ground topology?',' ',ok,
*item clickonbitmap
*enditem
        CALL PHELPD('bitmap opening',59,'-',0,0,IER)
*item clickonbitmap
'Assuming the basic parameters (zone base and top height,'
'gridding and shap options have been set you can proceed '
'with adding points. Otherwise select continue and get'
'the parameters sorted first. '
*enditem
        call easkab('Options for adding objects (see help):',' ',
*item clickonbitmap
'This file contains a description of a ground form'
'for use by Radiance and viewing (later by esp). '
*enditem
 56       CALL EASKS(ltmp,' Ground topology/geometry file name ? ',
*item clickonbitmap
'This is a reminder of the ground type.'
*enditem
          CALL EASKS(t15,' Description of the ground?',
*item clickonbitmap
'The name of the zone is used both for descriptive'
'and bookkeeping purposes.  Each name should be'
'unique and should not contain blanks. '
*enditem
          CALL EASKS(ZN,' What do you want to call this new zone ',
*item clickonbitmap
'The zone description allows further information about'
'the zone form and composition to be recorded.  '
*enditem
 43       CALL EASKS(zd,' What does it represent ',
*item clickonbitmap
'Please convert any bitmap file to XBM format '
'and ensure that the graphic feedback area is large '
'enough for it to display properly and that the bitmap'
'is large enough to allow for accurate positioning of '
'the mouse. '
' '
'If you just want to use a blank bitmap or a bitmap with'
'tickmarks to quickly input zones and/or obstructions'
'then these are also available. '
*enditem
        call MENUATOL('Bitmap options: (see help)',' ',
*item clickonbitmap
*enditem
        CALL EASKXORGTKF(fname,'X11 bitmap file name?',' ',
*item clickonbitmap
'The view of a truncated bitmap can be panned left '
'and right and up and down (by increments of 50 pixels)'
*enditem
        CALL EASKATOG(msg,' ','done','left','right','up','down',' ',
*item clickonbitmap
'You previously defined an orgin on the bitmap.'
'If you want to change it say ok. '
*enditem
          CALL ASKOK(' ',' Redefine origin? ',OK,dok,2)
*item clickonbitmap
'You previously defined north on the bitmap.'
'If you want to change it say ok. '
*enditem
          CALL ASKOK(' ',' Redefine north? ',OK,dok,2)
*item clickonbitmap
'You previously defined scaling points on the bitmap.'
'If you want to change this say ok. '
*enditem
          CALL ASKOK(' ',' Redefine scale? ',OK,dok,2)
*item clickonbitmap
*enditem
          CALL EASKR(disn,' ','Distance (metres) between points?',
*item clickonbitmap
'You previously defined gridding for the bitmap.'
'If you want to change this say ok. '
*enditem
          CALL ASKOK(' ',' Redefine grid? ',OK,dok,2)
*item clickonbitmap
'A grey grid will overlay the bitmap from corner to '
'corner. '
*enditem
          CALL EASKATOG('Gridding options:',' ',
*item clickonbitmap
'Enter a value between 0.1 and 1.0.'
*enditem
            CALL EASKR(ZDI,' ',' Distance between grid points?',
*item clickonbitmap
'Input modes:'
'  Adding vertices (with same Z value) is useful if you'
'  want to gather information from the bitmap and later'
'  link the vertices to form surfaces.'
'                  '
'  Adding vertices (with different Z values) is useful'
'  if you want to capture information at several levels'
'  (e.g. contours on a site plan)'
'  '
'  Adding walls via a floor plan extrusion. Remember to'
'  select the `corners` anti-clockwise.'
'  '
'  South elevation fills X & Z coords @ one Y.'
'  East elevation  fills Y & Z coords @ one X.'
'  '
'  Ground toplogy will ask for Z value for each point.'
'  '
'  Obstructions asks for 2 points defining front and'
'  one point perpendicular as well as base and top.'
'  '
'If gridding is on and snap-to is on then the selected'
'coordinate may be relocated to the nearest point. '
*enditem
        call MENUATOL(msg,' Coordinate input options',
*item clickonbitmap
'If you previously were defining points via floor '
'plans the history of these points can be cleared '
'if you say ok. '
*enditem
            CALL ASKOK(
*item clickonbitmap
'This file contains a description of a ground form'
'for use by Radiance and viewing (later by esp). '
*enditem
 46         CALL EASKS(ltmp,' Ground topology/geometry file name ? ',
*item clickonbitmap
'This is a reminder of the ground type.'
*enditem
            CALL EASKS(t15,' Description of the ground?',
*item clickonbitmap
'The elevation is in metres.'
*enditem
          CALL EASKR(Z1,' ',' Elevation of vertices to be selected?',
*item clickonbitmap
'The base (floor) elevation is in metres.'
*enditem
          CALL EASKR(Z1,' ',' Elevation of the base surface? ',
*item clickonbitmap
'The south elevation has all the same'
'Y values (m).'
*enditem
          CALL EASKR(Y1,' ','Y value for south elevation?',
*item clickonbitmap
'The east elevation has all the same'
'X values (m).'
*enditem
          CALL EASKR(X1,' ','X value for east elevation?',
*item clickonbitmap
'The base elevation of obstruction is in metres.'
*enditem
          CALL EASKR(Z1,' ',' Elevation of the base of obstruction?',
*item clickonbitmap
'The top surface height is along the Z axis (metres).'
'Note: this is not the base-top distance!'
*enditem
          CALL EASKR(Z2,' ',' Elevation of the top surface? ',
*item clickonbitmap
'The height of obstruction is in metres.'
*enditem
          CALL EASKR(Z2,' ',' Height (top-bottom) of obstruction?',
*item clickonbitmap
'You might have selected this option by mistake. ESP-r'
'is expecting to have found a name for a zone at this'
'point. Probably you ment to select the `add another` '
'option first. '
*enditem
          call askok(
*item clickonbitmap
'The view of a truncated bitmap can be panned left'
'and right and up and down (by 50 pixels)'
*enditem
              CALL EASKATOG(msg,' ','done','left','right','up','down',
*item clickonbitmap
*enditem
              CALL EASKR(Z3,' ',' Elevation (Z metres)? ',
*item clickonbitmap
*enditem
            CALL EASKR(Z3,' ',' Elevation (Z metres)? ',
*item clickonbitmap
'Having stopped adding points, if you made a mistakes'
'you can clear and start again or you can clear data'
'and return to the menu or save the data.'
*enditem
          call easkabc('Options:',' ','clear points & redefine zone',
*item clickonbitmap
'The view of a truncated bitmap can be panned left'
'and right and up and down (by 50 pixels)'
*enditem
              CALL EASKATOG(msg,' ','done','left','right','up','down',
*item clickonbitmap
'Having stopped adding points, if you made a mistakes'
'you can clear and start again or you can clear data'
'and return to the menu or save the data.'
*enditem
          call easkabc('Options:',' ','clear points & redefine zone',
*item clickonbitmap
'The view of a truncated bitmap can be panned left'
'and right and up and down (by 50 pixels)'
*enditem
              CALL EASKATOG(msg,' ','done','left','right','up','down',
*item clickonbitmap
'Assuming the last block is where you want it proceed.'
*enditem
          CALL ASKOK(' ','Block position ok? ',OK,dok,1)
*item clickonbitmap
' Pick a zone for these obstructions.'
*enditem
          CALL EPICKS(INPIC,IVALS,' ',
*item clickonbitmap
'A descriptive name (up to 12 char) is recommended.'
*enditem
          CALL EASKS(S12,' ',' Name of obstruction? ',
*item clickonbitmap
'The base elevation of obstruction is in metres.'
*enditem
          CALL EASKR(Z1,' ',' Elevation of the base of obstruction?',
*item clickonbitmap
'The height of obstruction is in metres (dimension.'
'from base to top). '
*enditem
          CALL EASKR(Z2,' ',' Height of the obstruction?',
*item clickonbitmap
'The opaticy of the obstruction 0.0 transparent to'
'1.0 opaque (for future shading facility). '
*enditem
          CALL EASKR(blkopaq,' ',
*item clickonbitmap
'In order to account for external shading devices,'
'window reveals, trees, outside walls, etc. in a '
'detailed shading analysis the user should'
'approximate such objects as one or more prisms'
'which are described in a site obstruction file.'
'The browse option presents a list of files in the'
'project `zones` folder.'
*enditem
            CALL EASKS(LTMP,' Zone obstructions file? ',
*subroutine EDSITE
*item EDSITE
'This menu allows site and miscellaneous data to'
'be defined. In most cases the default entries will'
'be acceptable. An explanatyion of the less obvious'
'entries follows.'
' '
'Primary energy conversions are used to convert'
'predicted energy demands (for lights, small power,'
'heating etc.) to equivalent primary energy units.'
' '
'Dispersed demands are schedules of demands for items'
'such as pumps, lifts etc, that are not simulation'
'(although they could be). These items may then be'
'displayed on an IPV alongside data relating to'
'simulated items.'
' '
'An integrated performance view (IPV) definition'
'specifies the assessments to be included in an IPV,'
'what portion(s) of the model to cover, the time'
'period to consider and any scaling factors to apply.'
' '
'Situation specific wind pressure coefficent sets may'
'be calculated using CPCALC for later use in network'
'air flow modelling.'
' '
'Images are normally in GIF format although other'
'formats may be used where an appropriate display tool'
' '
'Where the time averaging method applied to climate'
'data is known this should be set via the toggle.'
'Shading should be recalculated when site data'
'changes. Each affected zone will be done in turn.'
*enditem
          CALL EASKABC(
*item EDSITE
'Each zone is calculated in turn. If you do '
'one zone then you should do all zones.'
*enditem
                  CALL ASKOK(outs,' ',OK,DOK,2)
*item EDSITE
*enditem
        CALL PHELPD('Model context',30,'-',0,0,IER)
*item EDSITE
'Site latitude in degrees, where North is +ve, e.g. 55.9'
'for Glasgow.'
*enditem
        CALL EASKR(SLAT,' ','Site latitude?',
*item EDSITE
'Site longitude difference is the difference in degrees'
'from the local reference meridian, East is +ve, e.g.'
'-4.1 for Glasgow (relative to the Greenwich Meridian).'
*enditem
        CALL EASKR(SLON,' ','Longitude difference?',
*item EDSITE
'The site exposure defines the relative view factors'
'between a vertical surface and the sky (S), ground (G)'
'and surrounding buildings (B). These data are used in'
'the calculation of external longwave radiation exchange.'
' '
'The following options are available.'
' '
'                          View factor to:  '
'Context                   S     G     B    '
'=========================================  '
'urban (normal):          0.36  0.36  0.28  '
'urban (low density):     0.41  0.41  0.18  '
'rural:                   0.45  0.45  0.10  '
'urban (equal weighting): 0.33  0.33  0.34  '
'urban (B emphasised):    0.15  0.33  0.52  '
'isolated rural:          0.50  0.50  0.00  '
'totally enclosed:        0.00  0.00  1.00  '
'user defined:             -     -     -    '
'=========================================  '
*enditem
        CALL EPICKS(IX,IVALS,' ','Site Exposure',
*item EDSITE
'0 <= Sky view factor <= .99'
*enditem
  290     CALL EASKR(skyview,' ','Sky view factor?',
*item EDSITE
'0 <= Ground view factor <= .99'
*enditem
          CALL EASKR(groundview,' ','Ground view factor?',
*item EDSITE
'0 <= Surroundings view factor <= .99'
*enditem
          CALL EASKR(buildingview,' ','Surroundings view factor?',
*item EDSITE
'Ground shortwave reflectance can be determined'
'from one of three methods:'
'Constant = time invariant value;'
'Simple   = 12 monthly values, with user'
'              defined snow cover;'
'Advanced = 12 monthly values, with hourly'
'              snow depth from weather file.'
*enditem
        CALL EASKABCD(' ','Ground reflectance method?',
*item EDSITE
'0 <= ground reflectance <= .99'
*enditem
          CALL EASKR(groundrefl,' ',' Ground reflectance?',
*item EDSITE
'Suggested ground reflectance (no snow):'
'  bituminous/gravel roof 0.13'
'  dry, bare ground       0.20'
'  weathered concrete     0.22'
'  grass                  0.26'
'  sand                   0.40'
'  light building surface 0.60'
*enditem
          CALL EASKS(HOLD,' ',
*item EDSITE
*enditem
          CALL EASKS(HOLD,' ',
*item EDSITE
'Suggested ground reflectance (with snow):'
'  city centre    0.20'
'  urban          0.40'
'  rural          0.50'
'  isolated rural 0.70'
*enditem
            CALL EASKR(snowgroundrefl,' ',
*item EDSITE
'For each month, enter the number of days with snow'
'd=epth typically greater than 5 cm.'
*enditem
            CALL EASKS(HOLD,' ',
*item EDSITE
*enditem
            CALL EASKS(HOLD,' ',
*item EDSITE
'Typical values for ground reflectance with snow:'
'  city centre:   0.20'
'  urban          0.40'
'  rural          0.50'
'  isolated rural 0.70'
*enditem
            CALL EASKR(snowgroundrefl,' ',
*item EDSITE
'The snow depth file contains hourly values of snow'
'depth. The data should be formatted as a single'
'column within an ASCII file, with the snow depth'
'given in centimeters for each of the 8760 hours of'
'the year.'
*enditem
            CALL EASKS(SNFNAM,'Enter name of snow depth file',
*item EDSITE
'Please ensure that the file exists, or selectpress '
'`OK` if the file will be created later.'
*enditem
              CALL ASKOK('File not found: continue?',' ',OK,DOK,2)
*item EDSITE
'Some locations reserve days other than Saturday and'
'Sunday as `weekends`. You can define these days or'
'set a one day weekend by defining the second day'
'equal to the first.'
*enditem
        CALL EASKI(idwe1T,'Day index (Mon=1,Tue=2, ...) for',
*item EDSITE
*enditem
        CALL EASKI(idwe2T,'Day index (Mon=1,Tue=2, ...) for',
*item EDSITE
'Control and scheduling actions the year to be defined.'
'You may accept the one specified with the climate'
'file or provide an alternative.'
' '
'The choice is year impacts the day of the week for'
'1 January. It also will alter the day type associated'
'of days in the calendar which are the standard default'
'weekday/saturday/sunday (but not user defined day types.'
*enditem
        CALL EASKI(iyeart,' ','Simulation year?',
*item EDSITE
'You can use the calandar to check that a day or days'
'fall on a required date (e.g. to test a heating system`s'
'response under a cold, Monday start).'
*enditem
        call askok(' ','View calendar?',ok,dok,3)
*item EDSITE
'If there is an existing ground toplogy you may browse'
'or edit its defining data. To create a new toplogy you'
'may input the defining data manually or elect to'
'click on points on a bitmap.'
*enditem
        call easkabcd(' ','Ground topology defining options:',
*item EDSITE
'Ground temperature profiles define the monthly soil'
'temperatures at some arbitrary depth (typically 1.5m)'
'for use as aboundary condition within a simulation.'
'Up to 12 profiles may be defined, each comprising 12'
'monthly temperature values.'
*enditem
        CALL EASKABC(' ','Ground temperature profile options:',
*item EDSITE
'Provide index of the ground temperature profile'
'to be edited.'
*enditem
            CALL EASKI(IFOC,' ','Profile to edit?',
*item EDSITE
'Temperatures are typically defined at a 1.5m depth.'
*enditem
        CALL EASKS(HOLD,' ','Temperatures, January- thro June?',
*item EDSITE
'Temperatures are typically defined at a 1.5m depth.'
*enditem
        CALL EASKS(HOLD,' ','Temperatures, July thro December?',
*item EDSITE
'Energy demand may be converted to primary energy'
'(e.g. as comsumed at a power station) and also to'
'equivalent emission values.'
*enditem
        CALL EASKABC(' ','Energy demand conversion options:',
*item EDSITE
'This file holds data required to later construct'
'an `Integrated Performance View` of simulation'
*enditem
 142      CALL EASKS(ltmp,' ','IPV description file?',
*subroutine ROAMING
*item ROAMING
' '
*enditem
        CALL PHELPD('Roaming Introduction',19,'-',0,0,IER)
*item ROAMING
*enditem
        CALL EASKAB(' ','Roaming file actions:',
*item ROAMING
*enditem
        CALL EASKS2CMD(LROAM,' Roaming file? (see help)',
*item ROAMING
*enditem
      CALL ASKOK('View location information?',' ',OK,dok,19)
*item ROAMING
*enditem
        CALL ASKOK('View cruise schedule?',' ',OK,dok,19)
*subroutine manageimages
*item manageimages
'Images may be associated with a model for various'
'purposes - for example to record site conditions'
'may be associated with a model.'
' '
'The following image types are supported: gif, tiff,'
'jpeg and X11 bitmap. To edit an image name, select'
'it from the list.'
' '
'Newer model configuration files can also include a'
'text block explaining the image. '
*enditem
        CALL PHELPD('Model images',11,'-',0,0,IER)
*item manageimages
'Images can be associated with various aspects of a'
'model. You can add images to the current list from'
'either the model images folder or by entering an'
'absolute path and file name.'
*enditem
        CALL EASKABCD(' ','Project image options:',
*item manageimages
'Notes (<248 char) for images can help with'
'communicating supporting information.'
*enditem
                CALL EASKS248(tcname,' ','Image notes:',
*item manageimages
*enditem
            call easks(limg,'Image file name',' ',72,'xxx.gif',
*item manageimages
'Notes (<248 char) for images can help with'
'communicating supporting information.'
*enditem
                CALL EASKS248(tcname,' ','Image notes:',
*item manageimages
'Notes (<248 char) for images can help with'
'communicating supporting information.'
*enditem
            CALL EASKS248(tcname,' ','Image notes:',
*subroutine setuptemporal
*item setuptemporal
'Temporal definitions are used to impose special'
'boundary condition on a simulation or to modify'
'design parameters as a simulation proceeds.'
' '
'A temporal file holds one or more entities (e.g. climate'
'data, casual gains, set points etc.) over a specified '
'number of days and for a specified time step. These'
'entities, depending on their type, may be associated'
'with zones or controls within the model and will'
'replace existing definitions.'
' '
'associations - entities in the temporal file can be'
'  associated with entities in your model depending on'
'  the type of information. For example climate data'
'  is associated with the whole model and infiltration'
'  is associated with a zone.'
' '
'Currently the following item types are offered: '
' ALLCLMT - all climate data (includes next 6 items)'
' BDTEXTT - ambient temperature'
' WINDVLT - wind velocity'
' WINDDRT - wind direction'
' RELHUMT - ambient relative humidity'
' DIFHSLT - diffuse horizonal radiation'
' GLOHSLT - global horizonal radiation'
' DIRSOLT - direct normal solar radiation'
' SETPTTT - control setpoint temperature'
' CASUALT - zone casual gains (combined gains)'
' CASUAL3T -zone casual gains (Occup/Lights/SM Pwr)'
' ACTIVITY -global database: gains,setpoints, etc.'
' BIDIRSET -Bidirectional datasets (e.g. slat angles)'
' VERTSOL -Vertical solar radiation data for a facade'
' HTCLSETP -Specify columns to read H/C setpoints.'
' DBTZNM  - measured zone db temperature'
' SURTM   - measured surface temperature'
' '
'manage associations - you can add and delete associations'
'  that have been previously defined. Note this does not'
'  alter the contents of the temporal file.'
' '
'dereference temporal file - this removes current links'
'  between the model and entities in the temporal file.'
'  It does not remove the temporal file.'
' '
'create file - you supply a file name, if it exists it'
'  is scanned otherwise a minimal file is created.'
' '
'edit/list - contents of the current file are presented'
'  and if you have permission you can alter its contents.'
' '
'General instructions for setting up a temporal file:'
'a) Decide the period of the data (start and end dates)'
'   as well as frequency (1stph to 60 tsph).'
'b) If data is to be imported from a file with columns'
'   of data take a note of which columns are required.'
'c) Plan the names of the temporal entities you will be'
'   be creating as well as which zones or controls in '
'   the model are going to be associates with the'
'   entities in the temporal file.'
'At the current time there are no temporal definitions;'
*enditem
          CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
*item setuptemporal
'An outdated file format is associated with the model.'
*enditem
          CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
*item setuptemporal
'You may view the temporal data via view option.'
*enditem
            CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
*item setuptemporal
'An outdated file format is associated with the model.'
*enditem
            CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
*item setuptemporal
'You can view the temporal data via view opton.'
*enditem
            CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
*item setuptemporal
'Temporal definitions are available for editing/use.'
*enditem
            CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
*item setuptemporal
*enditem
          CALL EASKS(ltmp,' ','Temporal definitions file?',
*item setuptemporal
*enditem
        CALL EASKS(ltmp,' ','Temporal definitions file?',
*item setuptemporal
'Temporal definitions are used to impose special'
'boundary condition on a simulation or to modify'
'design parameters as the simulation proceeds.'
*enditem
        CALL EASKS(ltmp,' Temporal definitions file name?',
*item setuptemporal
'Existing associations can be removed or new '
'associations between temporal entities and '
'model zones and/or controls can be added. '
*enditem
          call easkabc('Temporal association options:',' ',
*item setuptemporal
*enditem
          call easkabcd('Temporal association options:',' ',
*item setuptemporal
'Select the index of the temporal item you do not wish'
'use in the current model. This removes the association'
'but does not remove the entity from the temporal file.'
' '
'A cancel request leaves the model unchanged. '
*enditem
          CALL EASKI(it,'Temporal item which you do not want to use',
*item setuptemporal
'Select the index of the association you wish to'
'modify in the current model. '
' '
'A cancel request leaves the model unchanged. '
*enditem
            CALL EASKI(ite,'Which temporal association to modify?',
*item setuptemporal
'Select the index of the temporal item you wish'
'to associate. '
*enditem
              CALL EASKI(it,' ','Associate temporal item?',
*item setuptemporal
'Select the index of the temporal item you wish to'
'include in the current model. '
' '
'A cancel request leaves the model unchanged. '
*enditem
            CALL EASKI(it,'Temporal item index to associate with',
*item setuptemporal
*enditem
            call askzone(ic,izdef,' Related zone for casual gains?',
*item setuptemporal
*enditem
            call askzone(ic,izdef,' Related zone for ventilation?',
*item setuptemporal
*enditem
            call askzone(ic,izdef,' Related zone for air velocity?',
*item setuptemporal
*enditem
            call askzone(ic,izdef,' Related zone for control state?',
*item setuptemporal
*enditem
            call askzone(ic,izdef,' Related zone for activity db?',
*item setuptemporal
*enditem
              CALL EASKABC(' Control linkage options:',' ',
*item setuptemporal
*enditem
                CALL EASKI(ispl,'Control loop to use set point data?',
*item setuptemporal
*enditem
              CALL EASKABC(' Control linkage options:',' ',
*item setuptemporal
'This control assumes that heating and cooling'
'capacities are adequate for reaching the setpoints'
'in the temporal definition file (tdf). It is only'
'required to define the columns in the tdf where the'
'setpoints should be read from. Defaults are column 4'
'for heating setpoint and column 5 for cooling.'
*enditem
              CALL EASKS(HOLD,
*item setuptemporal
*enditem
              CALL EASKS(HOLD,
*item setuptemporal
'A temporal item of type SETPPT can be associated'
'with a zone control in order to force the zone'
'temperature to match that recorded in the temporal'
'file. It makes use a control law 11 to do this. '
' '
'If you want to use an existing control it will be '
'updated to impliment the necessary links. If you '
'want to create a new zone control then all of the '
'necessary control period will be generated. '
' '
'If you want to use temporal-based setpoints for'
'several zones you will need a separate temporal '
'item and a separate zone control law for each zone.'
' '
'You will be asked about: '
' a) control loop index (existing or new)'
' b) maximum and minimum heating & cooling capacity'
'    which should have sufficient capacity to main-'
'    tain the setpoint.'
' c) the zone where the set point will be used '
' '
'It is not necessary to further modify the zone '
'control once it has been created (unless you did '
'not guess the correct capacity. '
' '
'A cancel request leaves the model unchanged. '
*enditem
            CALL PHELPD('temporal-control popup',26,'-',0,0,IER)
*item setuptemporal
*enditem
              CALL EASKABC(' Control linkage options:',' ',
*item setuptemporal
*enditem
                CALL EASKI(ispl,'Control loop to use set point data?',
*item setuptemporal
*enditem
              CALL EASKABC(' Control linkage options:',' ',
*item setuptemporal
*enditem
 255        call askzone(ic,izdef,'Related zone for temporal setpoint?',
*item setuptemporal
'Heat delivery is normally set high so that the '
'target temperature is attained. The heating minimum'
'is normally 0 but if > 0 then heating will continue'
'at the minimum even when the temperature is'
'reached. '
'In the unlikely event that you want to control to'
'another temperature but allow no cooling capacity '
'the control may not work properly.'
*enditem
            CALL EASKS(HOLD,
*item setuptemporal
*enditem
            call askzone(ic,izdef,
*item setuptemporal
*enditem
            call easksur(IC,ISUR,'-',
*item setuptemporal
*enditem
            call askzone(ic,izdef,
*item setuptemporal
*enditem
            call easksur(IC,ISUR,'-',
*item setuptemporal
*enditem
            call askzone(ic,izdef,' Related zone for measured db T?',
*item setuptemporal
*enditem
            call askzone(ic,izdef,'Related zone for measured surf T?',
*item setuptemporal
*enditem
            call easksur(IC,ISUR,'-',
*item setuptemporal
'If you want to continue adding temporal refences '
'then answer yes. '
*enditem
            CALL ASKOK(' ',' Use another temporal item?',OK,DOK,2)
*subroutine peconv
*item peconv
*enditem
        call easkabc('Typical patterns',' ','UK','Europe','zeros',IW,41)
*item peconv
'Use these emission patterns as an approximation of '
'patterns in several regions. '
' '
'Emissions [grams per kWh primary energy]. '
'Typical UK       CO2    NOx   SOx   '
'Gas              190.   0.3    0.2    '
'Oil              260.   2.5    0.1    '
'Coal             320.   1.3   2.63  '
'Electricity      612.   2.06  7.57   '
'Where heating and DHW are gas, and lights/fans/pumps'
'are electricity. '
' '
'Typical Europe   CO2    NOx   SOx   '
'Gas              190.   0.3   0.2    '
'Oil              260.   2.5   5.0    '
'Coal             320.   1.3   2.63  '
'Electricity      360.   1.2   4.5   '
' '
'Conversion demand units > primary energy units includes'
'both the typical seasonal efficiency of the equipment '
'and transport losses. Transmission losses assumed'
'are 4% for gas, none for fuel oil, none for solid fuel.'
' '
'Heating system efficiencies and conversions are: '
'  gas boiler (fan assisted flue)     68%  1.53'
'  gas boiler (open/balanced flue)    65%  1.60'
'  gas condensing boiler              85%  1.22'
'  gas combi boiler                   72%  1.44'
'  solid fuel (auto feed)             60%  1.73'
'  oil fired (standard)               70%  1.48'
'  oil fired (condensing)             85%  1.22'
'  gas fired warm air (fan asst flue) 80%  1.30'
'  gas fired warm air (open/bal flue) 70%  1.48'
' '
'Cooling system efficiencies and conversions are: '
'  packaged A/C unit assuming 2.5 CoP      1.44'
'  split A/C unit assuming 2.5 CoP         1.44'
' '
'Conversion factors: '
'  small power & lighting: 3.2-3.6 (typical UK) '
'  small power & lighting: ? (typical Europe) '
*enditem
        CALL PHELPD('prim convers',41,'-',0,0,IER)
*item peconv
*enditem
        CALL EASKR(pcnvht,' ','Heating primary energy multiplier:',
*item peconv
*enditem
        CALL EASKR(pcnvcl,' ','Cooling primary energy multiplier:',
*item peconv
*enditem
        CALL EASKR(pcnvlt,' ','Lighting primary energy multiplier:',
*item peconv
*enditem
        CALL EASKR(pcnvfn,' ','Fans & pumps primary energy multiplier:',
*item peconv
*enditem
        CALL EASKR(pcnvsp,' ','Small power primary energy multiplier:',
*item peconv
*enditem
        CALL EASKR(pcnvhw,' ','Hot water primary energy multiplier:',
*item peconv
*enditem
        CALL EASKS(HOLD,'Heating related emissions [gr/kWh primary]:',
*item peconv
*enditem
        CALL EASKS(HOLD,'Cooling related emissions [gr/kWh primary]:',
*item peconv
*enditem
        CALL EASKS(HOLD,'Lighting related emissions [gr/kWh primary]:',
*item peconv
*enditem
        CALL EASKS(HOLD,'Fan & pump emissions [gr/kWh primary]:',
*item peconv
*enditem
        CALL EASKS(HOLD,'Small power emissions [gr/kWh primary]:',
*item peconv
*enditem
        CALL EASKS(HOLD,'Hot water emissions [gr/kWh primary]:',
*subroutine calenmanage
*item calenmanage
'This facilitiy sets up and manages a calendar of day'
'types which can be associated with zone casual gains,'
'infiltration schedues and controls.'
' '
' '
' '
' '
'This facility is still being developed further and '
'does not yet hold standard calendars for use by projects'
'nor does it access typical patterns for differenct '
'countries. '
'Short phrase idenfitying the calendar. '
'Useful if you need to maintain several variants.'
*enditem
        CALL EASKS(tcalename,' Description of calendar: ',
*item calenmanage
'This facility allows you to manage day types. You can'
'add a day type. To change the details of a day type'
'click on the relevant menu item.'
*enditem
          CALL PHELPD('calendar day section',3,'-',0,0,IER)
*item calenmanage
'Day types cannot be deleted (yet) but may not'
'not be assigned to any day at all. The equivalent'
'of deletion is to unassign a day type from all '
'actual days '
*enditem
            CALL EASKABC(' Options:',' ',
*item calenmanage
'The tag is one word (<12 char) e.g. holiday'
'Description is phrase for use in selection lists.'
*enditem
              CALL EASKS(tcalentag,' Calendar day type tag: ',
*item calenmanage
*enditem
              CALL EASKS(tcalendayn,' Calendar day type descripton: ',
*item calenmanage
'The tag is one word (<12 char) e.g. holiday'
'Description is phrase for use in selection lists'
'e.g. Holidays in Wales'
*enditem
          CALL EASKS(tcalentag,' Calendar day type tag: ',
*item calenmanage
*enditem
          CALL EASKS(tcalendayn,' Calendar day type descripton: ',
*item calenmanage
*enditem
        CALL PHELPD('calendar section',11,'-',0,0,IER)
*item calenmanage
*enditem
        call MENUATOL(outs,'Display options:',
*item calenmanage
'Select one of the existing day types. This day type'
'will be applied to each of the julian days selected.'
*enditem
        CALL EPICKS(IX,IDVALS,' ',' Available day types:',
*item calenmanage
'Days can be selected "one by one" and you can associate'
'any day type with any day. A faster method is to follow'
'a pattern. Here you will first be asked for dates during'
'which the new day type is to be added (called relevant'
'dates) The selected day type will then be added to every'
'Nth day in the relevant dates starting from the first '
'relevant date e.g. N=7 for weekly, N=1 for all days'
*enditem
          CALL EASKABC('How to add day types (see help)?',' ',
*item calenmanage
*enditem
            CALL EPICKS(ixd,ixdvals,' ',' Days in the year:',
*item calenmanage
'Days can be selected "one by one" and you can associate'
'any day type with any day. A faster method is to follow'
*enditem
            CALL EASKI(IFRQ,
*item calenmanage
'Select one of the existing day types. '
'Note: this applies only to the current day of the year.'
*enditem
        CALL EPICKS(IX,IDVALS,' ',' Available day types:',
*subroutine calenprint
*subroutine EDDGTP
*item EDDGTP
'Ground temperature profiles define the monthly soil'
'temperatures at arbitrary depths for use as a boundary'
'condition within a simulation.  Up to 12 profiles may'
'be defined each comprising 12 monthly temperatures.'
*enditem
        CALL EASKABC(' ','Options:',
*item EDDGTP
'Provide index of the ground temperature profile.'
' '
'A cancel request leaves the model unchanged. '
*enditem
            CALL EASKI(IFOC,' ',' Index of profile to edit?',
*item EDDGTP
'Temperatures are typically at 1.5m depth.'
*enditem
      CALL EASKS(HOLD,' Temperatures January-June:',' ',72,' ',
*item EDDGTP
'Temperatures are typically at 1.5m depth.'
*enditem
      CALL EASKS(HOLD,' Temperatures July-December:',' ',72,' ',
*subroutine EDDSHD
*item EDDSHD
'Shading should be recalculated when site'
'changes. Each affected zone will be done in turn.'
*enditem
      CALL EASKABC(' Reflect site change in shading options:',' ',
*item EDDSHD
'Each zone is calculated in sequence.'
'If you do one, you should do all.'
*enditem
            CALL ASKOK(outs,' ',OK,DOK,2)
*subroutine CTLWRT
*subroutine e2eplus
*item e2eplus
'EnergyPlus needs to know the offset in hours from GTM.'
'West is negative, East is positive. '
' '
'The cancel option will skip the creation of the '
'EnergyPlus descriptive file time zone section.'
*enditem
      CALL EASKI(IIC2T,' Time zone (hours +- GTM) ',
*item e2eplus
'EnergyPlus needs to know the site elevation in metres'
'above sea level. '
*enditem
      CALL EASKR(SLM,' Site elevation above sea level (m) ',
*item e2eplus
'EnergyPlus needs to know how many people are represented'
'by the peak occupant gain in this room. The numbers '
'presented are the sensible and latent gains and the '
'tototal of the sensible and latent. '
*enditem
        CALL EASKR(vpeople,' Number of people in room (see report): ',
*item e2eplus
'Is its parent surface in the current'
'zone. If not say no. '
*enditem
              call askok(outs,
*item e2eplus
*enditem
                call easksur(izz,iss,'-',outs,' ',ier)
*subroutine EDCASCTL
*item EDCASCTL
'The zone casual gain control file allows to control'
'zone casual gains based on the internal or external'
'photocell illuminance. Different levels of calculation'
'of photocell illuminance and control algorithms are'
*enditem
  246     CALL EASKS(LTMP,' Zone casual gain control file ?',
*item EDCASCTL
*enditem
 8888     call EASKABC('Radiance model for daylight coefficients:',' ',
*item EDCASCTL
'This menu allows to create/edit zone casual control'
'file. The casual gain control file allows to control'
'zone casual gains based on the internal or external'
'photocell illuminance. Different levels of calculation'
'of photocell illuminance and control algorithms are'
'supported.'
' '
'           Casual Gains Control Menu'
'a Wkd Wkend control: Which casual gain type to control'
'b Control periods  : Star and end hours of control'
'  Lighting zones   : Displays number of lighting zones'
'c Lighting zone    : Scrol through lighting zones'
'd Control type     : Selection of control algorithm'
'e Calculation type : Selection of sensor illuminance'
'                     calculation method'
'f Control data     : Control algorithm input data'
'g Photocell data   : Casual gain distribution between'
'                     lighting zones and number of'
'                     photocells'
' '
'  Posn: x y z ux ..: Photocell location & orientation'
'                     (opt. daylight coefficient link)'
*enditem
        CALL PHELPD('cgc editing',22,'-',0,0,IER)
*item EDCASCTL
'Save casual gain control information into the file'
'with specified name. File name is passed back to the '
'model description.'
'Default file name is zone_name.cgc'
*enditem
  247   CALL EASKS(LTMP,' Zone casual gain control file ?',
*item EDCASCTL
*enditem
        CALL EASKAB(' ','Modify nmber of lighting zones:',
*item EDCASCTL
'The model has an associated 72 character descriptor'
'which is used later as an identifier, e.g. Dimming'
'control with 2 lighting zones.'
*enditem
 52     CALL EASKS(DTMP,
*item EDCASCTL
*enditem
        CALL EASKAB(' ','Control casual gains for ','one day type',
*item EDCASCTL
*enditem
          CALL EPICKS(IX,KSTR,' ',
*item EDCASCTL
*enditem
        CALL EASKABC(' ','Control casual gain type ','occupants',
*item EDCASCTL
'Specify time of the day when casual gain control'
'algorithm is active. Two numbers are expected:'
' '
'         * Control period start hour'
'         * Control period end hour'
*enditem
        CALL EASKS(HOLD,' Control is active from hour to hour:',
*item EDCASCTL
'Select control type from menu by mouse clicking:'
'* Alway On  - casual gain will be alway on'
'* Alway Off - casual gain will be alway off'
'* On-Off    - on-off control algorithm'
'* Step      - step control algorithm 100% - 50% - 0%'
'* Dimming   - three dimming control algorithms are'
'              supported'
'* Probab    - user probability switching algorithm'
*enditem
        call EASKATOG(' Control type:',' ',
*item EDCASCTL
'Select dimming control algorithm by mouse clicking:'
'* Ideal: ideal dimming control algorithm by matching'
'  the photocell illuminance value. Usually photocell'
'  is located at the horizontal workplane.'
'* Integral reset: more realistic dimming control'
'  algorithm requiring night-time calibration of'
'  photocell. Usually photocell is located at ceiling'
'* Closed loop: more realistic dimming control'
'  algorithm requiring night-time and day-time '
'  calibration of photocell. Usually photocell is'
'  located at ceiling.'
*enditem
          call EASKATOG(' Dimming control type:',' ',
*item EDCASCTL
'      One input parameter is expected:'
' '
'* Night-time photocell calibration value, this'
'  value can be measured or calculated and'
'  represents illuminance at the photocell point'
'  from an artificial lighting only.'
*enditem
            CALL EASKS(HOLD,' Night-time calibration lux value:',
*item EDCASCTL
'      Two input parameters are expected:'
' '
'* Night-time photocell calibration value, this'
'  value can be measured or calculated and'
'  represents illuminance at the photocell point'
'  from an artificial lighting only.'
' '
'* Linear control slope value, this value helps to'
'  set dimming level as a linear function of the'
'  difference between photocel signal and'
'  night-time calibration value. This value could'
'  be measured or calculated under variety of the'
'  sky luminance distribution conditions.'
*enditem
            CALL EASKS(HOLD,' Night-time calibration lux value &',
*item EDCASCTL
'Select photocell illuminance calculation type by mouse'
'clicking. The following types are supported:'
'* Analyt DF: horizontal workplane daylight factors'
'  calculated by combination of analytical formula for'
'  sky component and split flux method for'
'  interreflected component. Direct solar photocell'
'  illuminance is being traced. THE METHOD WORKS ONLY'
'  FOR VERTICAL 4 VERTEX TMC POLYGONS!'
'* User DF: horizontal workplane daylight factors'
'  provided by user which could be either measured or'
'  calculated values. Direct solar sensor illuminance'
'  is not being traced i.e. sensor shaded from direct'
'  sunlight.'
'* Extern: external unobstructed horizonal or vertical'
'  global illuminance. In the case of vertical global'
'  illuminance sensor location on the zone external '
'  surface has to be specified.'
'* Coupling: direct running time coupling between'
'  thermal and lighting simulations at the time step'
'  level using third party global illumination solvers.'
'  In the current version coupling with Radiance is'
'  implemented. THIS IS AN EXPERT LEVEL AND CAN BE'
'  COMPUTATIONALY INTENSIVE!'
'* DayCoeff: set of precalculated daylight coefficients'
'  is being used to calculate sensor illuminance at the'
'  time step level. Ones daylight coefficient have been'
'  calculated or measured simulation progress fast.'
'  Third party global illumination solvers are being'
'  used to calculate set of daylight coefficients.'
'  In the current version Radiance is used to get'
'  daylight coeff. THIS IS AN EXPERT LEVEL AND CAN BE'
'  COMPUTATIONALY INTENSIVE!'
*enditem
        CALL PHELPD('cgs calct type',32,'photocell   ',0,0,IER)
*item EDCASCTL
'See the previously displayed summary. '
*enditem
        call EASKATOG(' Calculation type:',' ',
*item EDCASCTL
'Specify number of control alhorithm parameters.'
'Five numerical inputs are expected:'
' '
'* Photocell lux set point (lux) i.e. anything from'
'  300 lux to 2000 lux or more for external sensors.'
' '
'* Switch-off light level i.e. level at which the light'
'  is being switch-off, usually from 150% to 250%'
'  expressed here as a ratio i.e 1.5 to 2.5.'
' '
'* Minimum dimming light output i.e. the level to which'
'  artificial lights can be dimmed i.e. usually 10%'
'  expressed here as a ratio i.e. 0.1.'
' '
'* Minimum electric/gain dimming output i.e. the level'
'  to which electric power/ heat gain can be dimmed,'
'  expressed here as a ratio. Does not have to equal'
'  to the minimum dimming light output.'
' '
'* Switch-off delay time i.e. the time for which the'
'  control algorithm will wait before switching off'
'  lights. Expressed here in number of building side'
'  simulation time steps. Usually anything from 5 min'
'  to 30 min. Off course this effect can be traced'
'  only with short simulation time step.'
*enditem
        CALL PHELPD('cgc control data',25,'-',0,0,IER)
*item EDCASCTL
'See the control message just displayed. '
*enditem
        CALL EASKS(HOLD,
*item EDCASCTL
'        Two input parameters are expected:'
' '
'* Part of the casual heat gains associated with this'
'  lighting zone. Casual gains are specified at the'
'  thermal zone level and have to be split into the'
'  lighting zones. Ratio is expected i.e 50% -> 0.5.'
' '
'* Number of the photocells in this lighting zone. If'
'  more than one photocell is specified (max. 9) then'
'  simple average of all photocell illuminances will'
'  be used for control. Integer number is expected '
'  from 1 to 9.'
*enditem
        CALL EASKS(HOLD,' Casual gain portion & No of photocells',
*item EDCASCTL
'       Six input parameters are expected:'
' '
'* X, Y, Z coordinates of the photocell location (m)'
'  relative to the site origin.'
' '
'* Photocell orientation expressed as the X, Y, Z of'
'  direction vector i.e. horizontal photocell facing'
'  up 0  0  1 or facing down 0  0  -1.'
' '
'  Note that photocell orientation will not effect'
'  Analyt DF calculation type as here only horizon-'
'  tal facing up sensors are allowed.'
*enditem
          CALL EASKS(HOLD,' Sensor x y z & ux uy uz',
*item EDCASCTL
'     Two input parameters are expected:'
' '
'* Zone external surface number at which the'
'  photocell is to be located.'
' '
'* Indication of the photocell orientation:'
'  0.0 - measure global horizontal illuminance'
'  1.0 - measure global vertical illuminance'
*enditem
          CALL EASKS(HOLD,' Sensor surface number position &',
*item EDCASCTL
'       Seven input parameters are expected:'
' '
'* X, Y, Z coordinates of the photocell location (m)'
'  relative to the site origin.'
' '
'* Photocell orientation expressed as the X, Y, Z of'
'  direction vector i.e. horizontal photocell facing'
'  up 0  0  1 or facing down 0  0  -1.'
' '
'* Daylight coefficient number to be linked to the'
'  given photocell location. This has to match no.'
'  of daylight coefficients in the DC file.'
*enditem
          CALL EASKS(HOLD,' Sensor x y z & ux uy uz',
*item EDCASCTL
'       Six input parameters are expected:'
' '
'* X, Y, Z coordinates of the photocell location (m)'
'  relative to the site origin.'
' '
'* Photocell orientation expressed as the X, Y, Z of'
'  direction vector i.e. horizontal photocell facing'
'  up 0  0  1 or facing down 0  0  -1.'
' '
'  Note that photocell orientation will not effect'
'  Analyt DF calculation type as here only horizon-'
'  tal facing up sensors are allowed.'
*enditem
          CALL EASKS(HOLD,' Sensor x y z & ux uy uz',
*item EDCASCTL
'User specified DF are inputed here. You will be'
'prompted to input DF for each TMC polygon and'
'all photocells in this lighting zone'
' '
'Note that daylight factors (DF) are inputed as'
'ratios and not as percentage i.e 2% -> 0.02.'
*enditem
          CALL EASKS(HOLD2,outs,' ',72,' 1 0.05',' df for each ',IER,6)
*subroutine CFDCOMP
*item CFDCOMP
'A CFD input file holds the definition of the'
'geometry and gridding of the CFD domain,'
'information on how to conflate the CFD zone model'
'into the whole-building model, and data required'
'by the CFD solver.'
*enditem
      CALL EASKS(ltmp,' CFD input file?','  ',72,DFCFD,'dfd file',IER,5)
*item CFDCOMP
 'Data on conflation, geometry, gridding, solution'
 'variables, boundary conditions, solver parameters,'
 'output files, etc. are required for the CFD model.'
 'The majority of these data can be input through the'
 'menues provided in this facility; however, you will have'
 'to do some manual editing of the CFD input file (use the'
 'menu item provided in this facility to invoke the'
 'editor).'
 ' '
 'Each of the menu items in this list should be selected'
 'in turn to build-up the CFD input file.'
 ' '
 'Some hints on working with CFD domains: '
 ' '
 ' a) this portion of ESP-r is full of jargon because'
 '    those who work in CFD have evolved expressions that'
 '    seem like english but have a particular meaning. For'
 '    example, the `south face` of the domain might not'
 '    actually be facing south.'
 ' '
 ' b) there are lots of parameter options, some of which'
 '    influcence computation time and some of which are'
 '    not as well documented as some users would expect.'
 ' '
 ' c) ESP-r is normally compiled for domains of limited'
 '    grid resolution, it can be recompiled to increase'
 '    the grid density and those who do this should '
 '    carefully check their models and predictions.'
 ' '
 ' d) it is recommended that you plan your cfd domains'
 '    first and there are some places where efficiency'
 '    is improved if you record critical dimensions'
 '    as you work - e.g. so that boundary surface and'
 '    cell groups can be more reliably associated.'
 ' '
'You should refer to Section 5.9 - Zone CFD Domain File'
'in: Data Model Summary ESP-r Version 9 Series,'
'ESRU Report TR96/2, which forms part of the ESP-r'
'distribution (/usr/esru/esp-r/manual/DATA_MODEL).'
' '
'Note that CFD domains are currently restricted to'
'cuboidal zones.'
*enditem
        call EASKS(ltmp,'Description of CFD model:',' ',72,dtmp,
*item CFDCOMP
 'The CFD model can either operate in stand-alone mode'
 '(CFD-only) or it can be `conflated` with the'
 'whole-building simulation (BSim). The user must supply'
 'all boundary conditions when CFD is operated in'
 'stand-alone mode. When conflated, CFD and BSim operate'
 'in tandem, exchanging information on a time-step'
 'basis. Three different conflation mechanisms currently'
 'exist to allow BSim and CFD to `handshake`:'
 ' '
'With type 1 thermal conflation, the surface convection'
'heat transfer coefficients are calculated from the'
'CFD-predicted flow and temperature fields.  There is'
'no interaction between the air-flow network and CFD.'
' '
'With type 2 thermal conflation, the zone air-point'
'temperature and the surface convection heat transfer'
'are calculated from the CFD-predicted flow and'
'temperature fields. There is no interaction between'
'the air-flow network and CFD.'
' '
'With air-flow conflation, the nodal air-flow network'
'and CFD are integrated. A single air flow network node'
'is replaced by a CFD domain, thus dropping the'
'assumption of well-mixed conditions for that zone.'
'There is no interaction on the thermal level.'
' '
'Note: when changing from a stand-alone CFD definition'
'to a conflated CFD definition you will need to revise'
'the boundary definition of `solids` to `building surf`'
'so that the relevant solid-surface linkages are defined.'
' '
'For further details, refer to:'
'Clarke J A and Beausoleil-Morrison I, The Integration'
'of Computational Fluid Dynamics into Building'
'Simulation, IBPSA News, V9, N2, Dec. 1997.'
*enditem
        call EASKATOG('Conflation options:',' ','CFD only',
*item CFDCOMP
*enditem
        CALL PHELPD('CFD inputs',42,'-',0,0,IER)
*item CFDCOMP
'Recent changes to the CFD domain are held in memory '
'and might be lost if you exit without saving. '
*enditem
          CALL ASKOK(' Data not yet saved to CFD input file.',
*subroutine CFDGGRD
*item CFDGGRD
'Choose a vertex point.'
' '
'A cancel request will return you to the main menu '
'without altering the model. '
*enditem
        CALL EASKI(iorgt,' Specify vertex at origin of CFD domain. ',
*item CFDGGRD
'Choose a vertex point. Axes must be cartesian.'
*enditem
        CALL EASKI(ixendt,' Specify vertex at end of X axis. ',
*item CFDGGRD
*enditem
        CALL EASKI(iyendt,' Specify vertex at end of Y axis. ',
*item CFDGGRD
*enditem
        CALL EASKI(izendt,' Specify vertex at end of Z axis. ',
*item CFDGGRD
 'First, define the geometry of the CFD domain by'
 'establishing its origin and X,Y, and Z axes. This is'
 'done by specifying vertex points for the origin and'
 'the ends of each axis. CFD domains are currently'
 'restricted to cuboidal zones. Axes must be cartesian.'
 '  '
 'Second, subdivide the domain into cells by gridding'
 'each axis. Each axis may be divided into regions,'
 'enabling a fine mesh in some areas while a coarse mesh'
'in others. For 2-dimensional problems, specify only a'
'single grid in the redundant direction.'
'  '
'It is useful to visualize the grid to confirm your'
'Choose a vertex point.'
' '
'A cancel request will return you to the main menu '
'without altering the model. '
*enditem
        CALL EASKI(iorgt,' Specify vertex at origin of CFD domain. ',
*item CFDGGRD
'Choose a vertex point. Axes must be cartesian.'
*enditem
        CALL EASKI(ixendt,' Specify vertex at end of X axis. ',
*item CFDGGRD
*enditem
        CALL EASKI(iyendt,' Specify vertex at end of Y axis. ',
*item CFDGGRD
*enditem
        CALL EASKI(izendt,' Specify vertex at end of Z axis. ',
*item CFDGGRD
'This sets the general resolution along the axis '
'which is to be accommodaed by the regions in the axis.'
' '
'A cancel request will return you to the main menu '
'but you will need to check the CFD domain because some'
'prior edits might cause inconsistencies. '
*enditem
        CALL EASKI(icellx,outs,' ',1,'F',NTCELX,'F',10,
*item CFDGGRD
'This sets the general resolution along the axis '
'which is to be accommodaed by the regions in the axis.'
' '
'A cancel request will return you to the main menu '
'but you will need to check the CFD domain because some'
'prior edits might cause inconsistencies. '
*enditem
        CALL EASKI(icelly,outs,' ',1,'F',NTCELY,'F',10,
*item CFDGGRD
'This sets the general resolution along the axis '
'which is to be accommodaed by the regions in the axis.'
' '
'A cancel request will return you to the main menu '
'but you will need to check the CFD domain because some'
'prior edits might cause inconsistencies. '
*enditem
        CALL EASKI(icellz,outs,' ',1,'F',NTCELZ,'F',10,
*item CFDGGRD
 'Currently curvilinear is not yet operational.'
 ' ... '
*enditem
        CALL EASKABC('Options for Z gridding:',' ','orthogonal',
*item CFDGGRD
'Look at the wireframe image of the zone to find this'
'out. '
' '
'A cancel request will return you to the main menu'
'but you will need to check the CFD domain because'
'some prior edits might cause inconsistencies. '
*enditem
            CALL EASKI(ieorg,'Specify vertex at start of east Z axis.',
*item CFDGGRD
*enditem
            CALL EASKI(izendet,'Specify vertex at end of east Z axis.',
*item CFDGGRD
*enditem
        CALL PHELPD('gridding',14,'-',0,0,IER)
*subroutine CFDSVAR
*item CFDSVAR
 'Specify the equations to be solved in the CFD analysis.'
 '  '
 'Velocity must always be solved and is determined from'
 ' the grid definition. '
 '  '
 'Temperature. choice of on or off '
 '  '
 'Turbulence. five models available: '
 '   no turbulence (ie laminar flow conditions)'
'   k-e model (for recirculating flows)'
'   fixed eddy viscosity (for approximating turbulence)'
'   MIT zero-equation (for ...)'
'   fixed eddy -> k-e model (uses fixed eddy approx for N'
'      iterations then k-e as an aide to convegence)'
'  '
'Buoyancy.  three choices (temperature should be solved):'
'   none - buoyancy effects are ignored.'
'   ideal gas - density calculated by ideal gas equation.'
'   Boussinesq - Calculates buoyancy relative to buoyancy'
'      at reference temperature. Best for small '
'      temperature variations in domain. '
'  '
'The expert user can edit the individual equations which'
'are to be solved and adjust initial values, relaxation'
'factors etc via the edit equation setup option.  '
'If you have messed up the solution parameters you might'
'want to reset them to default values. Note that default'
'solution parameters might not be appropriate. '
*enditem
        call askok('Resetting solution parameters to default values.',
*item CFDSVAR
*enditem
        CALL PHELPD('solution variables',25,'-',0,0,IER)
*subroutine CFDEDAT
*item CFDEDAT
 'Specify the equations to be solved in the CFD analysis.'
 '  '
 'Velocity must always be solved and is determined from'
 ' the grid definition. '
 '  '
 'Temperature. choice of on or off '
 '  '
 'Turbulence. five models available: '
 '   no turbulence (ie laminar flow conditions)'
'   k-e model (for recirculating flows)'
'   fixed eddy viscosity (for approximating turbulence)'
'   MIT zero-equation (for ...)'
'   fixed eddy -> k-e model (uses fixed eddy approx for N'
'      iterations then k-e as an aide to convegence)'
'  '
'Buoyancy.  three choices (temperature should be solved):'
'   none - buoyancy effects are ignored.'
'   ideal gas - density calculated by ideal gas equation.'
'   Boussinesq - Calculates buoyancy relative to buoyancy'
'      at reference temperature. Best for small '
'      temperature variations in domain. '
'  '
'Most equations require the definition of initial values'
'and relaxation factors.  '
'  '
'Initial conditions can have a significant influence'
'  over convergence rates and potential.'
'  '
'Relaxation factors can also have a significant impact'
'  on convergence rates and potential. The optimal value'
'  depends upon the nature of the flow, gridding, and'
'  other factors.'
'  '
'Underrelaxation (values between 0 and 1) is'
'  typically employed to slow the solution to avoid'
'  divergence. Overrelaxation (values greater than 1),'
'  although not common, is permissible. Use smaller'
'  relaxation factors for highly non-linear problems.'
'  '
'  more on relaxation factors and convergence criteria...'
'Relaxation factors can be of two types.  The most common'
' is linear although relaxation via fictitious time steps'
' is also permissible.'
'  '
'If a solution diverges, consider reducing the'
'relaxation factors.'
'  '
'Convergence criteria are used by the solver to'
' judge when a converged solution has been obtained.'
' The solution will either terminate when the maximum'
' number of iterations is reached, or if the sum of the'
' residuals is less than the specified value.  Only the'
' latter case represents a successful solution.'
'Specify initial conditions which will apply to all grid'
'cells.  The relaxation factor will help the solution to'
'converge - if in doubt use the default value.'
*enditem
        call EASKS(ltmp,'Initial value and relaxation factor',
*item CFDEDAT
'Specify initial conditions which will apply to all grid'
'cells.  The relaxation factor will help the solution to'
'converge - if in doubt use the default value.'
*enditem
        call EASKS(ltmp,'Initial value and relaxation factor',
*item CFDEDAT
'Specify initial conditions which will apply to all grid'
'cells.  The relaxation factor will help the solution to'
'converge - if in doubt use the default value.'
*enditem
        call EASKS(ltmp,'Initial value and relaxation factor',
*item CFDEDAT
'Specify initial conditions which will apply to all grid'
'cells.  The relaxation factor will help the solution to'
'converge - if in doubt use the default value.'
*enditem
        call EASKS(ltmp,'Initial value and relaxation factor',
*item CFDEDAT
'Specify initial conditions which will apply to all grid'
'cells.  The relaxation factor will help the solution to'
'converge - if in doubt use the default value.'
*enditem
          call EASKS(ltmp,'Initial value and relaxation factor',
*item CFDEDAT
'Specify the value of the eddy-viscosity.  This will'
'apply to all grid cells.  The value is specified in'
'terms of a multiple of the molecular viscosity.'
*enditem
          call EASKS(ltmp,'Fixed value for eddy viscosity?',
*item CFDEDAT
'Specify the value of the eddy viscosity.  This will'
'apply to all grid cells.  The value is specified in'
'terms of a multiple of the molecular viscosity.'
'The number of iterations to apply this eddy viscosity'
'is also required. '
*enditem
          call EASKS(ltmp,'Fixed value for eddy viscosity and number ',
*item CFDEDAT
'Specify initial conditions which will apply to all grid'
'cells.  The relaxation factor will help the solution to'
'converge - if in doubt use the default value.'
*enditem
          call EASKS(ltmp,'Initial value and relaxation factor',
*item CFDEDAT
'Specify the value of the reference temperature.  This'
'should be approximately the average temperature in the'
'domain.  This will apply to all grid cells.  '
*enditem
        call EASKS(ltmp,'Reference temperature? ','  ',16,
*item CFDEDAT
 'An iterative solution procedure is employed.'
 'Iterations continue until either:'
 '  1) the solution converges to a user-specified'
 '     tolerance; or'
 '  2) a user-specified number of iterations has been'
 '     performed.'
 ' '
 'Specify the number of iterations, after which the'
 'calculations will be halted.'
' '
'A cancel results in no change to the model. '
*enditem
        CALL EASKI(ival,' ',' Maximum iterations to perform?',
*item CFDEDAT
 'An iterative solution procedure is employed.'
 'Iterations continue until either:'
 '  1) the solution converges to a user-specified'
 '     tolerance; or'
 '  2) a user-specified number of iterations has been'
 '     performed.'
 '  '
 'Specify the maximum equation residual. When the'
 'sum of the equation residues (for the mass and'
'momentum equations) over all cells in the domain'
'drops below this value, the solution is considered'
'converged. The residual is normalized by the flow'
'into the domain.'
'  '
'A value of 0.001 is considered well converged.'
'A reasonable prediction of the flow pattern can often'
'be achieved with a value of 0.02.'
*enditem
        CALL EASKR(VAL,' ',' Maximum equation residual?',
*item CFDEDAT
'Specify the localtion of the monitoring cell.  This'
'will be the cell whos values are displayed during the'
'solution.  '
*enditem
        call EASKS(ltmp,'Monitoring cell (i,j,k)? ','  ',16,
*item CFDEDAT
*enditem
        CALL PHELPD('solution variables',53,'-',0,0,IER)
*subroutine CFDBVAR
*item CFDBVAR
'A summary of each boundary condition is presented.'
'By selecting one you can see all the data associated '
'with this boundary and edit it if necessary.'
'If source type bc are to be defined do not start the '
'name by "SRC_"'
'New source type boundary condition types have been '
'defined to accomodate contaminant entering and '
'leaving the CFD domain via airflow connections'
'These are named SRC_[contaminant #][airflow node #]'
*enditem
          CALL PHELPD('boundary conditions',9,'-',0,0,IER)
*item CFDBVAR
*enditem
          CALL PHELPD('boundary conditions',5,'-',0,0,IER)
*item CFDBVAR
'No one has written a help message for this dialog.'
*enditem
        call easkabc('Add/ delete a boundary condition?','  ','Add',
*item CFDBVAR
'Choose the type of new boundary condition.'
*enditem
          call EASKATOG('Which type of boundary?','  ',
*item CFDBVAR
'Select a key volume to delete.'
*enditem
            call EPICKS(INDEL,IDEL,' ',' ',12,INVOL,NAMES,
*subroutine EDAIRO
*item EDAIRO
'There is no help for this menu (yet).'
 '  '
*enditem
        call EASKS(t12,'Opening name? ','  ',12,d12,'open name',IER,1)
*item EDAIRO
 'Boundary coundition if defined to be "from flow network"'
 'will make ALL air flow opening conditions to be defined'
 'from the airflow network and individual specification'
 'of boundary conditions will be overridden.'
 'If however CFD is run in standalone mode, boundary '
 'conditions, if previosuly defined, will be maintained.'
 'Only choose "from flow network" if an airflow network'
 'has been defined and you wish to take up boundary '
 'conditions from it i.e. conflate CFD and flow network.'
'If you choose to conflate then ALL air flow openings'
'will be taken from the flow network automatically'
'If you wish not to conflate CFD and flow network then'
'simply choose some other boundary condition and ALL'
'openings will be restored.'
*enditem
        CALL EASKATOG('Opening types: (see help)',' ','pressure',
*item EDAIRO
 'This is the pressure at the opening.'
*enditem
          call EASKR(VAL,' ',' Pressure (Pa) of cells?',
*item EDAIRO
 'This is the mass flow rate entering'
 'or leaving the domain.  '
*enditem
          call EASKR(VAL,' ',
*item EDAIRO
 'This is the mass flow rate entering'
 'or leaving the domain.  '
*enditem
          call EASKR(VAL,' ','Mass flow rate (kg/s) entering cells?',
*item EDAIRO
 'This is the temperature of air entering the domain.'
*enditem
        call EASKR(VAL,' ','Temperature (degC) of air entering domian?',
*item EDAIRO
 'The real opening area may be less than the area covered'
 'by the cells.  If this is the case then enter the true'
 'area of the opening and the mass flow rate and momentum'
 'of the incoming air will be preserved.'
*enditem
        call EASKR(VAL,' ','Real area (m^2) of opening?',
*item EDAIRO
*enditem
        CALL PHELPD('boundary conditions',1,'-',0,0,IER)
*subroutine MFCONF
*item MFCONF
*enditem
      call ASKMFNOD(INOPT,NNPK,INPK,PROMPT1,PROMPT2,NH)
*item MFCONF
*enditem
          CALL ASKMFCON(INODE,NNPK,ICPK,PROMPT1,PROMPT2)
*subroutine EDSLDB
*item EDSLDB
'There is no help text for this menu yet.'
 '  '
*enditem
        call EASKS(t12,'Boundary name? ','  ',12,d12,'bnd name',IER,1)
*item EDSLDB
 '  '
 ' ... '
*enditem
        CALL EASKATOG('Boundary types:',' ','temperature','heat flux',
*item EDSLDB
 '  '
*enditem
          call EASKR(VAL,'temperature (degC) at chosen face of cells?',
*item EDSLDB
 '  '
*enditem
          call EASKR(VAL,'Heat flux (W) at chosen face of cells?',
*item EDSLDB
*enditem
          CALL EASKSUR(IZONE,IS,'-','Select a surface.',' ',IER)
*item EDSLDB
*enditem
        CALL PHELPD('boundary conditions',1,'-',0,0,IER)
*subroutine EDSRC
*item EDSRC
 'This menu allows you to define contaminant source and'
 'sink for this CFD boundary type.  It is also possible to'
 'allow heat injection/extraction at these sources, to do '
 'this you may specify a heat flux manually or as a casual '
 'gain from the operations file in which case you have '
 'to give the index of that casual gain and fraction '
 'injected.'
 'It is also possible to define contaminants automatically'
 'from the contaminants definition file if you have created'
 'one. It is essential that you have an airflow network'
 'defined and/or coupled with CFD before contaminants can'
 'be auto defined. You may couple flow network with CFD by'
 'exiting from here are defining boundary condition of '
 'opening type boundaries to be taken from the flow network'
 'In standalone mode CFD will take static boundary'
 'conditions defined here '
 'This source type boundary condition has been set up'
 'to allow contaminant mass injections / extractions'
 'due to air flow as described from conflated mass flow'
 'and CFD. Do not modify any paramter definition in '
 'the menu to follow this message and exit from there!'
*enditem
        CALL PHELPD('Warning',5,'-',0,0,IER)
*item EDSRC
 '  '
*enditem
        call EASKS(t12,'Source name? ','  ',12,d12,'src name',IER,1)
*item EDSRC
 'Choose from contaminants network only if'
 '1. This is not standalone CFD'
 '2. You have a mass flow network which is conflated'
 '   with the CFD domain or you intend to conflate it'
 '   before simulation'
 '3. You have a contaminants flow network defined'
*enditem
        CALL EASKABC('How to specify coundary condition',' ','static',
*item EDSRC
 'You may link CFD with the contamiant network if you'
 'have defined one. Once this is done source type'
 'boundary conditions will take their strengths (kg/s)'
 'from source/sink models that you have defined in the'
 'contaminant network. If you have conflated a mass '
 'flow network with CFD then new source type boundary'
 'conditions which will accomodate any addition or '
 'deletion of contaminant from CFD domain due to air'
 'flow as computed from conflated CFD and mass flow nwk'
 'If you have not conflated the mass flow network with '
 'CFD you are advised to do so before linking CFD with'
 'contaminant network'
*enditem
          CALL ASKOK('Link CFD with contaminant network (see help) ?',
*item EDSRC
 'You are not allowed to conflate CFD with '
 'contaminants if CFD is not conflated with '
 'mass flow network'
*enditem
            CALL PHELPD(' ',3,'-',0,0,IER)
*item EDSRC
'Choose which contaminant is moisture'
'None of the contaminants is moisture'
*enditem
              CALL PHELPD(' ',1,'-',0,0,IER)
*item EDSRC
*enditem
            CALL PHELPD(' ',1,'-',0,0,IER)
*item EDSRC
 'In order to calculate contaminant distribution'
 'the turbulent Schmidt Number needs to be '
 'calculated. To do this the following information'
 'is required: molar mass, volume at critical point,'
 'boiling point and critical temperature.'
 'If this information is available press parameters'
 'If not press manual to specify a value for the '
 'turbulent Schmidt Number.  Click default to use a'
 'default value of unity or 0.59 for moisture'
*enditem
            CALL EASKABC('How to specify turbulent Schmidt #(see help)?'
*item EDSRC
*enditem
              CALL EASKS(HOLD,'enter mol mass(g/mol),crit vol(cm^3/mol)'
*item EDSRC
*enditem
              call EASKR(VAL,'What is Turbulent Schmidt Number for',
*item EDSRC
 'If sources and sinks are defined in the contaminant'
 'network then these can be linked with this CFD source'
 'boundary condition. For any one contaminant only one'
 'source/sink can be linked to one source b.c. but '
 'two or more source/sinks for as many contamiants can'
 'be linked with the same CFD source b.c.'
*enditem
          CALL ASKOK('Link contaminant network source/sink with this',
*item EDSRC
 'are displayed. Choose which one represents this'
 'source type CFD boundary condition (if at all)'
*enditem
                CALL PHELPD('Choose source/sink',3,'-',0,0,IER)
*item EDSRC
 'No sources/sinks defined for this contaminant'
*enditem
            CALL PHELPD(' ',1,'-',0,0,IER)
*item EDSRC
 '  '
*enditem
        call EASKR(VAL,'Heat flux (W) in source volume?',
*item EDSRC
 'This is the index of the casual gain included in the'
 'zone operation file.  '
 '  '
 'A cancel results in no change in the model.  '
*enditem
        call EASKI(IVAL,'Which casual gain index represents heat ',
*item EDSRC
*enditem
        call EASKR(VAL,'What fraction of casual gain is generated? ',
*item EDSRC
 ' '
*enditem
        CALL EASKABC('Add/Delete contaminant source',' ','add',
*item EDSRC
 'You cannot add / delete contaminants from '
 'contaminants network here, go to contaminants '
 'in Model Definition Menu'
 'To dereference contaminants network and invoke '
 'static definition (which you can edit here) change'
 'source type to "static" from "From ctm network"'
*enditem
            CALL PHELPD('Not allowed',6,'-',0,0,IER)
*item EDSRC
*enditem
            call EASKS(SRCNAM,'Contaminant name? ','  ',12,d12,
*item EDSRC
*enditem
            call EASKR(VAL,'What is source strength (kg/s) ',
*item EDSRC
*enditem
            CALL ASKOK(' ','Is this contaminant water',OK,dok,0)
*item EDSRC
 'In order to calculate contaminant distribution'
 'the turbulent Schmidt Number needs to be '
 'calculated. To do this the following information'
 'is required: molar mass, volume at critical point,'
 'boiling point and critical temperature.'
 'If this information is available press parameters'
 'If not press manual to specify a value for the '
 'turbulent Schmidt Number.  Click default to use a'
 'default value of unity or 0.59 for moisture'
*enditem
            CALL EASKABC('How to specify turbulent Schmidt #(see help)?'
*item EDSRC
*enditem
              CALL EASKS(HOLD,'enter mol mass(g/mol),crit vol(cm^3/mol)'
*item EDSRC
*enditem
              call EASKR(VAL,'What is Turbulent Schmidt Number ',
*item EDSRC
 'You cannot add / delete contaminants from '
 'contaminants network here, go to contaminants '
 'in Model Definition Menu'
 'To dereference contaminants network and invoke '
 'static definition (which you can edit here) change'
 'source type to "static" from "contaminants network"'
*enditem
            CALL PHELPD('Not allowed',6,'-',0,0,IER)
*item EDSRC
 'You can link contaminant(ctm) source/sink models from'
 'contaminants network here. '
 'To dereference contaminants network and invoke '
 'static definition (which you can edit here) change'
 'source type to "static" from "From ctm network"'
 'You can define which contaminant is moisture'
 'and how to specify turbulent Schmidt number'
 'You should also specify static source strengths '
 '(kg/s) these being the values that will be used '
 'CFD standalone mode'
*enditem
          CALL PHELPD('Contaminants Edit',10,'-',0,0,IER)
*item EDSRC
*enditem
          call EASKS(SRCNAM,'Contaminant name? ','  ',12,d12,
*item EDSRC
*enditem
        call EASKR(VAL,'What is source strength (kg/s) ',
*item EDSRC
*enditem
        CALL ASKOK(' ','Is this contaminant water(humidity)',OK,dok,0)
*item EDSRC
 'In order to calculate contaminant distribution'
 'the turbulent Schmidt Number needs to be '
 'calculated. To do this the following information'
 'is required: molar mass, volume at critical point,'
 'boiling point and critical temperature.'
 'If this information is available press parameters'
 'If not press manual to specify a value for the '
 'turbulent Schmidt Number.  Click default to use a'
 'default value of unity or 0.59 for moisture'
*enditem
        CALL EASKABC('How to specify turbulent Schmidt # (see help) ?'
*item EDSRC
*enditem
          CALL EASKS(HOLD,'enter mol mass (g/mol) crit vol (cm^3/mol)'
*item EDSRC
*enditem
          call EASKR(VAL,'What is Turbulent Schmidt Number ',
*item EDSRC
 'If sources and sinks are defined in the contaminant'
 'network then these can be linked with this CFD source'
 'boundary condition. For any one contaminant only one'
 'source/sink can be linked to one source b.c. but '
 'two or more source/sinks for as many contamiants can'
 'be linked with the same CFD source b.c.'
*enditem
          CALL ASKOK('Link contaminant network source/sink with this',
*item EDSRC
 'are displayed. Choose which one represents this'
 'source type CFD boundary condition (if at all)'
*enditem
              CALL PHELPD('Choose source/sink',3,'-',0,0,IER)
*item EDSRC
 'No sources/sinks defined for this contaminant'
*enditem
          CALL PHELPD(' ',1,'-',0,0,IER)
*item EDSRC
*enditem
        CALL PHELPD('sources edit help',16,'-',0,0,IER)
*item EDSRC
 'According to Recknagel, Sprenger und Schrameck'
 'persons at light, sedentary activity release '
 'water vapour: '
 '20C - 35g/h; 22C - 40g/h; 23C - 50g/h; 24 and 25C - 60/h'
*enditem
*        call EASKR(VAL,'Moisture (g/hr) generated in source volume?',
*item EDSRC
 'Assuming CO2 production of 0.0000153737kg/s/person  '
*enditem
*        call EASKR(VAL,'No of people breathing in source volume?',
*subroutine EDBLK
*item EDBLK
'There is no help text for this menu (yet).'
 ' '
*enditem
        call EASKS(t12,'Blockage name? ','  ',12,d12,'blk name',IER,1)
*item EDBLK
 '  '
*enditem
        call EASKR(VAL,'Heat flux (W/m^2) on blockage surfaces?',
*item EDBLK
*enditem
        CALL PHELPD('blocakage edit',1,'-',0,0,IER)
*subroutine HANDSHK
*subroutine PIKCELS
*item PIKCELS
 'You will have to pick a face at which the'
 'boundary condition will apply.'
 'Based on the face you select, information about'
 'the face X/Y or Z cell coordinates will be reported'
 'in the text feedback area. '
*enditem
        CALL EASKATOG('Boundary face is on which side?',t30,'West',
*item PIKCELS
'The boundary condition will apply to a volume (or face)'
'defined by the start and end control volume in the three'
'orthogonal directions i,j,k.'
' '
'If in doubt, review the cell coordinates which listed'
'in the text feedback area.'
*enditem
      call EASKS(s30,'Boundary cells?',t30,30,dflt,'bndry cells',IER,6)
*subroutine PIKFACE
*item PIKFACE
 'You will have to pick a face at which'
 'the boundary condition will apply.'
*enditem
        CALL EASKATOG('Boundary face is on which side?',' ','West',
*subroutine TOPBOT
*item TOPBOT
'The curvilinear gridding routine requires the shape of the'
'high and low boundaries of the domain to be defined as '
'follows:  '
'For the high boundary start with the vertex at the '
'intersection of the west and high boundaries.  Select the'
'next vertex to the east in the same east-west, high-low'
'plane. '
'     4____ 5'
'     /     \\'
'  3/       | 6'
'   |       |'
'   |       |'
' 1 -------- 9 '
' view from south'
'In the example above HIGH is defined by the vertices  '
'3 4 5 6 and the LOW by 1 and 9. Note: order is from '
'the WEST to the EAST (i.e. left to right). '
'Repeat for the bottom boundary. '
*enditem
      CALL PHELPD('gen start popup',18,'-',0,0,IER)
*item TOPBOT
'Type the list of vertices (west to east) OR '
'click mouse on existing vertices, ending with an '
'` e `. A match is assumed if within 5 pixels.'
'You will be given an oportunity to confirm the list. '
*enditem
        CALL EASKS(HOLD,' Give high vertices (west to east)','  ',
*item TOPBOT
*enditem
        CALL EASKSCMD(HOLD,' Give high vertices (west to east)',
*item TOPBOT
*enditem
          CALL EASKS(HOLD,' Associated high vertices (confirm):',
*item TOPBOT
'Type the list of vertices (west to east) OR '
'click mouse on existing vertices, ending with an '
'` e `. A match is assumed if within 5 pixels.'
'You will be given an oportunity to confirm the list. '
*enditem
        CALL EASKS(HOLD,' Give low vertices (west to east)','  ',
*item TOPBOT
*enditem
        CALL EASKSCMD(HOLD,' Give low vertices (west to east)',
*item TOPBOT
*enditem
          CALL EASKS(HOLD,' Associated low vertices (confirm):',
*subroutine GRIDDEF
*item GRIDDEF
'Number of cells - specifies how many computational'
'cells (control volumes, grid points) the current'
'region contains. There is a limit for each axis due'
'to array dimensions (if you would like to change it,'
'please read file esrudfs/Info/help1.txt.'
' '
'The length of the region is in meters.'
' '
'The power law coefficient guides the distribution of'
'cells - a value of 1.0 will distribute cells evenly,'
'for a value bigger/less than 1 - each next cell will'
'increase/decrease in size.'
' '
'To have a grid of a good quality - the size/distance'
'of two neighbor cells should not differ more than 20%'
'which can be controlled using --> vizualize gridding'
'--> list x,y,z plane points (aspect ratio) from the '
'upper menu.'
' '
'Symmetrical gridding will set an axis of symmetry'
'in the middle of the region.'
'Number of cells - specifies how many computational'
'cells (control volumes, grid points) the current'
'region contains. There is a limit for each axis due'
'to array dimensions (if you would like to change it,'
'please read file esrudfs/Info/help1.txt.'
' '
'The length of the region is in meters.'
' '
'The power law coefficient guides the distribution of'
'cells - a value of 1.0 will distribute cells evenly,'
'for a value bigger/less than 1 - each next cell will'
'increase/decrease in size.'
' '
'To have a grid of a good quality - the size/distance'
'of two neighbor cells should not differ more than 20%'
'which can be controlled using --> vizualize gridding'
'--> list x,y,z plane points (aspect ratio) from the '
'upper menu.'
' '
'Symmetrical gridding will set an axis of symmetry'
'in the middle of the region.'
*enditem
        call EASKS(HOLD,outs,' ',32,' 1 1.0 1.0 ','cell data',IER,21)
*item GRIDDEF
'Symmetrical gridding will set an axis of symmetry'
'in the middle of the region. If this is what you'
'want say ok. '
*enditem
          CALL ASKOK(' ',' Symmetrical gridding?',OK,dok,3)
*item GRIDDEF
 'Each axis is sub-divided into regions which are'
 'gridded independently.'
*enditem
        call EASKABC('Region operations:','  ','add one','delete one',
*item GRIDDEF
 'You can specify regions either by selecting'
 'vertices or by giving dimensioned input (m).'
*enditem
            CALL EASKABC('Specify region length:',' ','by vertices',
*item GRIDDEF
 'This is the zone vertex index.'
 'The distance parallel to the axis between these '
 'vertices will be calculated.'
*enditem
              call EASKS(HOLD,'Specify vertex at start & end of region',
*item GRIDDEF
 'Distance in metres.'
*enditem
              CALL EASKR(VAL,' ','Length of current region (m) ? ',
*item GRIDDEF
'A region can be subdivided into a number of cells.'
' '
'A cancel takes you back to the grid definition'
'menu and you should check your model for incon-'
*enditem
              CALL EASKI(icellt,' Specify number of cells in region',
*item GRIDDEF
 'The cells faces are located according to a '
 'power-law relation:'
 '            Xi = L*(i/n)**c'
 'where `i` is cell number, `Xi` is position of '
 'face of i`th cell, `L` is length of region, '
 '`n` is number of cells in region, and `c` is '
 'power-law coeff. '
 '  '
 'c > 1:      grid spacing grows along axis'
'0 < c < 1:  grid spacing decreases along axis'
'c = 1:      uniform grid'
'-1 < c < 0: grid spacing grows along axis'
'c < -1:     grid spacing decreases along axis'
*enditem
                CALL EASKR(VAL,'  ','Power-law coefficient?',
*item GRIDDEF
'Symmetrical gridding will set an axis of symmetry'
'in the middle of the region. If this is what you'
'want say ok. '
*enditem
                CALL ASKOK('  ','Symmetrical gridding?',OK,dok,3)
*item GRIDDEF
 'This is the region index.'
 'A cancel returns you to the menu without changing'
 'the model.'
*enditem
          CALL EASKI(IDEL,' ','Which region to delete ? ',
*item GRIDDEF
*enditem
        CALL PHELPD('CFD inputs',21,'-',0,0,IER)
*subroutine ASKMFNOD
*item ASKMFNOD
*enditem
      call EPICKS(NNPK,INPK,PROMPT1,PROMPT2,
*subroutine ASKMFCON
*item ASKMFCON
*enditem
        call EPICKS(NNPK,IPK,PROMPT1,PROMPT2,
*subroutine edcfg
*item edcfg
'A model, as defined within the system configuration file,'
'comprises several entities such as simulation domain'
'definition, site location, geometry, construction, usage'
'and control. The system configuration file references'
'other files where the actual defining data is held.'
' '
'The structure of this menu reflects the entities of a'
'system configuration file. The options may be used to'
'define a model to be simulated.  For example, it is'
'possible to initially define a single building zone and'
'then add further zones, plant and control later. It is'
'also possible to increase the resolution of a model by,'
'adding in a CFD domain to represent zone air movement'
'or plant component working fluid flow.'
' '
'The `actions` section includes comissioning assessments'
'of the model, recovering performance indidators, as'
'well as generating QA reports on the composition of'
'the model. '
*enditem
        CALL PHELPD('configuration images',19,'-',0,0,IER)
*item edcfg
'The current model description will be written to'
'this file.'
*enditem
   89   CALL EASKS(ltmp,' ','Update system configuration file?',
*item edcfg
'The surface topology of the model is held'
'in the surface connections file.'
*enditem
            CALL EASKS(ltmp,' ','Surface connections file name?',
*item edcfg
'Check to see that the disk is not full and that you'
'have permission to write to the folder.'
*enditem
          CALL ASKOK('Problem creating new file!',
*item edcfg
'The domains included in a model are automatically'
'updated in the system configuration file as you add'
'new information. While you can change the defined domain'
'at any time, BE WARNED - if you change from a building'
'only domain to a plant only domain, all zone data will'
'be lost from your model.'
' '
'The `registration level` domain holds only site'
'information and images (i.e. no building/plant details).'
*enditem
        call MENUATOL(outs,'Domain options:',
*item edcfg
'Normally the domains included in a model are updated'
'automatically as new information is added. Changing'
'the domain can have a significant impact: for example,'
'if the domain is `building and plant` and you change'
'it to `plant only`, all references to the building'
'zones will be removed. The zone files will still exist'
'but would need to be reattached to the model.'
*enditem
          call askok('Are you sure you want to change the domains',
*item edcfg
'Idealized model creates an .hvac file with    '
'descriptions of main and backup systems.      '
'Explicit creates a plant network file which   '
'defines plant components and their connection '
'topology.                                     '
*enditem
            CALL PHELPD('Idealized or Explicit Plant Model?'
*item edcfg
'A plant network file holds the definition of a     '
'system, the purpose of which is usually to supply  '
'the building with heat, coolth and/or power. Unless'
'you have access to a suitable components database, '
'DO NOT use this facility.                          '
*enditem
              CALL ASKOK(
*item edcfg
'The plant network file defines plant components'
'and their connection topology.'
*enditem
              CALL EASKS(ltmp,' ','Plant network definition file?',72,
*item edcfg
'The plant network file defines plant components and'
'topology. If you supply an existing file it will be'
'used, otherwise a new file will be created.'
' '
'The dereference option removes the name of the plant'
'network file from the system configuration file but'
'does not delete it. The plant domain can later be'
're-established by rintrosucting the configuration'
'file reference.'
*enditem
              CALL EASKSCMD(ltmp,'Plant network definition file?',' ',
*item edcfg
*enditem
              CALL EASKS2CMD(ltmp,'Plant network definition file?',' ',
*item edcfg
'File not found, select `OK` if you want this file'
'to hold the definition of a new plant network.'
*enditem
              CALL ASKOK('This is a new plant network file.',
*item edcfg
'Found an existing file, select `OK` if you want to'
'use or modify it.'
*enditem
              CALL ASKOK('Found existing plant network file.',
*item edcfg
'Air flow can be modelled using an empirical air'
'infiltration model, sheduling flow by prescribing'
'flowrates and imposing controls or by defining a'
'detailed air flow network.'
'The Alberta Air Infiltration Model (AIM-2) is used '
'to describe the empirical air infilration model.'
'It is possible to schedule air flowing from the'
'outside (infiltration) and from specified zones or'
'plant components (ventilation). This is sometimes'
'appropriate at an early design stage and for flow'
'problems of limited complexity.'
' '
'The flow network approach employs flow components'
'(doors, cracks, ducts, fans etc.) to explicitly'
'represent the distributed flow paths. This approach'
'requires significantly more defining information.'
'(A related facility, described elsewhere, allows'
'a CFD domain to be linked to this flow network so'
'that intra-zone flows can be evaluated under the'
'influence of the above flow network.)'
' '
'Flow networks may be defined by selecting components'
'from a menu or by graphical manipulation.'
*enditem
        call EASKATOG('Define air flow via:',' ',
*item edcfg
*enditem
 250      CALL EASKGEOF('Select a zone:',CFGOK,IC,'-',IER)
*item edcfg
'This is the network graphics file generated by the'
'`net` tool.'
*enditem
          CALL EASKS(LFIL,' ','Network graphics file?',72,
*item edcfg
'You may have nodes that are not linked to a zone'
'but where network nodes and zones are linked, the'
'temperature of the former will be matched to the'
'latter. '
*enditem
              CALL EASKABC(outs,' ','ok',
*item edcfg
*enditem
                call ASKRNOD('available nodes','-',IC,IER)
*item edcfg
*enditem
              CALL EASKAB(outs,' ','ok','select a node',iacc,3)
*item edcfg
*enditem
                call ASKRNOD('available nodes','-',IC,IER)
*item edcfg
'You have been working on an independant description'
'of a flow network. To use it in a simulation you '
'need to associate it with zones in the current'
*enditem
            CALL ASKOK('Save graphic flow network links to zones',
*item edcfg
'This option is password protected because it is'
'under development and so must be used with care.'
'The password is available from ESRU on request.'
*enditem
        call easki(IPASS,' ','Password?',
*item edcfg
'In addition to the in-built perspective view you can'
'request a hidden line view of the model or send'
'it to be rendered by Radiance.'
*enditem
          CALL EASKABC(' ','Visualisation options:','hidden line',
*subroutine EDZCOMP
*item EDZCOMP
'This menu provides facilities to create, browse'
'and edit zone-level data such as geometry and'
'construction, schedules and miscellaneous technical'
'data relating to CFD, casual gain control etc.'
' '
'The `Zones` section (geometry, construction, operations)'
'are the essential attributes of zones which must be'
'completed prior to simulation.'
' '
'The `Topology` section allows you to automate the'
'specification of what-is-on-the-other-side of surfaces'
'in the model (which can also be done on a surface by'
'surface basis within the geometry facility). Anchors'
'can be thought of as named lists of surfaces e.g.'
'a list called `finistration` might point to all windows'
'in a facade to allow you to change them all to a new'
'type of glazing.'
' '
'The `Options` section allows you to add additional'
'descriptions and or detail to your model as and when'
'such concepts become important to your performance'
'assessments. If you do not specify these additional'
'model attributes default assumptions are made.'
' '
'The `Special components` section also allows you to'
'add detail to your model to support specialists'
'tasks (e.g. assigning electrical characteristics to'
'PV cells embedded within surfaces).'
' '
'The `Global tasks` option allows you to transform and'
'rotate the model on the site and do search & replace '
'actions on surface attributes. '
*enditem
        CALL PHELPD('zones definition',32,'-',0,0,IER)
*item EDZCOMP
'Transforms and rotations may be applied to one or more'
'zones in the model. Global attribution allows all'
'surfaces matching some criteria (e.g. vertical and'
'opaque) to be assigned a particular attribute.'
*enditem
          call EASKATOG(' Global action?',' ',
*item EDZCOMP
*enditem
          call EASKATOG(' Global action?',' ',
*item EDZCOMP
'A transform shifts each zone & its solar obstructions'
'by a given amount along each axis.'
*enditem
            CALL EASKS(HOLD,'X, Y and Z transform (m)?',' ',
*item EDZCOMP
*enditem
            CALL EASKSCMD(HOLD,'X, Y and Z transform (m)?',' ',
*item EDZCOMP
' Pick one, several or all zones for inclusion.'
*enditem
          CALL EPICKS(INPIC,IVALS,' ','Zones to transform?',
*item EDZCOMP
'The rotation is applied to all selected zones about'
'a common point or the site origin. Positive is  '
*enditem
          CALL EASKR(VAL,' ','Rotation (degrees, +ve anticlockwise)?',
*item EDZCOMP
*enditem
            CALL EASKABC(' ','Rotation choice?',
*item EDZCOMP
'The point is relative to the site'
'Tcoordinate system.'
*enditem
              CALL EASKR(x1,' ','X point (m)?',
*item EDZCOMP
*enditem
              CALL EASKR(y1,' ','Y point (m)?',
*item EDZCOMP
'Pick one, several or all zones to rotate.'
*enditem
            CALL EPICKS(INPIC,IVALS,' ','Zones to rotate?',
*item EDZCOMP
*enditem
          CALL EASKGEOF('Select a zone to focus on:',CFGOK,IC,'M',IER)
*item EDZCOMP
'When you copy a zone, the control file needs to be'
'updated to reflect the additional zone. Separately'
'(in the control interface) you must indicate which'
'control loop to use with the copied zone. The'
'initial assumption is that it free-floats. '
*enditem
            CALL ASKOK(
*item EDZCOMP
'The (optional) system control file holds the '
'definition of all building/plant controls. '
'A free-flot control has been associated with the'
'copied zone.'
*enditem
            CALL EASKS(lctmp,' Control file ? ',
*item EDZCOMP
'While scanning the file a problem was noted. If you'
'think this might be because the wrong file name was'
'given you can try it again. '
*enditem
            CALL ASKOK('Problem reading geometry file.','Try again?',
*item EDZCOMP
'The name of the zone is used both for descriptive'
'and bookkeeping purposes.  Each name should be'
'unique and should not contain blanks. '
*enditem
          CALL EASKS(ZN,' What do you want to call this copied zone ',
*item EDZCOMP
'The zone description allows information about'
'zone form and composition to be recorded.'
*enditem
  40      CALL EASKS(zd,'What does it represent?',
*item EDZCOMP
'The original zone had associated solar obstructions'
'and you have two options '
' a) copy the obstructions so that modifications'
'    relevant to the copied zones obstructions can'
'    be made.'
' b) do not copy the obstructions. Optionally you'
'    can reference the original obstructions (via'
'    the project files menu).'
*enditem
            CALL ASKOK(' ','Also copy obstructions of source zone?',
*item EDZCOMP
'When copying a zone and obstructions the copy is'
'usually shifted away from the position of the '
'source. You can skip such transforms.'
'When copying a zone the copy is usually shifted'
'away from the position of the source.  You can '
'skip such transforms. '
'Transform shifts the zone by a given amount in'
'each axis.'
*enditem
            CALL EASKSCMD(HOLD,'Transform (X Y Z metres):',' ',
*item EDZCOMP
*enditem
            CALL EASKS2CMD(HOLD,'Transform (X Y Z metres):',' ',
*item EDZCOMP
'If you want to rotate the zone from its initial'
'position now is a good time to do this if the '
'point of rotation is the first vertex of the zone.'
*enditem
          CALL ASKOK(' ',' Rotate the copied zone',OKZR,dok,3)
*item EDZCOMP
'The rotation is applied around vertex 1,'
'positive is anticlockwise.'
*enditem
            CALL EASKR(VAL,' ',' Rotation (deg., +ve anticlockwise)?',
*item EDZCOMP
'The default rotation is about vertex 1 of the'
'zone with a positive angle denoting anticlockwise.'
'You may change this to rotate the zone about the'
'site origin or a specified point.'
*enditem
              CALL EASKABCD(' ','Rotation choices:',
*item EDZCOMP
'Point is in the site coordinate system.'
*enditem
                CALL EASKR(x1,' ',' X point (metres) ? ',
*item EDZCOMP
*enditem
                CALL EASKR(y1,' ',' Y point (metres) ? ',
*item EDZCOMP
'When writing the geometry file a problem was found.'
'Check that you have permission to update the file '
'and that there is sufficient disk space. '
*enditem
            CALL ASKOK(' ','Problem creating geometry...try again?',
*item EDZCOMP
'You can have the new zone constructions based'
'on the source zone (by copying the file)'
'or by pointing to the file (exercise care)'
'or browse available files or continue without'
'defining constructions at this time.'
*enditem
            CALL EASKATOG(' ','Source zone has a constructions file:',
*item EDZCOMP
'You can have the new zone constructions by'
'browing available files or continue without'
'defining constructions at this time.'
*enditem
            CALL EASKATOG(' ','Source zone has no constructions file:',
*item EDZCOMP
'A zone construction file contains thermophysical'
'data for the zone surfaces.'
*enditem
            CALL EASKS(CFILE,' New construction file name:',
*item EDZCOMP
'A zone tmc file contains optical data for the'
'data zone surfaces.'
*enditem
                CALL EASKS(DFILE,' ','New zone tmc file name:',
*item EDZCOMP
'You can have the new zone operations based initially'
'on the source zones operations (by copying the file)'
'or use the same operations (by pointing to the file)'
'or browse available files or continue without '
'defining operations at this time. '
*enditem
            CALL EASKATOG(
*item EDZCOMP
'You can have the new zone operations by'
'browing available files or continue without'
'defining operations at this time.'
*enditem
            CALL EASKATOG(
*item EDZCOMP
'A zone operation file contains schedules of air'
'flow and casual gains.'
*enditem
            CALL EASKS(DFILE,' New zone operations file name:',
*item EDZCOMP
'The new zone view factors file can be based on the'
'source zone (by copying the file) or you can'
'point to the source zone file (use care because'
'the two zones may change shape) or browse available '
'files or continue. '
*enditem
            CALL EASKATOG(
*item EDZCOMP
'A zone view factor file contains calculations of'
'how much each surface can see other surfaces.'
*enditem
              CALL EASKS(DFILE,' ','New view factor file name?',
*item EDZCOMP
'The new zone casual gain control can be based on'
'the source zone (by copying the file) or you'
'can point to the source zone file or browse'
'available files.'
*enditem
            CALL EASKATOG(
*item EDZCOMP
'A zone casual gain control file contains logic'
'for light switching in a zone.'
*enditem
              CALL EASKS(DFILE,' ','Zone CG file name?',
*item EDZCOMP
'The new zone convection regime can be based on'
'the source zone (by copying the file) or you'
'can point to the source zone file or browse  '
'available files or continue.'
*enditem
            CALL EASKATOG('Source zone has a CC file.',
*item EDZCOMP
'A zone convection coefficients file contains data'
'used to impose surface convection regimes within'
'a zone.'
*enditem
              CALL EASKS(DFILE,' ','Zone CC file name?',
*item EDZCOMP
'A problem was found while reading the geometry and'
'you have the option to try again. Do this if you '
'think you migh have the wrong file. '
*enditem
            CALL ASKOK('Problem reading geometry file!',
*item EDZCOMP
*enditem
 249    CALL EASKGEOF('Select a zone to focus on:',CFGOK,IC,'t',IER)
*item EDZCOMP
'If you suspect that your zone constructions file has'
'been corrupted or is out of date then this command'
'will refresh it. This requires that the model has'
'existing zone construction files because the process'
'of refreshing requires the file names.'
*enditem
          CALL ASKOK(' ','Update zone constructions files?',
*item EDZCOMP
*enditem
        call askzone(ic,izdef,' ','Zone Operations Selection',
*item EDZCOMP
'You can upgrade older unsorted zone operations files'
'if they exist in the current model.'
' '
'You can also check current operations files to see'
'if the casual gains periods are sorted.'
*enditem
          CALL EASKABC(
*item EDZCOMP
*enditem
        call askzone(ic,izdef,' ','Zone Shading Selection',
*item EDZCOMP
'You can establish detailed shading and/orinsolation'
'patterns in nominated zones as follows.'
' '
'  Recalculate shading in all zones where a shading'
'  file exists.'
' '
'  Nominate zones for which you want to include an'
'  insolation analysis (i.e. track the distribution of'
'  the directly transmitted solar component).'
' '
'  Nominate zones for which you want to create solar'
'  obstructions so that shading and insolation can'
'  be calculated.'
' '
'  Nominate zones for which you want to dereference'
'  the shading/insolation file.'
' '
'If you review the result of a shading analysis'
'and find unexpected patterns, this may be because'
'of incorrectly ordered surface edges.'
' '
'  a) Check that a surface that appears to face a'
'     particular directyion in the wireframe view'
'     actually does!'
' '
'  b) Check the ordering of the edges of all'
'     problematic surfaces by adhering to the'
'     following advice.'
' '
'It is suggested that the first surface edge be'
'close to horizontal if possible.'
*enditem
          CALL EASKABCD(' ','Options for multiple zones:',
*item EDZCOMP
*enditem
            call askmultizone(inpic,ivals,
*item EDZCOMP
*enditem
            call askmultizone(inpic,ivals,
*item EDZCOMP
'The zone shading/insulation database holds time'
'varying external surface shading and internal surface'
*enditem
          CALL EASKS(SFIL,' ','Zone shading/insulation file?',
*item EDZCOMP
'The zone shading/insulation database holds time'
'varying external surface shading and internal surface'
'insolation. You may dereference an existing file.'
*enditem
          CALL EASKSCMD(SFIL,' ','Zone shading/insulation file?',
*item EDZCOMP
'If you reached this point you probably have all you'
'need to carry out the shading/insolation analysis.'
'If in doubt, double check. '
*enditem
        CALL ASKOK(' ',
*item EDZCOMP
*enditem
        call askzone(ic,izdef,' ','Zone Convection Selection',
*item EDZCOMP
*enditem
        call askzone(ic,izdef,' ','Zone View Factors Selection',
*item EDZCOMP
'Inter-surface view factors may be determined as simple'
'area weightings or exactly using ray tracing. Area '
'weighting is the default treament.'
' '
'You can nominate the zones to which you want to apply'
'either calculation type or, alternatively, you may'
'dereference an exiting zone view factor file.analysis'
*enditem
          CALL EASKABCD(' ','View factor options:',
*item EDZCOMP
*enditem
            call askmultizone(inpic,ivals,
*item EDZCOMP
*enditem
            call askmultizone(inpic,ivals,
*item EDZCOMP
*enditem
        call askzone(ic,izdef,' ','Zone CG Ctl Selection',
*item EDZCOMP
'This menu allows the dereferencing or editing of a'
'zone casual gain control file.'
*enditem
          CALL EASKABC(' ','Casual gain control options:','edit',
*item EDZCOMP
'This menu allows a zone casual control file to be'
'created/editted. The data within this file controls'
'zone casual gains based on the internal or external'
'illuminance. Different control algorithms are offered.'
*enditem
          CALL EASKABC(' ','Casual gain ctl options:',
*item EDZCOMP
'This facility allows you to compose a file defining'
'the zone parameters required for a CFD simulation.'
'You may reference and dereference the CFD domain'
'within the current model at any time.'
*enditem
        CALL PHELPD('CFD domain + parameters',4,'-',0,0,IER)
*item EDZCOMP
*enditem
        call askzone(ic,izdef,' ','Zone CFD Selection',
*item EDZCOMP
'If the CFD domain is complete you will probably want'
'to associate it with the model. If you do not do this'
'now, you can do it later (but you will need to supply'
'the name of the file to complete the association). '
' '
'If you want to ignore the CFD domain just say no. '
*enditem
          CALL ASKOK(outs,'(see help)',OK,dok,6)
*item EDZCOMP
*enditem
        CALL EASKGEOF('Select zone for adaptive gridding:',CFGOK,IC,
*item EDZCOMP
'The moisture file holds moisture transport data'
'for nodes.'
*enditem
          CALL EASKSCMD(SFIL,outs,' ','ignore',clkok,72,DSFIL,
*item EDZCOMP
*enditem
          CALL EASKSCMD(SFIL,outs,' ','dereference',clkok,72,DSFIL,
*item EDZCOMP
'There are four adaptive gridding files which must be'
'specified for each zone to which such gridding is to'
'be applied. Check documentation for more information.'
*enditem
          CALL EASKAB(' Addaptive gridding options:',
*item EDZCOMP
*enditem
          CALL EASKABC(' Addaptive gridding options:',
*item EDZCOMP
'The 3D control volumes file defines...'
'<< more text to be added here >>'
*enditem
        CALL EASKS(SFIL,' 3D control volumes file',
*item EDZCOMP
'The 3D control volumes connections file defines...'
'<< more text to be added here >>'
*enditem
        CALL EASKS(SFIL,' 3D control volumes connections file',
*item EDZCOMP
'The 3D nodes coordinates file defines...'
'<< more text to be added here >>'
*enditem
        CALL EASKS(SFIL,' 3D nodes coordinates file',
*item EDZCOMP
'The 3D nodes temperatures file defines...'
'<< more text to be added here >>'
*enditem
        CALL EASKS(SFIL,' 3D nodes temperatures file',
*item EDZCOMP
'To proceed with adaptive gridding you first have to...'
'<< instructions to be added >> '
*enditem
        CALL ASKOK(' ',' Proceed with adaptive gridding?',OK,dok,2)
*subroutine NEWPRB
*item NEWPRB
'The system configuration file holds the definition'
'of the building/plant to be simulated, including'
'references to the various files comprising a model.'
'If the name given matches an existing file then that'
'model is loaded by the Project Manager and becomes'
'available for browsing and editing (if you are the'
'owner. If the file does not exist then a new one is'
'created and loaded with a set ofdefaults that can'
'subsequently be modified. The default model is'
' '
' '
'Note that before this model can be edited, it must'
'be copied to your user area to give you write'
'permission. Other example models are available'
'via the `exemplars` option.'
*enditem
        CALL EASKXORGTKF(LCMDFL,
*item NEWPRB
'The following files match the search criteria.'
'Select one to use or, if none selected, it will'
'revert to prior value. '
*enditem
            CALL EPICKS(IX,ivlist,outs,' ',
*item NEWPRB
*enditem
          CALL EASKABC('When reading the model description,',
*item NEWPRB
'There was an unspecified problem, review any warnings'
'to see if the problem is one you can fix. Also check'
'that the file was of the correct type.'
' '
'If you say `no` then it may be possible to work with'
'the model, but it may be incomplete or inconsistent'
'and should be treated as at risk.'
*enditem
          CALL ASKOK('While reading the model configuration file',
*item NEWPRB
'There was a problem while scanning the control'
'file. Review any messages to see if you can correct'
'the problem. Also check to see that the file is'
'of the correct type. '
' '
'If you say `no`, the model description may be'
'incomplete so be careful. Consider dereferencing'
'the control file and recreating it from scratch.'
*enditem
            CALL ASKOK('While reading the control file a',
*item NEWPRB
'There is an unspecified error with this model. Please'
'review earlier error messages.'
*enditem
          CALL ASKOK('There was an error reported as the',
*item NEWPRB
'If the name supplied is not found you can: '
'  a) edit the name,'
'  b) create a new configuration file using that name,'
'  c) delay the decision by selecting `cancel`.'
' '
'If you are running the GTK version of Project Manager,'
'and the name of the model appears correct (including'
'the correct directory path), then select the respecify'
'option and use the file browser to locate the model.'
*enditem
        CALL EASKABC(OUTSTR,' Options: (see help)',
*subroutine visualz
*item visualz
'The hidden line perspective program requires an input'
'file, which may be automatically created from the'
'current model.'
*enditem
        CALL EASKS(LFIL,' ','File name for image data?',
*item visualz
'If the export of vector information was accomplished'
'without error you should be able to start up the module'
'that displays hidden line views.'
*enditem
        CALL ASKOK(' ',' Display hidden line views?',OK,dok,3)
*item visualz
'Creating a folder for Radiance model: `../rad`.'
'The current model includes a Radiance model in the'
'`cfg` folder. If you want to use this old model,'
'you should move the files to `../rad` and update'
'the `scenes` and `rif` files. The current scenes'
'file is:'
*enditem
              CALL PHELPD('visu-rad-warning',7,'-',0,0,IER)
*item visualz
'A Radiance scene file specifies the composition of the'
'model for Radiance as well as the purpose of various'
'scenes (general viewing, daylight appraisal etc.).'
*enditem
          CALL EASKS(ltmp,' Radiance scene file for this model?',
*item visualz
' CLICK here when you have finished with the'
' colour rendering module.'
*enditem
        CALL PHELPD('e2r finished menu',2,'-',0,0,IER)
*subroutine globaltransform
*item globaltransform
'You have rotated the zone and probably also'
'want to rotate the sensors to match.'
*enditem
                call askok('Transform MRT sensors of',outs,OK,dok,2)
*item globaltransform
'You rotated the zone(s) and so will probably'
'also want to rotate associated obstructions.'
*enditem
              call askok(outs,' ?',OK,dok,2)
*item globaltransform
'You rotated the zone(s) and so will probably'
'also want to rotate associated obstructions.'
*enditem
                call askok(outs,' ?',OK,dok,2)
*subroutine globalrotate
*item globalrotate
'You already rotated the zone, you will most'
'likely want to rotate MRT sensors for the '
'zone as well. '
*enditem
                call askok('Rotate MRT sensors of',outs,OK,DOK,3)
*item globalrotate
'You rotated the zone and so will probably'
'want to rotate the solar obstructions which'
'are associated with it as well. '
*enditem
              call askok(outs,' ?',OK,dok,3)
*item globalrotate
'You rotated the zone and so will probably'
'want to rotate the solar obstructions which'
'are associated with it as well. '
*enditem
                call askok(outs,' ?',OK,dok,3)
*subroutine EDCON
*item EDCON
'In scanning the geometry it was found that many of '
'the surfaces have not been attributed as to their '
'construction type.  It is recommended that you: '
'  '
'  a) go to the  `geometry browse & edit` facility and'
'     attribute the surface construction types - after'
'     which you can return to this facility,'
'  '
'  b) in the case of an existing `old or unattributed`'
'     zone construction file select the `Save` '
'     option in the following menu. '
*enditem
        CALL PHELPD('unknowns atrib in constr',11,'-',0,0,IER)
*item EDCON
'The zone construction file defines the thermo-'
'physical properties of the zone and is mandatory.'
*enditem
        CALL EASKS(LTMP,' Zone construction file? ',' ',
*item EDCON
'Unless there is control on optical properties, the'
'best way to proceed is to recreate via geometry'
*enditem
          CALL EASKABC(outs,'Options:',
*item EDCON
'The construction file does not exist, or was not'
'found, please create/rereference this file.'
*enditem
          CALL PHELPD('file error',2,'-',0,0,IER)
*item EDCON
*enditem
          CALL EASKAB(outs,'Options:','respecify',
*item EDCON
'The opaque/transparent attribute of the surface is not'
'OPAQUE. If it is opaque then select `ok`.'
*enditem
          CALL ASKOK(outs,'Confirm surface is opaque?',OK,DOK,2)
*item EDCON
'A TMC file holds optical properties for transparent'
'surfaces within a zone as well as the definition of'
'any control of blinds associated with such surfaces.'
'Specify name of *.cfc file which will store the CFC'
'input data for this zone.'
*enditem
        CALL EASKS(ltmp,'CFC file name?',
*item EDCON
'Complex Fenestration Construction (CFC)'
'A CFC allows for a more accurate treatment of'
'modeling windows with or without shading devices.'
'A CFC surface has the following attributes:'
' '
'-Exterior, vertical surface (IE=0)'
'-Each glazing/shading layer is separated by gas gap'
'-Currently limited to one shading layer per CFC'
' '
'For an example of usage of CFCs see'
'"Appendix F: CFC User Reference" from'
'http://uwspace.uwaterloo.ca'
'/bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
'The Glazing Shading Layer editor (GSLedit) used for'
'importing CFC input properties can be downloaded from'
'the ESRU website, downloads section.'
*enditem
        CALL PHELPD('CFC instructions',19,'-',0,0,IER)
*item EDCON
'The surface attributes within the zone geometry file,'
'in conjunction with the Constructions db, allow the'
'specific thermo-physical properties to be saved within'
'the model definition.'
' '
'The recommended procedure is to attribute surfaces'
'using the geometry editing facility before creating'
'the zone contructions file.'
' '
'Surfaces which are composed of transparent materials'
'will have optical properties defined from either'
'the optical database or by manual input. If there'
'is a mismatch between information in a zone TMC'
'file and existing surface attributes then you will be'
'asked to confirm the correct choice.'
' '
'Optical properties can have scheduled controls which'
'allow an alternative optical property to be used based'
'on the following sensd parameters:'
' a) time - alternative optics are used during a'
'    specific period of the day'
' b) total radiation on the outside face of a zone'
'    surface - you specify a radiation level (W/m^2)'
'    above which the alternate optical propertiess'
'    are used.'
' c) ambient temperature - you specify a temperature'
'    above which the alternative optical properties'
'    are used.'
' d) zone air temperature - you specify the temperature'
'    above which the alternative optical properties'
'    are used.'
' e) lux level - you specify the lux level above which'
'    the alternative optical properties are used.'
'    '
'Note that there can be up to 8 control periods during'
'a day and that all days within the simulation are treated'
'the same).'
' '
'The alternative optical propetry set must relate to the'
'same number of material layers as the original set. It'
'is a good idea to prepare the alternative set using the'
'the Optical Properties db management facility prior to'
'using the transparent properties facility in this menu.'
' '
'Control of optical properties can be used to approximate'
'the closing of window blinds and shutters.'
' '
'If the model has an air flow network you might also'
'wish to control any flow components associated with'
'transparent surfaces that have optical property control.'
'Note however that the air flow control logic is'
'different from optical property control logic so care'
'is required to ensure that they operate together as'
'The Project Manager thinks that there have been recent'
'changes to either surface attributes or constructions'
'that have not been saved. To be safe agree to saving'
'these changes.'
*enditem
          CALL ASKOK('Save changes in surface attributes or',
*item EDCON
*enditem
        CALL PHELPD('zone geom file section',54,'-',0,0,IER)
*item EDCON
'This facility currently requires that you use an'
'external text editor to add information to the zone'
'constructions file to define linear dependencies.'
'Please contact your administrator for information on'
'how to do this.'
' '
'The linear facility identifies which layers in the'
'model will have such dependencies applied.'
' '
'A non-linear property facility is also available'
'from the above menu.'
*enditem
        CALL PHELPD('linear properties',11,'-',0,0,IER)
*item EDCON
'The current construction data will be placed in a'
'file. If this is the same name as the source file'
'then it will be overwritten.'
'In addition, details of surfaces which are transparent'
'will be place in a separate zone TMC file. '
*enditem
        CALL PHELPD('zone constr file save',5,'-',0,0,IER)
*item EDCON
*enditem
        CALL EASKS(SFILE,' New construction file? ',
*item EDCON
'Check that you have permission to update the zone'
'construction and/or optics files and that you have'
'sufficient disk space. '
*enditem
          CALL ASKOK(
*item EDCON
'ESP-r thinks that there are recent changes that have'
'not yet been saved to file. Information might be lost'
'if you do not save the changes. '
*enditem
        CALL ASKOK('Save zone geometry to reflect recent changes',
*subroutine EDSCON
*item EDSCON
'This is a display of the surface attributes which may'
'be edited.  Most are selections from existing database'
'  '
'You are allowed to modify the thermophysical proper-'
'ties of the layers BUT BE CAREFUL.  Manual editing'
'may be overwritten by subsequent file re-attrubution.'
' '
'RATHER create additional multilayer constructions'
'for each unique case and use them as attributes.   '
'DO NOT CHANGE the TOPOLOGY (ie. move air gaps around)'
'here - do it in the mlc database.'
*enditem
        CALL PHELPD('surface details',12,'-',0,0,IER)
*item EDSCON
'The choice of using an opaque or transparent construction'
'is dependent on the optical properties. Where there is a'
'mix of opaque and transparent layers the construction'
'should be marked transparent.'
' '
'For a more exact treatment of windows that may include'
'slat type operable blinds, choose Complex Fenestration'
' '
'After selecting TRAN you will be asked for further '
'information. '
*enditem
        CALL EASKABCD('Select a type for the surface.',' Surface type',
*item EDSCON
'The infrared emissivity is normally 0.1 < x < 0.9'
*enditem
        CALL EASKR(EMISI(ISUR),' ','Inside emissivity  ?',
*item EDSCON
*enditem
        CALL EASKR(EMISE(ISUR),' ','Outside emissivity ?',
*item EDSCON
'The short wave absorptivity is normally 0.1 < x < 0.9'
*enditem
        CALL EASKR(ABSI(ISUR),' ',' Inside absorptivity ? ',
*item EDSCON
*enditem
        CALL EASKR(ABSE(ISUR),' ',' Outside absorptivity? ',
*item EDSCON
'WARNING: You are allowed to modify the properties'
'of the layers BUT NOT CHANGE the TOPOLOGY (ie.'
'move air gaps around) - do that in the multi-layer '
'construction database facility.  Quality assurance'
'is enhanced if you use the multilayer construction'
'facility rather than editing entities here. '
*enditem
          CALL PHELPD('surface details',6,'-',0,0,IER)
*item EDSCON
'The conductivity can vary from about 0.03 W/(mK) for'
'insulation to about 200 W/(mK) for copper'
' '
'The density can vary from about 30 kg/m^3 for'
'insulation to about 8900 kg/m^3 for copper'
' '
'Specify the specific heat in J/(kgK)'
' '
'Specify the thickness of the layer (m)'
*enditem
        CALL EASKS(HOLD,
*item EDSCON
'Enter air gap resistance.'
'Typically this is 0.18 m^2K/W for a cavity wall'
*enditem
            CALL EASKR(VAL,' ',' Air gap resistance ? ',
*subroutine EDZCON
*subroutine MKTWIN
*item MKTWIN
' The TMC file does not exist, or was not found, '
'please create / rereference this file individually.'
*enditem
        CALL PHELPD('file error',2,'-',0,0,IER)
*subroutine EDTWIN
*item EDTWIN
*enditem
          CALL EASKAB(outs,' do you want to:','switch to opaque',
*item EDTWIN
'Supplying optical properties if you know the angular'
'transmission and absorption data. '
*enditem
          CALL EASKABC(outs,' Do you want to: ',
*item EDTWIN
'You interupted the specification. If you want to start'
'again say yes or if you want to not have optical controls'
'say no and the data will be cleared. '
*enditem
        CALL ASKOK('Try again to define the optical control?',
*item EDTWIN
'There is a surface attribute that indicates that an'
'existing optical control. You have the following '
'options: '
' a) remove this optical control '
' b) edit the current optical control'
' c) continue with out changing this control'
' '
'Hint - scroll the text feedback backwards to see the'
'current optical control details. '
*enditem
          CALL EASKABC(outs,' ','remove this optical control',
*item EDTWIN
'There is a surface attribute that indicates that an'
'optical control could be defined. To do it say `yes`. '
*enditem
          CALL ASKOK(OUTS,'optical control?',OK,dok,2)
*item EDTWIN
'Up to 8 control periods are allowed.'
*enditem
        CALL EASKI(N1,' ','Number of control periods?',
*item EDTWIN
'The position of the sensor may be as follows.'
' * each transparent surface has its own'
'   sensor (default);'
' * one user defined external surface will'
'   contain the sensor for all surfaces which'
'   use this particular TMC type;'
' * one user defined internal Daylight Coefficient'
'   sensor is employed.'
*enditem
        CALL EASKAB(' ','Transparent surfaces controlled by:',
*item EDTWIN
*enditem
          CALL EASKI(N2,' ','Surface for common sensor location?',
*item EDTWIN
'Control period starting and ending times should'
'define consecutive periods.'
*enditem
          CALL EASKR(VAL,outs,' Begin at hour: ',
*item EDTWIN
*enditem
          CALL EASKR(VAL,outs,' End at hour  : ',
*item EDTWIN
'Surfaces composed of transparent constructions'
'will have optical properties defined from either'
'the Optical Properties db or by manual input. If'
'there is a mismatch between information in a zone'
'TMC file and existing surface attributes then you'
'will be asked to confirm the correct choice.'
' '
'Optical properties can have scheduled controls which'
'allow an alternative optical property to be use based'
'on the following sensed parameter:'
' a) time - alternative optics are used during a'
'    specific period of the day;'
' b) total radiation on the outside face of a'
'    surface in the zone - you specify a radiation'
'    level (W/m^2) above which the alternate optical'
'    properties will be used;'
' c) ambient temperature - you specify a temperature'
'    above which the alternative optical properties'
'    will be used;'
' d) zone air temperature - you specify the'
'    temperature above which the alternative optical'
'    properties will be used;'
' e) lux level - you specify the lux level above'
'    which the alternative optical properties will'
'    be used. Two alternative lux calculation'
'    approaches are offered.'
' '
'Note: there can be up to 8 control periods in a'
'day (all days within the simulation will be treated'
'the same).'
' '
'The alternative optics must correspond to the same'
'number of layers as the initial set. It is a good'
'idea to prepare the alternative properties via the'
'Optical Properties db management facility prior to'
'using the transparent properties facility here.'
' '
'Control of optical properties can be used to'
'approximate closing blinds/shutters and shading'
' '
'If the model has an air flow network you might also'
'think about controlling any air flow components'
'associated with any transparent surfaces that have'
'been assigned optical property control. Note however'
'that the air flow control logic is different from'
'the optical property control logic so some care and'
'testing is required to ensure that optical and flow'
'control works together.'
*enditem
            call EASKATOG('Controlled on:','(currently time)',
*item EDTWIN
*enditem
            call EASKATOG('Controlled on:','(currently radiation)',
*item EDTWIN
*enditem
            call EASKATOG('Controlled on:','(currently ambient temp.)',
*item EDTWIN
*enditem
            call EASKATOG('Controlled on:','(currently zone temp.)',
*item EDTWIN
*enditem
            call EASKATOG('Controlled on:','(currently daylight coef)',
*item EDTWIN
*enditem
            call EASKATOG('Controlled on:','(currently Lightswitch)',
*item EDTWIN
*enditem
            call EASKATOG('Controlled on:','(currently undefined)',
*item EDTWIN
*enditem
            CALL EASKR(VAL,' ','Radiation set point?',
*item EDTWIN
*enditem
            CALL EASKR(VAL,' ','Ambient temp. set point?',
*item EDTWIN
*enditem
            CALL EASKR(VAL,' ','Zone temp. set point',
*item EDTWIN
*enditem
            CALL EASKR(VAL,' ','Lux set point',
*item EDTWIN
*enditem
            CALL EASKR(VAL,' ','Lightswitch lux set point?',
*subroutine EOPTKS
*item EOPTKS
'Manual data input will ask for the direct transmission'
'at each angle as well as absorption characteristics for'
'layer. Using data from an optical database simplifies '
'the process. '
*enditem
      CALL EASKAB(' Get optical properties from: ',' ',
*item EOPTKS
'The simulation of radiation transmission through '
'glazing is angular dependent.  Five angles are '
'used: 0 (normal), 40, 55, 70 & 80 degrees and the'
'data can be obtained via program win.'
*enditem
      CALL EASKS(HOLD,' Direct trans @ 0 40 55 70 80 degrees: ',
*item EOPTKS
'The visible transmittance at normal incidence is'
'used for daylighting calculations.'
*enditem
      CALL EASKR(VTRN,' ',' Visible transmittance: ',
*item EOPTKS
'This is almost always equal to that of the associated'
'multilayer construction. Layers index (outside=1).'
'If you cancel you will be taken back to the start'
'of the editing sequence. '
*enditem
        CALL EASKI(NTLT,' ',
*item EOPTKS
'The simulation of radiation transmission through '
'transparent constructions requires that the short-'
'wave absorptance at each layer (including air gaps)'
'is defined for five angles of incidence: '
'  0 (normal), 40, 55, 70 & 80 degrees '
'This data can be obtained via program window.'
'The values for an air gap are usually: '
'   0.001, 0.002, 0.003, 0.004, 0.005 '
*enditem
          CALL EASKS(HOLD,outs,'  ',
*subroutine scntcnst
*subroutine ELISTMAT
*item ELISTMAT
'The classifications shown in the display include up to'
'18 materials. To get a listing of the items included'
'select one of the classifications.'
*enditem
        CALL PHELPD('materials menu',3,'-',0,0,IER)
*item ELISTMAT
'You may select one or more classes to list. '
*enditem
        CALL EPICKS(INPIC,ICLSSEL,' ',' Which classes to list:',
*item ELISTMAT
' Summary reporting can be shown in the text feedback'
' or a text file.'
*enditem
        CALL EASKABC(' Reporting to:',' ',
*item ELISTMAT
'This description may be up to 32 char. '
*enditem
          CALL EASKS(t32,' Classification name (<32 char)?',' ',
*item ELISTMAT
'The information in this display is based on data from'
'a materials database.  Databases of this'
'type are used to build a construction database.'
'Data in this db rarely changes. However, users may '
'wish to add additional materials or classifications to'
'conform to materials in their region.  '
'  '
'Adding or Deleting a material is supported. The'
'former creates a material at the end of the current'
'classification which may then be edited.  You have'
'the choice of manually supplying the data or to'
'select two materials and give each a weighting'
'(useful for approximating ISO 6946 non-homogeneous'
'layers in constructions).'
' '
'You may copy an existing material into a new item at'
'the end of the list. BE SURE TO ALTER ITS NAME! '
'Recent changes to the materials database are held'
'in memory and might be lost if not saved to file.'
*enditem
            CALL ASKOK('Changes have been made in database. ',
*item ELISTMAT
'A classification has a descriptive name (up to '
'32 char).'
*enditem
          CALL EASKS(t32,' ',' Classification name (<32 char)?',
*item ELISTMAT
'Notes (<248 char) for this category of materials'
'are useful for descriptions that apply to all'
'the materials.'
*enditem
          CALL EASKS248(t248,'Category notes:',' ',
*item ELISTMAT
*enditem
          CALL PHELPD('materials database',17,'-',0,0,IER)
*item ELISTMAT
'You cannot recover a deleted material. You can add a'
'homogeneous or non-homogeneous material (type in the'
'new thermophysical values or you can derive a new'
'non-homogeneous material (repeating thermal bridges)'
'based on percentages of two existing materials for '
'use with ISO 6946:2007 section 6.2.4 lower limit '
'calculations. '
' '
'Note: currently the derivation only works with two'
'solid materials. If air is in the layer then its'
'air gap resistance needs to be converted into an'
'equivalent thermal conductivity. The 6946 spec'
'applies to pairs of materials which do not differ'
'greatly in conductivity and thus is not applicable'
'for metal & insulation combinations. '
' '
'The conductivity, density, spedific heat and vapour'
'properties will be weighted from the two sources.'
*enditem
          CALL EASKABCD(' ','Options: ','Delete existing material',
*item ELISTMAT
'Assuming there are two materials used in a layer of'
'a construction you will be asked for the percentage'
'(1-99%) for the first and second materials. '
*enditem
            CALL EASKR(PER1,' ','First material % in the layer: ',
*item ELISTMAT
'Assuming there are two materials used in a layer of'
'a construction you will be asked for the percentage'
'(1-99%) for the first and second materials. '
*enditem
            CALL EASKR(PER2,' ','Second material % in the layer: ',
*item ELISTMAT
'Last chance to abort the selection. '
*enditem
            CALL ASKOK(outs,'as your selection ?',OK,dok,1)
*subroutine EDONEMAT
*item EDONEMAT
'This display shows the attributes of this material.'
'The attributes vary depending on the source of the '
'material (legacy materials have fewer attributes). '
' '
'Some attributes (e.g. single layer optics) will be '
'used in a future ESP-r version but are required for'
'expport to other assessment tools. '
' '
'Edit by selecting an item. '
'Recent changed to materials are held in memory '
'and if you say no then edits will be discarded. '
*enditem
          CALL ASKOK(' ','Accept changes in material (see help)?',
*item EDONEMAT
'A descriptive name (up to 32 char) is required.'
'This will appear in selection lists (but might be'
'be shown in a truncated form in some locations). '
*enditem
        CALL EASKS(tnam,' ',' Description of material? ',
*item EDONEMAT
'Documentation (up to 248 char) is a really good idea'
'and might include the source and test regime etc.'
*enditem
        CALL EASKS248(tdoc,' ',' Documentation for material? ',
*item EDONEMAT
'Conductivity units are W/(m deg.C) '
*enditem
        CALL EASKR(DBCON,' ',' Conductivity (W/(m deg.C): ',
*item EDONEMAT
'Density units are  kg/m**3 '
*enditem
        CALL EASKR(DBDEN,' ',' Density (kg/m**3): ',
*item EDONEMAT
'Specific Heat units are J/(kg deg.C) '
*enditem
        CALL EASKR(DBSHT,' ',' Specific heat (J/(kg deg.C): ',
*item EDONEMAT
'Surface emissivity is based on infrared band. '
'It is specified as fraction 0.01 < x < 0.99 '
'This legacy material will have the same value '
'for the inside and outside face. '
*enditem
          CALL EASKR(EOUT,' ',' Surface emissivity : ',
*item EDONEMAT
'Surface emissivity is based on infrared band. '
'It is specified as fraction 0.01 < x < 0.99 '
'You may specify different values for each face '
'(but ESP-r does not yet use this). '
*enditem
          CALL EASKR(EOUT,' ',' Outside face emissivity : ',
*item EDONEMAT
'Surface emissivity is based on infrared band. '
'It is specified as fraction 0.01 < x < 0.99 '
'This legacy material will have the same value '
'for the inside and outside face. '
*enditem
          CALL EASKR(EIN,' ',' Surface emissivity : ',
*item EDONEMAT
'Surface emissivity is based on infrared band. '
'It is specified as fraction 0.01 < x < 0.99 '
'You may specify different values for each face '
'(but ESP-r does not yet use this). '
*enditem
          CALL EASKR(EIN,' ',' Inside face emissivity : ',
*item EDONEMAT
'Surface absorptance is based on solar band. '
'It is specified as fraction 0.01 < x < 0.99 '
'This legacy material will have the same value '
'for the inside and outside face. '
*enditem
          CALL EASKR(AOUT,' ',' Surface absorptance: ',
*item EDONEMAT
'Surface absorptance is based on solar band. '
'It is specified as fraction 0.01 < x < 0.99 '
'You may specify different values for each face '
'(but ESP-r does not yet use this). '
*enditem
          CALL EASKR(AOUT,' ',' Outside face absorptance: ',
*item EDONEMAT
'Surface absorptance is based on solar band. '
'It is specified as fraction 0.01 < x < 0.99 '
'This legacy material will have the same value '
'for the inside and outside face. '
*enditem
          CALL EASKR(AIN,' ',' Surface absorptance : ',
*item EDONEMAT
'Surface absorptance is based on solar band. '
'It is specified as fraction 0.01 < x < 0.99 '
'You may specify different values for each face '
'(but ESP-r does not yet use this). '
*enditem
          CALL EASKR(AIN,' ',' Inside face absorptance: ',
*item EDONEMAT
'Vapour resistvity for vapour transfer has units'
'of MNs g^-1m^-1. Used to support assessments of'
'condensation within constructions. '
*enditem
        CALL EASKR(dbdrv,' ','Vapour resistvity (MNs g^-1m^-1): ',
*item EDONEMAT
'Thickness (mm) is the typical/default thickness of this'
'material. '
*enditem
        CALL EASKR(THICK,' ',' Default thickness (mm) : ',
*item EDONEMAT
'Legacy opaque was imported from an older materials'
'database and only contains essential data. '
' '
'Opaque will have option of additional parameters. '
' '
'Transparent includes single layer optics such as '
'used by WIS and Window5.1 etc. '
' '
'There are two types of gas (work in progress): '
' Data with T correction to match data model of'
' the UK Energy Performance Directive'
' '
' Data (viscosity, conductivity, density, CP at'
' 4 temperature points.'
*enditem
        CALL EASKATOG('Material options:',message,
*item EDONEMAT
'Longwave transmittance units (-) between 0.0 & 1.0'
*enditem
            CALL EASKR(IRTRAN,' ','Longwave transmittance (-): ',
*item EDONEMAT
'Solar transmittance units(-) between 0.0 & 1.0'
*enditem
            CALL EASKR(SOLDRTRN,' ','Solar direct transmittance (-): ',
*item EDONEMAT
'Solar reflectance units are (-) between 0.0 and 1.0'
'The outside face is farthest from zone air.'
*enditem
            CALL EASKR(soldrotrfl,' ',
*item EDONEMAT
'Solar reflectance units are (-) between 0.0 and 1.0'
'The inside face is nearest the zone air.'
*enditem
            CALL EASKR(soldrinrfl,' ',
*item EDONEMAT
'Visible transmittance units are (-) between 0.0 & 1.0'
*enditem
            CALL EASKR(vistran,' ','Visible trans (-): ',
*item EDONEMAT
'Visible reflectance units are (-) between 0.0 and 1.0'
'The outside face is farthest from zone air.'
*enditem
            CALL EASKR(visotrfl,' ',
*item EDONEMAT
'Visable reflectance units are (-) between 0.0 and 1.0'
'The inside face is nearest the zone air.'
*enditem
            CALL EASKR(visinrfl,' ',
*item EDONEMAT
'Colour rendering units are (?) between 0.0 & 100.0'
'<<more text to be added...>>'
*enditem
            CALL EASKR(visinrfl,' ',
*item EDONEMAT
*enditem
        CALL PHELPD('material attributes',9,'-',0,0,IER)
*subroutine EDMLDB
*item EDMLDB
'The information in this display is based on data from'
'both a materials database and a construction database.'
'It is used to build zone construction files'
'according to the construction name associated with'
'each surface.'
'  '
'Note that the reporting level influences the detail '
'in this display and you may wish to reset the'
'reporting level to see additional information.'
'  '
'Adding or Deleting constructions is supported. The'
'former creates a single layer construction at the end'
'of the list which may then be edited. '
' '
'You may copy an existing construction into a new item at'
'the end of the list. Be sure its name is unique! '
' '
'To cope with non-symmetrical partitions you may wish'
'to use the copy & invert function.'
'Recent changed to constructions are held in memory '
'and might be lost if not save to file. '
*enditem
          CALL ASKOK(' ','Save recent changes to constructions db?',
*item EDMLDB
*enditem
        CALL PHELPD('construction db',19,'-',0,0,IER)
*item EDMLDB
'In order to reflect changes you have made in this db'
'in the current model you will have to rebuild the '
'zone construction and tmc files.   '
' '
'This option will be presented to you when you exit'
'the database management session. '
*enditem
        CALL PHELPD('construction db save',6,'-',0,0,IER)
*item EDMLDB
'The list of MLC database entries can be sent to a'
'text file or displayed.  Optical properties are'
'included in detailed files or if the reporting level'
'has been set to verbose. '
*enditem
        CALL EASKABCD(' Reporting to:',' ',
*item EDMLDB
'Copies of exsiting constructions should have unique '
'names. Before deleting a construction check that no '
'surfaces use this attribute. '
' '
'The copy and invert function is useful where nonsymmetric'
'constructions are used in partitions. For example, in'
'the case of a raised floor system from the point of view'
'of the room the carpet is on the inside face and from the'
'point of view of the floor void the carpet should be on '
'the outside face. '
*enditem
        call easkatog('Constructions options:',' ',
*item EDMLDB
'Although you only have 12 characters to work with'
'try and create a useful name for the construction'
'that is not a duplicate of an existing name. '
*enditem
          CALL EASKS(T14,' ',' Name of construction? ',
*item EDMLDB
'Last chance to abort removal of construction. '
*enditem
          CALL ASKOK(' ',' Are you sure? ',OK,dok,1)
*item EDMLDB
'Each construction in the database should have a unique'
'name. Please edit the name (12 character or less) with'
'no spaces or unprintable characters. '
*enditem
          CALL EASKS(T14,' ',' Name of new construction (<12 char)?',
*item EDMLDB
'Typically the original and interted constructions have'
'similar names with one indicating its inverted state.'
'The name should be less than or equal to 12 characters'
'and not use spaces or unprintable characters. '
*enditem
          CALL EASKS(T14,'Name of inverted construction (<12 char)?',
*item EDMLDB
 'Although g-values for transparent glazings are not used'
 'in ESP-r is is possible to report these in accordance '
 'with Test G5 TM33:2006 CIBSE. '
 'You will be required to provide for each pane its  '
 'transmittance and reflectance (both in the direction of'
 'incident radiation and against it)'
 'Single/double and triple glazings are supported '
 'G-value calculations are currently restricted to '
 'air or gas filled triple glazings which are symmetric'
'in construction'
*enditem
        CALL PHELPD('G-value for tran construction',10,'-',0,0,IER)
*item EDMLDB
'In order to calculate G-value ESP-r needs values for'
'trnt   = transmittance of the pane,'
'ref    = reflectance of this pane in direction of'
'         incident radiation'
'o-ref  = reflectance of this pane in direction '
'         opposite incident radiation'
'ems    = emissivity of this pane in direction of'
'         incident radiation'
'o-ems  = emissivity of this pane in direction '
'         opposite incident radiation'
' '
'Choose CIBSE TM33:2006 prescribed values or   '
'define your own'
'Note that low emissivity glass has been inverted'
'because it is always the 2nd pane for TM33'
*enditem
            CALL EPICKS(INPICK,IVALS,PROMP1,PROMP2,
*item EDMLDB
*enditem
              CALL EASKS(T72,
*subroutine EDWALL
*item EDWALL
'A construction is composed of between one and eight'
'layers (three of which may be air gaps). Each layer'
'has a thickness and is composed of one material. '
'The thermophysical properties of each layer are based'
'on data in the current materials database.'
'  '
'Instances of the data for this construction will be'
'inserted in the zone construction file. To ensure'
'model quality, avoid further editing of the zone con-'
'struction files (create more constructions if you need'
'variant thermophysical properties).'
' '
'Current options allow one layer at a time to be added'
'to the end of the list or inserted into the list. You'
'may also delete one layer at a time.  If you alter a'
'construction you will be asked (later) if you want to'
'update the zone construction files.'
'  '
'Note: layer 1 is considered the `outside`.'
'  '
'The terms SYMMETRIC and NONSYMMETRIC have the following'
'meaning: SYMMETRIC constructions can be referenced from'
'either zone associated with a partition; a NONSYMMETRIC'
'construction must have an `inverted` version in the'
'database in the case of surfaces which are partitions.'
' '
'In ESP-r air gaps in constructions are represented as'
'a fixed resistance to heat flow (depending on the orien-'
'tation of the surface using the construction). The R'
'value supplied should account for the resistance across'
'the cavity (including the impact of low emissivity'
'at the adjacent solid layers).'
' '
'Air gaps are assumed not to have air movement. If the'
'cavity is ventilated you might have to represent it as'
'a thermal zone and include it in an air flow network.'
'The current construction is linked to a reversed '
'version of itself. You will want to keep these in'
'sync with each other. '
*enditem
            CALL ASKOK(outs,'Update the linked construction as well?',
*item EDWALL
*enditem
       CALL PHELPD('construction editing',36,'-',0,0,IER)
*item EDWALL
'You can delete an existing layer, append a new layer '
'at the `inside face` of the surface (remember the '
'order is other-side to zone-side), or insert a layer'
'(you will be asked to select a point of insertion and'
'existing inner layers will be shifted).'
' '
'If you cancel no changes will be made in the mode. '
*enditem
        CALL EASKABCD(' Layer options: ',' ',' Delete',
*item EDWALL
'Any one of the layers may be selected.'
*enditem
          CALL EPICKS(IX,imlay,' ',' Layer to delete: ',
*item EDWALL
'Any one of the layers may be selected.'
*enditem
              CALL EPICKS(IX,imlay,' ',' Point of insertion: ',
*item EDWALL
'If you want to keep the current material answer NO'
'otherwise you can find one by browsing the database.'
*enditem
            CALL ASKOK('Browse the materials db for a new material',
*item EDWALL
'If air is correct then accept, otherwise'
'reselect from the list or abort the task.'
*enditem
                CALL EASKABC('Your selection is `0` i.e. air. Options:',
*item EDWALL
'A set of default assumptions on the R value of'
'an air gap is requested, in case the construction '
'is used in different orientations.'
'This information will allow for the automatic'
'creation of zone construction files with sub-'
'stantially less user interaction.'
*enditem
              CALL EASKR(VAL,outs,
*item EDWALL
*enditem
              CALL EASKR(VAL,outs,
*item EDWALL
*enditem
              CALL EASKR(VAL,outs,
*item EDWALL
'The thickness of the layer is nominally between'
'1 mm and 300 mm. It is stored in the file as m.'
*enditem
            CALL EASKR(VAL,' ',' Layer thickness (mm): ',
*item EDWALL
'A descriptive name (up to 12 characters) is required.'
'Because the name is short it is a good idea to also'
'separately document what this name really means. '
*enditem
        CALL EASKS(T14,' ','Name of the construction?',
*item EDWALL
'In order to make cross checking easier the user is'
'asked to define the construction as either'
'OPAQUE or TRANSPARENT. A complex fenestration '
'construction, CFC, can also be chosen to model'
'windows with slat type operable blinds.'
*enditem
        CALL EASKABC(' ','Please choose one type :',
*item EDWALL
'Complex Fenestration Construction (CFC)'
'A CFC allows for a more accurate treatment of'
'modeling windows with or without shading devices.'
'A CFC surface has the following attributes:'
' '
'-Exterior, vertical surface (IE=0)'
'-Each glazing/shading layer is separated by gas gap'
'-Currently limited to one shading layer per CFC'
' '
'For an example of usage of CFCs see'
'"Appendix F: CFC User Reference" from'
'http://uwspace.uwaterloo.ca'
'/bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
'The Glazing Shading Layer editor (GSLedit) used for'
'importing CFC input properties can be downloaded from'
*enditem
          CALL PHELPD('CFC instructions',20,'-',0,0,IER)
*item EDWALL
'In order to allow for the optical properties to be'
'used in the model description and to be acted on'
'by control laws the relevant optical property id  '
'(from the optical properties db) is required.'
*enditem
          CALL PHELPD('optical selection',4,'-',0,0,IER)
*item EDWALL
'Could not recover that particular optical property'
'set. You might want to select a different one. '
*enditem
            CALL ASKOK(' ',' Not found... try again? ',OK,dok,2)
*item EDWALL
'This construction is not symmetrical and needs to '
'be linked to a reversed copy of itself if it is going'
'to be used as a partition between two zones. '
*enditem
          CALL ASKOK('Would you like to link this construction to',
*item EDWALL
'To change to a different material select it from the'
'the list within the current materials database.'
'If you need an air gap, choose one from the GAPS '
'category (you may be asked for the air gap resistance'
'values for various orientations of the construction.'
' '
'If you want to keep the current material just say NO.'
*enditem
        CALL ASKOK('Change the materials db reference via browsing',
*item EDWALL
'If air is correct then accept, otherwise'
'reselect from the list or abort the task.'
*enditem
            CALL EASKABC('Your selection is `0` i.e. air. Options:',
*item EDWALL
'A set of default assumptions on the R value of'
'an air gap is requested, in case the construction '
'is used in different orientations.'
'This information will allow for the automatic'
'creation of zone construction files with sub-'
'stantially less user interaction.'
*enditem
          CALL EASKR(VAL,outs,
*item EDWALL
*enditem
          CALL EASKR(VAL,outs,
*item EDWALL
*enditem
          CALL EASKR(VAL,outs,
*item EDWALL
'The thickness of the layer is normally between'
'0.001 m and 0.500 mm. It is held in the file as'
*enditem
        CALL EASKR(VAL,' ',' Layer thickness (mm): ',
*subroutine allmat
*item allmat
'This menu allows existing materials to be viewed and'
'one of them selected.'
*enditem
        CALL PHELPD('materials section',2,'-',0,0,IER)
*subroutine EDDB
*item EDDB
'ESP-r is provided with standard databases located at'
'For some simulation models a user may'
'require a bespoke version of a database.  In such a'
'case the user may either copy a standard database'
'into a local directory for modification or simply begin'
'from scratch.'
' '
'In most cases a bespoke database may be created by'
'copying a standard database into the project'
'directory (hint: give it a name identifiable with'
'the project) and then modifying it to fit the needs'
'of the project.'
' '
'Initially the database names will correspond to'
'the defaults supplied by ESRU.  If these defaults'
'are not found, the most likely reason is that they'
'have not been correctly installed in the file path'
'given at the top of this message.'
'Recent changes in database file names need to be'
'recorded in the model if the correct databases are'
'to be accessed in the future. If you do not update'
'the model configuration other dependencies might be'
'left unresolved. '
' '
'If you are have not quite finished work on your'
'databases (e.g. you are creating an alternative)'
'you might wish to delay updating the model. '
*enditem
          CALL ASKOK(
*item EDDB
'Recent changes to the materials, constructions'
'or optical databases may make the zone files '
'out-of-date. If you want these changes to be '
'reflected in the zone files say yes. '
*enditem
              CALL ASKOK(
*item EDDB
*enditem
        call phelpd('databases overview',19,'-',0,0,IER)
*item EDDB
'Information on each databases is provided.'
*enditem
        call easkatog(' ','Help options:','overview','climate',
*item EDDB
'ESP-r is provided with standard databases located at'
'Where a model requires a bespoke version of a'
'database, the user may either copy a standard database'
'into a local directory and modify it or create a new'
'database from scratch.'
*enditem
          CALL PHELPD('databases overview',7,'-',0,0,IER)
*item EDDB
'Climate databases contain hourly parameters over the'
'period 1h00 on 1 Jan to 24h00 on 31 December (i.e. no'
'leap years). Where data is supplied for only one or'
'more parts of this period, the remaining data will be'
'set to zero. The parameters required for each hour are'
'as follows.'
' '
' 1. Diffuse horizontal solar intensity (W/m^2).'
' 2. Dry bulb temperature (tenths degC, i.e. 102 ='
'   10.2degC).'
' 3. Direct normal solar intensity (W/m^2). As an'
'    alternative, global horizontal intensity may be'
'    used in which case a corresponding db flag must'
'    be set.'
' 4. Wind speed (tenths m/s, i.e. 15 = 1.5 m/s).'
' 5. Wind direction (clockwise degrees from North.'
' 6. Relative humidity (%).'
' '
'When using these climate parameters ESP-r will'
'assume that the data represents the one hour period'
'centered on the hour in question. Where sub hour'
'simulation time steps are used, interpolation is'
' '
'The database is held in binary format to allow random'
'access. Conversion to an ASCII format is supported to'
'allow transfer between different operating systems.'
*enditem
          CALL PHELPD('climate overview',26,'clm_dbitems ',0,0,IER)
*item EDDB
'The Materials database holds the density, specific'
'heat, conductivity, diffusion resistance and surface'
'absorptivity and emissivity of products such as brick,'
'concrete, metal, wood and so on.'
' '
'The database is held in binary format to allow random'
'access. Conversion to an ASCII format is supported to'
'allow transfer between different operating systems.'
*enditem
          CALL PHELPD('materials db overview',8,'materials_db',0,0,IER)
*item EDDB
'The Constructions database defines the composition of'
'walls, floors, roofs etc in terms of layer ordering,'
'thickness and material. Where the construction is'
'transparent a named set of optical properties, as held'
'in the Optical Properties database, is associated.'
*enditem
          CALL PHELPD('constr db overview',5,'mlc_database',0,0,IER)
*item EDDB
'The Optical Properties database holds the solar'
'transmissivity and absorptivity for each layer within'
'a transparent construction and for 5 angles of'
'incidence - 0 (normal), 40, 55, 70 and 80 degrees.'
*enditem
          CALL PHELPD('optics overview',4,'optical_db',0,0,IER)
*item EDDB
'The Plant Ccomponents database holds data defining'
'individual plant components for assembly into networks'
'defining particular systems of arbitrary complexity.'
' '
'The database is held in binary format to allow random'
'access. Conversion to an ASCII format is supported to'
'allow transfer between different operating systems.'
*enditem
          CALL PHELPD('plant db overview',7,'plant_db_fld',0,0,IER)
*subroutine opendb
*item opendb
'It is likely that the Materials db associated with'
'this model is for use under a different operating'
'system. ESP-r will attempt to locate an ASCII version'
'of this database and, if successful, convert it to'
'the required binary format if you agree.'
'The Materials db holds the thermo-physical properties'
'of a range of materials. An ascii version of this db'
'may be used to transfer the contents between operating'
'systems that have incompatible binary representations'
'(e.g. Unix and Windows).'
*enditem
            CALL EASKS(LASCI,' ','Materials database (ASCII)?',
*subroutine EDDBMATERIAL
*item EDDBMATERIAL
'The Materials database holds the density, specific'
'heat, conductivity, diffusion resistance and surface'
'absorptivity/emissivity for materials such as brick'
'concrete, wood, metal etc. Older versions of thie db'
'were held in binary format and newer models tend to'
'use an ASCII version of the file and support additional'
'attributes. Conversion options between ascii and binary'
'versions are available.'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database '
'   and if you have permission to update the file you'
'   can edit the entities in the database.'
' '
'b) select another file: you will asked for a file'
'   name and if it is found you can browse or edit it.'
' '
'c) make a new database: a new database will be created '
'   based on the file name you supply.'
' '
'd) copy default database: a project copy of the default'
'  database will be made and you will be offered a '
'  chance to rename it.'
' '
'e) Convert a binary representation of the db (which is'
'   platform dependant) to an ASCII representation.'
' '
'f) Convert an ascii representation of the db to a'
'   binary representation (NOTE THIS IS ONLY for'
'   LEGACY models and is depreciated).'
' '
'g) browse ../dbs allows you to look in the model ../dbs'
'  folder for alternative optics files. If you do not'
'  find anything the previous value will be restored.'
' '
'h) browse distribution displays files in the databases'
'  folder of the ESP-r distribution. If you do not find'
'  anything the previous value will be restored.'
' '
'i) copy another database to the project allows you to'
' locate a database and get a project copy of it.'
'g) select a file (X11 only): edit the file name'
'   and if it is found you can browse or edit it.'
'   Hint: if you eventually want to copy that other file'
'   into the model folder first select it and then ask'
'   for a copy.'
' '
' '
' '
' '
' '
*enditem
        call MENUATOL('  ','Materials db',
*item EDDBMATERIAL
*enditem
        call MENUATOL('  ','Materials db',
*item EDDBMATERIAL
*enditem
        call MENUATOL('  ','Materials db',
*item EDDBMATERIAL
*enditem
        call MENUATOL('  ','Materials db',
*item EDDBMATERIAL
'The suggested name of this db is related to the'
'current project name.'
'The suggested name of this db is related to the'
'current project name.'
*enditem
        CALL EASKSCNCL(ltmp,' ','New materials db?',
*item EDDBMATERIAL
'A mostly empty materials database has been created'
'and it it useless until it has been populated with'
'data. If you have the information required you can'
'proceed with that task. '
*enditem
        CALL ASKOK(' ','Browse or edit new database?',OK,dok,4)
*item EDDBMATERIAL
'You are asked to confirm the source file for the'
'copy action. If this one is ok then accept it. '
*enditem
          CALL EASKXORGTKF(lguess,
*item EDDBMATERIAL
'The suggested name of this database is based on the '
'project name. '
*enditem
   66   CALL EASKS(LTMP,
*item EDDBMATERIAL
'This db is held as a binary representation for speed'
'of access. Supply the name of the binary file.'
*enditem
        CALL EASKSCNCL(LTMP,'Materials db (binary)?',' ',
*item EDDBMATERIAL
'This db is held as a binary representation for speed'
'of access. It is sometimes necessary to convert to'
'an ASCII representation, e.g. to facilitate manual'
'editing or implementation on an operating system that'
'uses a different binary representation.'
*enditem
        CALL EASKSCNCL(LTMP,'Materials db (ascii)?',' ',
*item EDDBMATERIAL
'An ascii (human readable) version of the Materials db'
'may be manually edited and is also convenient for'
'use in operating systems or computers that employ'
'different binary representations.'
' '
'NOTE: only older ASCII files can be converted to binary.'
'If you have a newer ASCII materials database the process'
'will fail. '
*enditem
        CALL EASKSCNCL(LTMP,'Materials db (legacy ascii)?',' ',
*item EDDBMATERIAL
*enditem
 143    CALL EASKSCNCL(ltmp,'Materials db (legacy binary)?',' ',
*item EDDBMATERIAL
'The Materials database holds the density, specific'
'heat, conductivity, diffusion resistance and surface'
'absorptivity/emissivity for materials such as brick'
'concrete, wood, metal etc. Older versions of thie db'
'were held in binary format and newer models tend to'
'use an ASCII version of the file and support'
'additional attributes.'
*enditem
        CALL EASKXORGTKF(LCOPY,'Materials db?',' ',
*item EDDBMATERIAL
*enditem
            CALL ASKOK('Is this file in the model ../dbs folder?',
*item EDDBMATERIAL
'The Materials database holds the density, specific'
'heat, conductivity, diffusion resistance and surface'
'absorptivity/emissivity for materials such as brick'
'concrete, wood, metal etc. Older versions of thie db'
'were held in binary format and newer models tend to'
'use an ASCII version of the file and support'
'additional attributes.'
*enditem
          CALL EASKF(LCOPY,' ','Materials db?',
*item EDDBMATERIAL
'The binary Materials db file could get corrupted.'
'It is good to have a backup to restore from and'
'this is held in ascii format.'
*enditem
        CALL EASKSCNCL(LTMP,
*subroutine EDDBPCDB
*item EDDBPCDB
'The plant components database is a binary, random '
'access file holding plant component descriptions to '
'enable the establishment of component state-space '
' representations used by ESP-r.'
' '
'If there is no such file then a new one will be'
'created to hold data for new components.'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database '
'   and if you have permission to update the file you'
'   can edit the entities in the database.'
' '
'b) select another file: you will asked for a file'
'   name and if it is found you can browse or edit it.'
' '
'c) make a new database: a new database will be created '
'   based on the file name you supply.'
' '
'd) copy default database: a project copy of the default'
'  database will be made and you will be offered a '
'  chance to rename it.'
' '
'e) browse ../dbs allows you to look in the model ../dbs'
'  folder for alternative optics files. If you do not'
'  find anything the previous value will be restored.'
' '
' f) browse distribution displays files in the databases'
'  folder of the ESP-r distribution. If you do not find'
'  anything the previous value will be restored.'
' '
' g) copy another database to the project allows you to'
' locate a database and get a project copy of it.'
'e) select a file (X11 only): edit the file name'
'   and if it is found you can browse or edit it.'
'   Hint: if you eventually want to copy that other file'
'   into the model folder first select it and then ask'
'   for a copy.'
' '
' '
' '
' '
' '
*enditem
        call MENUATOL('  ','Plant Components db',
*item EDDBPCDB
*enditem
        call MENUATOL('  ','Plant Components db',
*item EDDBPCDB
*enditem
        call MENUATOL('  ','Plant components db',
*item EDDBPCDB
*enditem
        call MENUATOL('  ','Plant Components db',
*item EDDBPCDB
'The suggested name of this database is based on the '
'project name. '
'The plant component database binary file holds the'
'description of available components. If the name'
'given matches an existing file, it will be read in'
'and the components data will be available for'
'listing and editing. If there is no such file then'
'a new one will be created to hold data for new'
*enditem
        CALL EASKSCNCL(ltmp,' ','Plant Components db?',
*item EDDBPCDB
'An empty plant component database has been created'
'and it it useless until it has been populated with'
'data. If you have the information required you can'
'proceed with that task. '
*enditem
        CALL ASKOK(outs,' Browse or edit new database?',OK,dok,4)
*item EDDBPCDB
'You are asked to confirm the source file for the'
'copy action. If this one is ok then accept it. '
*enditem
          CALL EASKXORGTKF(lguess,
*item EDDBPCDB
'The suggested name of this database is based on the '
'project name. '
*enditem
   66   CALL EASKS(LTMP,
*item EDDBPCDB
'The plant component database binary file holds the'
'description of available components. If the name'
'given matches an existing file, it will be read in'
'and the components data will be available for'
'listing and editing. If there is no such file then'
'a new one will be created to hold data for new'
*enditem
        CALL EASKXORGTKF(LCOPY,'Plant templates db?',' ',
*item EDDBPCDB
*enditem
            CALL ASKOK('Is this file in the model ../dbs folder?',
*item EDDBPCDB
'The plant component database binary file holds the'
'description of available components. If the name'
'given matches an existing file, it will be read in'
'and the components data will be available for'
'listing and editing. If there is no such file then'
'a new one will be created to hold data for new'
*enditem
          CALL EASKF(LCOPY,' ','Plant templates db?',
*subroutine EDDBPROFILE
*item EDDBPROFILE
 '   Events Database '
 ' '
 'Profiles in this database are currently used to'
 'assist in the defintion of zone operations.  The'
 'standard db are found in '
 'as either ASCII versions (ends with .a) or a binary'
 'version (depreciated).'
 ' The data requirements are summarised below :- '
' '
' for each profile - number of events.'
' '
' for each event - start and finish hours'
'                  percentage of first magnitude '
'                  percentage of second magnitude '
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database '
'   and if you have permission to update the file you'
'   can edit the entities in the database.'
' '
'b) Select from list (not available for events databases).'
' '
'c) Make a new database: a new database will be created '
'   based on the file name you supply. It will contain a'
'   minimal number of items and you can then modify this'
'   as required. '
'   Exercise care if you use a text editor to copy sets'
'   of data from another event profile database.'
' '
'd) copy default database: a project copy of the default'
'  database will be made and you will be offered a '
'  chance to rename it.'
' '
'e) binary -> ascii conversion saves current database '
'  to a computer independant form.'
' '
'f) ascii -> binary useful when you need to pass the model.'
'   to someone with an old version of ESP-r that only reads'
'   a binary version,'
' '
'g) browse ../dbs allows you to look in the model ../dbs'
'  folder for alternative profile files. If you do not'
'  find anything the previous name will be restored.'
' '
'h) browse distribution displays files in the databases'
'  folder of the ESP-r distribution. If you do not find'
'  anything the previous file will be restored.'
' '
'i) copy another database to the project allows you to'
' locate a database and get a project copy of it.'
'g) select a file (X11 only): edit the file name'
'   and if it is found you can browse or edit it.'
'   Hint: if you eventually want to copy that other file'
'   into the model folder first select it and then ask'
'   for a copy.'
' '
' '
' '
' '
' '
*enditem
        call MENUATOL('  ','Event Profiles db',
*item EDDBPROFILE
*enditem
        call MENUATOL('  ','Event Profiles db',
*item EDDBPROFILE
*enditem
        call MENUATOL('  ','Event Profiles db',
*item EDDBPROFILE
*enditem
        call MENUATOL('  ','Event Profiles db',
*item EDDBPROFILE
'The suggested name of this database is based on the '
'project name. '
'An event profiles db holds a schedule of patterns'
'over a day. When a new db is created in the model'
'it will be the ASCII version.'
*enditem
        CALL EASKSCNCL(ltmp,' ','Event Profiles db? (ASCII)',
*item EDDBPROFILE
'An empty profiles database has been created. It'
'is useless unless it is populated with data. If '
'you have the required data, use this facility '
'to do this.'
*enditem
        CALL ASKOK(outs,' Browse or edit database?',OK,dok,4)
*item EDDBPROFILE
'You are asked to confirm the source file for the'
'copy action. If this one is ok then accept it. '
*enditem
          CALL EASKXORGTKF(lguess,'Event Profiles db (source)?',' ',
*item EDDBPROFILE
'The suggested name of this database is based on the '
'project name. '
*enditem
  66    CALL EASKS(LTMP,
*item EDDBPROFILE
'The events db contains one or more descriptions of'
'profiles created via a diary entry format. This'
'otion converts from a legacy binary to an asci version'
'of the file.'
*enditem
        CALL EASKXORGTKF(LPRFDB,'Event Profiles db (source)?',' ',
*item EDDBPROFILE
'The events db contains one or more descriptions of'
'profiles created via a diary entry format. This option'
'allows you to convert an ASCII version to a binary'
'version of the file (if you need to pass the model to'
'someone with an older version of ESP-r that only deals'
'with binary versions).'
*enditem
        CALL EASKXORGTKF(LLASCI,
*item EDDBPROFILE
'Existing binary events db will be overwritten'
'with the data from the ASCII version. If you'
'want to use the binary file select it.'
*enditem
        CALL EASKXORGTKF(lbin,'Event Profiles db (binary)?',' ',
*item EDDBPROFILE
'An event profiles database holds named sets of profiles'
'in either a binary or ASCII representation.'
' '
'A local database folder (../dbs) is usually associated'
'with each model. '
*enditem
        CALL EASKXORGTKF(LCOPY,'Event Profiles db?',' ',
*item EDDBPROFILE
*enditem
            CALL ASKOK('Is this file in the model ../dbs folder?',
*item EDDBPROFILE
'An event profiles database holds named sets of profiles'
'in a binary representation. '
' '
'The ESP-r distribution includes alternatives to the'
'default which might be useful.'
*enditem
          CALL EASKF(LCOPY,' ','Event Profiles db?',
*subroutine EDDBMLCON
*item EDDBMLCON
'A (multilayer) construction database defines the com-'
'position of constructions such as walls and glazing'
'systems in terms of layers of materials of particular'
'thickness in a particular order and, where appropriate,'
'with a named set of optical properties. '
' '
'The following options can be selected:'
' '
' '
'a) If the file exists than you can browse the database '
'   and if you have permission to update the file you'
'   can edit the entities in the database.'
' '
'b) Select from list (not available for MLC databases).'
' '
'c) Make a new database: a new database will be created '
'   based on the file name you supply. It will contain a'
'   minimal number of items and you can then modify this'
'   as required. '
'   Exercise care if you use a text editor to copy sets'
'   of data from another MLC database.'
' '
'd) copy default database: a project copy of the default'
'  database will be made and you will be offered a '
'  chance to rename it.'
' '
'e) browse ../dbs allows you to look in the model ../dbs'
'  folder for alternative MLC files. If you do not'
'  find anything the previous value will be restored.'
' '
' f) browse distribution displays files in the databases'
'  folder of the ESP-r distribution. If you do not find'
'  anything the previous value will be restored.'
' '
' g) copy another database to the project allows you to'
' locate a database and get a project copy of it.'
'e) select a file (X11 only): edit the file name'
'   and if it is found you can browse or edit it.'
'   Hint: if you eventually want to copy that other file'
'   into the model folder first select it and then ask'
'   for a copy.'
' '
' '
' '
' '
' '
*enditem
        call MENUATOL('  ','Constructions db',
*item EDDBMLCON
*enditem
        call MENUATOL('  ','Constructions db',
*item EDDBMLCON
*enditem
        call MENUATOL('  ','Constructions db',
*item EDDBMLCON
*enditem
        call MENUATOL('  ','Constructions db',
*item EDDBMLCON
'A (multilayer) construction database defines the com-'
'position of constructions such as walls and glazing'
'systems in terms of layers of materials of particular'
'thickness in a particular order and, where appropriate,'
'with a named set of optical properties. '
*enditem
        CALL EASKSCNCL(ltmp,'Constructions database?',
*item EDDBMLCON
'An empty MLC database has been created. It is'
'useless until it is populated with data. If you '
'have the relevant information you can start now.'
*enditem
        CALL ASKOK('  ',' Browse or edit new database?',OK,dok,3)
*item EDDBMLCON
'You are asked to confirm the source file for the'
'copy action. If this one is ok then accept it. '
*enditem
          CALL EASKXORGTKF(lguess,'Constructions db (source)?',
*item EDDBMLCON
'The suggested name of this database is based on the'
'project name. '
*enditem
  66    CALL EASKS(LTMP,
*item EDDBMLCON
'A (multilayer) construction database defines the com-'
'position of constructions such as walls and glazing'
'systems in terms of layers of materials of particular'
'thickness in a particular order and, where appropriate,'
'with a named set of optical properties. '
' '
'A local database folder (../dbs) is usually associated'
'with each model. '
*enditem
        CALL EASKXORGTKF(LCOPY,'Constructions db?',' ',
*item EDDBMLCON
*enditem
            CALL ASKOK('Is this file in the model ../dbs folder?',
*item EDDBMLCON
'A (multilayer) construction database defines the com-'
'position of constructions such as walls and glazing'
'systems in terms of layers of materials of particular'
'thickness in a particular order and, where approp-'
'riate, with a named set of optical properties. '
' '
'The ESP-r distribution includes alternatives to the'
'default which might be useful.'
*enditem
          CALL EASKF(LCOPY,' ','Constructions db?',
*subroutine EDDBOPT
*item EDDBOPT
'The optical properties of multilayer constructions'
'are defined in an optical database.  The data include'
'angular (0, 40, 55, 70, 80 degrees from normal) solar'
'transmission and absorption at each layer.'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database '
'   and if you have permission to update the file you'
'   can edit the entities in the database.'
' '
'b) Select from list (not available for optics databases).'
' '
'c) Make a new database: a new database will be created '
'   based on the file name you supply. It will contain a'
'   minimal number of items and you can then modify this'
'   as required. '
'   Exercise care if you use a text editor to copy sets'
'   of data from another optical database.'
' '
'd) copy default database: a project copy of the default'
'  database will be made and you will be offered a '
'  chance to rename it.'
' '
'e) browse ../dbs allows you to look in the model ../dbs'
'  folder for alternative optics files. If you do not'
'  find anything the previous value will be restored.'
' '
' f) browse distribution displays files in the databases'
'  folder of the ESP-r distribution. If you do not find'
'  anything the previous value will be restored.'
' '
' g) copy another database to the project allows you to'
' locate a database and get a project copy of it.'
'e) select a file (X11 only): edit the file name'
'   and if it is found you can browse or edit it.'
'   Hint: if you eventually want to copy that other file'
'   into the model folder first select it and then ask'
'   for a copy.'
' '
' '
' '
' '
' '
*enditem
        call MENUATOL('  ','Optical Properties db',
*item EDDBOPT
*enditem
        call MENUATOL('  ','Optical Properties db',
*item EDDBOPT
*enditem
        call MENUATOL('  ','Optical Properties db',
*item EDDBOPT
*enditem
        call MENUATOL('  ','Optical Properties db',
*item EDDBOPT
'The suggested name of this database is based on the '
'project name. '
'An optics db holds properties of transparent'
'constructions '
*enditem
        CALL EASKSCNCL(ltmp,' Optics database?',
*item EDDBOPT
'An empty optics database has been created. It is'
'useless until it is populated with data. If you '
'have the relevant information you can start now.'
*enditem
        CALL ASKOK('  ',' Browse or edit new database?',OK,dok,3)
*item EDDBOPT
'You are asked to confirm the source file for the'
'copy action. If this one is ok then accept it. '
*enditem
          CALL EASKXORGTKF(lguess,'Optical Properties db (source)?',
*item EDDBOPT
'The suggested name of this database is based on the '
'project name. '
*enditem
  66    CALL EASKS(LTMP,
*item EDDBOPT
'An optical properties database holds information for'
'transparent constructions. It is closely related to'
'the constructions database referenced by the project.'
' '
'A local database folder (../dbs) is usually associated'
'with each model. '
*enditem
        CALL EASKXORGTKF(LCOPY,'Optical Properties db?',' ',
*item EDDBOPT
*enditem
            CALL ASKOK('Is this file in the model ../dbs folder?',
*item EDDBOPT
'An optical properties database holds information for'
'transparent constructions. It is closely related to'
'the constructions database referenced by the project.'
' '
'The ESP-r distribution includes alternatives to the'
'default which might be useful.'
*enditem
          CALL EASKF(LCOPY,' ','Optical Properties db?',
*subroutine EDDBPRES
*item EDDBPRES
'To enable the calculation of wind-induced surface'
'pressures (as required the simulator), this database'
'of angle dependent pressure coefficients is provided.'
' '
'Wind pressure coefficients are pressure coefficients'
'for surfaces in typical positions and within several'
'different exposure categories.'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database '
'   and if you have permission to update the file you'
'   can edit the entities in the database.'
' '
'b) Select from list (not available for optics databases).'
' '
'c) Make a new database: a new database will be created '
'   based on the file name you supply. It will contain a'
'   minimal number of items and you can then modify this'
'   as required. '
'   Exercise care if you use a text editor to copy sets'
'   of data from another optical database.'
' '
'd) copy default database: a project copy of the default'
'  database will be made and you will be offered a '
'  chance to rename it.'
' '
'e) browse ../dbs allows you to look in the model ../dbs'
'  folder for alternative database. If you do not'
'  find anything the previous value will be restored.'
' '
' f) browse distribution displays files in the databases'
'  folder of the ESP-r distribution. If you do not find'
'  anything the previous value will be restored.'
' '
' g) copy another database to the project allows you to'
' locate a database and get a project copy of it.'
'e) select a file (X11 only): edit the file name'
'   and if it is found you can browse or edit it.'
'   Hint: if you eventually want to copy that other file'
'   into the model folder first select it and then ask'
'   for a copy.'
' '
' '
' '
' '
' '
*enditem
        call MENUATOL('  ','Pressure Distributions db',
*item EDDBPRES
*enditem
        call MENUATOL('  ','Pressure Distributions db',
*item EDDBPRES
*enditem
        call MENUATOL('  ','Pressure Distributions db',
*item EDDBPRES
*enditem
        call MENUATOL('  ','Pressure Distributions db',
*item EDDBPRES
'To enable the calculation of wind-induced surface'
'pressures (as required the simulator), this database'
'of angle dependent pressure coefficients is provided.'
' '
'Wind pressure coefficients are pressure coefficients'
'for surfaces in typical positions and within several'
'different exposure categories. '
' '
'Please supply and confirm the file name.'
'The suggested name of this database is based on the '
'project name. '
*enditem
  62    CALL EASKSCNCL(ltmp,' New pressure coefficients database?',
*item EDDBPRES
'An empty pressure database has been created. It is'
'useless until it is populated with data. If you '
'have the relevant information you can start now.'
*enditem
        CALL ASKOK('  ',' Browse or edit new database?',OK,dok,3)
*item EDDBPRES
'You are asked to confirm the source file for the'
'copy action. If this one is ok then accept it. '
*enditem
          CALL EASKXORGTKF(lguess,
*item EDDBPRES
'The suggested name of this database is based on the '
'project name. '
*enditem
  66    CALL EASKS(LTMP,
*item EDDBPRES
'Wind pressure coefficients are pressure coefficients'
'for surfaces in typical positions and within several'
'different exposure categories.'
' '
'A local database folder (../dbs) is usually associated'
'with each model. '
*enditem
        CALL EASKXORGTKF(LCOPY,'Pressure coefficients db?',' ',
*item EDDBPRES
*enditem
            CALL ASKOK('Is this file in the model ../dbs folder?',
*item EDDBPRES
'Wind pressure coefficients are pressure coefficients'
'for surfaces in typical positions and within several'
'different exposure categories.'
' '
'The ESP-r distribution includes alternatives to the'
'default which might be useful.'
*enditem
          CALL EASKF(LCOPY,' ','Pressure coefficients db?',
*subroutine EDDBCLM
*item EDDBCLM
'Climate databases are hourly sets of values from '
'1h00 on 1 Jan to 24h00 on 31 December.  For each hour'
' the following data is held:'
' '
' Diffuse horizontal solar intensity (W/m^2)'
' Dry bulb temp. (tenths of degree C ie. 102 = 10.2C)'
' Direct normal or global horiz. solar intensity (W/m^2)'
' Wind speed (tenths m/s ie. 15 = 1.5 m/s)'
' Wind direction (degrees from north, clockwise)'
' Relative humidity (percent)'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database '
'   and if you have permission to update the file you'
'   can edit the entities in the database.'
' '
'b) select another file: you will asked for a file'
'   name and if it is found you can browse or edit it.'
' '
'c) make a new database: a new database will be created '
'   based on the file name you supply.'
' '
'd) copy default database: a project copy of the default'
'  database will be made and you will be offered a '
'  chance to rename it.'
' '
'e) convert binary file to an (esp-r) ascii file '
'   (typically for transport between machine types).'
' '
'f) convert ascii (esp-r) climate file to a binary'
'   suitable to the current computer.'
' '
'g) convert an EPW file (which has already been edited'
'   as per EPW_readme instructions) to an esp-r binary'
'   climate file'
*enditem
        call MENUATOL('  ','Climate db',
*item EDDBCLM
*enditem
        call MENUATOL('  ','Climate db',
*item EDDBCLM
*enditem
        call MENUATOL('  ','Climate db',
*item EDDBCLM
'Climate databases are hourly sets of values from '
'1h00 on 1 Jan to 24h00 on 31 December. Please'
'specify which file in the list.'
*enditem
                  CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
*item EDDBCLM
*enditem
                  CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
*item EDDBCLM
*enditem
                  CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
*item EDDBCLM
*enditem
                CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
*item EDDBCLM
*enditem
                CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
*item EDDBCLM
'The suggested name of this database is based on the '
'project name. '
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
'An empty climate file has been created. It can`t'
'be used for anything until it is populated with '
'climate data.  '
*enditem
        CALL ASKOK(' ','Browse/edit new climate data?',OK,dok,3)
*item EDDBCLM
*enditem
          CALL ASKOK(' ','Browse/edit new climate data?',OK,dok,3)
*item EDDBCLM
'The suggested name of this database is related to the'
'active project name.'
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
*enditem
          CALL ASKOK(' ','Browse/edit copied climate data?',OK,dok,3)
*item EDDBCLM
'Some databases are held as BINARY files for speed'
'of access and security. It is sometimes convenient'
'to convert to ASCII - e.g. for implementation under'
'a different operating system or for word processing.'
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
        CALL ASKOK(' ','Browse/edit exported climate data?',OK,dok,3)
*item EDDBCLM
'Some databases are held as BINARY files for speed'
'of access and security. There are machine dependant'
'and can be created from ASCII file versions.'
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name ? ',
*item EDDBCLM
*enditem
        CALL ASKOK(' ','Browse/edit exported climate data?',OK,dok,3)
*item EDDBCLM
'ESP-r can import climate data from EPW format files'
'(some editing is required, see instructions in the'
'file EPW_readme). This option converts EPW files'
'to ESP-r climate files.'
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name (binary)? ',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name (binary)? ',
*item EDDBCLM
*enditem
          CALL EASKF(longtmp,' ',' Climate file name (binary)? ',
*item EDDBCLM
'Use the browse function to clarify whether the climate'
'data you have selected is appropriate for the current '
'model. '
*enditem
        CALL ASKOK(' ','Browse/edit imported climate data?',OK,dok,3)
*item EDDBCLM
'Typically the project location will not deviate'
'by much from the location of Climate db.'
*enditem
      CALL ASKOK(outs,
*item EDDBCLM
'The year associated with a model primarily tells the'
'simulator what day of the week is 1 January. '
' '
'IF YOU CHANGE the model year remember to save '
'your model before you exit the project manager. '
' '
'The choice is year impacts the day of the week for'
'1 January. It also will alter the day type associated'
'of days in the calendar which are the standard default'
'weekday/saturday/sunday (but not user defined day types.'
*enditem
      CALL ASKOK(OUTS,
*subroutine EDDBMSC
*item EDDBMSC
'The miscellaneous components database can'
'be edited using the current defined text editor'
'(as defined in the default file).'
'BE CAREFUL!'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database '
'   and if you have permission to update the file you'
'   can edit the entities in the database.'
' '
'b) Select from list (not available for mscel comp db).'
' '
'c) Make a new database: not yet available '
' '
'd) copy default database: a project copy of the default'
'  database will be made and you will be offered a '
'  chance to rename it.'
' '
'e) browse ../dbs allows you to look in the model ../dbs'
'  folder for alternative files. If you do not'
'  find anything the previous value will be restored.'
' '
' f) browse distribution displays files in the databases'
'  folder of the ESP-r distribution. If you do not find'
'  anything the previous value will be restored.'
' '
' g) copy another database to the project allows you to'
' locate a database and get a project copy of it.'
'e) select a file (X11 only): edit the file name'
'   and if it is found you can browse or edit it.'
'   Hint: if you eventually want to copy that other file'
'   into the model folder first select it and then ask'
'   for a copy.'
' '
' '
' '
' '
' '
*enditem
        call MENUATOL('  ','Miscellaneous components db',
*item EDDBMSC
*enditem
        call MENUATOL('  ','Miscellaneous components db',
*item EDDBMSC
*enditem
        call MENUATOL('  ','Miscellaneous components db',
*item EDDBMSC
*enditem
        call MENUATOL('  ','Miscellaneous components db',
*item EDDBMSC
'You are asked to confirm the source file for the'
'copy action. If this one is ok then accept it. '
*enditem
          CALL EASKXORGTKF(lguess,'Miscellaneous comp db (source)?',
*item EDDBMSC
'The suggested name of this database is based on the '
'project name. '
*enditem
  66    CALL EASKS(LTMP,
*item EDDBMSC
'The miscellaneous components database can'
'be edited using the current defined text editor'
'(as defined in the default file).'
'BE CAREFUL!'
' '
'A local database folder (../dbs) is usually associated'
'with each model. '
*enditem
        CALL EASKXORGTKF(LCOPY,'Miscellaneous comp db?',' ',
*item EDDBMSC
*enditem
            CALL ASKOK('Is this file in the model ../dbs folder?',
*item EDDBMSC
'The miscellaneous components database can'
'be edited using the current defined text editor'
'(as defined in the default file).'
'BE CAREFUL!'
' '
'The ESP-r distribution includes alternatives to the'
'default which might be useful.'
*enditem
          CALL EASKF(LCOPY,' ','Miscellaneous components db?',
*item EDDBMSC
'Exercise care when editing this text file as the'
'format may be sensitive to user edits! '
'If you alter the file name when saving the text'
'in the editor then you will have to browse to'
'find the new file.'
*enditem
      CALL ASKOK('  ','Use this edited database (see help)?',OK,dok,5)
*subroutine EDZONE
*item EDZONE
'This menu allows the attributes of a thermal zone to'
'be specified as follows.'
' '
'* Zone name: label used in lists and reports.'
'* Base area: list of surfaces associate with the base.'
' '
'* Vertex list & coordinates: X, Y, Z coordinates of'
'  vertices in the zone and related functions'
'  (add/delete/copy and transforms).'
' '
'* Surface list: topology (edge ordering) of each surface'
'  with related functions (add/delete/copy as well as'
'  transforms).  New surfaces can be composed via point'
'  and click, imported from other zones or defined via'
'  keyboard input.'
' '
'* Surface attributes: name, composition, opacity and'
'  boundary conditions. This is the preferred place to'
'  define composition and opacity.'
'  '
'* Solar insolation: as a alternative to running a'
'  time-series insolation analysis, you may specify'
'  the surface or surfaces that will receive any'
'  solar radiation entering a zone.'
' '
'* Obstructions: Shading patterns are generated via the'
'  use of obstruction blocks, and the definition of'
'  these blocks is via this menu pick.'
' '
'* Browse: displays a table of information about each'
'  surface in a zone.'
'If you exit without saving changes then some of'
'your inputs may be lost.'
*enditem
          CALL ASKOK('Save changes to zone composition and surface',
*item EDZONE
'The name of the zone is used both for descriptive and'
'bookkeeping purposes.  Each name should be unique.'
*enditem
        CALL EASKS(T14,'Descriptive name for zone?','(<12 characters)',
*item EDZONE
'Input a succinct description of the zone here.'
*enditem
  64    CALL EASKS(T64,'Zone description?','(<64 characters)',
*item EDZONE
'These surfaces are associated with the base area'
'because they had attributes of `flor` or were'
'previously picked by the user. You can edit this'
'list or select none and then edit the value.'
'No surfaces are associated with the base area because'
'the user manually edited the floor area value.'
'You can select surfaces (and the floor area will be'
'calculated) or select none and then edit the value.'
'A subset of surfaces are associated with the base'
'area (user excluded some `flor` surfaces). Select'
'surfaces and the floor area will be calculated'
'or select none and then edit the value.'
*enditem
        CALL EPICKS(INPICK,IVALS,outs,
*item EDZONE
*enditem
          CALL EASKR(ZBASEA(ICOMP),' ',
*item EDZONE
'Changes to vertex data may be lost if you continue'
'working without saving the data.'
*enditem
          CALL ASKOK(' ','Save vertex changes?',OK,DOK,2)
*item EDZONE
*enditem
        CALL EASKSUR(ICOMP,IS,'M','Select surface(s) to attribute.',
*item EDZONE
'You can apply an attribute to several surfaces or'
'edit several surface names. For composition you will'
'be asked to select a construction and then a list of'
'surfaces to apply this to. Boundary conditions are'
'set in the same way as are the USES of surfaces (to'
'assist with code compliance).'
*enditem
          CALL EASKATOG('Surface attribution: ',' ',
*item EDZONE
'The boundary conditions at the other face of this'
'surface is specified  here. The default is `exterior`.'
' '
' Exterior - exposed to external weather.'
' '
' Similar to current - exposed to the same conditions'
'   as the inside face except for the treatment of solar'
'  insolation: only the diffuse component assumed the'
'  same. A temperature (C) and radiation (W/m^2) offset'
'  may be imposed.'
' '
' Prescribed static - exposed to a user specifiec and'
'  constant temperature and radiation condition.'
' '
' Surface in other zone - exposed to the temperature and'
'  radiation condition of a specified surface in a'
'  other zone (but one time step in arrears).'
' '
' Ground (monthly profile) - exposed to a temperature'
'  defined by a standard monthly temperature profile'
'  embedded in ESP-r.'
' '
' Ground (user defined profile) - exposed to a'
'  temperature defined by a monthly temperature profile'
'  defined by the user (in Model Context).'
' '
' Ground (3D conduction model) - exposed to a'
'  temperature calculated from a model based on a 3D'
'  representation of the ground.'
' '
' Adiabatic - heat flux set to zero.'
' '
' BASESIMP foundation configuration -  used to represent'
'  a basement configuration and precalculate basement'
'  heat transfer. Requires the existence of a `basesimp`'
'  file giving dimensions and required computational'
'  parameters.'
' '
' CEN 13791 partition - CEN 13791 test: like'
'  `similar to current` above but the temperature and'
'  radiation offsets are not available. Details given'
'  in Section 4.4.2 of the CEN 13791 standard.'
' '
'Note that the Project Manager is able to automatically'
'link adjacent surfaces based on the infomation'
'available in zone geometry files.'
*enditem
            CALL EPICKS(IX,IVALSS,' ','Surface boundary condition:',
*item EDZONE
'A `similar to current` boundary condition can'
'include a temperature (degC) and radiation (W/m^2)'
'from the current zone. For example, the adjacent'
'zone (not included in the model) might tend to be'
'cooler and have lower solar and/or casual gains.'
'Dimensions are whole degC and whole W'
*enditem
              CALL EASKR(VALT,' ','Temperature offset?',
*item EDZONE
*enditem
              CALL EASKR(VALW,' ','Radiation offset?',
*item EDZONE
'A `prescribed static` boundary condition requires'
'the specification of a constant temperature (degC)'
'and radiation value (W/m^2).'
*enditem
              CALL EASKR(VALT,' ','Constant temperature?',
*item EDZONE
*enditem
              CALL EASKR(VALW,' ','Constant radiation?',
*item EDZONE
'A ground connection is either:'
' > 0 connection to one of several standard profiles'
'     in which case the profile number is required.'
' = 0 connection to a user defined profile in which'
'     case a 0 followed by a profile number is'
'     required.'
' =-3 connection to a 3D ground model.'
*enditem
              CALL EASKI(IIC2,' ','Standard ground profile number?',
*item EDZONE
' A user defined ground profile numbers is'
'required here.'
*enditem
                CALL EASKI(IIE2,' ',
*item EDZONE
'Select the surfaces for which the name is to'
'be defined.'
*enditem
            CALL EPICKS(INPICK,IVALS,' ',' ',15,NSUR,ITEMSS,
*item EDZONE
'Select the surfaces for which the composition '
'is to be defined.'
*enditem
            CALL EPICKS(INPICK,IVALS,' ',' ',32,NSUR,ITEMSS,
*item EDZONE
'Select the surfaces for which the boundary condition'
'is to be defined.'
*enditem
            CALL EPICKS(INPICK,IVALS,' ',' ',32,NSUR,ITEMSS,
*item EDZONE
'Select the surfaces for which a specific USE will be'
'associated e.g. DOOR VEHICLE, FRAME FACADE.'
*enditem
            CALL EPICKS(INPICK,IVALS,' ',' ',32,NSUR,ITEMSS,
*item EDZONE
'Use this attribute to name the surface in a way'
'that makes it easy to reference the surface later.'
*enditem
 52           CALL EASKS(T14,outs,'(<=12 chars, no spaces)',
*item EDZONE
'You can define shading obstructions by either supplying'
'an origin and dimensions or clicking on a bitmap.'
*enditem
          call easkab(' ','Shading obstruction definition via:',
*item EDZONE
*enditem
          call easkabc(' ','Shading obstruction definition via:',
*item EDZONE
'The current zone geometry can be modified via'
'rotation, translation and mirroring options that'
'apply to all zone surfaces and, optionally,'
'to obstructions and Mean Radiant Temperature'
'sensors in the zone.'
' '
'Rotation: + = anticlockwise.'
' '
'Translation: use to change all X Y or Z by the same'
'amount. To translate a portion of the zone use surface'
'translation or edit vertices.'
' '
'Mirror: flips one axis - you specify the axis and'
'the point along that axis where the mirror is to'
'occur. A positive Y mirror is shown below; a negative'
'mirror is top to bottom.'
' '
'             +Y'
'            |  .......'
'            |  :     :.......'
'            |  :     /\\     :'
'            |  :.....||.....:'
'           -|- - - - || - - - - - -mirror line'
'            |  ......||......'
'            |  :     ||     :'
'            |  :     .......:'
'            |  :.....:'
' -X_________|______________________ +X '
'            |'
'            | -Y    Positive Y mirror'
'  '
'  '
'A positive X mirror is shown below; a negative mirror'
'is from right to left.'
' '
'             +Y'
'            |            mirror line'
'            |           |'
'            | ......... | ..........'
'            | :     ==========>    :'
'            | :     ..: | :..      :'
'            | :.....:   |   :......:'
'   -X_______|___________|__________ +X '
'            |'
'            | -Y    Positive X mirror'
'                  '
'Please ensure that the mirror point is at the edge of'
'or outside the zone since a mirror point within a'
'zone can cause problems.'
'Take care: there is no undo facility.'
*enditem
          CALL PHELPD('rotation section',50,'-',0,0,IER)
*item EDZONE
*enditem
          CALL EASKR(VAL,' ','Rotation (+ = anticlockwise)?',
*item EDZONE
*enditem
              CALL EASKR(x1,' ','X-coord?',
*item EDZONE
*enditem
              CALL EASKR(y1,' ',' Y-coord?',
*item EDZONE
'You have rotated the zone. You probably also '
'need to rotate the MRT sensors.'
*enditem
              call askok('Apply this rotation to MRT sensors',
*item EDZONE
'You have already rotated the zone. Probably '
'you will want to rotate associated obstructions.'
*enditem
            call askok('Apply this rotation to obstructions',
*item EDZONE
'You have already rotated the zone. Probably '
'you will want to rotate associated obstructions.'
*enditem
            call askok('Apply this rotation to obstructions',
*item EDZONE
*enditem
  43        CALL EASKS(HOLD,'Transform (X Y Z metres):',' ',36,
*item EDZONE
*enditem
            call askok('Apply this transform to zone surfaces?',' ',
*item EDZONE
*enditem
            call askok(msgv,' Is this ok?',ok,dok,58)
*item EDZONE
*enditem
            CALL EASKGEOF(
*item EDZONE
*enditem
            call askok(msgv,' Is this ok?',ok,dok,58)
*item EDZONE
'You have transformed the zone. You probably also '
'want to transform its MRT sensors.'
*enditem
              call askok('Apply this transform to MRT sensors',
*item EDZONE
'You already transformed the zone. You probably also'
'want to transform the associated obstructions. '
*enditem
            call askok('Apply this transform to obstructions',
*item EDZONE
'You already transformed the zone. You probably also'
'want to transform the associated obstructions. '
*enditem
            call askok('Apply this transform to obstructions',
*item EDZONE
'The mirror facility flips one axis.  You specify '
'which axis and the point along that axis where the '
'mirror is to occur. A positive Y mirror is shown. '
'A negative mirror is top to bottom. '
 '             +Y'
 '            |  .......'
 '            |  :     :.......'
 '            |  :     /\\     :'
 '            |  :.....||.....:'
'           -|- - - - || - - - - - -mirror line'
'            |  ......||......'
'            |  :     ||     :'
'            |  :     .......:'
'            |  :.....:'
' -X_________|______________________ +X '
'            |'
'            | -Y    Positive Y mirror'
'  '
'  '
'  '
'A positive X mirror is shown. The negative goes from'
'right to left. '
' '
 '             +Y'
 '          |            mirror line'
 '          |           |'
 '          | ......... | ..........'
 '          | :     ==========>    :'
 '          | :     ..: | :..      :'
 '          | :.....:   |   :......:'
 ' -X_______|___________|__________ +X '
 '          |'
 '          | -Y    Positive X mirror'
 '                  '
 '                  '
*enditem
          CALL PHELPD('axis mirror',35,'-',0,0,IER)
*item EDZONE
'Please ensure the mirror point is at or outside '
'of the zone. For +mirror the point is above the'
'object.  For -mirror the point is below it. '
*enditem
            CALL EASKR(VALM,' ','Mirror point on Y-axis?',
*item EDZONE
*enditem
            call askok(' ','Apply mirror transform?',ok,dok,3)
*item EDZONE
'Please ensure the mirror point is at or outside of'
'the zone. For +mirror the point is to the right of'
'the zone.  For -mirror the point is on the left.'
*enditem
            CALL EASKR(VALM,' ','Mirror point on X-axis?',
*item EDZONE
*enditem
            call askok(' ','Apply mirror transform?',ok,dok,3)
*item EDZONE
'In addition to surface attributes you can view the'
'thermo-physical properties of the zone.'
*enditem
           call askok(' ','Also view thermo-physical details?',
*item EDZONE
'The current geometry  will be written to file in'
'GEN format.'
*enditem
        CALL EASKS(LTMP,' ','Zone geometry file?',
*item EDZONE
*enditem
        CALL PHELPD('geometry section',35,'zone_geo_ed ',0,0,IER)
*subroutine EDINSUL
*item EDINSUL
'There are a number of options for treating shading and '
'insolation distibution in a zone:'
' '
'* The user specifies a static insolation distribution '
'  i.e. which surface or pair of surfaces to which all '
'  insolation entering the room is to be directed.'
'* Insolation is distributed diffusely (by surface area '
'  and absorptance) (this is the default).'
' '
'* A dynamic analysis of shading and insolation distri-'
'  bution via `ish` which is stored in a shading/'
'  insolation file based on user directives.'
'  Typical directives are to calculate shading on all'
'  applicable surfaces (those that face the outside) as'
'  and include all outside facing transparent surfaces'
'  as insolation sources and to do calculations for all'
'  months of the year.'
'  '
'Note: Shading is assessed based on any shading obstruc-'
'tions associated with the current zone. Insolation'
'can be assessed if there is at least one outside facing'
'transparent surface.'
' '
'Note that you can define directives for the shading and'
'insolation analysis in another sub-menu of the geo- '
'metry facility. These directives allow automated recal-'
'culation if the zone geometry is revised or if there is'
'no zone shading file at simulation time. '
*enditem
        CALL PHELPD('shad:insol',28,'-',0,0,IER)
*item EDINSUL
'Having defined obstructions, you must run a separate'
'analysis to predice temporal distribution patterns.'
*enditem
        CALL EASKABC('Shading & insolation analysis options: ',' ',
*item EDINSUL
'The shading/ insulation database holds time '
'varying external surface shading and internal'
'surface insolation.'
*enditem
            CALL EASKS(SFIL,' New zone shading/ insulation database?',
*item EDINSUL
'There are a number of options for treating shading and '
'insolation distibution in a zone:'
' '
'* The user specifies a static insolation distribution '
'  i.e. which surface or pair of surfaces to which all '
'  insolation entering the room is to be directed.'
'* Insolation is distributed diffusely (by surface area '
'  and absorptance) (this is the default).'
*enditem
        CALL EPICKS(IX,IVAL,' static insolation options:','  ',
*item EDINSUL
*enditem
          CALL EASKSUR(ICOMP,IS,'A','Select surface for insolation.',
*item EDINSUL
*enditem
          CALL EASKSUR(ICOMP,IS,'A','Select first insolated surface.',
*item EDINSUL
*enditem
          CALL EASKSUR(ICOMP,IS,'A','Select 2nd insolated surface.',
*subroutine PICKSSUR
*item PICKSSUR
'A shading analysis calculates the time varying patterns'
'of shading on external zone surfaces. You must select'
'the surfaces to include in this calculation. Selecting'
'`all applicable surfaces` corresponds to all outside'
'facing opaque and tansparent surfaces.'
*enditem
        CALL EASKABCD(' ','Shading calculation options:',
*item PICKSSUR
'An insolation analysis calculates the time varying'
'insolation of internal zone surfaces. You must select'
'the external surfaces (with windows) to include in'
'this calculation. Selecting`all applicable surfaces`'
'corresponds to all outside facing tansparent surfaces.'
*enditem
         CALL EASKABCD(' ','Insolation calculationoptions:',
*item PICKSSUR
'Pick one or more surfaces from the zone (up to'
'the limit indicated).'
*enditem
          CALL EPICKS(INPIC,IVALS,'Which surfaces?',msg1,
*item PICKSSUR
'Pick one, several or all surfaces for inclusion.'
*enditem
          CALL EPICKS(INPIC,IVALS,' ','Surfaces to Include',
*subroutine EDSURA
*item EDSURA
'This menu displays the surface attributes that may'
'be edited. Editing is accomplished by selecting one'
'of the surfaces.'
' '
'You can add a rectangular opening (e.g. a window or'
'door) to a surface by specifing its position within'
'the parent surface. This position is an X Y offset from'
'the lower left hand corner (when looking from outside'
'the model). An opening will then be created within'
'the parent surface with the specified width and height.'
' '
'To add a non-rectangular opening, use the surface'
'list & edges menu. Or you might begin with a rectangle'
'and then add more vertices (be careful with openings'
'in sloped surfaces).'
*enditem
        CALL PHELPD('surface attributes menu',11,'-',0,0,IER)
*item EDSURA
'Inserting a surface into an existing surface is a'
'common way to create a door or window opening.'
'Use this attribute to name the surface in a way that'
'makes it easy to reference the surface later.'
*enditem
 52     CALL EASKS(T14,' Surface name?','(<=12 characters, no spaces)',
*item EDSURA
'If a surface is composed of at least one transparent'
'layer then it is considered not to be opaque.'
*enditem
    9   CALL EPICKS(IX,IVAL,' ','Surface Type',
*item EDSURA
'The surface orientation is an optional attribute which'
'is used to assist in assessing surfaces for daylight'
'calculations and determine casual gains based on floor'
'area. Initial values are based on the azimuth and'
'elevation of each surface. Leaving this attribute'
'as `UNKNOWN` is not detrimental.'
*enditem
        call MENUATOL(' ','Surface Orientation',
*item EDSURA
'To enable 3D geometry definition (as required for'
'3D gridding), the distance between the current'
'surface and an imaginary external surface (line)'
'is required. One imaginary surface may be assumed'
'for all surfaces with similar direction angles.'
*enditem
        CALL EASKR(SINDT,' ','Surface indentation?',
*item EDSURA
'There is no zone construction file yet although'
'you can browse entries in the Constructions db.'
*enditem
                call askok('View thermo-physical properties of ',
*item EDSURA
'You can see the thermo-physical properties as held'
'in the zone constructions file.'
*enditem
              call askok('View thermo-physical properties of ',outs,
*item EDSURA
'If this surface is a partition and the construction is'
'non-symetrical and linked to a reversed construction,'
'you should check that the surface in the other room'
'has also been properly updated.'
*enditem
          call askok('Modify thermo-physical data of',outs,ok,dok,7)
*item EDSURA
'The boundary conditions at the other face of this'
'surface is specified  here. The default is `exterior`.'
' '
' Exterior - exposed to external weather.'
' '
' Similar to current - exposed to the same conditions'
'   as the inside face except for the treatment of solar'
'  insolation: only the diffuse component assumed the'
'  same. A temperature (C) and radiation (W/m^2) offset'
'  may be imposed.'
' '
' Prescribed static - exposed to a user specifiec and'
'  constant temperature and radiation condition.'
' '
' Surface in other zone - exposed to the temperature and'
'  radiation condition of a specified surface in a'
'  other zone (but one time step in arrears).'
' '
' Ground (monthly profile) - exposed to a temperature'
'  defined by a standard monthly temperature profile'
'  embedded in ESP-r.'
' '
' Ground (user defined profile) - exposed to a'
'  temperature defined by a monthly temperature profile'
'  defined by the user (in Model Context).'
' '
' Ground (3D conduction model) - exposed to a'
'  temperature calculated from a model based on a 3D'
'  representation of the ground.'
' '
' Adiabatic - heat flux set to zero.'
' '
' BASESIMP foundation configuration -  used to represent'
'  a basement configuration and precalculate basement'
'  heat transfer. Requires the existence of a `basesimp`'
'  file giving dimensions and required computational'
'  parameters.'
' '
' CEN 13791 partition - CEN 13791 test: like'
'  `similar to current` above but the temperature and'
'  radiation offsets are not available. Details given'
'  in Section 4.4.2 of the CEN 13791 standard.'
' '
'Note that the Project Manager is able to automatically'
'link adjacent surfaces based on the infomation'
'available in zone geometry files.'
*enditem
        CALL EPICKS(IX,IVAL,' ','Other Side Boundary Condition',
*item EDSURA
'A `similar to current` boundary condition can'
'include a temperature (degC) and radiation (W/m^2)'
'from the current zone. For example, the adjacent'
'zone (not included in the model) might tend to be'
'cooler and have lower solar and/or casual gains.'
'Dimensions are whole degC and whole W'
*enditem
          CALL EASKR(VALT,' ','Temperature offset?',
*item EDSURA
*enditem
          CALL EASKR(VALW,' ','Radiation offset?',
*item EDSURA
'A `prescribed static` boundary condition requires the'
'specification of a constant temperature (degC) and'
'radiation value (W/m^2).'
*enditem
          CALL EASKR(VALT,' ','Constant temperature?',
*item EDSURA
*enditem
          CALL EASKR(VALW,' ','Constant radiation?',
*item EDSURA
*enditem
          CALL EASKGEOF('If other zone known select it, else exit.',
*item EDSURA
*enditem
            CALL EASKSUR(IZ,ISO,'A','Select surface in',
*item EDSURA
'You have modified an attribute of a surface which'
'is a partition between two zones. You probably'
'should also update the adjacent zone surface to'
'maintain consistency. '
*enditem
              CALL ASKOK(' ','Update other surface side?',
*item EDSURA
'A ground connection is either:'
' > 0 connection to one of several standard profiles'
'     in which case the profile number is required.'
' = 0 connection to a user defined profile in which'
'     case a 0 followed by a profile number is'
'     required.'
' =-3 connection to a 3D ground model.'
*enditem
  777     CALL EASKI(IIC2,' ','Standard ground profile number?',
*item EDSURA
'A user defined ground profile number is required'
*enditem
 778        CALL EASKI(IIE2,' ','User defined ground profile number?',
*item EDSURA
'Specify the BASESIMP configuration number.'
'Refer to src/esp-r/esrubld/bscoeff.F for'
'correspondence between this number (iconfig)'
'and the BASESIMP descriptors (e.g. BCIN_1).'
'BASESIMP is a whole foundation model. Therefore, when'
'a basement is represented by several ESP-r surfaces'
'(e.g. n walls + floor), you must specify the'
'percentage of the whole foundation heat loss to'
'attribute to each surface. Normally the sum of the'
'will be 100%. A basesimp file (defining dimensions and'
'computational parameters must exist and be associated'
'with the ESP-r basement zone.'
*enditem
          CALL EASKI(Ifrac,' ','% BASESIMP loss to this surface?',
*subroutine edituse
*item edituse
'For QA and code compliance purposes as well as to'
'help auto-generate air flow networks ESP-r allows'
'you to attach SEMANTIC tags to surfaces in a zone.'
' '
'There are a number of types of tags e.g. DOOR, '
'FICT (fictitious construction), FLOOR, FRAME (around'
'a window or door), FURNIture (surfaces representing'
'internal mass), GRILL/SMOKEVNT (surfaces representing'
'specific location of forced air flow), ROOF, STRUC'
'(column or beam), WALL/FLOOR (part of the facade), '
'and either PARTN or `-` to represent other surfaces.'
' '
'There are, of course, more than one kind of DOOR and '
'WINDOW so a second specifier is included. For some '
'objects you will also be asked for indicators of air'
'flow e.g. CLOSED/UNDERCUT/OPEN/BIDIR as qualifiers'
'which specify where air might flow. NOTE: flow'
'inference is not yet implemented. When implemented'
'a zone operation file might detect a mismatch in '
'infiltration if there were cracks or openings noted'
'for surfaces. When implmented such key words could'
'help to auto-generate mass flow networks. '
' '
'For building code complience you will want to set '
'appropriate qualifiers e.g. a WINDOW DISPLAY surface'
'will not be resized to meet code requirements but '
'other surfaces marked WINDOW ORDINARY will. '
' '
'Models which are intended for UK code compliance checking'
'are restricted to a limited set of surface use tags: '
'DOOR PERSONEL, DOOR ENTRANCE, DOOR VEHICLE, WALL, '
'WINDOW NORMAL, WINDOW DISPLAY, WINDOW SKYLIGHT,'
'WINDOW FRAME, ROOF PITCHED (>20deg slope),'
'ROOF FLAT (0deg-20deg slope).'
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item edituse
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item edituse
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item edituse
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item edituse
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item edituse
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item edituse
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this door. '
' '
'Undercut signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Open - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Bidirectional - other facilities should confirm'
'the details of two way flow. Control might be'
'applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','DOOR air leakage:',
*item edituse
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this door. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Open - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Bidirectional - other facilities should confirm'
'the details of two way flow. Control might be'
'applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','FICT surface air leakage:',
*item edituse
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this door. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Vent - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','FRAME surface air leakage:',
*item edituse
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this door. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Open - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Sash - implies an upper and lower opening. '
' '
'Bidirectional - other facilities should confirm'
'the details of two way flow. Control might be'
'applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','WINDOW surface air leakage:',
*subroutine selectuse
*item selectuse
'For QA and code compliance purposes as well as to'
'help auto-generate air flow networks ESP-r allows'
'you to attach SEMANTIC tags to surfaces in a zone.'
' '
'There are a number of types of tags e.g. DOOR, '
'FICT (fictitious construction), FLOOR, FRAME (around'
'a window or door), FURNIture (surfaces representing'
'internal mass), GRILL/SMOKEVNT (surfaces representing'
'specific location of forced air flow), ROOF, STRUC'
'(column or beam), WALL/FLOOR (part of the facade), '
'and either PARTN or `-` to represent other surfaces.'
' '
'There are, of course, more than one kind of DOOR and '
'WINDOW so a second specifier is included. For some '
'objects you will also be asked for indicators of air'
'flow e.g. CLOSED/UNDERCUT/OPEN/BIDIR as qualifiers'
'which specify where air might flow. NOTE: flow'
'inference is not yet implemented. When implemented'
'a zone operation file might detect a mismatch in '
'infiltration if there were cracks or openings noted'
'for surfaces. When implmented such key words could'
'help to auto-generate mass flow networks. '
' '
'For building code complience you will want to set '
'appropriate qualifiers e.g. a WINDOW DISPLAY surface'
'will not be resized to meet code requirements but '
'other surfaces marked WINDOW ORDINARY will. '
' '
'Models which are intended for UK code compliance checking'
'are restricted to a limited set of surface use tags: '
'DOOR PERSONEL, DOOR ENTRANCE, DOOR VEHICLE, WALL, '
'WINDOW NORMAL, WINDOW DISPLAY, WINDOW SKYLIGHT,'
'WINDOW FRAME, ROOF PITCHED (>20deg slope),'
'ROOF FLAT (0deg-20deg slope).'
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item selectuse
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item selectuse
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this door. '
' '
'Undercut signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Open - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Bidirectional - other facilities should confirm'
'the details of two way flow. Control might be'
'applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','DOOR air leakage:',
*item selectuse
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this door. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Open - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Bidirectional - other facilities should confirm'
'the details of two way flow. Control might be'
'applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','FICT surface air leakage:',
*item selectuse
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this door. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Vent - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','FRAME surface air leakage:',
*item selectuse
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this door. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Open - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Sash - implies an upper and lower opening. '
' '
'Bidirectional - other facilities should confirm'
'the details of two way flow. Control might be'
'applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','WINDOW surface air leakage:',
*subroutine EDVERT
*item EDVERT
'This menu allows existing vertices to be viewed and'
*enditem
        CALL PHELPD('configuration section',2,'-',0,0,IER)
*item EDVERT
'*--x-* Vertex on a line: finds one or more points'
'along a line (defined by specifying two vertices).'
' '
'*<-?->* Distance between vertices: gives distance'
'given two vertices.'
' '
'Vertex at angle: finds a (new) vertex relative to'
'a given vertex at a specified distance, angle and'
' '
'Angle between lines: finds angle A between two lines'
'given 3 vertex as in:'
'                            * 1 '
'                           /    '
'                       a  /     '
'                3 *------* 2    '
' '
'The intersection of a line & plane asks you for two'
'points defining a line as well as a plane to test.'
' '
'The intersection of LINES and plan ask for a plane'
'to test and then checks ALL lines that intersects'
'that plane and adds vertices where they cross. This'
'can be used to help subdivide surfaces within a zone.'
*enditem
        call MENUATOL(' ',
*item EDVERT
'Distance along the line in metres.'
*enditem
          CALL EASKR(vdis,' ','Distance along line?',0.001,
*item EDVERT
'Distance is in metres, azimuth assumes North = 0,'
'+ degrees clockwise, elevation of 90 is vertical.'
*enditem
 342      CALL EASKS(HOLD,
*item EDVERT
*enditem
            CALL EASKSUR(ICOMP,IS,'-','Select surface to intersect.',
*item EDVERT
*enditem
          CALL EASKSUR(ICOMP,IS,'-','Select surface to intersect.',
*item EDVERT
'This can become a new vertex. '
*enditem
                  CALL EASKABC(' ',outs,'new vertex',
*item EDVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
  136               CALL EASKS(HOLD,outs,' ',36,' 0. 0. 0. ','vtx co',
*item EDVERT
'The new vertex is within 3mm of an'
'edge of another surface. Probably the'
'vertex should also be included in that'
'other surface so the rules about'
'matching edges are followed. '
*enditem
                      call askok(' ','Insert this vertex?',ok,dok,5)
*item EDVERT
'Last chance to change the vertex position. '
*enditem
            call askok('Is this aligned vertex ok?',' ',ok,dok,1)
*item EDVERT
'The new vertex is within 3mm of an'
'edge of another surface. Probably the'
'vertex should also be included in that'
'other surface so that the rules about'
'matching edges are followed. '
*enditem
                      call askok(' ','Insert this vertex?',
*item EDVERT
'This function lists vertices which are probably'
'duplicates or a close to a given vertex.'
*enditem
          CALL EASKABC(' ','Options:','find close vertices',
*item EDVERT
'Distance (m) along the line in metres. Positive'
'is towards the 2nd vertex; negative is away from'
'the 2nd vertex.'
*enditem
            CALL EASKR(vdis,' ','Movement distance?',
*item EDVERT
'Last chance to abort the change. '
*enditem
            call askok('Apply this move?',' ',OK,dok,1)
*item EDVERT
'This can become a new vertex. '
*enditem
            CALL EASKABC(' ',outs,'new vertex',
*item EDVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
  43          CALL EASKS(HOLD,outs,' ',36,' 0. 0. 0. ','vtx co',IER,2)
*item EDVERT
'The new vertex is within 3mm of an'
'edge of another surface. Probably the'
'vertex should also be included in that'
'other surface so the rules about'
'matching edges are followed. '
*enditem
                      call askok(' ','Insert this vertex?',ok,dok,5)
*item EDVERT
'If you have several vertices along one line you'
'can click ok to continue defining them.'
*enditem
                call askok('Another vertex along the line? ',' ',
*item EDVERT
'If you have several vertices from this origin'
'you can click ok to continue defining them.'
*enditem
                call askok('Another vertex from this origin? ',
*item EDVERT
'If you have several vertices along one line you'
'can click ok to continue defining them.'
*enditem
                call askok('Another intersection of line and plane? ',
*item EDVERT
'If a new vertex is a minor variation of an existing '
'point then it may be easier to copy and then edit. '
' '
'You may delete one or more vertices (but only those'
'which are unlinked to surfaces may be deleted). '
'In graphic mode click on the vertices (end with and `e`)'
' '
'Replication can be used make several varitants of a'
'single vertex (useful where only one coordinate needs'
'to be altered). '
' '
'In graphic mode you can edit a number of vertices by '
'clicking on the wire-frame image. '
' '
'A cancel request leaves the model unchanged. '
*enditem
        CALL EASKATOG(' ','Vertex operations:','add','delete','copy',
*item EDVERT
*enditem
          CALL EASKI(IADD,' ',' How many vertices to add ? ',
*item EDVERT
*enditem
            CALL EASKI(IADD,' ',' Replicate how many times ? ',
*item EDVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
 146          CALL EASKS(HOLD,outs,' ',36,' 0. 0. 0. ','vertex coord',
*item EDVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
  42    CALL EASKS(HOLD,outs,' ',36,' 0. 0. 0. ','vertex coord',IER,2)
*subroutine EDVLIST
*item EDVLIST
'This menu allows existing vertices to be viewed and'
'edited. Edit by selecting an item or -Exit to escape.'
' '
'The `@ check vertex topology` looks for unbounded '
'edges, edges with an adjacent edge ordered in the same'
'direction (one surface probably reversed) and for '
'missing intermediate vertices (where one edge is has'
'more than one adjacent surface). '
' '
'The `>` command to shift a surface along its normal '
'axis updates vertices associated with that surface '
'and thus surfaces sharing these vertices.  Useful '
'for expanding/shrinking a zone. '
' '
'NOTE: it is suggested that the first surface edge be'
'horizontal (or close to horizontal) if at all possible.'
'The shading analysis application gets confused if the'
'first edge of a surface is vertical. Nothing in esp-r'
'warns you of this so get into a consistent habit of '
'avoiding vertical first edges in surfaces. '
' '
'There are several options for adding surfaces to a zone'
' *made from existing vertices - use this if all of the'
'    vertices already exist within the zone.'
' '
' *made from existing vertices (mouse) - the same but you'
'    can select points by clicking on them in the wire-'
'    frame view.'
' '
' *inserted into a surface - this option would allow you'
'    to insert a window or a door or a grill into an'
'    existing surface.'
' '
' *copy surface(s) in this zone - this option allows you'
'    to replicate an existing surface and transform or'
'    rotate it into a new position. Useful if you have'
'    repeating element(s). Most attributes are preserved.'
' '
' *copy surface(s) from another zone - this option allows'
'    you to re-use surfaces defined in another zone such'
'    as a partition. Most surface attributes are preserved'
'    during the copy process. '
' '
' *vertical rectangle - allows you to place a rectangle'
'    which is vertical within or at the edge of the zone.'
' '
' *horizontal rectangle - allows you to place a rectangle'
'    in a horizontal position within or at the edge of the'
'    zone. E.g. to make a desk add a horizontal rectangle'
'    in the correct location and then copy and invert this'
'    surface to form two back-to-back surfaces (and give'
'    them either adiabetic or a partition connection to'
'    the other.'
' '
' *extrude sides and top from a base surface - can take'
'    an initial surface and extrude it to form a closed'
'    set of surfaces taking its shape. A base surface can'
'    be extruded up and a wall initial surface extrudes'
'    sideways.'
*enditem
        CALL PHELPD('vertex section',59,'-',0,0,IER)
*item EDVLIST
*enditem
        CALL EASKSUR(ICOMP,IS,'-','Select surface to act on.',
*item EDVLIST
'Possible actions: '
'  shift surface along surface normal (+ve is outward);'
'  translate vertices by X,Y,Z metres;'
'  rotate surface about one of its vertices;'
'  invert ordering (to swop front and back faces);'
'  apply several operations to the surface;'
'  cancel (no action).'
*enditem
          CALL PHELPD('transform section',7,'-',0,0,IER)
*item EDVLIST
'Distance along the normal (+=out) in metres.'
*enditem
          CALL EASKR(vdis,' ','Distance along normal?',
*item EDVLIST
*enditem
 152      CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
*item EDVLIST
'The rotation is applied around one vertex of'
'the surface. The index is to the 1st, 2nd, 3rd,'
'vertex in the surface. '
' '
'A cancel leaves the model unchanged. '
*enditem
          CALL EASKI(IRV,'Rotate about which vertex index: ',
*item EDVLIST
'The rotation is applied with positive'
'being anticlockwise. '
*enditem
          CALL EASKR(ANGR,' ','Rotation (+ = anticlockwise)?',
*item EDVLIST
'If you say no then no changes to the geometry.'
*enditem
                CALL ASKOK(outs,'Update the vertex?',OK,DOK,1)
*item EDVLIST
'If you say no then no changes to the zone geometry.'
*enditem
        CALL ASKOK('Apply the transformed points to the',
*item EDVLIST
*enditem
        CALL EASKSUR(ICOMP,IS,'-','Select surface to delete.',
*item EDVLIST
'Insertion into an existing surface is a common way '
'to create a door or window opening. '
' '
'You may copy (and then transform) a surface within this '
'zone to make a new surface. An example an identical shape'
'which is repeated in several locations. '
' '
'You may copy (and then transform) a surface from another '
'zone for use in this zone. For example, a partition which'
'shared between two zones. '
' '
'You may create a rectangular surface by specifying its'
'origin and either an azimuth (for vertical) or a '
'rotation between the X axis and its `length edge` for.'
'a horizontal rectangle. '
' '
'Creating a new surface with existing vertices can be '
'done by either entering the indices of each vertex in '
'turn (anticlockwise looking from the outside or clock-'
'wise looking from the inside). '
' '
'NOTE: it is suggested that the first surface edge be'
'horizontal (or close to horizontal) if at all possible.'
'The shading analysis application gets confused if the'
'first edge of a surface is vertical. Nothing in esp-r'
'warns you of this - so get into a consistent habit of'
'avoiding vertical first edges in surfaces! '
' '
'You may take a surface and extrude an enclosure (like'
'the process of creating a zone from a floor plan). With'
'a surface extrusion the shape of the initial surface is'
'repeated as a top to the extrusion Xm along the normal'
'vector and the sides are filled in and given default '
'names. '
' '
'Hint: the extrusion value (if positive) will extrude'
'in the direction of the outward surface normal and if'
'negative it will extrude in inwards. If the original '
'surface is a floor position use a negative extrusion.'
'If the original surface is an exterior wall a negative'
'extrusion value will extude inwards. '
' '
'If you are working in a graphics display you can use'
'mouse clicks on the existing vertices.'
' '
'Options to insert a vertical or horizontal rectangle'
'into the zone have two variange. One creates a single'
'wurface with a name and construction and the MASS'
'option creates a pair of surfaces which are thermally'
'connected as partitions to each other. For the MASS'
'option the construction should represent the full'
'thickness (as opposed to the use of an ADIABETIC'
'connection where the construction represents half of'
'the thickness. '
*enditem
          call MENUATOL(' ','new surface options',
*item EDVLIST
*enditem
          call MENUATOL(' ','new surface options',
*item EDVLIST
*enditem
          CALL EASKSUR(ICOMP,IS,'-','Select surface to insert into.',
*item EDVLIST
'The origin of the surface will be its lower left hand'
'corner when viewed from the outside. '
*enditem
          CALL EASKS(HOLDS,' Vertical surface origin X Y & Z: ',' ',
*item EDVLIST
'The orientation of the new surface is specified via'
'defining its surface normal. A surface polygon which'
'is parallel to the Y axis should face North or South.'
'Azimuth 0.0 is north, 180 is south, 270 is west.'
'Azimuth 90.0 is east '
'Length and height are in metres.'
*enditem
          CALL EASKS(HOLDS,' Surface azimuth (deg) length & height:',
*item EDVLIST
'The origin of the surface will be its lower left hand '
'corner when viewed from the outside. '
*enditem
          CALL EASKS(HOLDS,' Horizontal surface origin X Y & Z: ',' ',
*item EDVLIST
'Rotation is in relation to the first edge along the '
'`length` edge and the X axis (positive is anticlockwise'
'and negative is clockwise.'
*enditem
          CALL EASKS(HOLDS,' Surface rotation (deg) length & height: ',
*item EDVLIST
*enditem
          CALL EASKSUR(ICOMP,IS,'-','Select surface .',
*item EDVLIST
*enditem
          CALL EASKR(vdis,' ','Extrusion distance along normal?',
*item EDVLIST
*enditem
            CALL EASKS(T14,'Revised surface name',
*item EDVLIST
'Well named surfaces (e.g. call a door a door) '
'can help you understand a model better! '
*enditem
          CALL EASKS(T14,'Inserted surface name (12 char max):','  ',
*item EDVLIST
'The list of associated vertices should be given in'
'anticlockwise order as one faces the outside of the'
'surface.  If one is looking at the inside face then'
'think of the list in clockwise order.  It is a con-'
'vention that the first vertex is located at the'
'bottom-left corner of the surface (looking from the'
'outside) with the next vertex moving horizontally.'
'It helps to follow a consistent pattern!'
*enditem
        CALL EASKS248(t248,' Associated vertices (type the indices)?',
*subroutine EPKVERT
*item EPKVERT
*enditem
        CALL PHELPD('vertex pick',NHELP,'-',0,0,IER)
*subroutine surfprm
*subroutine EZIPIN
*subroutine LINTHBRDG
*item LINTHBRDG
'The underlying assumptions about heat flows via'
'thermal bridges depend on whether the facade uses'
'metal cladding. '
' '
'Initial values will be based on the geometry of the'
'room as well as the boundary conditions and the'
'surface use attributes. IF YOU HAVE NOT YET set the'
'boundary conditions or surface use attributes for'
'this zone you should do that first (choose exit).'
' '
'The fixed % option sets thermal bridges equivalent'
'to a percentage of the overall UA value. '
*enditem
            CALL EASKABCD('This zone:','(see help)',
*item LINTHBRDG
'The underlying assumptions about heat flows via'
'thermal bridges depend on whether the facade uses'
'metal cladding. You can setup thermal bridge'
'definitions to fit the specifics of your design.'
' '
'Initial values will be based on the geometry of the'
'room as well as the boundary conditions. IF YOU'
'HAVE NOT YET set the boundary conditions for this'
'zone you should do that first (choose exit). '
' '
'The fixed % option sets thermal bridges equivalent'
'to a percentage of the overall UA value. '
*enditem
            CALL EASKABCD('This zone:','(see help)',
*item LINTHBRDG
'The user needs to define the length of the thermal'
'bridge around junction/openings/etc. Psi values can'
'also be defined or the default values can be used'
'This was based on the BRE IP 1/06 document'
*enditem
        CALL PHELPD('thermal bridge menu',4,'-',0,0,IER)
*item LINTHBRDG
*enditem
          CALL EASKR(thbrpercent,' ',
*item LINTHBRDG
'define psi value of thermal bridge '
*enditem
            CALL EASKR(psiv,phrasepsi(lookfor),msg,
*item LINTHBRDG
'define length of thermal bridge in metres.'
*enditem
              CALL EASKR(lenv,phraselen(lookfor),msg,
*item LINTHBRDG
'define psi value of thermal bridge '
*enditem
          CALL EASKR(psiv,phrasepsi(lookfor),msg,
*item LINTHBRDG
'define length of thermal bridge in metres.'
*enditem
          CALL EASKR(lenv,phraselen(lookfor),msg,
*item LINTHBRDG
'define psi value of thermal bridge '
*enditem
        CALL EASKR(psiv,phrasepsi(lookfor),msg,
*item LINTHBRDG
'define lentgh of thermal bridge in metres.'
*enditem
        CALL EASKR(lenv,phraselen(lookfor),
*subroutine updatesvfc
*subroutine IPVCMD
*subroutine ipvdat
*item ipvdat
'Definition of an Integrated Performance View (IPV) '
' '
'It includes descriptive information: title, version'
'and synopsis and one or more images. These can be'
'edited directly.'
' '
'Performance metrics (comfort, zone dry bulb temp, etc.)'
'are associated with a set of thermal zones and have'
'weighting factors (to assist in ranking performance).'
' '
'Demand sets are sets of zones for which heating, cooling'
'lighting, small power and DHW are reported. Each set'
'has a scaling factor so that, for example 2 offices'
'zones can be scaled to represent 15 offices.'
' '
'Annual performance is scaled from an annual run, three'
'seasonal runs: winter/transition/summer, or five runs:'
'1st winter/spring/summer/autumn/2nd winter. Each run '
'has date and heating and cooling degree day ratio '
'attributes. Periods can be setup based on a best-fit'
'scan of climate data (see option 5).'
' '
'Display days: are specific days (up to 10) for which'
'timestep data is recorded.'
' '
'Seasons are based on information in the `climatelist`'
'file. This information is included to clarify the'
'relationship between each season and the 1/3/5 sim-'
'ulations being run. '
' '
'Ratios: are typically ratios between the number of'
'days (or heating/cooling degree days) of the season'
'and the assessment period. For an annual simulation'
'the ratios are 1.00.'
' '
'Option 5 `re-scan climate` is a two step process;'
'the first to scan the `climatelist` file for the '
'days in each season; the second being scanning the'
'climate data to find the best fit week in each'
'season. '
' '
'Setting up an integrated performance view: '
'a) edit the title version and synopsis, '
'b) select relevant performance metrics for the project,'
'c) select the number of simulations,'
'd) re-scan the climate file for seasons,'
'e) re-scan the climate for ratios,'
'f) select display days (within the simulations).'
' '
'This file holds a description of an Integrated'
'Performance View of this model, including periods,'
'climatic degree day information & associated zones.'
*enditem
            CALL EASKS(ltmp,'IPV description file ?',
*item ipvdat
*enditem
        CALL PHELPD('IPV setup',10,'-',0,0,IER)
*item ipvdat
'The main IPV title (<=40 char). '
*enditem
        CALL EASKS(t40,'IPV tile?',' ',40,'TITLE','IPV Tile',IER,1)
*item ipvdat
'The version of the project or IPV (<=40 char). As in'
'base case or reference 1 etc. '
*enditem
        CALL EASKS(t40,'version ?',' ',40,'base','version',IER,2)
*item ipvdat
'The synopsis is up to 248 characters of text to describe'
'the model and intent of the ipv. You will be presented'
'with the synopsis in sections for purposes of editing.'
'(you can skip to the left and right within the block'
'as required). '
*enditem
        CALL EASKS248(t248,'Synopsis',' ',72,
*item ipvdat
'Images (GIF) can be included in an IPV.'
*enditem
        CALL EASKABCD(outs,'Choices: ','list',
*item ipvdat
'Images (GIF) can be included in an IPV.'
' '
'A cancel results in no change in your model. '
*enditem
          CALL EASKI(IFOC,'Which image (give index) ? ',' ',
*item ipvdat
'This image file will be associated with the IPV. '
*enditem
          CALL EASKS(t72,'Image file name:',' ',72,'xxx','image file',
*item ipvdat
*enditem
            CALL EASKS(t72,'Image file name:',' ',72,'xx','image file',
*item ipvdat
'Simulation start day & month and finish day and month. '
' '
*enditem
        CALL PHELPD('periods',4,'-',0,0,IER)
*item ipvdat
*enditem
          CALL EASKS(HOLD,'Simulation period: start (day & month) and',
*item ipvdat
*enditem
          CALL EASKS(HOLD,'Winter period: start (day & month) and',
*item ipvdat
*enditem
          CALL EASKS(HOLD,'1st winter period: start (day & month) and',
*item ipvdat
'Simulation start day & month and finish day and month. '
' '
*enditem
        CALL PHELPD('periods',4,'-',0,0,IER)
*item ipvdat
*enditem
          CALL EASKS(HOLD,'Transition period: start (day & month) and',
*item ipvdat
*enditem
          CALL EASKS(HOLD,'Spring period: start (day & month) and',
*item ipvdat
'Simulation start day & month and finish day and month. '
' '
*enditem
        CALL PHELPD('periods',4,'-',0,0,IER)
*item ipvdat
*enditem
        CALL EASKS(HOLD,'Summer period: start (day & month) and',
*item ipvdat
'Simulation start day & month and finish day and month. '
' '
*enditem
        CALL PHELPD('periods',4,'-',0,0,IER)
*item ipvdat
*enditem
        CALL EASKS(HOLD,'Autumn period: start (day & month) and',
*item ipvdat
'Simulation start day & month and finish day and month. '
' '
*enditem
        CALL PHELPD('periods',4,'-',0,0,IER)
*item ipvdat
*enditem
        CALL EASKS(HOLD,'2nd winter period: start (day & month) and',
*item ipvdat
'Display day & month. This is a day (one of up to 10)'
'where detailed hourly data will be recovered.'
*enditem
            CALL EASKS(HOLD,'Display day & month: (should be',
*item ipvdat
*enditem
        CALL EASKAB('Options: ',' ','add another day','continue',IW,1)
*item ipvdat
*enditem
          CALL EASKS(HOLD,'Display day & month: (should be',
*item ipvdat
'These multipliers allow for scaling of predictions'
'from a simulation period to a season.  If the'
'simulation period equals the season then use 1.0 or'
'use either a heating degree day ratio or a day ratio'
' '
'If single simulation only edit first number. '
'If three simulations only edit first three numbers.'
'If five simulations edit all numbers.'
' '
'Note: the `rescan climate` function can be used to'
'find these ratios if the simulation period is a '
*enditem
        CALL EASKS(HOLD5,'Seasonal multiplier for heating:',
*item ipvdat
'These multipliers allow for scaling of predictions'
'from a simulation period to a season.  If the'
'simulation period equals the season then use 1.0 or'
'use either a cooling degree day ratio or a day ratio'
' '
'If single simulation only edit first number. '
'If three simulations only edit first three numbers.'
'If five simulations edit all numbers.'
' '
'Note: the `rescan climate` function can be used to'
'find these ratios if the simulation period is a '
*enditem
        CALL EASKS(HOLD5,'Seasonal multiplier for cooling:',
*item ipvdat
'These multipliers allow for scaling of predictions'
'from a simulation period to a season.  If the'
'simulation period equals the season then use 1.0 or'
'use either a daylighting ratio or a day ratio'
' '
'If single simulation only edit first number. '
'If three simulations only edit first three numbers.'
'If five simulations edit all numbers.'
' '
'Note: the `rescan climate` function can be used to'
'find these ratios if the simulation period is a '
*enditem
        CALL EASKS(HOLD5,'Seasonal multiplier for lighting:',
*item ipvdat
'These multipliers allow for scaling of predictions'
'from a simulation period to a season.  If the'
'simulation period equals the season then use 1.0 or'
'use a day ratio (simulation period -> season)'
' '
'If single simulation only edit first number. '
'If three simulations only edit first three numbers.'
'If five simulations edit all numbers.'
' '
'Note: the `rescan climate` function can be used to'
'find these ratios if the simulation period is a '
*enditem
        CALL EASKS(HOLD5,'Seasonal multiplier for small power:',
*item ipvdat
'These multipliers allow for scaling of predictions'
'from a simulation period to a season.  If the'
'simulation period equals the season then use 1.0 or'
'use a day ratio (simulation period -> season)'
' '
'If single simulation only edit first number. '
'If three simulations only edit first three numbers.'
'If five simulations edit all numbers.'
' '
'Note: the `rescan climate` function can be used to'
'find these ratios if the simulation period is a '
*enditem
        CALL EASKS(HOLD5,'Seasonal multiplier for fans & pumps:',
*item ipvdat
'These multipliers allow for scaling of predictions'
'from a simulation period to a season.  If the'
'simulation period equals the season then use 1.0 or'
'use a day ratio (simulation period -> season).'
' '
'If single simulation only edit first number. '
'If three simulations only edit first three numbers.'
'If five simulations edit all numbers.'
' '
'Note: the `rescan climate` function can be used to'
'find these ratios if the simulation period is a '
*enditem
        CALL EASKS(HOLD5,'Seasonal multipliers for domestic hot water:',
*item ipvdat
'Each climate data set may have different seasons and'
'different typical assessment periods. Choosing this '
'will rescan a `climatelist` file and update display.'
' '
'Both the climate tool and the project manager can scan'
'the current climate file to locate the best fit week '
'in each season and return the ratios of days or degree'
'days (for heating and cooling) for use in scaling short'
'simulations to whole seasons.'
*enditem
        CALL EASKABC('Options: ',' ',
*item ipvdat
'Definition of an Integrated Performance View (IPV)'
'includes one or more performance metrics. These are'
'a subset of the metrics which can be found in the'
'results analysis module. '
' '
'Each selected metric has an associated list of zones,'
'and a weighting factor (to give priority in multi-'
'criteria assessments.'
'You can add another metric set or delete an existing set'
*enditem
        CALL EASKABC('Metric set options:',' ','add','delete',
*item ipvdat
'You can delete an existing set. If you request a'
'rather than supplying an index then the model is '
'not changed. '
*enditem
          CALL EASKI(IFOC,'Which metric set (give index) ? ',
*item ipvdat
*enditem
        CALL PHELPD('IPV metrics',8,'-',0,0,IER)
*item ipvdat
'This is a sub-set of the metrics that can be selected'
'in the results analysis module. '
' '
'For each metric the IPV will include statistics,'
'frequency reporting and timestep data for display days.'
' '
'If you need to cancel select the NO CHOICE option. '
*enditem
        CALL PHELPD('metric options',7,'-',0,0,IER)
*item ipvdat
*enditem
      CALL EPICKS(INPIC,IVALS,' ',
*item ipvdat
'Give a short (12 char or less) unique identifier for the'
'group of zones associated with this metric. '
*enditem
      CALL EASKS(t12,
*item ipvdat
'Floor area for zones associated with this metric.'
*enditem
      CALL EASKR(TFLA,' ',' Associated floor area (m^2)? ',
*item ipvdat
'If metric is to be assessed only during occupied '
'periods then supply the casual gain type assiciated '
'with occupancy. A zero means full time occupancy. '
' '
'If you cancel then no changes are made to the metric.'
*enditem
      CALL EASKI(icgv,'Casual gain type associated with occupancy',
*item ipvdat
'Definition of an Integrated Performance View (IPV)'
'include one or more energy demand sets. These are groups'
'of zones which can be combined and/or scaled for'
'reporting and/or analysis purposes.'
'You can add another demand set or delete an existing set'
*enditem
        CALL EASKABC('Demand set options:',' ','add','delete',
*item ipvdat
'You can add delete an existing set and if you choose'
'to cancel then no changes are made to the demand sets.'
*enditem
          CALL EASKI(IFOC,'Which demand set (give index) ? ',
*item ipvdat
*enditem
        CALL PHELPD('IPV demand sets',4,'-',0,0,IER)
*item ipvdat
'Give a short (12 char or less) identifier for this '
'energy demand set to help you remember why you'
'created this set.'
*enditem
      CALL EASKS(t12,'Identifier for this demand set ?',
*item ipvdat
'Pick one, several or all zones for inclusion. You can'
'have one or two sets of zones which can be scaled up '
'to represent a whole building. One set might'
'represent offices and the other support zones.'
*enditem
      CALL EPICKS(INPIC,IVALS,' ',
*item ipvdat
'Floor area for this energy related set of zones.'
*enditem
      CALL EASKR(edgflr(iset),' ','Energy set floor area (m^2)? ',
*item ipvdat
'Multiplier from this set to building. Example: if'
'set results needed to be multiplied by 4.2 '
*enditem
      CALL EASKR(edgsca(iset),' ','Multiplier for energy set? ',
*subroutine ipvseasons
*item ipvseasons
'Select an assessment regime from the list provided.'
'The `winter/spring/summer/autumn` options are based on'
'information in the `climatelist` file for the current'
'climate file. For example if you ask for the summer season'
'the period from the `climatelist` file will be used. '
' '
'The annual assessment will do one simulation for the whole'
'year (this may generate a large results file). '
' '
'The three season option does winter transition and summer'
'runs for a typcial week each season (as determined by'
'an analysis of heating and cooling degree days and solar'
'radiation) a fortnight in each season or all days in the'
'season. '
' '
'The five season option does winter (jan..) spring summer'
'autumn and winter (dec..) for a typical week or fortnight'
'or every day in each season. '
*enditem
        CALL PHELPD('IPV seasons',18,'-',0,0,IER)
*subroutine ipvdatinit
*subroutine ipv2simpar
*subroutine getmultip
*item getmultip
'Degree day calculations are derived from a specific '
'base temperature (deg C). '
*enditem
      CALL EASKR(HBT,' ',' Heating base temperature ? ',
*item getmultip
*enditem
      CALL EASKR(CBT,' ',' Cooling base temperature ? ',
*item getmultip
'There is one winter assessment to represent the first and'
'second winter seasons. The ratios is of the winter'
'assessment period to all winter days and/or degree days.'
*enditem
        call easkab(
*item getmultip
'There is one transition assessment to represent spring'
'and autumn seasons. The ratios is of the transition'
'assessment period to all transition days and/or DD.'
*enditem
        call easkab(
*subroutine makeCFCfile
*item makeCFCfile
' For instructions on importing *.GSL files'
' see "Appendix F: CFC User Reference" from'
' http://uwspace.uwaterloo.ca'
' /bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
' If GSL files have already been imported, select'
' continue.'
' To download the Glazing Shading Layer Editor go to'
' the ESRU website downloads section.'
*enditem
      CALL EASKAB(outs,'Options:',
*item makeCFCfile
' Each CFC type requires a corresponding *.GSL file'
' except when the only difference between two CFCs '
' is the shade layer slat angle. The slat angle is '
' set during the import process.'
' The minimum number of CFC types required is given as'
' default,'
*enditem
      CALL EASKI(ncfctypes,' ','Number of CFC types?',
*item makeCFCfile
 'Assign CFC type to surface. '
' For an example of usage see'
' "Appendix F: CFC User Reference" from'
' http://uwspace.uwaterloo.ca'
' /bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
*enditem
          CALL EASKI(itype,'CFC type for: ',outs,1,'F',
*item makeCFCfile
' Provide the path and file name of the *.GSL file  '
' that corresponds to this CFC type.'
' For an example of usage see'
' "Appendix F: CFC User Reference" from'
' http://uwspace.uwaterloo.ca'
' /bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
*enditem
        CALL EASKS(ltmp,outs,' ',72,ltmp,'GSLedit file name',IER,7)
*item makeCFCfile
' Generate *.GSL file using GSLedit and copy file'
' to desired location within the Model folders.'
' Make sure path is correct.'
' For an example of usage see'
' "Appendix F: CFC User Reference" from'
' http://uwspace.uwaterloo.ca'
' /bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
*enditem
          CALL EASKAB('File not found! ','Options:',
*subroutine importGSLedit
*item importGSLedit
' Vertical or Horizontal Slats: '
' '
' For slat angle sign convention, see Figure F.12 in:'
' "Appendix F: CFC User Reference" from'
' http://uwspace.uwaterloo.ca'
' /bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
*enditem
          CALL EASKAB(outs(1:ln_outs),' ',
*item importGSLedit
' Initial Slat angle:'
' This is a constant if there is not slat control'
' For slat angle sign convention, see Figure F.12 in:'
' "Appendix F: CFC User Reference" from'
' http://uwspace.uwaterloo.ca'
' /bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
*enditem
          CALL EASKR(rphi,' ',outs(1:ln_outs),-89.999,'F',
*item importGSLedit
' CFCs must contain more than one layer.'
*enditem
        CALL PHELPD('file error',2,'-',0,0,IER)
*subroutine read_in_cfc_file
*subroutine askCFCtype
*item askCFCtype
'Select CFC type to apply shading schedule/control.'
*enditem
          CALL PHELPD('Choose CFC type',1,'-',0,0,IER)
*item askCFCtype
'*.cfc file not found'
'CFC input data must first be imported before'
'editing the shading schedule can commence.'
*enditem
        CALL PHELPD('CFC file not found',4,'-',0,0,IER)
*subroutine EDMRT
*item EDMRT
'The zone viewfactor file contains data from the'
'ESRU espvwf program which allows a more robust treatment'
'of longwave radiation within a zone.'
' '
'If you want to ignore the existing viewfactors for this'
'zone click on dereference. '
*enditem
   46   CALL EASKSCMD(LTMP,'Zone viewfactor file? ',' ',
*item EDMRT
'The zone viewfactor file contains data from the'
'ESRU vwf program which allows a more robust treatment'
'of longwave radiation within a zone.'
' '
'If you want to ignore the existing viewfactors for this'
'zone click on dereference. '
*enditem
   47   CALL EASKSCMD(LTMP,'Zone viewfactor file? ',' ',
*item EDMRT
'This menu allows zone viewfactors or MRT sensors to'
'be viewed and edited.  These are then passed to the '
'program `espvwf` for further processing if a robust '
'evaluation of view factors or position dependent '
'mean radiant temperatures is required. '
' '
'View factors may also be created from scratch in'
'this section of prj.  Note that the default treatment'
'is to have area weighted viewfactors which do not'
'require the creation of a view factor file.'
' '
'MRT sensors are rectangular bodies similar to those'
'used for zone obstructions. The default size is a'
'100mm cube.  They are placed within a zone to find '
'the view-factor weighted mean radiant temperature. '
' '
'If you wish you may alter the dimension of the sensor'
'to approximate an occupant or other object. '
*enditem
        CALL PHELPD('mrt sensor',18,'-',0,0,IER)
*item EDMRT
'The zone viewfactor file contains data from the'
'ESRU vwf program which allows a more robust treatment'
'of longwave radiation within a zone.'
*enditem
   48   CALL EASKS(LTMP,' Zone viewfactor file? ',
*item EDMRT
*enditem
        CALL EASKSUR(ICOMP,IS,'-',
*item EDMRT
*enditem
            CALL EASKR(V,outs,' view factor: ',
*item EDMRT
'If the total is not close to one then we suggest'
'that you re-edit the values.'
*enditem
          call easkab(outs,' ','re-edit','continue',IW,2)
*item EDMRT
'The ray-tracing calcs will start a calculation module.'
*enditem
        call easkabc(' Zone viewfactor calculations can be either',
*item EDMRT
'When the computation is completed you will be '
'asked whether you want to make use of this data.'
'The computation may take some time... do not '
'attempt to use the data until it is finished. '
*enditem
          CALL PHELPD('espvwf running',4,'-',0,0,IER)
*item EDMRT
'The previous pop-up message applies.'
*enditem
          CALL EASKABC(' Post calculation choices :',' ',
*subroutine EDMRTS
*item EDMRTS
'The specification of MRT sensors is currently based'
'on a sensor being a prism.  Assuming there is no'
'rotation the width of the sensor is its distance'
'along the X axis, the depth is along the Y axis, and'
'the height is along the Z axis.  The sensor may then'
'be rotated with the angle being measured anticlockwise'
'from the X axis.'
'The origin of the sensor is in site coords. '
*enditem
        CALL EASKR(XOC(ICUB),MSG,'Origin X coordinate?',
*item EDMRTS
'The origin of the sensor is in site coords. '
*enditem
        CALL EASKR(YOC(ICUB),MSG,' Origin Y coordinate?',
*item EDMRTS
'The origin of the sensor is in site coords. '
*enditem
        CALL EASKR(ZOC(ICUB),MSG,'Origin Z coordinate?',
*item EDMRTS
'The width (with no rotation) is along the X axis.'
*enditem
        CALL EASKR(DXC(ICUB),MSG,' Sensor width? ',
*item EDMRTS
'The depth (with no rotation) is along the Y axis.'
*enditem
        CALL EASKR(DYC(ICUB),MSG,' Sensor depth? ',
*item EDMRTS
'The height (with no rotation) is along the Z axis.'
*enditem
        CALL EASKR(DZC(ICUB),MSG,' Sensor height? ',
*item EDMRTS
'Rotation is anticlockwise degrees between the '
'length side of the sensor and the X axis.'
*enditem
        CALL EASKR(CANG(ICUB),MSG,' Sensor rotation? ',
*item EDMRTS
'A descriptive name (up to 6 char) is recommended.'
*enditem
        CALL EASKS(S6,' ',' Name of MRT sensor ? ',
*item EDMRTS
*enditem
        CALL PHELPD('sensor menu',7,'-',0,0,IER)
*subroutine EDOBS
*item EDOBS
'In order to account for external shading devices,'
'window reveals, trees, outside walls, etc. in a'
'detailed shading analysis the user should approx-'
'imate such objects as one or more prisms.'
' '
'The obstruction composition defaults to NONE, but'
'can be set to a multi-layer construction for use in'
'visualisation studies. '
' '
'After defining obstructions select the shading and'
'insolation directives menu option from where you'
'can also ask for a shading & insolation calculations'
'to be run.'
*enditem
        CALL PHELPD('obstr menu',13,'-',0,0,IER)
*item EDOBS
'For shading and daylighting analysis it is useful to'
'use obstruction blocks to represent the thickness '
'of an opening (ie. window reveal). This is automated'
'by adding 4 blocks 5mm away from the surface with a'
'thickness of the adjacent wall.'
' '
'Each of the blocks will share an root name.'
*enditem
        CALL PHELPD('obstr reveal',7,'-',0,0,IER)
*item EDOBS
*enditem
        CALL EASKSUR(ICOMP,IRS,'-','Which surface should the reveal',
*item EDOBS
'This root name will be added to for each of the 4 '
'obstructions: nglz -> nglzs, nglzh, nglzl, nglzr '
'where nglzs is the sill, nglzh is the head, nglzl and'
'nglzr are the left and right fins (seen from outside)'
*enditem
          CALL EASKS(blkroot,' Root name for related obstructions?',
*item EDOBS
'Thickness associated with surrounding wall (m). Check'
'the multi-layer construction for this. '
*enditem
          CALL EASKR(RTK,' ',' Thickness of the wall (m)?',
*item EDOBS
'Choose one or more blocks to rotate or transform'
'within the site coordinate system.'
*enditem
        CALL EASKABC(' Choices:',' ','rotate','transform',
*item EDOBS
'Choose one or more blocks to rotate.'
*enditem
          CALL EPICKS(INPIC,IVALB,' ',' Which obstructions to rotate:',
*item EDOBS
'The rotation is applied at the obstruction origin,'
'with the anticlockwise direction positive. '
*enditem
          CALL EASKR(ANGR,' ','Rotation (degrees, anticlockwise +ve)?',
*item EDOBS
'Rotate obstruction about the site origin or about'
'a specified point.  To rotate about the '
'obstruction origin use the edit option.'
*enditem
            CALL EASKAB(' Rotate about the:',' ',
*item EDOBS
'Point is in the site coordinate system.'
*enditem
              CALL EASKR(x1,' ',' X coordinate (m)?',
*item EDOBS
*enditem
              CALL EASKR(y1,' ',' Y coordinate (m)?',
*item EDOBS
'Choose one or more blocks to transform.'
*enditem
          CALL EPICKS(INPIC,IVALB,' ','Transform which obstructions:',
*item EDOBS
'Offsets are from block origin in metres. '
*enditem
 152      CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
*item EDOBS
'Use this to add / delete / copy obstructions. '
*enditem
        CALL EASKATOG('Modify obstruction list:',' ',
*item EDOBS
'Choose block(s) to delete.'
*enditem
          CALL EPICKS(INPIC,IVALB,' ','Delete which obstruction(s):',
*item EDOBS
'Choose a block to copy.'
*enditem
          CALL EPICKS(INPIC,IVALB,' ','Copy which obstruction:',
*item EDOBS
'Supply a unique block name for this copy (perhaps'
'modifying thenname of the original block) '
*enditem
            CALL EASKS(tbn,' Re-name the obstruction copy:',
*item EDOBS
'Transform shifts a solar obstruction origin'
'by a given amount in X Y Z axis. Leave these'
'at zero if copy should overlay the original. '
*enditem
 243        CALL EASKS(HOLDS,'Transform obstruction (X Y Z metres):',
*item EDOBS
'In order to determine the shading distribution '
'a grid is superimposed on each surface.  This '
'may be between 4 and 20 points in each direction.'
'Detailed grids require more processing time but'
'will allow greater resolution, especially for'
'complex surfaces or those with thin edges.'
*enditem
        CALL EASKS(HOLD,' Surface X & Z grid density:',' ',
*subroutine ECROBS
*item ECROBS
'In order to account for external shading devices,'
'window reveals, trees, outside walls, etc. in a '
'detailed shading analysis the user should'
'approximate such objects as one or more prisms'
'which are described in a site obstruction file.'
' '
'The browse option presents a file list in the project'
'`zones` folder to allow import of legacy obstructions'
'(overwriting any obstructions already held in the zone'
'geometry file.  '
' '
' '
'The browse option presents a file list in the project'
'`zones` folder to associate with obstructions in an'
'exising zone obstruction file. '
' '
'The dereference option removes the reference to any'
'currently associated obstruction file. '
*enditem
            CALL EASKSCMD(LTMP,'Legacy obstructions import (see help):',
*item ECROBS
*enditem
            CALL EASKSCMD(LTMP,'Zone obstructions file (see help):',
*item ECROBS
*enditem
           CALL EASKS2CMD(LTMP,'Legacy obstructions import (see help):',
*item ECROBS
*enditem
           CALL EASKS2CMD(LTMP,'Zone obstructions file (see help):',
*item ECROBS
*enditem
          CALL EASKS2CMD(LTMP,
*item ECROBS
*enditem
          CALL EASKS2CMD(LTMP,'Obstructions file (see help):',
*item ECROBS
*enditem
            CALL EASKS(LTMP,
*item ECROBS
*enditem
          CALL EASKS(LTMP,
*subroutine EDOBSB
*item EDOBSB
'The specification of obstructions is currently based'
'on an obstruction being a prism.  Assuming there is'
'no rotation the width of the block is its distance'
'along the X axis, the depth is along the Y axis, and'
'the height is along the Z axis.'
'  '
'Rotations: '
' First rotation: Assuming the block length dimension is'
' along the X axis the 1st rotation is in the Z axis'
' with a positive angle being measured anticlockwise'
' from the X axis. Note this is currently a different'
' syntax from the rotation of zones.'
' '
' Second rotation: Assuming the block has no first '
' rotation, the 2nd axis of rotation is about the Y axis'
' with the angle being measured between the base face'
' and the horizon + is elevation, - is depression.'
' '
' Third rotation: Tilt is not yet implemented but will.'
' be in the X axis (assuming no other rotations).'
'  '
' The combination of two rotations can be use to make'
' a sloped roof eve or an external shading slat that'
' is horizonal along its length but slanted in a short'
' dimension.'
'  '
'To assist in determining the placement of obstruc- '
'tion blocks the site coordinates of the 4 corners:'
' Front Left  = Block origin, '
' Front Right = Right side (along initial X axis), '
' Back Right  = Side diagonal from block origin '
' '
'The associated zone bounds are also show. '
'The construction gives surfaces properties for use'
'in visualisation applications. '
' '
'A block type obstruction can be converted into a general'
'polygon enclosure with six sides (as long as each face is'
'flat). Such general obstructions could represent non- '
'rectangular objects. '
' '
'The base of a general polygon obstruction is made up of'
'vertices 1 4 3 2. The upper surface is 5 6 7 8. The front'
'surface is 1 2 6 5. The left surface is 4 1 5 8. The '
'right surface is 2 3 7 6. The back surface is 3 4 8 7.'
' '
'Obstructions (will in the future) have an attribute of '
'opacity where 0.0 is transparent and 1.0 is opaque. '
'You can edit the origin of the block, make it the same'
'as a vertex in the zone, or the same as a vertex in'
'the zone after editing.'
*enditem
          CALL EASKABCD('Choices:',' ','edit origin','use zone vertex',
*item EDOBSB
'Distance is in metres, azimuth assumes north=0 '
'+ degrees clockwise, elevation 90 is vertical. '
*enditem
 342          CALL EASKS(HOLD,
*item EDOBSB
'The origin of the block is in site coords. '
*enditem
          CALL EASKS(HOLD,MSG,
*item EDOBSB
'The width (with no rotation) is along the X axis.'
*enditem
          CALL EASKS(HOLD,MSG,' width (X), depth (Y), height (Z) ',
*item EDOBSB
'First rotation: Assuming the block length dimension is'
'along the X axis the 1st rotation is in the Z axis'
'with a positive angle being measured anticlockwise'
'from the X axis. Note this is currently a different'
'syntax from the rotation of zones.'
*enditem
          CALL EASKR(VX,MSG,' Block Z rotation? ',
*item EDOBSB
'Second rotation: Assuming the block has no first '
'rotation, the 2nd axis of rotation is about the Y axis'
'with the angle being measured between the base face'
'and the horizon: + is elevation, - is depression.'
'  '
'The combination of two rotations can be use to make'
'a sloped roof eve or an external shading slat that'
'is horizonal along its length but slanted in a short'
*enditem
          CALL EASKR(VX,MSG,' Block Y rotation (see help)? ',
*item EDOBSB
'A descriptive name (up to 12 char) is required.'
*enditem
          CALL EASKS(S12,' ',' Name of obstruction? ',
*item EDOBSB
'Some shading devices are perforated or otherwise let'
'light pass and thus have an equivalent opacity. This '
'value is 0.0-1.0 where 0.0 is transparent and 1.0 '
'is fully opaque. '
*enditem
          CALL EASKR(VX,MSG,' Block opacity (see help)? ',
*item EDOBSB
*enditem
          CALL PHELPD('obstr menu',48,'-',0,0,IER)
*item EDOBSB
'The first coordinate is the lower front left.'
*enditem
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
*item EDOBSB
'The 2nd coordinate is the lower front right.'
*enditem
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
*item EDOBSB
'The 3rd coordinate is the lower back right.'
*enditem
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
*item EDOBSB
'The 4th coordinate is the lower back left.'
*enditem
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
*item EDOBSB
'The 5th coordinate is the upper front left.'
*enditem
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
*item EDOBSB
'The 6th coordinate is the upper front right.'
*enditem
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
*item EDOBSB
'The 7th coordinate is the upper back right.'
*enditem
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
*item EDOBSB
'The 8th coordinate is the upper back left.'
*enditem
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
*item EDOBSB
'A descriptive name (up to 12 char) is required.'
*enditem
          CALL EASKS(S12,' ',' Name of obstruction? ',
*item EDOBSB
'Some shading devices are perforated or otherwise let'
'light pass and thus have an equivalent opacity. This '
'value is 0.0-1.0 where 0.0 is transparent and 1.0 '
'is fully opaque. '
*enditem
          CALL EASKR(VX,MSG,' Block opacity (see help)? ',
*item EDOBSB
*enditem
          CALL PHELPD('obstr menu',48,'-',0,0,IER)
*subroutine EREVEAL
*item EREVEAL
'Reveals only created around a rectangular opening. '
'You can specify 4 corners (i.e. 4 vertices, '
'beginning lower left and going anti-clockwise). '
*enditem
        CALL EASKAB('The selected surface doesn`t have 4 sides.',
*item EREVEAL
'You can specify 4 corners (i.e. 4 vertices, '
'beginning lower left and going anti-clockwise). '
*enditem
 153      CALL EASKS(HOLDS,' 4 vertices defining corners: ',' ',
*subroutine EDACONN
*item EDACONN
'The problem contiguity (boundary conditions at surfaces)'
'are set in this menu.  Before a simulation can be'
'performed it is necessary that it be complete.'
' '
'There are several means to define the topology: '
' a) attribute surfaces via the zone geometry facility'
'    as they are created,'
'    '
' b) manually edit them via this list, '
'    '
' c) search for matching vertices within the problem to'
'    fill in all partitions and then complete this list'
'    by editing or importing surface attributes.'
' '
'The automated facility is considerably faster than'
'manual methods and best used when all the zones have'
'been created. '
*enditem
        CALL PHELPD('connection section',17,'-',0,0,IER)
*item EDACONN
'The boundary conditions at the other face of this sur-'
'face is specified via the selection of one of these'
'choices.  The default is OUTSIDE.'
' '
' Exterior - the other face of the surface is exposed to'
'  ambient air temperature, wind and solar radiation.'
' '
' Dynamic/similar - the other face of the surface is'
'  exposed to the same conditions as the inside face'
'  (except that when direct sunlight is falling on the'
'  inside face it cannot be falling on the other face'
'  only the diffuse component is used on the other face.'
'  where both sides get the same radiation.'
'  A dynamic/similar connection can include an offset'
'  temperature (C) and radiation (W/m^2).'
' '
' Static - requires that a constant temperature and'
'  radiation be supplied. You might use this to represent'
'  a cold storage room.'
' '
' Surface in another zone - the other face of the surface'
'  gets its boundary conditions from the last known state'
'  of the other surface. There is a thermophysical con-'
'  nection established between the two zones.'
' '
' Ground (standard profile) - the other face of the'
'  surface is in direct contact with one of the standard'
'  monthly temperature profiles embedded in ESP-r.'
' '
' Ground (user defined profile) - the other face of the'
'  surface is in direct contact with a monthly profile'
'  previously created by the user (in the model context)'
' '
' Ground (3D conduction) - the other face connects to a'
'  3D ground representation. This is not often used.'
' '
' Adiabatic boundary - typically used for back-to-back'
'  surfaces in a zone representing thermal mass. There'
'  is no heat flux passed beyond the other-face. '
' '
' BASESIMP is used to represent one of several basement'
'  configurations and precalculated patterns of heat'
'  transfer. For this to be useful there must be a'
'  basesimp file created for the zone giving a number'
'  of dimensions and computational parameters.'
' '
' CEN 13791 partition which is like the SIMILAR'
'  but for CEN 13791 test. The offset temperauture'
'  and radiation (W/m^2) in SIMILAR is not available'
'  for the CEN 13791 partition type. For details see'
'  section 4.4.2 CEN 13791 standard. '
*enditem
        call MENUATOL(outs,' Connection options ',
*item EDACONN
'A similar (type 1) connection can include an offset'
'temperature and radiation (W/m^2) from that of the'
'current zone. For example, if the adjacent space'
'which has not been geometrically defined tends to '
'be 2degC cooler then use a -2 offset. '
' '
'(units are in whole degC and whole W) '
' '
'Use care when setting a high offset temperature.'
*enditem
          CALL EASKR(VALT,' Offset temperature? [default=0.0]',
*item EDACONN
*enditem
          CALL EASKR(VALW,' Offset radiation source (W/m^2)?',
*item EDACONN
'A type 2 connection requires that a constant '
'temperature and radiation (Watts) be entered.'
' '
'Use care when setting a high adjacent temperature.'
*enditem
          CALL EASKR(VAL,' ',' Constant temperature ? ',
*item EDACONN
*enditem
          CALL EASKR(VAL,' ',
*item EDACONN
*enditem
          CALL EASKGEOF('Select zone on other side:',CFGOK,IZ,'-',IER)
*item EDACONN
*enditem
          CALL EASKSUR(IZ,IS,'-','Select surface in the adjacent',
*item EDACONN
'Where a pair of surfaces form a partition between'
'two zones changes in one sides attributes should'
'be reflected in the other side to maintain model'
'consistency. Usually you want to update the other'
'side.  '
*enditem
            CALL ASKOK(' ','Update other side?',updoth,dok,5)
*item EDACONN
'A ground connection allows either:'
'> 0 a connection to one of several standard profiles'
'    in which case the profile number is required.'
'= 0 a connection to a user defined profile in which'
'    case a 0 followed by a profile number is '
'    required.'
'-3  a connection to a 3D ground model.'
*enditem
  777     CALL EASKI(IIC2,' Monthly (standard) profile index? ',
*item EDACONN
'One of the user defined profile numbers is'
'required at this point.'
*enditem
            CALL EASKI(IIE2,' User defined ground profile index ?',
*item EDACONN
'Specify the BASESIMP configuration number (iconfig). '
'Refer to src/esp-r/esrubld/bscoeff.F for the '
'correspondence between iconfig and standard BASESIMP '
'descriptors (e.g. BCIN_1).'
'BASESIMP is a `whole-foundation model`. Therefore, when'
'a foundation is represented by numerous ESP-r surfaces'
'(e.g. four walls + floor to represent a basement), you'
'must specify the percentage of the whole-foundation'
'heat loss to attribute to each surface. Normally the'
'sum of surfaces representing a founcation is 100%.'
*enditem
          CALL EASKI(Ifrac,' Percent of BASESIMP loss to this surface?'
*subroutine EDOPT
*item EDOPT
'Optical properties are used for transparent constructions'
'as well as to support daylighting calculations and the'
'control of casual gains.  All data is used except for '
'that which is marked as (documentation).'
' '
'For QA purposes you may fill in the surface solar abs'
'& refl values to match the MLC surface properties.'
'The Uvalue is for documentation only. Similarly, '
'solar heat gain coefficients are not used by ESP-r but '
'can be included for documentation purposes. '
' '
'The angular reflections are derived from the overall '
'solar transmission and layer absorptions. '
' '
'The import function currently recognises files from '
'the LBL program WINDOW 4.1/5.1/5.2/6.2 Here is a step'
'by step guide to importing optical data. '
' '
'1) Start up W4.exe and use the Function 5 key to enter '
' the glazing system library. '
' '
'2) If you have existing glazing systems select one and '
' ensure that angular properties have been calculated'
' via Function 9 key. If the angular properties have not'
' been calculated press A to turn on angular calcs.'
' This should fill up the table. Type escape to return'
' to the main W4 window. For safety type alt S to save'
' the current description. Then then alt P to print'
' the data for the currently highlighted glazing system.'
' '
' You will be asked if it is Library or Detail, select '
' Detail and then give it a file name. It may take a few'
' moments for it to compelete the calculations before'
' it finishes writing the file.'
' '
'3) If you want to create a new glazing system type A for'
' Add and then either N for New or C for Copy. Hint:'
' scan the Glass Lib via Function 3 to confirm the'
' glass code numbers you want to use first.'
' Double check the layer thickness is correct. In W4 (as'
' in esp-r) layer 1 is at the outside face and sub-'
' sequent layers are towards the room. Once the layers'
' have been defined press the space key to force initial'
' calculations. Escape back to the main menu, and then'
' type Function 9 to calculate angular properties.'
' Once this is done escape back to the main menu and use'
' alt S to save and alt P to print (as described above).'
' '
'4) Edit the reports from W4 to remove the null character'
' before the word Temperature Distribution.'
' '
'5) Transfer edited report to esp-r folder (use dos2unix'
' if necessary to convert line endings). In the Project'
' Manger use the import option in the optical database  '
' facility and supply the W4 print file name. A'
' correct translation should result in a graph of the'
' properties. Change the id string and description and'
' check that the number of layers is correct.'
'In order to reflect changes you have made in this db'
'in the current model you will have to rebuild the '
'zone construction and tmc files.  This is in option '
'`Construction` of the `model definition` menu.'
*enditem
          CALL PHELPD('optical db update',4,'-',0,0,IER)
*item EDOPT
*enditem
        CALL PHELPD('optics db',58,'-',0,0,IER)
*item EDOPT
'You can direct optical details to file or display'
*enditem
        CALL EASKABC(' Reporting to:',' ',
*item EDOPT
'Options: Import reads from Window4.1 screen dumps'
'or the reports generated by Window 5.1 or 5.2 or'
'Window v6.'
' '
'Note that Window 5.1/2 & v6 files have the thickness of'
'the layer in an unreadable location so be sure to'
'correct the thickness after the import.'
' '
'Add/Delete/Copy work on current contents of db. '
*enditem
        CALL EASKATOG('Optical actions: ',' ',
*item EDOPT
'This is a WIS report file. You should provide the'
'full path to this file.'
*enditem
          CALL EASKS(lfil,'WIS file name?',
*item EDOPT
'The layout of glazing, air gaps and blinds can'
'be selected from this list or an alternative '
' '
'A cancel request leaves the model unchanged.'
*enditem
            CALL EPICKS(IX,IVALSS,' ','Typical glazing types:',
*item EDOPT
*enditem
              CALL EASKI(nl,' ',' Number of layers in the new set ?',
*item EDOPT
'Select on of the existing glazings to delete.'
*enditem
          CALL EPICKS(IX,IGSET,' ','Optical set to delete:',
*item EDOPT
'Last chance to avoid deleting the optical set. '
*enditem
            CALL ASKOK(' ',' Are you sure?',OK,dok,1)
*item EDOPT
'Select on of the existing glazings to copy.'
*enditem
            CALL EPICKS(IX,IGSET,' ','Optical set to copy:',
*subroutine OPT2TMP
*subroutine EDITOPT
*item EDITOPT
'Optical properties are used for transparent constructions'
'as well as to support daylighting calculations and the'
'control of casual gains.  All data is used except for '
'that which is marked as (documentation).'
' '
'For QA purposes you may fill in the surface solar abs'
'& refl values to match the MLC surface properties.'
'The Uvalue is for documentation only. Similarly, '
'solar heat gain coefficients are not used by ESP-r but '
'can be included for documentation purposes. '
' '
'The angular reflections are derived from the overall '
'solar transmission and layer absorptions. '
' '
'The import function currently recognises files from '
'the LBL program WINDOW 4.1 Here is a step by step guide'
'to importing optical data. '
' '
'1) Start up W4.exe and use the Function 5 key to enter '
' the glazing system library. '
' '
'2) If you have existing glazing systems select one and '
' ensure that angular properties have been calculated'
' via Function 9 key. If the angular properties have not'
' been calculated press A to turn on angular calcs.'
' This should fill up the table. Type escape to return'
' to the main W4 window. For safety type alt S to save'
' the current description. Then then alt P to print'
' the data for the currently highlighted glazing system.'
' '
' You will be asked if it is Library or Detail, select '
' Detail and then give it a file name. It may take a few'
' moments for it to compelete the calculations before'
' it finishes writing the file.'
' '
'3) If you want to create a new glazing system type A for'
' Add and then either N for New or C for Copy. Hint:'
' scan the Glass Lib via Function 3 to confirm the'
' glass code numbers you want to use first.'
' Double check the layer thickness is correct. In W4 (as'
' in esp-r) layer 1 is at the outside face and sub-'
' sequent layers are towards the room. Once the layers'
' have been defined press the space key to force initial'
' calculations. Escape back to the main menu, and then'
' type Function 9 to calculate angular properties.'
' Once this is done escape back to the main menu and use'
' alt S to save and alt P to print (as described above).'
' '
'4) Edit the reports from W4 to remove the null character'
' before the word Temperature Distribution.'
' '
'5) Transfer edited report to esp-r folder (use dos2unix'
' if necessary to convert line endings). In the Project'
' Manger use the import option in the optical database  '
' facility and supply the W4 print file name. A'
' correct translation should result in a graph of the'
' properties. Change the id string and description and'
' check that the number of layers is correct.'
*enditem
        CALL PHELPD('optics set',58,'-',0,0,IER)
*item EDITOPT
'For insert the point of insertion will be at the location'
'selected. For copy the layer copied will be placed at the'
'inside face.'
*enditem
        CALL EASKABCD('Layer actions: ',' ','Add (insert)',
*item EDITOPT
'Select a position to add/insert a new layer...'
*enditem
            CALL EPICKS(IX,IGSET,' ','Point of insertion:',43,NTLED+1,
*item EDITOPT
'Select a layer to delete...'
*enditem
          CALL EPICKS(IX,IGSET,' ','Layer to delete:',43,NTLED,
*item EDITOPT
'Select a layer to copy. It will become a new inside'
*enditem
          CALL EPICKS(IX,IGSET,' ','Layer to copy:',43,NTLED,
*item EDITOPT
'This should be a UNIQUE identifier of up to 12 char '
'with no spaces. '
*enditem
        CALL EASKS(T12,'Id string ?',' ',12,GTYPE,'opt id',IER,2)
*item EDITOPT
'This is an aide memorie for this set of optics. '
*enditem
        CALL EASKS(GDESCR,'Description ?',' ',36,'new','opt desc',IER,1)
*item EDITOPT
'The visible transmission is used in daylighting calcs.'
*enditem
        CALL EASKR(VTRNED,' ','Visable transmission? ',
*item EDITOPT
'The overall solar reflectance and absorption are '
'not yet used in the calculations - documentation only'
*enditem
        CALL EASKS(hold,'Solar absoption & reflectance?',
*item EDITOPT
'The visible transmission is used in daylighting calcs.'
'The U value is currently for documentation only.'
*enditem
        CALL EASKR(UVALED,'U value','(documentation): ',
*item EDITOPT
'The overall solar transmittance at 5 angles (from '
'normal @0deg 40deg 55deg 70deg 80deg)'
*enditem
        CALL EASKS(hold,'Solar trn @ 0 40 55 70 80 deg:',
*item EDITOPT
'The visible transmission is used in daylighting calcs.'
'The overall heat gain (for documentation purposes) at 5 '
'angles (from normal @0deg 40deg 55deg 70deg 80deg)'
*enditem
        CALL EASKS(hold,'Overall heat gain @ 0 40 55 70 80 deg:',
*item EDITOPT
'The Refraction index for glass is usually 1.52.'
'Absorption (from normal @0deg 40deg 55deg 70deg 80deg)'
*enditem
        CALL EASKS(hold,'Refraction index, absorb @ 0 40 55 70 80 deg:',
*subroutine IMPOPT
*item IMPOPT
'This is either a WINDOW 4.1 Optical Properties file or '
'a WINDOW 4.1 or WINDOW 5.1 or 5.2 glazing system file'
'or a WINDOW 6.1 or 6.2 glazing system file.'
*enditem
      CALL EASKS(lwin4,' Optical import file name? ',
*subroutine IMPWIS
*item IMPWIS
'This is a WIS transparent system report file which '
'<< more text >>'
*enditem
      CALL EASKS(lwin4,' WIS report file to import? ',
*subroutine edbioptics
*item edbioptics
'ESP-r accepts measured optical properties at 5 degree'
'intervals over a hemisphere. This high resolution optical'
'data can be associated with surfaces in the model. Note'
'that each such surface is assumed to have a normal '
'optical attribute.'
' '
'Currently this data is read in from an external file.'
'See esrucom/econstr.F or ask ESRU for details on the '
'file format. An example is given here. '
'Lines starting with # are optional and for documentation '
'purposes: '
'*BIDIRECTIONAL '
'*types,1 '
'*item, Genius internal with heat mirror DGU '
'##(3 datatypes: Te_g_rho, Te_abs_n_diffuse, Te_g_only) '
'*datatype,Te_g_rho '
'*layers,3 '
'*sets,6 '
'## Next four lines are not used (only for documentation)'
'## Properties of DGU: '
'## WSV Iplus neutral E (4mm/16mm/4mm) '
'## g0 = 0.60; '
'## tauvis0 = 0.80; '
'## udgu := 1.1; '
'*start_set '
'*set_type 1,#slat angle = 0deg '
'*Uvalue 1.1 '
'*Rexternal 0.04 '
'*Rinternal 0.13 '
'#Next 2 lines: only used for datatype 1 (Te_abs_n_diffuse)'
'*diffuse_abs,0.260,0.521,0.002,0.000,0.007 '
'*diffuse_trn,0.345 '
'*direct_angs,37,37 '
'*data '
'#Azimuth,Height,Te,g,rho '
'-90,-90,0,0,1 '
'-90,-85,0,0,1 '
'-90,-80,0,0,1 '
'... '
'90,85,0,0,1 '
'90,90,0,0,1 '
'*end_set '
'*start_set '
'*set_type 2,#slat angle = 15deg '
'*Uvalue 1.1 '
'*Rexternal 0.04 '
'*Rinternal 0.13 '
'#Next 2 lines: only used for datatype 1 (Te_abs_n_diffuse)'
'*diffuse_abs,0.260,0.521,0.002,0.000,0.007 '
'*diffuse_trn,0.345 '
'*direct_angs,37,37 '
'*data '
'#Azimuth,Height,Te,g,rho '
'-90,-90,0,0,1 '
'-90,-85,0,0,1 '
'... '
'90,85,0,0,1 '
'90,90,0,0,1 '
'*end_set '
' '
*enditem
        CALL PHELPD('bi-directional attributes',60,'-',0,0,IER)
*item edbioptics
'This is a high resolution bi-directional optical data'
'file << more text >>'
*enditem
        CALL EASKS(lfil,' bi-directional optical data to use?',
*item edbioptics
'Select if you want to re-define the bi-directional file'
*enditem
          call easkab(' File not found. Do you want to specify again?',
*item edbioptics
'If this surface fits your critera then proceed.'
*enditem
C          CALL ASKOK(
*item edbioptics
'There are a limited number of types. '
' '
'A cancel request leaves the model unchanged.'
*enditem
C              CALL EASKI(nl,' ',' Which bi-directional type?',
*item edbioptics
'This surface uses bi-directional optics and'
'you can remove this attribute. '
*enditem
C          CALL ASKOK(
*subroutine CASFMK
*item CASFMK
 '   Events Database '
 ' '
 'Profiles in this database are currently used to  '
 'assist in the defintion of zone operations.  The'
 'standard is found in /usr/esru/esp-r/databases '
 ' '
 ' The data requirements are summarised below :- '
 ' '
' for each profile - number of events.'
' '
' for each event - start and finish time'
'                  percentage of first (sensible) value'
'                  percentage of second (latent) value'
' '
'If you edit data in the database the ASCII file will be'
'updated. Consider using a model specific file if you'
'need custom profiles.'
*enditem
        CALL PHELPD('event profiles',18,'-',0,0,IER)
*item CASFMK
'An event is equivalent to a period of time with'
'associated values. '
' '
'A cancel request leaves the model unchanged.'
*enditem
        CALL EASKI(IV,' ','Number of events in profile: ',
*subroutine EDPROF
*item EDPROF
'If you edit in actual start times the subsequent '
'editing tasks will be easier. '
*enditem
        CALL EASKS(CSTR,' Start hour of each event',
*item EDPROF
'You may alter the start and/or stop times of any '
'period as well as the associated values. For casual'
'gain type profiles the first value is the sensible '
'and the second is the latent. '
' '
'When a change is made to the data a fresh copy of '
'the ASCII version will be written out. '
' '
'Models pointing to binary versions of this file will'
'will be converted to ASCII versions after editing.'
*enditem
        CALL PHELPD('pro edit',10,'-',0,0,IER)
*item EDPROF
'The description (up to 40 char) is provided as a way '
'to select a profile.  It helps to make it unique.'
*enditem
        CALL EASKS(TMP,' Description ? ',
*subroutine EDEVENT
*item EDEVENT
'An event may start between hours 0 and 23. '
' '
'A cancel request leaves the model unchanged.'
*enditem
      CALL EASKI(IES,outs,' start hour : ',
*item EDEVENT
'An event may finish  between hours 1 and 24.'
' '
'A cancel request leaves the model unchanged.'
*enditem
      CALL EASKI(IEF,outs,' finish hour: ',
*item EDEVENT
*enditem
        CALL EASKAB(' Finish time overlaps next event...',
*item EDEVENT
'The first value is the percentage of sensible gain.'
*enditem
      CALL EASKR(EC,' ',' First value (sensible) percentage ? ',
*item EDEVENT
'The second value is the percentage of latent gain.'
*enditem
      CALL EASKR(EL,' ',' Second value (latent) percentage ? ',
*subroutine EDSPLIST
*item EDSPLIST
'If you know of the name of an existing file click on'
'ok. If you want to create one say no. '
*enditem
        CALL ASKOK('Does a special components file exist?',' ',OK,dok,2)
*item EDSPLIST
'If you have the data needed to create this portion of'
'the model say ok. '
*enditem
          CALL ASKOK('Would you like to create a new special',
*item EDSPLIST
'This file contains information about special components'
'integrated into the building fabric. Examples include:'
'facade integrated photovoltaics, ducted wind turbines,'
'phase change materials, thermochromic glazing, etc.'
*enditem
        call easks(lfil,' ',' Special components filename?',72,
*item EDSPLIST
'This menu controls the definition of special'
'components in the model. Special component properties '
'supports features such as integrated photovoltaics or'
'and phase change materials. '
' '
'Each entry is given a name and includes positional '
'information to link it to a surface/layer within'
'the building model.  NOTE that changes to zones such '
'as adding/deleting surfaces or changing composition '
'is not automatically updated. '
*enditem
        CALL PHELPD('special component edit',10,'-',0,0,IER)
*item EDSPLIST
' '
*enditem
        CALL EASKABCD('Options:',' ','delete component',
*item EDSPLIST
'Last chance to avoid editing the component. '
*enditem
            CALL ASKOK('Edit this component?',' ',OK,dok,1)
*subroutine EDSPM
*item EDSPM
'The menu options relate to different categories'
'of special components which may be selected for'
'integration into the building. Select a category'
*enditem
        call phelpd('Special component',3,'-',0,0,IER)
*item EDSPM
'Select a special component from the list. Each material  '
'shown is associated with a set of pre-defined parameters'
',these can be altered if required. '
'  '
'  '
'Switching the "component info" toggle to ON lets the'
'user view any more information associated with the   '
'special component; this appears in the text window. '
*enditem
          CALL PHELPD('Special material',8,'-',0,0,IER)
*item EDSPM
*enditem
      call easks(labl,' ',' Label for material (no spaces)?',16,
*item EDSPM
'Enter the required data for the special component. '
'Either accept the default values or enter your own'
'data.                                             '
*enditem
      call phelpd('Special mat data',3,'-',0,0,IER)
*item EDSPM
*enditem
            call easkr(datsp,outs,' ',1.,'-',99.,'-',1.0,'SPM data',
*item EDSPM
*enditem
            call easkr(datsp,outs,' ',1.,'-',99.,'-',1.0,'SPM data',
*item EDSPM
*enditem
      CALL ASKZONE(IZ,0,OUTS,'Select zone','-','spm locate',IER)
*item EDSPM
*enditem
        CALL EASKSUR(IZ,ISO,'-','Select surface for DWT','inlet.',IER)
*item EDSPM
*enditem
        CALL EASKSUR(IZ,ISO,'-','Select surface for special',
*item EDSPM
'To enable the calculation of wind-induced surface'
'pressures (as required by the ducted wind turbine'
'model), a database of angle dependent pressure'
'coefficients is provided.'
'The default ESP-r set contains wind pressure coeffi-'
'cients for surfaces in typical positions and within '
'several different exposure categories.'
'They can be used (with care) for low-rise buildings.'
'See the ESP manual for additional info.'
' '
'It is also possible to calculate pressure coeffi-'
'cients using CpCalc (see database maintenance).'
' '
'Select the pressure coefficient from this list, '
'which is most appropriate for the location of the '
'ducted wind turbine.'
' '
'Notes about pressure coefficients: '
'The first 27 data sets in the standard pressure coef'
'database are from the Air Infiltration & Ventilation'
'Centre Handbook called <Air Infiltration Calculation'
'Techniques - An Applications Guide>. The 27 data '
'sets are only applicable for buildings up to 3 '
'storeys andcome with the usual warnings about usage'
'of the data. '
' '
'Each data set is described with the following terms:'
' a) facade or roof at different roof pitch angles'
' b) the ratio of the building length to width and'
'    for a non square building there will be a long'
'    and a short wall to select'
' c) site shielding as follows:'
'   exposed - open countryside with no obstructions'
'   simi-exposed - rural with some obstructions'
'   sheltered - urban, surrounded on all sides by'
'     obstructions of similar size.'
*enditem
          CALL PHELPD('databases overview',36,'-',0,0,IER)
*item EDSPM
'A chance to correct selection error.'
*enditem
        CALL ASKOK(t72,'as the pressure coefficient set?',OK,dok,1)
*item EDSPM
'This angle is used to derive the boundary pressure, '
'which is angular dependent, from the pressure coef db'
'and the current wind speed and direction.'
*enditem
        CALL EASKR(VAL,' ',
*item EDSPM
*enditem
        CALL ASKZONE(IZ,0,OUTS,'Select zone','-','spm locate',IER)
*item EDSPM
*enditem
        CALL EASKSUR(IZ,ISO,'-','Select surface for DWT','outlet.',IER)
*item EDSPM
'To enable the calculation of wind-induced surface'
'pressures (as required by the ducted wind turbine'
'model), a database of angle dependent pressure'
'coefficients is provided.'
'The default ESP-r set contains wind pressure coeffi-'
'cients for surfaces in typical positions and within '
'several different exposure categories.'
'They can be used (with care) for low-rise buildings.'
'See the ESP manual for additional info.'
' '
'It is also possible to calculate pressure coeffi-'
'cients using CpCalc (see database maintenance).'
' '
'Select the pressure coefficient from this list, '
'which is most appropriate for the location of the '
'ducted wind turbine.'
*enditem
          CALL PHELPD('databases overview',16,'-',0,0,IER)
*item EDSPM
'A chance to correct selection made in error. '
*enditem
        CALL ASKOK(t72,'as the pressure coefficient set?',OK,dok,1)
*item EDSPM
*enditem
        CALL EASKR(VAL,' ',
*item EDSPM
'Choose a layer at which to situate a special'
'materials node.                                     '
'Select a node within the layer in which to position'
'the special component. The value given is the node in'
'the centre of the layer.'
'  '
'If a PV component is chosen and the ALL the '
'construction layers are opaque then the node should'
'be placed at the outside surface (node no. 1).'
' '
'A cancel request leaves the model unchanged.'
*enditem
          call easki(nodloc,' Position component at ',
*item EDSPM
'This is a location that can accept another node.'
*enditem
                call askok(' An existing special component exists at',
*item EDSPM
*enditem
          call phelpd('Special material',2,'-',0,0,IER)
*subroutine EDCONN
*item EDCONN
'The model contiguity ie. the boundary conditions'
'at surfaces are set in this menu.  Before a simulation'
'can be performed it is necessary that it be complete.'
' '
'There are several means to define the topology: '
' a) attribute surfaces via the zone geometry facility'
'    as they are created,'
'    '
' b) manually edit them via the `cfg` facility, '
'    '
' c) search for matching vertices within the model'
'    to fill in all partitions and then complete this'
'    list by editing or importing surface attributes.'
' '
'If internal mass in zone or explicit blinds have been'
'defined as back-to-back surfaces then they will be'
'treated as partitions unless you force confirmation.'
' '
'The automated facility is considerably faster than'
'manual methods and best used when all the zones have'
'been created. '
*enditem
        CALL PHELPD('connection section',21,'surf_topo   ',0,0,IER)
*item EDCONN
'The tolerance is expressed in metres and applies to'
'the X, Y & Z of each vertex.'
*enditem
        CALL EASKR(CACC,' ',' Tolerance (metres) ? ',
*item EDCONN
'The tolerance is expressed in degrees and allows the'
'user to control how much of a change in direction'
'along a line constitutes a surface corner.  If set '
'too small, it will pick up minor vertices along a '
'side as corners. '
*enditem
        CALL EASKR(DACC,' ',' Corner tolerance (degrees) ?',
*item EDCONN
'Within cfg the shape of a surface is determined by'
'the number of corners within the surface polygon.'
'Vertices which lie along a line are not counted unless'
'the angle of the line changes by several degrees.'
'If the difference is 0 then both surfaces must have '
'the same number of corners and they must be within '
'the distance tolerance specified.  Increasing this'
'number will allow for one or more of the corners to'
'be out of tolerance and still be presented to the'
'user for confirmation. '
*enditem
        CALL EASKI(IACC,' Number of corners which are allowed outside',
*item EDCONN
'Typically, you would want to include existing '
'partitions in the list of surfaces to check.'
'You are allowed to exclude them even though it '
'is a dangerous option for expert users. '
*enditem
          call askok('Are you sure you want to skip marked partitions?',
*item EDCONN
'This option will result in any surface which does'
'not conform to the geometric matching criteria to be'
'assumed to have an EXTERNAL boundary condition.'
'If you want to choose the boundary condition then'
'you should toggle `no match found` to YES.'
*enditem
          CALL PHELPD('cfg import atrib',5,'-',0,0,IER)
*item EDCONN
'Typically, back-to-back surfaces in a room represent'
'mass and/or blinds and if these surfaces are connected'
'to each other heat will flow. If you want the option'
'to reset these to ADIABETIC say YES. '
*enditem
          call askok('Do you want to confirm back-to-back surfaces',
*item EDCONN
'In restructuring a model it is sometimes useful to '
'redefine the topology.'
' '
'The `clear subset` asks for each type of connection '
'(partitions/identical etc.) to clear. '
' '
'The `clear all` will rebuild the whole master list '
'and this should be done if the list has been corrupted.'
*enditem
        CALL EASKABC(' Topology Options:',' ','clear all topology',
*item EDCONN
*enditem
          call askok('About to clear ALL contiguity.','Is this ok',
*item EDCONN
'After clearing contiguity you can re-establish some of'
'the connections via surface attributes (adiabetic,'
'similar, constant and ground connections). If these.'
'attributes are YES in the list of boundary type'
'toggles (choices c-h) then you will be asked for '
'confirmation. '
' '
'Answering yes to this question can save you lots of '
'time. '
*enditem
          call askok('Recover surface attribute data?',
*item EDCONN
'The `clear subset` asks for each type of connection '
'(partitions/identical etc.) to clear. '
' '
'Say yes to SIMILAR and/or CONSTANT and/or GROUND'
'and/or ADIABETIC if you want to clear connections'
'of surfaces matching these boundary types. '
*enditem
          call askok(' ','Clear items marked SIMILAR?',M1OK,dok,6)
*item EDCONN
*enditem
          call askok(' ','Clear items marked CONSTANT?',M2OK,dok,6)
*item EDCONN
*enditem
          call askok(' ','Clear items marked GROUND?',M4OK,dok,6)
*item EDCONN
*enditem
          call askok(' ','Clear items marked ADIABETIC?',M5OK,dok,6)
*item EDCONN
*enditem
          call askok(' ','Clear items marked BASESIMP?',M6OK,dok,6)
*item EDCONN
*enditem
          call askok(' ','Clear items marked IDENT_CEN?',M7OK,dok,6)
*item EDCONN
'After clearing contiguity you can re-establish some of'
'the connections via surface attributes (adiabetic,'
'similar, constant and ground connections). If these.'
'attributes are YES in the list of boundary type'
'toggles (choices c-h) then you will be asked for '
'confirmation. '
'This facility might save lots of time. '
*enditem
          call askok('Recover surface attribute data?',
*item EDCONN
'The surface topology of the problem is held'
'in a connections file.'
*enditem
          CALL EASKS(LCNN,' Updated surface connections file ?',' ',
*item EDCONN
'The current problem description will be placed'
'into this file. It is suggested that you define'
'a new file (ie. project.cfg > project_a.cfg).'
*enditem
          CALL EASKS(CFGFN,
*item EDCONN
'The surface topology of the problem is held'
'in a connections file.'
*enditem
          CALL EASKS(LCNN,' Updated surface connections file ?',' ',
*item EDCONN
'The current problem description will be placed'
'into this file. It is suggested that you define'
'a new file (ie. project.cfg > project_a.cfg).'
*enditem
          CALL EASKS(CFGFN,
*subroutine CONFIG
*item CONFIG
' Pick one, several or all zones for inclusion'
*enditem
      CALL EPICKS(ICPIC,ICVALS,' ',' Which zones to include: ',
*item CONFIG
'Normally you would check all of the zones. And '
'if you need to exit this process (ran out of '
'coffee) this is a place you can do this. NOTE '
'that this can leave the model in an inconsistent'
'state. '
*enditem
            CALL ASKOK(outs,'(see help)',OK,dok,5)
*item CONFIG
'The boundary conditions at the other face of this sur-'
'face is specified via the selection of one of these'
'choices.  The default is OUTSIDE.'
' '
' Exterior - the other face of the surface is exposed to'
'  ambient air temperature, wind and solar radiation.'
' '
' Dynamic/similar - the other face of the surface is'
'  exposed to the same conditions as the inside face'
'  (except that when direct sunlight is falling on the'
'  inside face it cannot be falling on the other face'
'  only the diffuse component is used on the other face.'
'  where both sides get the same radiation.'
'  A dynamic/similar connection can include an offset'
'  temperature (C) and radiation (W/m^2).'
' '
' Static - requires that a constant temperature and'
'  radiation be supplied. You might use this to represent'
'  a cold storage room.'
' '
' Surface in another zone - the other face of the surface'
'  gets its boundary conditions from the last known state'
'  of the other surface. There is a thermophysical con-'
'  nection established between the two zones.'
' '
' Ground (standard profile) - the other face of the'
'  surface is in direct contact with one of the standard'
'  monthly temperature profiles embedded in ESP-r.'
' '
' Ground (user defined profile) - the other face of the'
'  surface is in direct contact with a monthly profile'
'  previously created by the user (in the model context)'
' '
' Ground (3D conduction) - the other face connects to a'
'  3D ground representation. This is not often used.'
' '
' Adiabatic boundary - typically used for back-to-back'
'  surfaces in a zone representing thermal mass. There'
'  is no heat flux passed beyond the other-face. '
' '
' BASESIMP is used to represent one of several basement'
'  configurations and precalculated patterns of heat'
'  transfer. For this to be useful there must be a'
'  basesimp file created for the zone giving a number'
'  of dimensions and computational parameters.'
' '
' CEN 13791 partition which is like the SIMILAR'
'  but for CEN 13791 test. The offset temperauture'
'  and radiation (W/m^2) in SIMILAR is not available'
'  for the CEN 13791 partition type. For details see'
'  section 4.4.2 CEN 13791 standard. '
' '
'There is a module of ESP-r which uses polygon adjacency'
'to automatically link partitions together. '
' '
*enditem
                call MENUATOL(outs,' Connection options ',
*item CONFIG
'A type 2 connection requires that a constant'
'temperature and radiation (Watts) be entered.'
*enditem
                  CALL EASKR(VAL,' ',' Constant temperature ? ',
*item CONFIG
*enditem
                  CALL EASKR(VAL2,' ',' Constant rad (W/m^2) ? ',
*item CONFIG
'A ground connection allows either:'
'> 0 a connection to one of several standard'
'    profiles. Supply its index.'
'= 0 a connection to a user defined profile. '
'    supply 0 plus user profile index. '
'-3  a connection to a 3D ground model.'
*enditem
  777             CALL EASKI(IIC2,' Monthly (standard) profile index?',
*item CONFIG
'One of the user defined profile numbers is'
'required at this point.'
*enditem
                    CALL EASKI(IIE2,
*item CONFIG
'Specify the BASESIMP configuration index.'
'Refer to src/esp-r/esrubld/bscoeff.F for the '
'correspondence between iconfig and standard '
'BASESIMPdescriptors (e.g. BCIN_1).'
'BASESIMP is a `whole-foundation model`. Therefore, when'
'a foundation is represented by numerous ESP-r surfaces'
'(e.g. four walls + floor to represent a basement), you'
'must specify the percentage of the whole-foundation'
'heat loss to attribute to each surface. Normally the'
'sum of surfaces representing a founcation is 100%.'
*enditem
                  CALL EASKI(Ifrac,
*item CONFIG
'You asked to specify connection if a match was'
'found to another surface in the same room. '
*enditem
                CALL EASKABC('Matched surface within room:',' ',
*item CONFIG
'If there is more than ONE possible matching '
'geometric connection you are asked to confirm'
'which one. Exercise care - the interface does'
'not tell you how many possible matches it will'
'be showing you. '
*enditem
              CALL ASKOK(outs,' Accept this? (see help)',OK,dok,5)
*item CONFIG
'If you continue, the current connection type '
'will be retained.  You can edit this connection '
'after all of the surfaces have been checked.'
*enditem
            CALL EASKABCD(' None of the suggestions taken:',' ',
*item CONFIG
'At this point the zone geometry files will have updated'
'surface attributes. And the master connections list is '
'still held in memory and needs to be written out to file'
'or the model will be inconsistent.'
' '
'This dialog allows you to save the master connections list'
'to a different file name (in case you do not want to'
'overwrite the existing file. '
*enditem
      CALL EASKS(LCNN,' Surface connections file name?',' ',
*subroutine ESACON
*item ESACON
'This pause allows you to correct errors. '
*enditem
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON
'This pause allows you to correct errors. '
*enditem
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON
'A type 2 connection requires that a constant '
'temperature and radiation (Watts) be entered.'
*enditem
          CALL EASKR(VAL,' ',' Constant temperature ? ',
*item ESACON
*enditem
          CALL EASKR(VAL2,' ',' Constant rad (W/m^2) ? ',
*item ESACON
'This pause allows you to correct errors. '
*enditem
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON
'A ground connection allows either:'
'> 0 - a connection to one of several standard profiles'
'  in which case the profile number is required.'
'= 0 - a connection to a user defined profile:'
'    a 0 followed by a profile number is required.'
'-3  a connection to a 3D ground model.'
*enditem
          CALL EASKI(IVAL,' Monthly profile (0 = user defined) ? ',
*item ESACON
'One of the user defined profiles numbers is'
'required at this point.'
*enditem
            CALL EASKI(IVAL,' User defined profile: ',
*item ESACON
'This pause allows you to correct errors. '
*enditem
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON
'This pause allows you to correct errors. '
*enditem
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON
'Specify the BASESIMP configuration index.'
'Refer to src/esp-r/esrubld/bscoeff.F for the '
'correspondence between iconfig and standard '
'BASESIMPdescriptors (e.g. BCIN_1).'
'BASESIMP is a `whole-foundation model`. Therefore, when'
'a foundation is represented by numerous ESP-r surfaces'
'(e.g. four walls + floor to represent a basement), you'
'must specify the percentage of the whole-foundation'
'heat loss to attribute to each surface. Normally the'
'sum of surfaces representing a founcation is 100%.'
*enditem
          CALL EASKI(Ifrac,
*item ESACON
'This pause allows you to correct errors. '
*enditem
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON
'This pause allows you to correct errors. '
*enditem
          CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON
'Assuming the last task was successful you need to '
'save the topology to file to preserve any changes '
'made to the model.  '
*enditem
      CALL ASKOK(' ','Save updated topology?',OK,dok,3)
*subroutine anchor
*item anchor
'Anchor points allow a user to line a number of items '
'(such as surfaces) to a concept so that global actions'
'(such as attribution or performance enquiries) can be '
'undertaken. An achor point consists of name (12 char),'
'a list of item indices and a type indicator. '
' '
'Anchor types set the context within which esp-r can'
'manipulate items associated with an anchor. Details: '
' a general surface - supports actions such as changing'
'   attributes or graphing temperatures of a '
'   collection of surfaces).'
' '
'Tagging surfaces as possible openings or leakage paths'
'in a flow network:'
' b closed door - surface acts as or includes a closed'
'   door (or crack) between two flow nodes.'
' c open(able) door - surface acts as or includes an '
'   open door (perhaps controlled) between flow nodes.'
' d closed window - surface acts as/includes a closed'
'   window (or crack) between two flow nodes.'
' e open(able) window - surface acts as/includes a'
'   window (perhaps controlled) between flow nodes.'
' f closed grill - surface acts as/includes a closed'
'   grill (or crack) between two flow nodes.'
' g open(able) grill - surface includes an grill or'
'   vent (perhaps controlled) between two flow nodes.'
' h duct or pipe - surface inclues an duct or pipe'
'   between two flow nodes.'
' i fan or pump - surface near a fan or pump between'
'   two flow nodes.'
*enditem
        CALL PHELPD('anchor points',30,'-',0,0,IER)
*item anchor
*enditem
        call easkconn(inpic,iconnpk,60,
*item anchor
'A chance to abort incorrect selection. '
*enditem
        call askok('Edit anchor name or type?',' ',ok,dok,1)
*item anchor
*enditem
          call MENUATOL('Select a type for the anchor:',
*item anchor
*enditem
            CALL EASKS(AL,' Label for anchor: ',
*item anchor
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','closed dr',IER,30)
*item anchor
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','open dr ',IER,30)
*item anchor
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','closd win',IER,30)
*item anchor
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','open win',IER,30)
*item anchor
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','closd grill',IER,30)
*item anchor
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','open grill',IER,30)
*item anchor
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','ductorpipe',IER,30)
*item anchor
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','fanorpump',IER,30)
*item anchor
'A chance to abort de-reference of link. '
*enditem
          call askok('De-reference link(s) to this surface?',' ',
*item anchor
'A chance not to dereference this anchor. '
*enditem
                    call askok(outs,' ',okd,dok,1)
*subroutine anchlist
*item anchlist
'Anchor points allow a user to line a number of items '
'(such as surfaces) to a concept so that global actions'
'(such as attribution or performance enquiries) can be '
'undertaken. An achor point consists of name (12 char),'
'a list of item indices and a type indicator. '
' '
'Anchor types set the context within which esp-r can'
'manipulate items associated with an anchor. Details: '
' a general surface - supports actions such as changing'
'   attributes or graphing temperatures of a '
'   collection of surfaces).'
' '
'Tagging surfaces as possible openings or leakage paths'
'in a flow network:'
' b closed door - surface acts as or includes a closed'
'   door (or crack) between two flow nodes.'
' c open(able) door - surface acts as or includes an '
'   open door (perhaps controlled) between flow nodes.'
' d closed window - surface acts as/includes a closed'
'   window (or crack) between two flow nodes.'
' e open(able) window - surface acts as/includes a'
'   window (perhaps controlled) between flow nodes.'
' f closed grill - surface acts as/includes a closed'
'   grill (or crack) between two flow nodes.'
' g open(able) grill - surface includes an grill or'
'   vent (perhaps controlled) between two flow nodes.'
' h duct or pipe - surface inclues an duct or pipe'
'   between two flow nodes.'
' i fan or pump - surface near a fan or pump between'
'   two flow nodes.'
*enditem
        CALL PHELPD('anchor points',30,'-',0,0,IER)
*item anchlist
*enditem
        CALL EASKABC('Anchor point options:',' ',
*item anchlist
*enditem
          call MENUATOL('Select a type for the anchor:',
*item anchlist
*enditem
            CALL EASKS(AL,' Label for anchor: ',
*item anchlist
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','closed dr',IER,30)
*item anchlist
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','open dr ',IER,30)
*item anchlist
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','closd win',IER,30)
*item anchlist
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','open win',IER,30)
*item anchlist
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','closd grill',IER,30)
*item anchlist
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','open grill',IER,30)
*item anchlist
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','ductorpipe',IER,30)
*item anchlist
*enditem
            CALL EASKS(AL,'Label:',' ',12,'none','fanorpump',IER,30)
*subroutine easkconn
*item easkconn
*enditem
          CALL PHELPD('connection pick string',NHELP+1,'-',0,0,IER)
*item easkconn
*enditem
          CALL PHELPD('connection pick string',2,'-',0,0,IER)
*subroutine procgdst
*item procgdst
'Interactive mode uses simulation parameters as '
'defaults. The silent running mode uses the'
'parameters to run in automatic mode. '
*enditem
        CALL EASKAB('Simulation interaction options: (see help)',
*subroutine serchrpl
*item serchrpl
'Often it is convenient to search a model for one  '
'constructional attribute and replace this by'
'another. You can do this by searching for occurances'
'of a particular construction or by selecting an anchor'
'point (with an associated list of surfaces) to apply'
'the new attribute to.'
' '
'In the first method, choose the construction to search'
'for and then its replacement (you will be asked to '
'confirm each replacement'
' '
'In the 2nd method, choose an anchor point and then the'
'substutute construction. '
' '
'NOTE: After using the search & replace facility '
'zone construction files should be rebuilt for the'
'new attributes to take effect. '
*enditem
        CALL PHELPD('global attributions',17,'-',0,0,IER)
*item serchrpl
*enditem
          CALL EASKABC(' Surfaces to update:',' ',
*item serchrpl
' Pick one, several or all zones to update.'
*enditem
          CALL EPICKS(INPIC,IVALS,' ',' Search zones:',
*item serchrpl
'Just in case you want to be selective...'
*enditem
                  CALL ASKOK(' ',outs,OK,dok,1)
*item serchrpl
'Indicate which anchor to use. '
*enditem
          CALL easkatog(' Which anchor:',' ',AL1,AL2,AL3,AL4,AL5,
*item serchrpl
*enditem
            CALL easkatog(' Which anchor:',' ',AL6,AL7,AL8,AL9,
*item serchrpl
'A chance to abort if incorrect construction selected.'
*enditem
          CALL ASKOK('Apply this construction?',' ',OK,dok,1)
*item serchrpl
'A search & replace only changes the surface attribute'
'it does not update the raw thermophysical data held in'
'the zone construction files. It is recommended that '
'you also update the zone files. '
*enditem
          CALL ASKOK(
*item serchrpl
'Often it is convenient to supply surface construct-'
'ional attribution by globally applying a material to'
'a subset of surfaces and then attend to exceptions. '
' '
'The following dialogue will allow you to define a '
'subset of surfaces via filters for position,  '
'orientation, opacity, etc. '
' '
'NOTE: After using the global attribution facility '
'you must then rebuild the zone construction files'
'for the new attributes to take effect. '
*enditem
        CALL PHELPD('global attributions',11,'-',0,0,IER)
*item serchrpl
'You may restrict updating to only opaque surfaces,'
'transparent surfaces or apply to both. '
*enditem
        CALL EASKABCD(' First filter--surface opacity:',' ',
*item serchrpl
'You may restrict updating to only surfaces which '
'face the outside, partitions (internal) etc. '
*enditem
        call EASKATOG(' Second filter--surface contiguity:',' ',
*item serchrpl
'You may restrict updating to only surfaces which '
'have a particular orientation. '
*enditem
        call EASKATOG(' Third filter--surface orientation:',' ',
*item serchrpl
'You may restrict update to avoid already attributed'
'surfaces. '
*enditem
        CALL EASKABCD(' Surfaces to update:',' ',
*item serchrpl
' Pick one, several or all zones to update.'
*enditem
        CALL EPICKS(INPIC,IVALS,' ',' Which zones to update: ',
*item serchrpl
'The criter you set were matched. And you can'
'still opt not to apply it in all cases. '
*enditem
                CALL ASKOK(' ',outs,OK,dok,2)
*subroutine SCRZONE
*item SCRZONE
'The zone description is used for descriptive and'
'book-keeping purposes. It should be unique, be less'
'than 12 characters and contain no spaces.'
*enditem
      CALL EASKS(ZN,'New zone description?','(<12 chars, no spaces)',
*item SCRZONE
'The zone description allows further information about'
'zone form and composition to be recorded.'
*enditem
 43   CALL EASKS(zd,'What does it represent?','(<64 characters)',
*item SCRZONE
'You have the option to describe zone geometry as an'
'extruded rectangle, a floor plan extrusion or a general'
'polyhedra. Keeping the geometry as simple as possible'
'will simplify the constructional attribution and result'
'interpretation tasks.'
' '
'Points from a bitmap:                  '
' Zone geometry can be defined by taking points from a'
' scanned image of a site plan or floor plan.         '
'                  '
' To do this you need to scan the relevant source and'
' then convert it to an XBM (X11 monochrome bitmap) file,'
' which should be placed in the project `cfg` folder.'
' '
' Please ensure that the bitmap is large enough to'
' allow for accurate positioning of the mouse. The bitmap'
' can be larger than the graphic display area, and where'
' it is you can pan left/right and up/down.'
'                  '
' The source image should have indications on it of an'
' origin (typically X=0.0 Y=0.0), the North direction'
' and a line of known length (to get scaling from).'
*enditem
      CALL EASKABCD(' ','Base zone geometry on:',
*item SCRZONE
'The specification of a rectangular extrusion requires'
'the specification of an origin (relative to the site'
'coordinate system, and a length, depthand height.'
'Assuming there is no rotation, the length dimension'
'is along the X axis, the depth dimension is along the'
'Y axis and the height dimension is along the Z axis.'
'The rectangle may then be rotated by an angle measured'
'from the X axis, anticlockwise positive.'
*enditem
        CALL EASKS(HOLD,' ','Origin X,Y,Z?',
*item SCRZONE
'The length (with no rotation) is along the X axis.'
'The width (with no rotation) is along the Y axis.'
'The height is along the Z axis.'
*enditem
        CALL EASKS(HOLD,' ','Rectangle length, width and height?',
*item SCRZONE
'Orientation is the angle between the length (DX) side'
'of the rectangle and the X-axis, anticlockwise +ve.'
*enditem
        CALL EASKR(ANGR,' ','Rectangle orientation?',
*item SCRZONE
'Elevation is the angle between the length (DX) side'
'of the rectangle and the horizon, +ve is an upwards'
'incline and -ve is a downwards incline. Zero results'
'in a standard horizontal base.'
*enditem
        CALL EASKR(ANGE,' ','Rectangle elevation (see help)?',
*item SCRZONE
'The base surface (probably floor) height relative to'
'the site coordinate system.'
*enditem
        CALL EASKR(Z1,' ','Z value of the base surface?',
*item SCRZONE
'The top surface (probably ceiling) height relative to'
'the site coordinate system. Note that this is not'
'necessarily the same as the base-top distance!'
*enditem
        CALL EASKR(Z2,' ','Z value of the top surface?',
*item SCRZONE
'The number of walls excluding the base and'
'the top.'
*enditem
        CALL EASKI(NW,' ','Number of walls?',
*item SCRZONE
'The coordinates should be entered in anti-clockwise'
'order when viewed from the top.'
*enditem
          CALL EASKS(HOLD,OUTSTR,'  ',32,' 0.  0.  ','floor xy',IER,2)
*item SCRZONE
'If you have any doubt as to whether you entered the'
'correct vertex coordinates you can save time by'
'respecifying them now. Usually this takes less time'
'than trying to correct problems later.'
*enditem
        CALL ASKOK(' ','Accept base vertices?',OK,dok,4)
*item SCRZONE
'Rotation is the angle between the site y-axis and'
'north, anticlockwise positive.'
*enditem
        CALL EASKR(AR,' ','Rotation angle?',
*item SCRZONE
'A general polyhedra is appropriate for complex'
'shapes. A set of vertices is defined and then'
'linked together to form surfaces that bound the'
'zone. Vertices are linked anti-clockwise when'
'viewed from outside the zone. It is convention'
'to start at the lower left vertex.'
' '
'After you supply the zone origin, a 2m x 2m'
'initial (floor) surface will be placed there.'
'These vertices may then be modified and new'
'ones added/linked to create the enclosed zone.'
'Initial warning messages may be ignored. These'
'will cease after you have defined a bounded zone.'
'The initial surface may be deleted if no longer'
*enditem
        CALL PHELPD('gen start popup',15,'-',0,0,IER)
*item SCRZONE
'The zone origin is located at the first surface.'
*enditem
        CALL EASKS(HOLD,' ','Origin X Y Z?',
*item SCRZONE
'When attempting to write the geometry a problem was'
'encountered. Check that you have permission to write'
'this type of file and that you have sufficient disk'
*enditem
        CALL ASKOK('Problem creating geometry file.','Try again?',
*subroutine NEWZONE
*item NEWZONE
'You may read in an existing ESP-r zone geometry file,'
'convert a cflow3/IES zip file into one or more zones'
'(i.e whole model conversion) or create a zone by inputing'
'data related to primitive shapes. '
' '
'NOTE: a cflow3/IES zip file is NOT a DXF file. If you'
'want to import DXF use the Model Management -> import CAD'
'file facility. '
' '
'NOTE: it is assumed that you the zone geometry file'
'that you specify is not that is NOT already used in'
'your model! Otherwise the Project Manager may get '
'confused because two zones point to the same fie! '
' '
'Check the zone name after you have loaded the existing'
'zone geometry file to make sure it is unique. '
*enditem
      CALL EASKABCD(' ','New zone options:','input dimensions',
*item NEWZONE
'If there was no existing geometry file found in the'
'../zones folder then you must supply a file name.'
'It should be relative to the cfg folder.'
' '
'NOTE: it is assumed that you the zone geometry file'
'that you specify is not that is NOT already used in'
'your model! Otherwise the Project Manager may get '
'confused because two zones point to the same fie! '
*enditem
        CALL EASKS(LTMP,OUTSTR,' ',72,DFILE,'geom file',IER,8)
*item NEWZONE
*enditem
          CALL ASKOK(' ','Geometry file not found, try again?',OK,
*item NEWZONE
'While scanning the geometry file a problem was'
'encountered. Check that the file is of the correct'
'type and that it has not been corrupted. '
*enditem
          CALL ASKOK(OUTSTR,
*item NEWZONE
'If you are extending a model via the use of existing'
'zone geometry files you might also have existing zone'
'schedules to reference. You can do that here. '
*enditem
        CALL ASKOK(' ','Also use an existing operation file?',OK,dok,3)
*item NEWZONE
'If there was not existing operations file found in the'
'../zones folder then you must supply a file name. '
'It should be relative to the cfg folder. '
*enditem
 295      CALL EASKS(LTMP,OUTSTR,' ',72,DFILE,'opr file',IER,3)
*item NEWZONE
*enditem
            CALL ASKOK(' ','Operations file not found, try again?',
*item NEWZONE
'If you are extending a model via the use of existing'
'zone geometry files you might also have existing zone'
'constructions to reference. You can do that here. '
*enditem
        CALL ASKOK(' ','Also use an existing constructions file? ',
*item NEWZONE
'If there was not existing constructions file found in '
'the ../zones folder then you must supply a file name.'
'It should be relative to the cfg folder. '
*enditem
 297      CALL EASKS(LTMP,OUTSTR,' ',72,DFILE,'constr file',IER,3)
*item NEWZONE
*enditem
            CALL ASKOK(' ','Constructions file not found, try again?',
*item NEWZONE
'If there is no existing geometry file found in the'
'../zones folder then you must supply a file name'
'including a path relative to the cfg folder.'
*enditem
 396    CALL EASKS(LTMP,' ',OUTSTR,72,DFILE,'zip file',IER,3)
*item NEWZONE
*enditem
          CALL ASKOK('Zip file not found!','Try again?',OK,
*item NEWZONE
'While scanning the geometry file a problem was'
'encountered. Check that the file is of the correct'
'type and that it has not been corrupted.'
*enditem
          CALL ASKOK('Problem scanning CAD file!',
*subroutine DELZONE
*item DELZONE
'             - W A R N I N G - '
'Because of the many inter-connections within a model, the '
'removal of a zone requires a number of steps and you will'
'be asked to confirm some actions. '
' '
'Upon completion, carefully review the model to ensure that'
'the new inter-connections are appropriate. '
' '
'If in doubt ARCHIVE of the model before embarking on a'
'major restructuring - there is no `undo` command! '
*enditem
      CALL ASKOK(outs,'(see help)',OK,dok,10)
*item DELZONE
'A linked network ventilation node will take the'
'current zone temperature during assessments. If,'
'after deleting a zone, the link points to a non-'
'existant zone then flows may not be correctly'
'predicted. Unlinking will result in the node using'
'a fixed temperature during assessments.'
'Because a node may have several connections within'
'the network you must edit the network to remove'
'such links before it can be removed. '
*enditem
              CALL ASKOK(outs,'Remove this link? (see help)',OK,DOK,9)
*item DELZONE
'The removal of a zone may result in zone or ventilation'
'control loops which specifically sense the removed zone'
'causing incorrect assessments. Also references to sub- '
'sequent zones in control loops need to be adjusted. '
*enditem
        CALL ASKOK(' System zone-based controls should also be',
*item DELZONE
*enditem
        CALL ASKOK(' System zone-based controls should also be',
*item DELZONE
'The system control file holds the definition of all of'
'the building/plant controls.  This file is optional.'
*enditem
        CALL EASKS(ltmp,' Control file ? ',
*item DELZONE
'The control sensor or actuator references this'
'specific zone. '
*enditem
                  CALL ASKOK(outs,' Remove this control loop?',OK,DOK,2)
*item DELZONE
'The vnetilation control sensor or actuator '
'references this specific zone. '
*enditem
                  CALL ASKOK(outs,' Remove this control loop?',OK,DOK,2)
*item DELZONE
'The control sensor or actuator references this'
'specific zone. '
*enditem
                  CALL ASKOK(outs,' Remove this control loop?',OK,DOK,2)
*item DELZONE
'You can de-reference a zone in the current model, and'
'you have the option to also remove the files. If you'
'might have a use for the files later keep them. '
*enditem
      CALL ASKOK(' In addition to de-referencing this zone do you',
*item DELZONE
'             - W A R N I N G - '
'Ventilation network nodes linked to the deleted zone'
'have been unlinked (i.e. they are assumed to be at a'
'static temperature).'
'If connections related to this node need to be revised '
'use the ventilation network facility.'
*enditem
        CALL PHELPD('mfs update popup',6,'-',0,0,IER)
*item DELZONE
'             - W A R N I N G - '
'Links to the deleted zone by zone and/or ventilation'
'control loops have been adjusted and are being saved.'
*enditem
        CALL PHELPD('control update popup',3,'-',0,0,IER)
*item DELZONE
'The current model description will be placed'
'into this file.'
*enditem
 49   CALL EASKS(ltmp,' Updated configuration file? ',
*subroutine WARNMOD
*subroutine SUMRCHG
*item SUMRCHG
' (rebuild via construction facility) '
' (rebuild via construction facility) '
' (recalculate via `Options viewfactors`)'
*enditem
            CALL PHELPD('files out of date',nh,'-',0,0,IER)
*item SUMRCHG
'Shading should be recalculated if the changes you'
'made affect isolation distribution. When in doubt'
'it is best to recalculate.'
*enditem
          CALL EASKABC(' Reflect zone change in shading options:',' ',
*item SUMRCHG
'Zone construction files should be rebuilt after '
'surface attributes change or surfaces are added or'
'deleted. '
*enditem
        CALL ASKOK('Update the zone construction and/ or TMC and/ or',
*subroutine ELECNET
*item ELECNET
'You have picked electrical network definition. This '
'network is best created after both the plant and '
'building side have been fully defined as power loads'
'in each zone and plant components can be connected to '
'the electrical network.'
' '
'If you have not defined the building and plant yet then'
'you are advised to exit this section.               '
*enditem
      CALL ASKOK(' ','Proceed with electrical network definition?',
*item ELECNET
'The synopsis is one way to review the current network.'
*enditem
        CALL ASKOK(OUTS,
*item ELECNET
' '
'This part of the Project Manager allows you to define an'
'electrical network, which can be simulated in tandem  '
'with your building/plant/flow model. The electrical   '
'network consists of several elements:  '
' '
'NODES - these are the calculation points in the network '
'and should be placed where conductors join, or where '
'loads or power sources connect to the network.'
'In multi-phase systems, multi-phase nodes are grouped'
'in phase-sets, one node of the set represents a phase.'
' '
'CONNECTING COMPONENTS - these convey electrical current'
'between the nodes in the network. They are impedance  '
'models of the distribution components in an electrical '
'system: lines, cables transformers. In addition to con-'
'veying power, the transformer component also changes the'
'voltage between two nodes.'
' '
'HVAC/PV/LIGHTS/EQUIPMENT and POWER-ONLY COMPONENTS - '
'these link into the network and either draw power '
'from or inject power into the network. HVAC components  '
'etc. are components which exist in other areas of your  '
'model, i.e. lighting loads a PV array or a fan. '
'Power-only components exist only in the electrical  '
'world e.g. a wind turbine or a diesel generator set.'
' '
'CONNECTIONS - these link the entire network together.'
'A connection links two or more nodes using a connecting'
'component, connections can be multi-phase, single-phase'
'd.c. or balanced. Single phase components can be used'
'in the connection of multi-phase sets of nodes but not'
'vice versa. Phase-set nodes can be linked to single '
'nodes, but only if the phase numbers of the connected '
'nodes match. An a.c. to d.c. connection is possible,'
'but only with AC/DC conversion devices.'
' '
'The complete NETWORK consists of all the above elements'
'connected together. Other information required includes'
'the type of network: a.c., d.c., mixed or balanced plus'
'BASE VALUES of voltage and power. These are needed as'
'network solution is done in PER UNIT notation. Voltage '
'base values for each node are generated automatically.'
'If required you can enter a short description of your'
'electrical enetwork here.                            '
*enditem
        CALL EASKS(ENDESC,'The electrical network description:',' ',
*item ELECNET
'Select the network type which describes your network: '
'd.c      - direct current only'
'1,2,3    - phase a.c. only '
'Balanced - a balanced 3-phase system '
'Mixed    - Mix of 1,2,3-phase elements and possibly d.c.'
'                         <the default> '
*enditem
        CALL EASKATOG('Select network type:',' ',
*item ELECNET
'The phase angles for the system are the phase in the'
'time domain in which each phase in the system operates'
'where the difference in each phase angle is given by '
'360/No. of phases. So for a three phase system the    '
'phase angles should separated by 120 degrees.          '
*enditem
        CALL EASKS(STR,'Enter the phase angle for each network phase.',
*item ELECNET
'The base power value is used in the conversion of all  '
'network power values to per-unit, where the per-unit   '
'power is defined by: Pp.u.=Actual Power/Base Power     '
'Choose a value that reflects the size of the power     '
'system being modelled, e.g:                            '
'1000    - small offices or dwellings                   '
'10000   - medium sized buildings, small communities    '
'1000000 - large CHP or community energy schemes        '
'For multi-phase system enter the multi-phase base value'
'e.g. for a three-phase system the three-phase base    '
'value should be entered. The system base value will be'
'this value divided by three.'
*enditem
        CALL EASKR(ENODBASEP,'Enter the system base power value (VA)',
*item ELECNET
*enditem
        CALL PHELPD('pwr net help',43,'-',0,0,IER)
*item ELECNET
'If you have the required support information you'
'may proceed with the base voltage calculation.'
*enditem
          CALL ASKOK(' ','Proceed with base voltage calculation?',
*item ELECNET
'Recent changes are held in memory and may be lost if'
'you do not save them to file. '
*enditem
        CALL ASKOK('Save any changes you have made?',' ',OK,dok,2)
*subroutine ELNODLST
*item ELNODLST
'The list shows the currently available nodes in the '
'electrical network. Click in a node to edit it      '
'or chose to add/delete/copy a node.                 '
'The list shows the currently available nodes in the '
'electrical network. Please select one from the list'
'displayed.                                          '
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
*item ELNODLST
*enditem
          CALL EASKABCD('Select option or continue',' ','Add node',
*subroutine ELHYBLST
*item ELHYBLST
'The list shows the HVAC, PV, lights, etc,. connected to'
'the electrical network. Please select one from the    '
'or chose to add/delete/copy a component.              '
'The list shows the HVAC, PV, lights, etc., connected to'
'the electrical network. Please select one from the    '
'list displayed.                                       '
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
*item ELHYBLST
*enditem
          CALL EASKABCD('Select option or continue',' ',
*subroutine ELPOWLST
*item ELPOWLST
'The list shows the available power only components '
'in the electrical network. Click on one to edit it '
'or chose to add/delete/copy a component.           '
'The list shows the available power only components    '
'in the electrical network. Please select one from the '
'list displayed.                                       '
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
*item ELPOWLST
*enditem
          CALL EASKABCD('Select option or continue',' ',
*subroutine ELCNCLST
*item ELCNCLST
'The list shows the current connecting components '
'in the electrical network. Click on one to edit it    '
'or chose to add/delete/copy a component.              '
'The list shows the current connecting components '
'in the electrical network. Please select one from the '
'list displayed.                                       '
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
*item ELCNCLST
*enditem
          CALL EASKABCD('Select option or continue',' ',
*subroutine ELCONLST
*item ELCONLST
'The list shows the currently defined connections      '
'in the electrical network. Click on one to edit it    '
'or chose to add/delete/copy a component.              '
'The list shows the currently defined connections      '
'in the electrical network. Please select one from the '
'list displayed.                                       '
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
*item ELCONLST
*enditem
          CALL EASKABCD('Select option or continue',' ',
*subroutine EDENOD
*item EDENOD
'The user has the option to add up to three nodes    '
'depending on the nature of the point in the         '
'network being modelled:                             '
'1 - a one phase or balanced system node             '
'2 - a two phase point in the network                '
'3 - a three phase point in the network              '
'Points of more than one phase in an a.c. system are '
'described by a "multi-phase set" of 2-3 nodes, each '
'of the form: root_name_phase_extension.             '
'For example: generator_1, generator_2, generator_3 '
'or lighting_1, lighting_2 or fan_1, fan_3, etc.    '
*enditem
        CALL EASKATOG
*item EDENOD
'The voltage type specifies whether the nodal voltage'
'is fixed by the user or calculated during the       '
'simulation. Generally nodal voltages should be      '
'calculated; however, those connected to the grid or '
'a large power source can be considered as fixed.    '
'Three methods are available for calculating nodal   '
'voltages:                                           '
'  - `Variable` means that the voltage is determined '
'    by the solution of the power flow matrix of eqs.'
'  - `PV` means that the voltage is calculated by    '
'     the buiding domain`s PV model.                 '
'  - `Plant` means that the voltage is calculated by '
'    a component in the plant domain.                '
*enditem
            CALL EASKABCD('What is the node type?',' ',
*item EDENOD
'Only the original esp-r PV model or a type 5'
'WATSUN-PV can be used. '
*enditem
                    CALL ASKOK(
*item EDENOD
'Please select a valid component. If you say no'
'then it get you out of the question loop.'
*enditem
                  CALL ASKOK('No special material component picked.',
*item EDENOD
*enditem
                CALL ASKPCMP('Select plant comp: ','-',IPCOMP,IER)
*item EDENOD
'Please select a valid component. If you say'
'no then it get you out of the question loop.'
*enditem
                    CALL ASKOK(
*item EDENOD
'duplicate names. If the node is one of a multi'
'-phase set then the name will be the root name.'
*enditem
            CALL EASKS(SHSTR,
*item EDENOD
'duplicate names. If the node is one of a multi'
'-phase set then this name will be the root name.'
*enditem
              CALL EASKS(SHSTR(1:10),
*item EDENOD
'Specify which phase of the electrical network the node'
'is associated with. Note, for balanced and d.c. nodes'
'simply specify 1.'
'NOTE: two nodes in a multi-phase set cannot have the'
'same phase! '
*enditem
            CALL EASKI(ENODPH(IENOD),OUTS,' ',1,'F',5,'F',
*item EDENOD
*enditem
            CALL EASKI(ENODPH(IENOD),OUTS,' ',1,'F',5,'F',
*item EDENOD
'When deleting a node any connections assoctated with'
'that node must also be deleted. Also if the node is part'
'of a multi-phase set then the other members of that set'
'must also be deleted. These deletions are done  '
'automatically. Any linkages to power only components or'
'hybrid components are nulled.'
*enditem
        CALL ASKOK(OUTS,' ',OK,dok,6)
*item EDENOD
'A chance to continue if wrong node selected. '
*enditem
        CALL ASKOK('Edit this node?',' ',OK,dok,1)
*item EDENOD
'duplicate names. If the node is one of a multi-phase'
'set then this name will be the root name.           '
' '
'Editing of nodal data is restricted to altering         '
'the component name and the nodal type. If the phase type'
'or phase number needs to be changed then please delete  '
'the node and create a new one with the desired          '
'properties.    '
*enditem
        CALL EASKS(SHSTR(1:ISTRL),
*item EDENOD
'The voltage type specifies whether the nodal voltage '
'is fixed by the user or calculated during the        '
'simulation. Generally nodal voltages should be       '
'calculated; however, those connected to the grid or  '
'a large power source can be considered as fixed.     '
'Three methods are available for calculating nodal    '
'voltages:                                            '
'  - `Variable` means that the voltage is determined  '
'    by the solution of the power flow matrix of eqs. '
'  - `PV` means that the voltage is calculated by     '
'     the buiding domain`s PV model.                  '
'  - `Plant` means that the voltage is calculated by  '
'    a component in the plant domain.                 '
*enditem
        CALL EASKABCD('What is the node type?',' ',
*item EDENOD
'Only the original esp-r PV model or a type 5 '
'WATSUN-PV can be used. '
*enditem
                  CALL ASKOK(
*item EDENOD
'Please select a valid component. If you say no'
'then it get you out of the question loop.'
*enditem
               CALL ASKOK('No special material component picked.',
*item EDENOD
*enditem
            CALL ASKPCMP('Select plant comp: ','-',IPCOMP,IER)
*item EDENOD
'Please select a valid component. If you say no'
'then it get you out of the question loop.'
*enditem
                CALL ASKOK(
*item EDENOD
'Give the copied node a unique name or root name.'
*enditem
        CALL EASKS(SHSTR,
*subroutine EDEHYB
*item EDEHYB
'A chance to continue without editing component. '
*enditem
          CALL ASKOK('Edit this component?',' ',OK,dok,1)
*item EDEHYB
'You can attach electrical loads and power sources to the'
'electrical network. Please select the type of component '
'you wish to attach: '
'- a zone-side electrical load i.e. lighting;'
'- a plant-side electrical load i.e. pump;   '
'- a pv material in the building facade.     '
'Note if none of these elements exist in the model     '
'already, you will not be able to attach anything.      '
*enditem
        CALL EASKABCD('Add which type of component ?',' ',
*item EDEHYB
*enditem
 10       CALL ASKZONE(IZ,0,OUTS,'Select zone','-','load locate',IER)
*item EDEHYB
'The zone operation file selected did not contain'
'any electrical data. You can select another zone.'
*enditem
             CALL ASKOK('Zone has no electrical loads',
*item EDEHYB
'Each user specified gain type in each zone can be '
'associated with a node in the electrical network. '
'The cumulative power consumption of all the gains'
'of that type (both absolute and per m2) is then   '
'attributed to the node; provided load electrical data '
'has been specified.'
*enditem
 16       CALL EASKABCD('What is the type of load do',
*item EDEHYB
'ESP-r expected you to have selected a component and'
'so here is your chance to try again. '
*enditem
            CALL ASKOK(outs,'to the network. Try again?',OK,dok,2)
*item EDEHYB
*enditem
 12       CALL ASKPCMP('Select plant comp: ','-',IPCOMP,IER)
*item EDEHYB
*enditem
               call askok('Is the plant component connected to',
*item EDEHYB
'ESP-r expected you to have selected a component with'
'electrical data so here is your chance to try again.'
*enditem
               CALL ASKOK(
*item EDEHYB
'Please select the phase type of this component from'
'the list.'
*enditem
          CALL EPICKS(IX,IVALS,'Which phase type',
*item EDEHYB
'Here is your chance to continue without over- '
'writing the node already referencing this phase.'
*enditem
              CALL ASKOK(OUTS,'Overwrite it?', OK,dok,2)
*item EDEHYB
'Please select a different nodes for AC and DC. Say'
'no to get you out of the question loop.'
*enditem
              call askok(
*item EDEHYB
*enditem
        CALL EASKS(SHSTR,
*item EDEHYB
*enditem
        CALL EASKS(LNGSTR,
*subroutine EDEPOW
*item EDEPOW
'Chance to continue without editing the component.'
*enditem
          CALL ASKOK('Edit this component?',' ',OK,dok,1)
*item EDEPOW
'The menu options relate to different categories'
'of power-only components which may be selected '
'for connection to the electrical network       '
'. Select a category'
*enditem
          CALL PHELPD('Power-only comp.',4,'-',0,0,IER)
*item EDEPOW
'Select a power-only component from the list. Each one'
'shown is associated with a set of pre-defined '
'parameters, these can be altered if required. '
'  '
'  '
'Switching the "additional info" toggle to ON lets the'
'user view any more information associted with the   '
'component; this appears in the text window. '
*enditem
            CALL PHELPD('Special material',8,'-',0,0,IER)
*item EDEPOW
*enditem
 99     CALL EASKS(SHSTR,' ',' name for component ?',12,
*item EDEPOW
*enditem
        CALL EASKS(LNGSTR,'You can take this oportunity to ',
*item EDEPOW
'Enter the required data for the power only component. '
'Either accept the default values or enter your own'
'data.                                             '
*enditem
        CALL PHELPD('Power comp data',3,'-',0,0,IER)
*item EDEPOW
*enditem
        CALL EASKI(NPOWCDAT(IEPOW),' ',' Number of data items ?',1,'-',
*item EDEPOW
*enditem
            CALL EASKR(DATSP,OUTS,' ',1.,'-',99.,'-',1.0,'SPM data',
*item EDEPOW
*enditem
        CALL EASKI(NPOWCDATS(IEPOW),' ','Number of string data items ?',
*item EDEPOW
'Enter the required data string for the power only  '
'component. Either accept the default values or give'
'your own data.                                     '
*enditem
            CALL PHELPD('Power comp data',3,'-',0,0,IER)
*item EDEPOW
*enditem
            CALL EASKS(DATSTR,OUTS,' ',72,'UNKNOWN',' pow str',IER,0)
*item EDEPOW
'Please select the phase type of this component from'
'the list.'
*enditem
          CALL EPICKS(IX,IVALS,'Which phase type',
*item EDEPOW
'Here is your chance to continue without over- '
'writing the node already referencing this phase.'
*enditem
              CALL ASKOK(
*item EDEPOW
'Please select different nodes for sending and'
'receiving. Say no to get out of the question loop.'
*enditem
              CALL ASKOK(
*subroutine EDECNC
*item EDECNC
'Chance to continue without editing the component.'
*enditem
          CALL ASKOK('Edit this component?',' ',OK,dok,1)
*item EDECNC
'The menu options relate to different categories'
'of connecting components which may be selected '
'for connection to the electrical network       '
'. Select a category'
*enditem
          CALL PHELPD('Power-only comp.',4,'-',0,0,IER)
*item EDECNC
'Select a connecting component from the list. Each one'
'shown is associated with a set of pre-defined '
'parameters, these can be altered if required. '
'  '
'  '
'Switching the "additional info" toggle to ON lets the'
'user view any more information associted with the   '
'component; this appears in the text window. '
*enditem
            CALL PHELPD('Connecting component',8,'-',0,0,IER)
*item EDECNC
*enditem
  99    CALL EASKS(SHSTR,' ',' name for component ?',12,
*item EDECNC
*enditem
        CALL EASKS(LNGSTR,'You can take this oportunity to',
*item EDECNC
'Enter the required data for the power only component. '
'Either accept the default values or enter your own'
'data.                                             '
*enditem
        CALL PHELPD('Power comp data',3,'-',0,0,IER)
*item EDECNC
*enditem
        CALL EASKI(NCONECOMDAT(IECNC),' ',' Number of data items ?',1,
*item EDECNC
*enditem
            CALL EASKR(DATSP,OUTS,' ',1.,'-',99.,'-',1.0,'cnc data',
*item EDECNC
'Please select the phase type of this component from'
'the list.'
*enditem
        CALL EPICKS(IX,IVALS,'Which phase type',
*item EDECNC
'If a conecting component is deleted, the connections '
'containing this component must also be deleted.      '
*enditem
        CALL ASKOK('Delete connections containing this component?',
*subroutine EDECON
*item EDECON
'Chance to continue without editing the connection.'
*enditem
          CALL ASKOK('Do you want to edit this connection?',' ',
*item EDECON
'This is a chance to correct this error.'
*enditem
          CALL ASKOK('You cannot connect a node to itself.',
*item EDECON
'This is your chance to correct this error. '
*enditem
            CALL ASKOK('You cannot connect nodes of different',
*item EDECON
'This is your chance to correct this error.'
*enditem
          CALL ASKOK('You can only connect a BALANCED connector to',
*item EDECON
'This is your chance to correct this error. '
*enditem
            CALL ASKOK('You can only connect a DC connector to',
*item EDECON
'This is your chance to correct this error. '
*enditem
          CALL ASKOK(
*item EDECON
'This is your chance to correct this error. '
*enditem
          CALL ASKOK(
*item EDECON
'As you are connecting a two phase component to a '
'three phase set, the program needs to know which'
'phase combination the component connects. For   '
'example 1 and 2, 2 and 3 or 1 and 3.            '
'please pick the other phase.                    '
*enditem
 50       CALL EASKABCD('Which other phase of the three-phases does',
*item EDECON
'This is your chance to correct this error.'
*enditem
            CALL ASKOK('This phase is already filled!','Try again',
*subroutine ENETBASEV
*item ENETBASEV
'In order to set the network base voltage values of the    '
'network you must define at least one voltage in the       '
'network; usually one which attaches to the grid and/or has'
'a fixed voltage. The other base voltage values will then  '
'be automatically calculated .                             '
*enditem
      CALL PHELPD('Set base value',5,'-',0,0,IER)
*item ENETBASEV
'This is your chance to correct this error. '
*enditem
        CALL ASKOK('Warning: this is NOT a node with a fixed ',
*item ENETBASEV
*enditem
      CALL EASKR(ENODBASEV(IENODPK),'Base voltage (V) for ',
*subroutine ENETCHECK
*subroutine scheddt
*subroutine EDTITEM
*item EDTITEM
'This display includes static and temporal information'
'about this instance.  The items proceeded by a key'
'character may be edited. To edit an item, select it and'
'follow the prompts supplied.  Fields are filled with '
'default values for a new instance. '
' '
'Use the ! option to focus the graph on a shorter period.'
'Use the page option to jump to other periods.'
'This display includes static and temporal information'
'about this instance.  The items proceeded by a key'
'character may be edited. To edit an item, select it and'
'follow the prompts supplied.  Fields are filled with '
'default values for a new instance. '
' '
'Use the ! option to focus the graph on a shorter period.'
'Use the page option to jump to other periods.'
' '
'Type specific help follows:'
'No type specific help available.'
*enditem
        CALL PHELPD('static fields',10+NHELP,'-',0,0,IER)
*item EDTITEM
'You can graph the current day or a sequence of days'
'or the whole period. '
' '
'You can insert column data (from a text file of column'
'data beginning at the startor at some timestep. '
' '
'You can insert static values (from a text file of data'
'listed sequentially. '
'You can also automatically insert UK National'
'Calculation Methodology Activity (operations) data '
*enditem
          CALL PHELPD('data options',10,'-',0,0,IER)
*item EDTITEM
*enditem
          CALL EASKPER('Display period:',igbdoy,igedoy,IFDAY,IER)
*item EDTITEM
'These options allow you to set the timestep within '
'the temporal file where the data you are importing is'
'to be inserted. '
' '
' start @ timestep one - this is the initial timestep'
'    of the temporal file. If the temporal file begins'
'    on the first day of February the data will be'
'    inserted from this point.'
' '
' start @ other timestep - use this if you want to'
'   begin inserting the data at a different point'
'   in the temporal file. For example if you want'
'   the imported data to write on the third day of'
'   the temporal file you would use the timestep '
'   X = 24 * frequency * 3 '
' '
'Later you will be asked to specify what line of '
'the data import file to begin reading from (e.g. '
'if there are labels or not-relevant data then you'
'can skip such lines at the beginning of the import'
'file. '
' '
'These timing relationships might take a few trys'
'to get sorted. It works best if you work out what'
'you want to do on paper first and try importing '
'data several times until the process is established.'
*enditem
          CALL EASKABC('Import data options: ','(see help)',
*item EDTITEM
'One import source file will be assumed throughout this'
'session. If this needs to be altered then the user'
'should return to this menu to give the new name.'
*enditem
          CALL EASKS(tfile,' Import file name? ',
*item EDTITEM
*enditem
          CALL EASKS(LINE,GDHDRT(3)(1:68),' ',
*item EDTITEM
*enditem
          CALL EASKSCMD(LINE,GDHDRT(3)(1:68),' ',
*item EDTITEM
*enditem
            CALL EPICKS(IX,IVAL,' ',PROMP,
*item EDTITEM
'In order to find items in the TDF db a unique id must'
'be assigned to each item. This id is a character'
'string up to 12 characters long with no blanks.'
*enditem
        CALL EASKS(TTAG,' ',' Unique id string? ',
*item EDTITEM
'This is your chance to verbosely identify this item of'
'the TDF db (up to 36 char). Word of advice: use of'
'this facility may save your sanity at a future date.'
*enditem
        CALL EASKS(TTAIDE,' ',' Item description ',
*item EDTITEM
*enditem
          CALL EASKR(TMAR(IFOC,IA),' ',PROMP,TMIN(IFOC,IA),
*item EDTITEM
*enditem
          CALL EPICKS(IX,IVAL,' ',PROMP,
*item EDTITEM
*enditem
          CALL EASKI(ITMAR(IFOC,IA),' ',PROMP,ITMIN(IFOC,IA),
*subroutine STRTIM
*subroutine EDIMPT
*item EDIMPT
 'This display allows the user to specify parameters'
 'which control the importation of data into this'
 'temporal file.  '
 ' '
 'After supplying the name of the file of column '
 'data that you want to import you can view the '
 'initial lines of the file to confirm which columns'
 'the relevant data is in as well as how many lines'
 '(if any) to ignore at the start of the file. If the'
'file name is not local, specify the whole path. '
' '
'If the column data file includes information '
'prior to the point in time that you are interested'
'in you can use the `begin reading @` instruction '
'to skip past the unwanted information (take care '
'when deciding how many lines to skip as there is '
'no way to shift time once the data is imported). '
' '
'You must specify the column within the import file'
'which corresponds to each of the fields which contain'
'timestep data ( a zero means no import for a field).'
'NOTE: blank characters, tabs, and commas are all '
'treated as separators. In the following db temp'
'is actually in column 5. '
' '
'# place year month day time direct_solar dbT '
'Berlin 2001-10-12 09.00 100.0  19.2 '
'Berlin 2001-10-12 09.50 112.0  19.3 '
'Berlin 2001-10-12 10.00 142.0  19.6 '
' '
'And the data that you are reading in is not transformed'
'as it is read (e.g. taking an integer value in tenths'
'of a m/s 105 to the value 10.5 m/s is not supported.'
' '
'Interpolation of data is not supported (i.e. you cannot'
'import hourly data into a temporal file with a frequency'
'of ten minutes. '
'One import source file will be assumed throughout this'
'session. If this needs to be altered then the user'
'should return to this menu to give the new name.'
*enditem
        CALL EASKS(tfile,' Import file name? ',
*item EDIMPT
'It is possible to import temporal information via'
'an ASCII file with columns of data.'
*enditem
        CALL EASKABC('Import options:',' ',
*item EDIMPT
'To allow flexibility you may specify that the imported'
'data should begin at a particular line of the import'
'file.  Comment lines (which begin with a # are not'
*enditem
        CALL EASKI(IV,' ','Begin reading @ import file line no:',
*item EDIMPT
*enditem
        CALL PHELPD('period fields',36,'-',0,0,IER)
*item EDIMPT
'The file you are importing appears to be a timestep'
'casual gain file.  NOTE that such files required '
'that the data included the startup period except for'
'the first hour of the first day (which was omitted)'
' '
'A temporal file includes the entire period of '
'the startup period so you may need to edit the '
'import file to take this into account. '
*enditem
          CALL PHELPD('timestep import warning',8,'-',0,0,IER)
*item EDIMPT
'Please specify which column of the import file is'
'associated with this data field. A `0` indicates that'
'no data will be imported into this field.'
*enditem
        CALL EASKI(IV,' ','Associated column in import file:',
*subroutine EDSTATICIMPT
*item EDSTATICIMPT
 'This display allows the user to specify parameters'
 'which control the importation of data into this'
 'temporal file.  '
 ' '
 'After supplying the name of the file of column '
 'data that you want to import you can view the '
 'initial lines of the file to confirm which items'
 'the relevant data is in as well as how many lines'
 '(if any) to ignore at the start of the file. If the'
'file name is not local, specify the whole path. '
' '
'If the data file includes information '
'prior to the point in time that you are interested'
'in you can use the `begin reading @` instruction '
'to skip past the unwanted information (take care '
'when deciding how many lines to skip as there is '
'no way to shift time once the data is imported). '
' '
'You must specify the item number within the import file'
'which corresponds to each of the fields which contain'
'data ( a zero means no import for a field).'
'NOTE: blank characters, tabs, and commas are all '
'treated as separators. '
'One import source file will be assumed throughout this'
'session. If this needs to be altered then the user'
'should return to this menu to give the new name.'
*enditem
        CALL EASKS(tfile,' Import file name? ',
*item EDSTATICIMPT
'To allow flexibility you may specify that the imported'
'data should begin at a particular line of the import'
'file.  Comment lines (which begin with a # are not'
*enditem
        CALL EASKI(IV,' ','Begin reading @ import file line no:',
*item EDSTATICIMPT
*enditem
        CALL PHELPD('period fields',23,'-',0,0,IER)
*item EDSTATICIMPT
'Please specify which item (e.g. separated by commas'
'but at the same line) of the import file is associated'
'with this data field. A `0` indicates that no data will'
'be imported into this field.'
*enditem
        CALL EASKI(IV,' ','Associated item number in import file:',
*subroutine pregist
*item pregist
'The model configuration file holds the definition'
'of the building, plant and control systems to be'
'simulated, including references to associated files.'
'The name you supply will be used as the root name'
'for the various files corresponding to the model'
'you will later establish. Up to 24 characters allowed.'
*enditem
        CALL EASKSCMD(LCFTMP,' ','Model root name?',
*item pregist
'If you overwrite the existing configuration file its'
'contents will be lost unless you have backed up your'
' '
'If you want to create a new model variant say no and'
'enter a different file name.'
*enditem
          call askok('There is an existing configuration with',
*item pregist
'ESP-r organises a model within a standard set of folders.'
' '
'Based on information you have supplied,'
' '
'will be created. '
' '
'Or, if the model will be small (one or two zones)'
'all the files can be in one folder shown below:'
' '
*enditem
        CALL EASKABC(' Create model in:',
*item pregist
'A model has an associated descriptor (<72 characters,'
'which is used later as an identifier, e.g. Low energy'
'building with optimum start/stop plant control.'
*enditem
      CALL EASKS(ltmp,' ','Model description?',
*item pregist
'The project log file holds a description of the project'
'and the analysis intentions. It is located in the `cgf`'
'directory. Keep it up to date via a text editor.'
*enditem
      CALL EASKS(ltmp,' ','Project log file?',
*item pregist
'The log file exists, but could not be scanned.'
'Check that it is not an empty file or contains'
'non-printable characters. '
*enditem
          CALL ASKOK('Problem detected with log file!',
*item pregist
'The log file is used to document your model and record the'
'purpose and outcomes of commissioned simulations. Update'
'it using a text editor as your modelling project evolves.'
'The file is located in the `cfg`directory of your model'
' '
'Assuming you have an editor associated with ESP-r (defined'
'via your .esprc file), you can edit the log file now.'
*enditem
      CALL ASKOK(' ','Edit log file?',OK,dok,8)
*item pregist
'A model can usefully include references to images'
'depicting different model aspects such as geometry,'
'flow networks, simulation results and the like.'
'Such images are usually located in the `images` folder.'
' '
'You can either identify such images now or add them'
'later via the `model context->images` menu item.'
*enditem
      CALL ASKOK(' ','Associate images now?',OKI,dok,7)
*item pregist
'Notes (<248 char) for images can help with'
'communicating supporting information.'
*enditem
            CALL EASKS248(tcname,' ','Image notes:',
*item pregist
'If you have more images select ok.'
*enditem
          CALL ASKOK(' ',' Another image?',OK,dok,1)
*item pregist
'Site latitude in degrees, where North is +ve, e.g. 55.9'
'for Glasgow.'
*enditem
        CALL EASKR(SLAT,' ','Site latitude?',
*item pregist
'Site longitude difference is the difference in degrees'
'from the local reference meridian, East is +ve, e.g.'
'-4.1 for Glasgow (relative to the Greenwich Meridian).'
*enditem
        CALL EASKR(SLON,' ','Longitude difference?',
*item pregist
'The assessment year is required for event scheduling.'
'You can either use the value offered or provide an'
' '
'The cancel option will accept the year associated with'
'the climate file used in a simultion.'
*enditem
        CALL EASKI(IYEART,' ','Assessment year?',
*item pregist
'Other site information, such as ground reflectivity and'
'wind exposure, have been automatically set to default'
'values and these may be changed via the `model context`'
'menu option accessed via the `browse/edit/simulate`'
'option of the present menu.'
' '
'If you have additional day types (e.g. summer holiday) '
'that you want to define, do this before working with '
'any schedules. '
*enditem
        CALL PHELPD('new site',9,'-',0,0,IER)
*subroutine pfolders
*item pfolders
'This menu allows you to edit the information related'
'to a project`s folders and files.'
' '
'The path options allow new files to be positioned in'
'standard folders. The paths are relative to the'
'location of the system configuration file.'
' '
'The option to examine a specified ASCII file is'
'useful if you have need to directly view the contents'
'of a problem describing entity such as the system'
'configuration file or a zone geometry file. There'
'is also an option to strip comments from files where'
'that will make them compatible with older versions'
'of the Project Manager.'
' '
'Editing an ASCII file - such as the project log'
'file - requires a text editor which is currently'
'This can be re-defined in your .esprc file.'
'ESP-r thinks that recent model changes have been'
'made. Because these changes are held only in'
'computer memory they will be lost if not saved to'
'file. Agree to updating the file.'
*enditem
            CALL ASKOK(' ','Update system configuration file?',
*item pfolders
*enditem
        CALL PHELPD('folders and files',19,'-',0,0,IER)
*item pfolders
'Give relative path from cfg to zones folder.'
'For example `../zones`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
'Give relative path from cfg to controls folder.'
'For example `../ctl`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
'Give relative path from cfg to AIM2 folder.'
'For example `../aim2`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
'Give relative path from cfg to networks folder.'
'For example `../nets`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
'Give relative path from cfg to images folder.'
'For example `../images`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
'Give relative path from cfg to documents folder.'
'For example `../docs`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
'Give relative path from cfg to temporary folder.'
'For example `../tmp`.'
'Holds transient information.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
'Give relative path from cfg to Radiance folder.'
'For example `../rad`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg folder',
*item pfolders
'Give relative path from cfg to hvac folder.'
'For example `../hvac`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
'Give relative path from cfg to BASESIMP folder.'
'For example `../bsm`.'
*enditem
          CALL EASKS(t24,'Relative path from cfg',
*item pfolders
*enditem
 254    CALL EASKGEOF('Select a zone to focus on:',CFGOK,IC,'-',IER)
*item pfolders
'The specified ASCII file will be read and displayed'
'in the text window page by page.'
*enditem
    6   CALL EASKS(LFIL,' ','ASCII file name?',
*item pfolders
'Chance to correct error in file name or location.'
*enditem
          CALL ASKOK(' Problem detected while trying to open',
*item pfolders
'An ASCII format file can be edited using the current'
'defined text editor.'
*enditem
        CALL EASKS(LFIL,' ','ASCII file to edit?',
*subroutine edimage
*item edimage
'Images will be displayed when the project is loaded.'
'The default image type is GIF.'
*enditem
      CALL EASKS(limg,' ','Name of image file?',
*item edimage
'Chance to change file name or location.'
*enditem
        CALL ASKOK('Could not locate image file.','Try again?',
*item edimage
'Select one of these standard image types. Each type'
'must have a related display application specified'
'in your .esprc file, e.g. *image_display GIF xv.'
*enditem
      call EASKATOG(' ','Image format?',
*item edimage
'Image files can have a 4 character format. Special'
'format tags can be linked to display applications '
'in the .esprc file. ie. XWD xwud -in '
*enditem
        CALL EASKS(t5,' ','Image type character code?',
*item edimage
'If an image is tagged `general` then it will be'
'displayed when the model is loaded, otherwise it'
'will only be displayed when requested via a graphic'
'display button.'
*enditem
      call EASKATOG(' ','Image focus?',
*item edimage
'Image files have a 4 character focus tag, e.g.'
'FZON for zones, FNET for networks etc.'
*enditem
        CALL EASKS(t5,' ','Image type character code?',
*subroutine edbuild
*item edbuild
'The files defining the composition of a zone are'
'listed in this menu. In the case of a blank entry,'
'the file is optional and is not currently defined.'
' '
'If the menu says `not yet defined` then the file is'
'required before simulations can proceed.  Such files'
'will be created when the related facilities have been'
'accessed (ie. geometry files are created as you define'
'each zone).  '
' '
'The default names of files is the zone name with'
'an extension indicating the file type.'
' '
'The primary use of this facility is to confirm the'
'current state of the model and to assist in the'
'sharing of files (i.e. when several zones share the'
'same constructions).  The model definition will be'
'updated after each change you make.'
*enditem
        CALL PHELPD('utility file contents',18,'-',0,0,IER)
*item edbuild
'The zone name is used as an identifier during'
'results analysis. Names should be unique.'
*enditem
        CALL EASKS(T15,' ','Zone name?',12,D15,'zone name',IER,2)
*item edbuild
'The zone geometry file is mandatory and defines the'
'closed body of a thermal zone.'
*enditem
   41   CALL EASKS(L,outs,' ',72,D,'Z geom',IER,2)
*item edbuild
'The zone construction file is mandatory and defines'
'the thermo-physical properties of the thermal zone.'
*enditem
        CALL EASKABC(' For zone construction file',
*item edbuild
*enditem
   42   CALL EASKS(L,outs,' ',72,D,'Z constr',IER,2)
*item edbuild
'The zone operation file is mandatory and defines'
'infiltration, ventilation and casual gains.'
*enditem
        CALL EASKABC(' For zone operation file',
*item edbuild
*enditem
   40   CALL EASKS(L,outs,' ',72,D,'Z operations',IER,2)
*item edbuild
'The zone obstructions file contains the geometry of'
'obstruction blocks for use in shading/ insolation'
'calculations. You may browse for existing files.'
*enditem
            CALL EASKABCD(' For zone obstruction file',' :',
*item edbuild
*enditem
            CALL EASKABC(' For zone obstruction file',
*item edbuild
*enditem
   47     CALL EASKS(L,outs,' ',72,D,'Z obstr',IER,3)
*item edbuild
'The zone optics (TMC) file contains the optical'
'properties of transparent surfaces and offering'
'a more exact treatment of, for example, windows.'
*enditem
          CALL EASKABCD(' For the zone TMC file',' :',
*item edbuild
*enditem
          CALL EASKABC(' For the zone TMC file',' :',
*item edbuild
*enditem
   51   CALL EASKS(L,outs,' ',72,D,'tmc file',IER,6)
*item edbuild
'The zone view factor file supports a more exact'
'treatment of longwave radiation exchange.'
'You may also browse for existing files.'
*enditem
          CALL EASKABCD(' For zone view factor file',' :',
*item edbuild
*enditem
          CALL EASKABC(' For zone view factor file',' :',
*item edbuild
*enditem
   46   CALL EASKS(L,outs,' ',72,D,'view factor',IER,4)
*item edbuild
'The zone casual gain control file allows a casual'
'gain type to be controlled on the basis of daylight'
'levels as sensed by one or more sensors located within'
'or outwith a zone and against a selected control law.'
*enditem
          CALL EASKABCD(' For zone casual gain control file',' :',
*item edbuild
*enditem
          CALL EASKABC(' For zone casual gain control file',' :',
*item edbuild
*enditem
   52   CALL EASKS(L,outs,' ',72,D,'casual gain control file',IER,6)
*item edbuild
'The shading/ insolation file contains the results of'
'a separate shading and insolation analysis for use'
'throughout a simulation to dictate solar injection'
*enditem
          CALL EASKABCD(' For zone shading/ insolation file',' :',
*item edbuild
*enditem
          CALL EASKABC(' For zone shading /insolation file',' :',
*item edbuild
*enditem
   48   CALL EASKS(L,outs,' ',72,D,'shd db',IER,6)
*item edbuild
'The convection regime file contains data for'
'controlling the calculation of internal and/or external'
'surface convection heat transfer for selected surfaces.'
'It is possible to override the default convection'
'coefficient correlations for specified surfaces and for'
'specified time intervals. You can specify fixed'
'coefficients, select from amongst a suite of specialised'
'correlations, or impose `adaptive` control over the'
'convection calculations.'
*enditem
          CALL EASKABCD(' For the convection regime file',' :',
*item edbuild
*enditem
          CALL EASKABC(' For zone convection regime file',' :',
*item edbuild
*enditem
   49   CALL EASKS(L,outs,' ',72,D,'Z hc',IER,6)
*item edbuild
'The domain flow file allows the association of a'
'computational fluid dynamics (CFD) domain with a'
'zone.  This allows intra-zone air movement to be'
*enditem
          CALL EASKABC(' For the zone domain flow file',
*item edbuild
*enditem
   53   CALL EASKS(L,outs,' ',72,D,'Domain flow model file',IER,6)
*item edbuild
'There are four adaptive gridding files which must be'
'specified for each zone to which such gridding is to'
'be applied. Check documentation for more information.'
*enditem
          CALL EASKABC(' For addaptive gridding files',
*item edbuild
'The 3D control volumes file defines ...'
'<< more text to be added here >>'
*enditem
        CALL EASKS(L,outs,' ',72,D,'control volumes',IER,2)
*item edbuild
'The 3D node connections file defines ...'
'<< more text to be added here >>'
*enditem
        CALL EASKS(L,' 3D volumes connections file?',
*item edbuild
'The 3D nodes coordinates file defines ...'
'<< more text to be added here >>'
*enditem
        CALL EASKS(L,' 3D coordinates file?',
*item edbuild
'The 3D nodes temperatures file defines the'
'location of additional construction nodes'
'corresponding to the finer discretisation'
'of a multi-layered construction.'
*enditem
        CALL EASKS(L,' 3D node temperatures file?',
*item edbuild
'Moisture transport data is required for adaptive '
'gridding use in the current zone.'
'Check documentation for more information.'
*enditem
          CALL EASKABC(' For moisture transport file',
*item edbuild
'The moisture file holds moisture transport data'
'for nodes. << more text to be added here >>'
*enditem
        CALL EASKS(L,outs,' ',72,D,'moisture file',IER,2)
*item edbuild
'structure mesh configuration file is required for '
'structured gridding of the current zone.'
'Check documentation for more information.'
*enditem
          CALL EASKABC(' For structured mesh file',
*item edbuild
'The structured mesh file holds structured mesh data'
'for a zone.'
*enditem
        CALL EASKS(L,outs,' ',72,D,'structured file',IER,2)
*item edbuild
'The zone complex fenestration constructions (CFC)'
'provides a more exact treatment for windows which'
'can include operable slat-type shading layers.'
*enditem
          CALL EASKABCD(' For the zone CFC file',' :',
*item edbuild
*enditem
          CALL EASKABC(' For the zone CFC file',' :',
*item edbuild
*enditem
  511   CALL EASKS(L,outs,' ',72,D,'cfc file',IER,6)
*subroutine GTOPOL
*item GTOPOL
'This file contains a description of a ground form '
'for use by Radiance and viewing (later by esp). '
*enditem
 46   CALL EASKS(ltmp,' Ground topology/geometry file name ? ',
*item GTOPOL
'This is a reminder of the ground type.'
*enditem
        CALL EASKS(t15,' Description of the ground?',
*item GTOPOL
'As an option the default assumption of a flat uniform'
'ground attributed only by a reflectance you can define'
'a gound topology and geometry.  Currently this infor-'
'mation is passed to imaging software such as Radiance'
'for wire-frame viewing packages.  In the FUTURE it  '
'will be included in shading calculations. '
' '
'Geometry is similar to that of zone enclosures but'
'is primarily a collection of triangles which need not'
'form a `closed` body - rather a mesh which approx- '
'imates the contours of the site. '
' '
'Each surface has an composition attribute (mlc db'
'name) so that surface properties are known. '
' '
'An automated building of triangles from a list of '
'vetices is provided. '
' '
'If you are creating the initial vertices via a click-'
'on-bitmap the ESP-r cookbook has a useful guide. '
' '
'<< to be written>> '
*enditem
        CALL PHELPD('grnd topo section',22,'-',0,0,IER)
*item GTOPOL
'This is a reminder of the ground (like zone names) '
*enditem
        CALL EASKS(t15,' Description of the ground?',
*item GTOPOL
*enditem
        CALL EASKGSUR(IS,'M','Select surface(s) to attribute.',' ',IER)
*item GTOPOL
'Select the surfaces for which the composition '
'is to be defined.'
*enditem
            CALL EPICKS(INPICK,IVALS,' ',' ',32,NGT,VERTS,
*item GTOPOL
'The auto triangulation method is most robust when'
'applied to a ground topography with no existing'
'surface. If you say yes, existing surfaces are'
'cleared before beginning triangulation. '
*enditem
            call askok('Existing surfaces will be removed prior to',
*item GTOPOL
'Rotation and translation options are the same as '
'for thermal zones. '
*enditem
        CALL EASKAB(' Adjust location of ground:',' ',
*item GTOPOL
'The rotation is applied around vertex 1 and positive'
'is anticlockwise. '
*enditem
          CALL EASKR(VAL,' ',' Rotation (deg + = anticlockwise) ? ',
*item GTOPOL
'You may wish to rotate it about the site '
'origin X=0., Y=0. or at a user specified point. '
*enditem
            CALL EASKABC(' Rotation choices :',' ','Site origin',
*item GTOPOL
'Point is in the site coordinate system.'
*enditem
              CALL EASKR(x1,' ',' X point (metres) ? ',
*item GTOPOL
*enditem
              CALL EASKR(y1,' ',' Y point (metres) ? ',
*item GTOPOL
'Transform shifts the zone by a given amount in'
'each axis.'
*enditem
          CALL EASKR(VALX,' ',' X shift (metres) ? ',
*item GTOPOL
*enditem
          CALL EASKR(VALY,' ',' Y shift (metres) ? ',
*item GTOPOL
*enditem
          CALL EASKR(VALZ,' ',' Z shift (metres) ? ',
*item GTOPOL
'This file contains a description of a ground form '
'for use by Radiance and viewing (later by esp). '
*enditem
        CALL EASKS(ltmp,' Ground topology/geometry file name ? ',
*subroutine EDGVERT
*item EDGVERT
'This menu allows existing vertices to be viewed and'
'edited. Edit by selecting an item or -Exit to escape.'
' '
'The `> find vertex` option is useful to predict an'
'intermediate vertex along an edge. '
' '
'The `^ distance along` option is useful to confirm'
'actual dimension of a surface.'
*enditem
        CALL PHELPD('configuration section',8,'-',0,0,IER)
*item EDGVERT
'ESP-r includes triangulation routines which require'
'you to identify which vertices are at an edge. '
'*--x-* Vertex on a line: finds one or more points '
'along a line (defined by specifying two vertices). '
' '
'*<-?->* Distance between vertices: gives distance in '
'metres given two vertices. '
' '
'Vertex at angle: finds a (new) vertex relative to '
'a given vertex at a specified distance, angle and '
'elevation. '
' '
'Angel between lines: finds angle A between two lines'
'given 3 vertex as in:      * 1 '
'                       a  /    '
'                3 *------* 2   '
*enditem
        call MENUATOL('available vertex transforms (see help):',
*item EDGVERT
'Distance along the line in metres.'
*enditem
            CALL EASKR(vdis,' Distance along the line (metres): ',
*item EDGVERT
'This can become a new vertex. '
*enditem
              CALL EASKABC(outs,' ','new vertex',
*item EDGVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
 443            CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vtx co',IER,2)
*item EDGVERT
'The new vertex is within 3mm of an'
'edge of another surface. Probably the'
'vertex should also be included in that'
'other surface (so the rules about'
'matching edges is followed). '
*enditem
                        call askok('Insert this vertex?','(see help)',
*item EDGVERT
'If you have several vertices along one line you '
'can click ok to continue defining them. '
*enditem
            call askok('Another vertex along the line? ',' ',ok,dok,2)
*item EDGVERT
'Distance is in metres, azimuth assumes north=0 '
'+ degrees clockwise, elevation 90 is vertical. '
*enditem
 342        CALL EASKS(HOLD,
*item EDGVERT
'This can become a new vertex. '
*enditem
              CALL EASKABC(outs,' ','new vertex',
*item EDGVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
 543            CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vtx co',IER,2)
*item EDGVERT
'If you have several vertices to create '
'can click ok to continue defining them.'
*enditem
            call askok('Another vertex from this origin?',' ',ok,dok,2)
*item EDGVERT
'Last chance to change the vertex position. '
*enditem
            call askok('Is this aligned vertex ok?',' ',ok,dok,1)
*item EDGVERT
'The new vertex is within 3mm of an'
'edge of another surface. Probably the'
'vertex should also be included in that'
'other surface (so the rules about'
'matching edges is followed). '
*enditem
                      call askok('Insert this vertex?','(see help)',
*item EDGVERT
'If there are vertices which are near duplicates, this'
'function will list them all or find ones close to one.'
*enditem
          CALL EASKABC('Options:',' ','find any close vertices',
*item EDGVERT
'Distance along the line in metres. Positive'
'will be towards the 2nd vertex. Negavie will '
'be away from 2nd vertex.'
*enditem
            CALL EASKR(vdis,' Move along the line (metres): ',
*item EDGVERT
'Last chance to abort the change. '
*enditem
            call askok('Apply this move?',' ',OK,dok,1)
*item EDGVERT
'This can become a new vertex. '
*enditem
            CALL EASKABC(outs,' ','new vertex',
*item EDGVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
  43          CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vtx co',IER,2)
*item EDGVERT
'If a new vertex is a minor variation of an existing '
'point then it may be easier to copy and then edit. '
' '
'You may delete one or more vertices (but only those'
'which are unlinked to surfaces may be deleted). '
'In graphic mode click on the vertices (end with and `e`)'
' '
'Replication can be used make several varitants of a'
'single vertex (useful where only one coordinate needs'
'to be altered). '
' '
'In graphic mode you can edit a number of vertices by '
'clicking on the wire-frame image. '
' '
'A cancel request leaves the model unchanged. '
*enditem
        CALL EASKATOG('Vertex operations:',' ','add','delete','copy',
*item EDGVERT
*enditem
          CALL EASKI(IADD,' ',' How many vertices to add ? ',
*item EDGVERT
*enditem
            CALL EASKI(IADD,' ',' Replicate how many times ? ',
*item EDGVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
 146          CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vertex coord',
*item EDGVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
  42    CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vertex coord',IER,2)
*subroutine EPKGVERT
*item EPKGVERT
*enditem
        CALL PHELPD('ground vertex pick',NHELP,'-',0,0,IER)
*subroutine ADDGVERT
*item ADDGVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
          CALL EASKS(HOLD,' Vertex  X  Y  Z (in metres): ',
*item ADDGVERT
'The new vertex is within 3mm of an'
'edge of another surface. Probably the'
'vertex should also be included in that'
'other surface (so the rules about'
'matching edges is followed). '
*enditem
                      call askok('Insert this vertex?','(see help)',
*item ADDGVERT
'The vertex coordinates should be in metres. '
'Exact duplicate vertices should be avoided.'
'It is not advisable for Z to be negative.'
*enditem
        CALL EASKS(HOLD,outs,' X  Y  Z (in metres): ',
*item ADDGVERT
'The new vertex is within 3mm of an'
'edge of another surface. Probably the'
'vertex should also be included in that'
'other surface (so the rules about'
'matching edges is followed). '
*enditem
                    call askok('Insert this vertex?','(see help)',
*subroutine EASKGSUR
*item EASKGSUR
'A ground surface will be selected via its name'
'in the list. (This may be edited elsewhere.)'
*enditem
        CALL PHELPD('ground surface file section',2,'-',0,0,IER)
*subroutine ADDGSUR
*item ADDGSUR
*enditem
        CALL EASKGSUR(IS,'-','Select surface to copy.',' ',IER)
*item ADDGSUR
*enditem
          CALL EASKS(SNAME1,'Revised surface name','Please edit.',
*item ADDGSUR
' Shift surface along (+ = outwards) surface normal.'
' Transform vertices by X,Y,Z.'
' Rotate surface about one of its vertices.'
' Invert ordering (to swop front & back faces).'
' Do several operations to the surface.'
' Continue with no action.'
*enditem
          CALL EASKATOG(' ','Surface action options:',
*item ADDGSUR
'Distance along the normal (+ = out).'
*enditem
            CALL EASKR(vdis,' ','Distance along normal?',
*item ADDGSUR
*enditem
 152        CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
*item ADDGSUR
'The rotation is applied around one vertex of'
'the surface.'
*enditem
            CALL EASKI(IRV,' ','Rotate about which vertex?',
*item ADDGSUR
'A positive rotation is anticlockwise.'
*enditem
            CALL EASKR(ANGR,' ','Rotation degrees?',
*item ADDGSUR
'The new vertex is within 3mm of an'
'edge of another surface. The vertex'
'should probably also be included in'
'the other surface in order that the'
'rules about matching edges is followed). '
*enditem
                      call askok(' ','Insert this vertex?',
*item ADDGSUR
'You can swop the front/back faces of a surface, e.g.'
'is the surface is facing the wrong way.'
*enditem
              CALL EASKAB('Reverse the edge ordering of',
*item ADDGSUR
'A surface is composed of an ordered list of vertices.'
'The order is anticlockwise when viewed from outside'
'the model. The total number of vertices defining a'
'surface must be less than 24. Note that the last line'
'of the surface is from the last to the first vertex. '
' '
'You may mouse click on existing vertices, ending with'
'an `e`. A match is assumed if the location is within'
'5 pixels.'
*enditem
          CALL EASKS(HOLD,' ','Vertex list?',
*item ADDGSUR
*enditem
          CALL EASKSCMD(HOLD,' ','Vertex list?','via mouse',
*item ADDGSUR
*enditem
            CALL EASKS(HOLD,' Associated vertices (confirm):',
*item ADDGSUR
*enditem
        CALL EASKS(SN,'Surface name','(unique word <=6char):',
*subroutine EDGVLIST
*item EDGVLIST
'This menu allows existing vertices to be viewed and'
'edited. Edit by selecting an item or -Exit to escape.'
' '
'The transforms for ground surfaces are similar to'
'those provided for zone surfaces.'
' '
'The add/copy/delete functions are similar to those'
'offered for zone surfaces (but ground surfaces are'
'can only have 6 vertices so some functions are omitted.'
' '
*enditem
        CALL PHELPD('ground vertex section',10,'-',0,0,IER)
*item EDGVLIST
*enditem
        CALL EASKGSUR(IS,'-','Select surface to transform.',' ',IER)
*item EDGVLIST
'Actions: '
' Shift surface along (+=outwards) surface normal.'
' Transform vertices by X,Y,Z metres.'
' Rotate surface about one of its vertices.'
' Invert ordering (to swop front & back faces).'
' Do several operations to the surface.'
' Continue with no action.'
*enditem
        CALL EASKATOG(outs,' :','shift along normal','transform xyz',
*item EDGVLIST
'Distance along the normal (+=out) in metres.'
*enditem
          CALL EASKR(vdis,' Distance along the normal (metres): ',
*item EDGVLIST
*enditem
 152      CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
*item EDGVLIST
'The rotation is applied around one vertex of'
'the surface. The index is to the 1st, 2nd, 3rd,'
'vertex in the surface. '
' '
'A cancel leaves the model unchanged. '
*enditem
          CALL EASKI(IRV,'Rotate about which vertex index: ',
*item EDGVLIST
'The rotation is applied with positive'
'being anticlockwise. '
*enditem
          CALL EASKR(ANGR,' ',' Rotation (deg + = anticlockwise) ?',
*item EDGVLIST
'If not then no change is made to the ground geometry.'
*enditem
        CALL ASKOK('Is it ok to apply the transformed points  ',
*item EDGVLIST
*enditem
        CALL EASKGSUR(IS,'-','Select surface to delete.',' ',IER)
*item EDGVLIST
'Insertion into an existing surface is a common way '
'to create a door or window opening. '
' '
'You may copy (and then transform) a surface within this '
'zone to make a new surface. An example an identical shape'
'which is repeated in several locations. '
' '
'You may copy (and then transform) a surface from another '
'zone for use in this zone. For example, a partition which'
'shared between two zones. '
' '
'You may create a rectangular surface by specifying its'
'origin and either an azimuth (for vertical) or a '
'rotation between the X axis and its `length edge` for.'
'a horizontal rectangle. '
*enditem
        call MENUATOL(' ','new surface options',
*item EDGVLIST
'The origin of the surface will be its lower left hand '
'corner when viewed from the outside. '
*enditem
          CALL EASKS(HOLDS,' Surface origin X Y & Z: ',' ',
*item EDGVLIST
'Azimuth 0.0 is north, 180 is south, 270 is west. '
'Length and height are in metres.'
*enditem
          CALL EASKS(HOLDS,' Surface azimuth (deg) length & height: ',
*item EDGVLIST
'The origin of the surface will be its lower left hand '
'corner when viewed from the outside. '
*enditem
          CALL EASKS(HOLDS,' Surface origin X Y & Z: ',' ',
*item EDGVLIST
'Rotation is in relation to the first edge along the '
'`length` edge and the X axis (positive is anticlockwise'
'and negative is clockwise.'
*enditem
          CALL EASKS(HOLDS,' Surface rotation (deg) length & height: ',
*item EDGVLIST
'If you accept the rectangle it will be converted into '
'a surface within the zone. If you elect to revise it'
'you will be presented with several options. '
*enditem
          CALL EASKABC('Options for this rectangle:',' ',
*item EDGVLIST
*enditem
          CALL EASKS(SN,' ',' Inserted surface name: ',
*item EDGVLIST
'The list of associated vertices should be given in'
'anticlockwise order as one faces the outside of the'
'surface.  If one is looking at the inside face then'
'think of the list in clockwise order.  It is a con-'
'vention that the first vertex is located at the'
'bottom-left corner of the surface (looking from the'
'outside) with the next vertex moving horizontally.'
'It helps to follow a consistent pattern!'
*enditem
  43    CALL EASKS(HOLD,outs,'  ',72,' ','associated vertices',IIER,8)
*subroutine pointtogline
*subroutine UGRNDR
*subroutine TRIANG
*item TRIANG
'Option to include vertex indices in drawing. '
*enditem
        CALL ASKOK(' ','Draw vertices?',OK,dok,1)
*item TRIANG
'Alternative logic will be used to check for surfaces'
'which might use this vertex. '
*enditem
          call askok('Try again to find this vertex?',' ',ok,dok,2)
*subroutine HCFMK
*item HCFMK
'A zone heat transfer coefficient file holds directives'
'instructing esp-r to either use a specific set of heat'
'transfer coefficients (e.g. related to ceiling diffusers'
'or user supplied data for surfaces in a zone. '
' '
'If you do not want to ignore the information in this '
'file click on dereference. '
*enditem
  245   CALL EASKSCMD(LTMP,'Zone conv regime file ?',
*item HCFMK
'The file was not of the expected (heat transfer'
'regime) and you should double check before you'
'agree to overwrite it with hc regime data. '
' '
'If you say no you will be returned to the zone '
'composition menu. '
*enditem
                CALL ASKOK(outs,
*item HCFMK
'Answering yes will create a new file to hold the'
'conv regime data. '
' '
'A no answer will return without changing the model.'
*enditem
            CALL ASKOK(
*item HCFMK
'A zone heat transfer coefficient file holds directives'
'instructing esp-r to either use a specific set of heat'
'transfer coefficients (e.g. related to ceiling diffusers'
'or user supplied data for surfaces in a zone. '
*enditem
  246   CALL EASKSCMD(LTMP,'Zone conv regime file ?',
*item HCFMK
'The choice of algorithm for calculating internal surface'
'convection coefficients (int-hc) can significantly affect'
'simulation results and can even impact design decisions.'
'It is important to recognize that by default int-hc'
'values are calculated using a buoyancy-flow relation. The'
'facility implemented here allows you to drop this'
'assumption and to calculate int-hc values in a more'
'rigorous fashion.'
' '
'The adaptive convection algorithm (ACA) implemented'
'under options `a` through `n` controls the calculation'
'of int-hc in a dynamic fashion. Based upon minimal data'
'input, the ACA appraises a configuration to assign an'
'appropriate set of int-hc correlation equations to each'
'internal surface. Then as the simulation evolves, the'
'ACA toggles between the int-hc equations in response to'
'the prevailing convective regime.'
' '
'Choose the option that best describes the principle'
'convection regime within the zone. You will be'
'prompted for supplementary data in subsequent menus.'
' '
'Simulation time-steps of 15 minutes or less are'
'recommended when this facility is used.'
' '
'Options a-c are appropriate when convection in the zone'
'is driven primarily by buoyancy resulting from surface-'
'to-air temperature differences caused by in-floor'
'heating, a heated wall panel, sun-patch or cold window.'
' '
'Options d-e are appropriate when convection is driven'
'primarily by buoyancy resulting from a heating device'
'(e.g. radiator, stove) located either undeer a window'
'or at some other location in the zone.'
' '
'Options f-g are specific for treating convection inside'
'open vertical channels with bouyancy driven flow.'
'The correlations apply to the vertical surfaces'
'and operate all the time'
' '
'Options h-j are appropriate when convection is driven'
'primarily by an air-handling system that supplies'
'heated or cooled air to the zone through ceiling'
'floor or wall-mounted diffusers. It should not be used'
'when buoyancy is also a significant factor.'
' '
'Option k is appropriate when convection in the zone'
'is driven primarily by a heating or cooling device that'
'circulates air within the zone. There is no intentional'
'supply or extract of air from the zone.'
' '
'Options l-m are appropriate when convection in the zone'
'is driven by both mechanical and buoyant forces. The'
'mechanical forces are caused by an air handling system'
'(AHU) that supplies heated or cooled air to the zone'
'through ceiling, floor, or wall-mounted diffusers. The'
'buoyant forces are caused by surface-to-air temperature'
'differences. This option is preferred over the'
'`air-based HVAC system` convective regime as it captures'
'the combined influence of buoyant and forced effects.'
*enditem
        CALL PHELPD('convective calculations',59,'-',0,0,IER)
*subroutine EconvA
*item EconvA
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok('View a synopsis of Bouyancy-driven flow',
*item EconvA
'This choice is appropriate when convection in the zone'
'is driven primarily by buoyancy resulting from'
'surface-to-air temperature differences.'
' '
'Use option `in-floor heating` when you have defined a'
'zone with floor surface(s) heated by flux injection'
'into the floor construction or by flux injection into'
'a plenum under the floor surface. It is assumed that'
'such a zone control is or will be defined.'
' '
'You will be prompted for the surface(s) which are '
'heated. '
' '
'ESP-r models convection as follows: '
'  walls:   Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows: Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  floor:   Awbi-Hatton heated floor eq when heat on;'
'           Alamdari-Hammond stably stratified/buoyant'
'           horizontal eq (or sim toggle) when heat off.'
'  ceiling: Khalifa eq 4 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
         CALL PHELPD('Cause of dT',28,'-',0,0,IER)
*item EconvA
'Use option `heated wall panel` when you have defined a'
'zone with surface(s) heated by flux injection into the'
'panel construction or by flux injection into a zone'
'which represents a panel heater. It is assumed that'
'such a zone control is or will be defined.'
' '
'You will be prompted for the surface(s) which are '
'heated. '
' '
'ESP-r models convection as follows: '
'  heated walls: Awbi-Hatton heated wall eq when heat'
'                on; Alamdari-Hammond vert eq (or sim'
'                toggle) when heat off.'
'  non-heated:   Khalifa eq 6 when heat on; Alamdari-'
'  walls:        Hammond vert eq (or toggle) when off.'
'  windows: Khalifa eq 6 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  floor:   Alamdari-Hammond stably stratified eq when'
'           heat on; Alamdari-Hammond stably stratified'
'           or buoyant horizontal eq (or sim toggle)'
'           when heat is off.'
'  ceiling: Khalifa eq 7 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
         CALL PHELPD('Cause of dT',32,'-',0,0,IER)
*item EconvA
'The option `other temp diff` is the appropriate choice'
'when the temperature diff is caused by a sun patch or'
'by heat transfer through the fabric (e.g. a cold window '
'surface). '
' '
' '
'ESP-r models convection as follows: '
' walls:   Alamdari-Hammond vertical eq (or sim toggle)'
'          when heat on or off.'
' windows: Alamdari-Hammond vertical eq (or sim toggle)'
'          when heat on or off.'
' floor:   Alamdari-Hammond stably stratified or buoyant'
'          horizontal eq (or sim toggle) when heat on'
'          or off.'
' ceiling: Alamdari-Hammond stably stratified or buoyant'
'          horizontal eq (or sim toggle) when heat on'
'          or off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
         CALL PHELPD('Cause of dT',25,'-',0,0,IER)
*item EconvA
'Treatment for wall depends on whether it is a'
'heated surface.'
*enditem
            CALL ASKOK(' ',outs,OK,dok,2)
*subroutine EconvB
*item EconvB
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok('View a synopsis of Bouyancy-driven flow',
*item EconvB
'This choice is appropriate when convection in the zone'
'is driven primarily by buoyancy resulting from'
'a heating device (e.g. radiator, stove) located within'
'the zone.'
' '
'Indicate whether the heating device is located beneath'
'a window or not as this will influence the convective'
'regime within the zone.'
' '
'You will be prompted to indicate whether you want to'
'apply Khalifa`s window correlations or alternate'
'equations. As discussed in Section 5.2 of'
'Beausoleil-Morrison (2000), it is suspected that'
'Khalifa`s window correlations overpredict int-hc.'
' '
'For option `a` the ACA models convection as follows:'
'  walls:   Khalifa eq 6 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows: Khalifa eq 6 or 9 (user choice) when heat on;'
'           Alamdari-Hammond  vertical eq (or sim toggle)'
'           when heat off.'
'  floor:   Alamdari-Hammond stably stratified eq when'
'           heat on; Alamdari-Hammond stably stratified'
'           or buoyant horizontal eq (or sim toggle) when'
'           heat off.'
'  ceiling: Khalifa eq 7 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
' '
'For option `b` the ACA models convection as follows:'
'(you will be prompted to indicate which wall surfaces'
'are adjacent to the heating device):'
'  walls close to heater:'
'           Khalifa eq 5 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  walls not close to heater:'
'           Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows: Khalifa eq 3 or 10 (user choice) when heat'
'           on; Alamdari-Hammond  vertical eq (or sim'
'           toggle) when heat off.'
'  floor:   Alamdari-Hammond stably stratified eq when'
'           heat on; Alamdari-Hammond stably stratified'
'           or buoyant horizontal eq (or sim toggle) when'
'           heat off.'
'  ceiling: Khalifa eq 4 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
        CALL PHELPD('Location of heater',52,'-',0,0,IER)
*item EconvB
'Surface transparent. Use Khalifa window correlation'
'(yes) or wall correlation (no)? '
*enditem
              CALL ASKOK(outs,'(see help)',OK,dok,2)
*item EconvB
'Surface transparent. Use Khalifa window correlation'
'(yes) or wall correlation (no)? '
*enditem
              CALL ASKOK(outs,'(see help)',OK,dok,2)
*item EconvB
'Surface is a wall. If it is close to the heater'
'say yes if not say no.'
*enditem
              CALL ASKOK(outs,'(see help)',OK,dok,2)
*subroutine EconvC
*item EconvC
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok('View a synopsis of Mechanically-driven flow',
*item EconvC
'This choice is appropriate when convection in the zone'
'is driven primarily by an air-handling system that'
'supplies heated or cooled air to the zone through ceiling'
'floor or wall-mounted diffusers. It should not be used'
'when buoyancy is also a significant factor. Buoyancy is'
'often negligible for cooling situations, but usually'
'important for heating situations. The `mixed flow`'
'convective regime is generally recommended as an'
'alternative to this choice as it can capture the combined'
'influence of buoyant and forced effects.'
' '
'Indicate the air-handling system type. This determines'
'the temperature and flowrate of air introduced to the'
'zone and thus the convective regime.'
' '
'NOTES: variable air volume system with constant volume'
'heating. When the zone requires cooling, the supply'
'air is chilled to a constant temp while the system'
'adjusts the air flow to meet the cooling load. When the'
'zone requires heat, the system supplies air at a fixed'
'flow rate, equal to the min damper position of the VAV'
'box. Reheat coils warm the air upstream of the diffuser'
'to meet the zone`s heating load.'
' '
'NOTE: variable air volume system with variable volume'
'heating. It operates the same as VAV with CV in'
'cooling mode. But when the zone requires heating, the'
'dampers and reheat coils work in conjunction to satisfy'
'the heating load. At low heat loads the system delivers'
'air at the min flowrate and the reheat coil heats the'
'air to meet the load. When the heating load is'
'sufficiently high that the reheat coil cannot meet the'
'load, the damper opens to increase the flowrate.'
' '
'NOTE: constant-volume variable-temperature system'
'delivers a constant flow of air, varying the temperature'
'of the supply air in response to the zone load.'
' '
' '
'It is important to note that the description given here'
'is used to simulate the convective regime induced in the'
'zone by the HVAC air handling system. It does not model'
'the performance and energy draws of the system`s'
'components. Therefore, you should ensure that the data'
'given here is consistent with the zone control data or'
'the explicit plant data that describes the HVAC system.'
*enditem
        CALL PHELPD('HVAC system type',46,'-',0,0,IER)
*item EconvC
'Enter the air flow rate supplied by the system to the'
'zone. This is expressed in terms of zone air changes per'
*enditem
        CALL EASKR(airflow,outs,' ',
*item EconvC
'Enter the minimum air temperature that can be supplied'
'by the system to the zone. This is the design temperature'
'for cooling and is measured at the diffuser.'
*enditem
        CALL EASKR(Tmin,outs,' ',
*item EconvC
'Enter the maximum air temperature that can be supplied'
'by the system to the zone. This is the design temperature'
'for heating and is measured at the diffuser.'
*enditem
        CALL EASKR(Tmax,outs,' ',
*item EconvC
'Enter the temperature at which air is supplied to the'
'zone when the system is cooling.'
*enditem
        CALL EASKR(Tmin,outs,' ',
*item EconvC
'Enter the minimum air flow rate that the system can'
'supply to the zone. This is flow rate that occurs when'
'the dampers in the VAV box are at their minimum'
'position. This is expressed in terms of zone air'
'changes per hour.'
*enditem
        CALL EASKR(airflow,outs,' ',
*item EconvC
'Enter the max air flow rate that the system can supply'
'to the zone. This is design flow rate and occurs when the'
'dampers in the VAV box are at their max position. This'
'is expressed in terms of zone air changes per hour.'
*enditem
        CALL EASKR(airflow,outs,' ',
*item EconvC
'Enter the maximum air temperature that can be supplied'
'by the system to the zone. This is the design temperature'
'for heating and is measured at the diffuser. Note that'
'if the zone`s heating load cannot be satisfied by this'
'supply air temp, it is assumed that any remaining heat is'
'supplied from another source (e.g. baseboard heaters)'
'which does not affect the flow regime.'
*enditem
        CALL EASKR(Tmax,outs,' ',
*item EconvC
'Typically the air handling unit (AHU) conditions outdoor'
'air. In this case, the conditioning of the outdoor air'
'is performed by the AHU`s heating or cooling coil.'
' '
'You can choose to represent the outdoor air in your model'
'as infiltration to the zone. This would give the correct'
'total heating or cooling load for the zone. However, in'
'this case it is necessary to subtract the outdoor air'
'load from the zone`s total load. In this way, the correct'
'temperature and flow rate at the diffuser can be'
'calculated. This is handled automatically when you'
'select option `b`.'
' '
'Alternatively, you can represent the AHU as another'
'zone. You would have infiltration of outdoor air to the'
'AHU zone then ventilation from the AHU zone to the'
'occupied zone. The energy inj/extracted to condition'
'this ventilation to the zone air-point temp must be'
'subtracted from the zone`s total load to correctly'
'calculate the temperature and flow rate at the diffuser.'
'This is handled automatically with option `c`.'
' '
'Use option `a` if you have no outdoor air in your model.'
*enditem
        CALL PHELPD('Outdoor air treated as',23,'-',0,0,IER)
*item EconvC
'The location of the supply diffusers affects the'
'convective regime in the zone. Select the option'
'that most closely describes the location of the'
'diffusers in the zone.'
' '
'If the diffusers are located within the ceiling, you'
'will be given the choice of using the Fisher'
'ceiling-jet or the Fisher & Pedersen correlations.'
'The Fisher horizontal-jet correlations will be used'
'if the diffusers are located in the wall.'
' '
'The Fisher or Fisher & Pedersen correlations will be'
'used when the AHU is on, while the Alamdari-Hammond'
'correlations will be used when it is off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
'Two alternate correlations are available to calculate'
'int-hc values for AHU`s that supply air through ceiling'
'diffusers. Both were generated from the same'
'experimental data set but use different functional'
'forms. Refer to Appendix C of Beausoleil-Morrison'
'(2000) for a discussion of this topic.'
*enditem
          CALL PHELPD('Which correlations',6,'-',0,0,IER)
*item EconvC
*enditem
        CALL PHELPD('Diffuser location',18,'-',0,0,IER)
*subroutine EconvD
*item EconvD
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok(
*item EconvD
'This choice is appropriate when convection in the zone'
'is driven primarily by a heating or cooling device that'
'circulates air within the zone. There is no intentional'
'supply or extract of air from the zone.'
' '
'You will be prompted to indicate which surfaces are'
'struck by the fan as this augments heat transfer.'
' '
'The ACA models convection as follows:'
'  walls, fan blowing on:'
'           Khalifa eq 8 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  walls, fan not blowing on:'
'           Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows, fan blowing on:'
'           Khalifa eq 8 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows, fan not blowing on:'
'           Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  floor:   Alamdari-Hammond stably stratified or buoyant'
'           horizontal eq (or sim toggle) when heat on'
'           or off.'
'  ceiling: Khalifa eq 4 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
*enditem
        CALL PHELPD('Outdoor air treated as',27,'-',0,0,IER)
*item EconvD
'Surface is oriented so it might get air from the '
'fan heater. If this is the case say yes. '
*enditem
          CALL ASKOK(outs,'(see help)',OK,dok,2)
*subroutine EconvE
*item EconvE
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok(
*item EconvE
'This choice is appropriate when convection in the zone'
'is driven by both mechanical and buoyant forces. The'
'mechanical forces are caused by an air handling system'
'(AHU) that supplies heated or cooled air to the zone'
'through ceiling, floor, or wall-mounted diffusers. The'
'buoyant forces are caused by surface-to-air temperature'
'differences. This option is preferred over the'
'`air-based HVAC system` convective regime as it captures'
'the combined influence of buoyant and forced effects.'
' '
'Indicate the air-handling system type. This determines'
'the temperature and flow rate of air introduced to the'
'zone and thus the convective regime.'
' '
'Option `VAV with CV heating` is a variable air volume'
'system with constant vol heating.'
'When the zone requires cooling, the supply air'
'is chilled to a constant temp while the system'
'adjusts the air flow to meet the cooling load. When the'
'zone requires heat, the system supplies air at a fixed'
'flow rate, equal to the min damper position of the VAV'
'box. Reheat coils warm the air upstream of the diffuser'
'to meet the zone`s heating load.'
' '
'Option `VAV with VV heating` is a variable air volume'
'system with variable volume heating. It operates the'
'same as `VAV with CV heating` in cooling model. In '
'heating mode, the dampers and reheat coils work in'
'in conjunction to satisfy the heating load.'
'At low heat loads the system delivers air at the low'
'flowrate and the reheat coil heats the air to meet the'
'load. If the reheat coil cannot meet the load,'
'the damper opens to increase the flowrate.'
' '
'Option `n` is a constant-volume variable-temperature'
'system. It delivers a constant flow of air, varying the'
'temperature of the supply air in response to the zone'
' '
'<< more comments to be added... >> '
' '
' '
' '
'It is important to note that the description given here'
'is used to simulate the convective regime induced in the'
'zone by the HVAC air handling system. It does not model'
'the performance and energy draws of the system`s'
'components. Therefore, you should ensure that the data'
'given here is consistent with the zone control data or'
'the explicit plant data that describes the HVAC system.'
' '
'Regardless of HVAC system type, the Beausoleil-Morrison'
'mixed flow correlations will be used when the AHU is on,'
'while the Alamdari-Hammond correlations will be used'
'when it is off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
        CALL PHELPD('Mixed convection',39,'-',0,0,IER)
*item EconvE
'Enter the air flow rate supplied by the system to the'
'zone. This is expressed in terms of zone air changes per'
*enditem
        CALL EASKR(airflow,outs,' ',
*item EconvE
'Enter the minimum air temperature that can be supplied'
'by the system to the zone. This is the design temperature'
'for cooling and is measured at the diffuser.'
*enditem
        CALL EASKR(Tmin,outs,' ',
*item EconvE
'Enter the maximum air temperature that can be supplied'
'by the system to the zone. This is the design temperature'
'for heating and is measured at the diffuser.'
*enditem
        CALL EASKR(Tmax,outs,' ',
*item EconvE
'Enter the temperature at which air is supplied to the'
'zone when the system is cooling.'
*enditem
        CALL EASKR(Tmin,outs,' ',
*item EconvE
'Enter the minimum air flow rate that the system can'
'supply to the zone. This is flow rate that occurs when'
'the dampers in the VAV box are at their minimum'
'position. This is expressed in terms of zone air'
'changes per hour.'
*enditem
        CALL EASKR(airflow,outs,' ',
*item EconvE
'Enter the max air flow rate that the system can supply'
'to the zone. This is design flow rate and occurs when the'
'dampers in the VAV box are at their max position. This'
'is expressed in terms of zone air changes per hour.'
*enditem
        CALL EASKR(airflow,outs,' ',
*item EconvE
'Enter the maximum air temperature that can be supplied'
'by the system to the zone. This is the design temperature'
'for heating and is measured at the diffuser. Note that'
'if the zone`s heating load cannot be satisfied by this'
'supply air temp, it is assumed that any remaining heat is'
'supplied from another source (e.g. baseboard heaters)'
'which does not affect the flow regime.'
*enditem
        CALL EASKR(Tmax,outs,' ',
*item EconvE
'Typically the air handling unit (AHU) conditions outdoor'
'air. In this case, the conditioning of the outdoor air'
'is performed by the AHU`s heating or cooling coil.'
' '
'You can choose to represent the outdoor air in your model'
'as infiltration to the zone. This would give the correct'
'total heating or cooling load for the zone. However, in'
'this case it is necessary to subtract the outdoor air'
'load from the zone`s total load. In this way, the correct'
'temperature and flow rate at the diffuser can be'
'calculated. This is handled automatically when you'
'select option `b`.'
' '
'Alternatively, you can represent the AHU as another'
'zone. You would have infiltration of outdoor air to the'
'AHU zone then ventilation from the AHU zone to the'
'occupied zone. The energy inj/extracted to condition'
'this ventilation to the zone air-point temp must be'
'subtracted from the zone`s total load to correctly'
'calculate the temperature and flow rate at the diffuser.'
'This is handled automatically with option `c`.'
' '
'Use option `a` if you have no outdoor air in your model.'
*enditem
        CALL PHELPD('Outdoor air treated as',23,'-',0,0,IER)
*subroutine EHCMAN
*item EHCMAN
'The convection calculations file contains data for'
'controlling the calculation of internal and/or external'
'surface convection heat transfer for selected surfaces.'
' '
'It is possible to override the default convection'
'coefficient correlations for specified surfaces and for'
'specified time intervals.'
' '
'Four `convection-calculation control` methods are'
'supported when you add or edit a period: '
' '
'fixed coefficients - coefficients can be specified for'
'each surface (interior and exterior to the building).'
'The initialise fixed values option creates initial '
'values for this option. '
' '
'fixed correlations - specify a correlation to use'
'for each surface (only applicable for interior '
'surfaces). This could allow, for example, the use of'
'the Alamdari & Hammond correlations for a wall, while '
'using one of the Khalifa & Marshall correlations for a '
'window. '
' '
'adaptive - allows adaptive control of the calculations '
'(only applicable for interior surfaces). '
' '
'CEN - supports CEN standard coefficient regimes or'
'regimes which are similar in approach. Applicable to'
'both inside and outside surfaces. Note this option'
'includes its own method of setting default values. CEN'
'values are almost always imposed for the whole day'
'rather than mixed with other convective regimes. '
' '
'Note that the `outside` surface of a mlc may be interior'
'to the building, ie. it may face the air-point of an '
'adjacent zone. '
' '
'Remember to save any changes before you leave this menu.'
' '
'A cancel option should leave the model unchanged (please'
'check to ensure the model).'
*enditem
        CALL EASKI(ihcftp,' ',' Number of control periods ?',
*item EHCMAN
*enditem
        CALL EASKI(IN,' ',' Which control period ? ',
*item EHCMAN
*enditem
        CALL EASKI(IN,' ',' Delete which control period ? ',
*item EHCMAN
'To give guidence on setting hc values you may supply '
'an air velocity (m/s) and an APPROXIMATE set of '
'hc values will be returned.  The method used is as in'
'esp-r external hc calculations. '
' '
'For comparison, typcial inside correlations based on '
'Alamdari & Hammond (assuming 1 degree C delta T and a'
'typical surface dimension of 2m.). '
*enditem
        CALL EASKR(V1,' ','Air velocity (m/s) [see help message] : ',
*item EHCMAN
*enditem
        CALL PHELPD('conv coef data',37,'-',0,0,IER)
*subroutine EconvF
*item EconvF
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok('View a synopsis of Bouyancy-driven flow in open ',
*item EconvF
'This choice is appropriate for open vertical channels'
'with flow driven primarily by buoyancy resulting from'
'surface-to-air temperature differences.'
' '
'Molina & Maestre correlation was developed specifically'
'for the SOLVENT ventilated window with a gap of 4.5 cm.'
'For more details refer to proceedings of the '
'EPIC AIVC 2002 conference. '
'  '
'Bar-Cohen and Rosenhow is a generic correlation for    '
'open vertical channels. See Fundamentals of Heat and '
'Mass Transfer, Incroppera and DeWitt for more details. '
*enditem
        CALL PHELPD('Channel correlations',12,'-',0,0,IER)
*item EconvF
*enditem
        CALL EASKAB(' ','Air enters channel from','Outdoor',
*item EconvF
*enditem
          CALL ASKZONE(IAORZ,0,' Air enters channel from which zone?',
*item EconvF
'Enter the channel width'
'(inside pane-to-pane distance)'
*enditem
        CALL EASKR(CWIDTH,'Channel width ?',
*item EconvF
'Enter the channel height'
*enditem
        CALL EASKR(CHEIGHT,'Channel height ?',
*subroutine EPHCF
*item EPHCF
'Time must be between 0. and 24. '
*enditem
      CALL EASKR(V1,' ',' Start time ? ',
*item EPHCF
'Time must be between 0. and 24. '
*enditem
      CALL EASKR(V2,' ',' End time ? ',
*item EPHCF
'Four `convection-calculation control` methods are'
'supported: '
' '
'fixed coefficients - allows coefficients to be specified '
'for each surface (interior and exterior to the building).'
' '
'fixed correlations - allows you to specify a correlation '
'to use for each surface (only applicable for interior '
'surfaces). This could allow, for example, the use of'
'the Alamdari & Hammond correlations for a wall, while '
'using one of the Khalifa & Marshall correlations for a '
'window. '
' '
'adaptive - allows adaptive control of the calculations '
'(only applicable for interior surfaces). '
' '
'CEN - supports CEN standard coefficient regimes or'
'regimes which are similar in approach. '
' '
'Note that the `outside` surface of a mlc may be interior'
'to the building, ie. it may face the air-point of an '
'adjacent zone. '
*enditem
      CALL EASKATOG('calculation control (see help):',' ',
*item EPHCF
'This data is usually from measurements. '
'A -1 signals use of calculated values. '
*enditem
          CALL PHELPD('conv coef data',2,'-',0,0,IER)
*item EPHCF
'This data is usually from measurements. '
'A -1 signals use of calculated values. '
*enditem
          CALL EASKS(SN,outs,'inside, outside?',12,' -1.0 -1.0',
*item EPHCF
'A number of empirical correlations and fixed values, '
'extracted from the following sources, are supported: '
' '
'Alamdari and Hammond (1983), `Improved Data '
'Correlations for Buoyancy-Driven Convection in Rooms`,'
'BSER&T, 4(3) 106-12. '
' '
'Khalifa and Marshall (1990), `Validation of Heat '
'Transfer Coefficients on Interior Building Surfaces '
'Using a Real-Sized Indoor Test Cell`, Int. J. Heat '
'and Mass Transfer, 33 (10) 2219-2236. '
' '
'Halcrow (1987), `Heat Transfer at Internal Building '
'Surfaces`, Report to ETSU, British Department of '
'Energy. '
' '
'CIBSE Guide (1988), 5th Edition, Table A3.4.'
' '
'CEN (1995), `Thermal Performance of Buildings, Room'
'Cooling Load Calculation, General Criteria for a'
'Simplified Calculation Method`, CEN/TC89/WG6 N.225 /'
'JWG-N79, Section 6.2.2. '
' '
'Each correlation is identified by an index.  Refer to'
'/usr/esru/src/esp-r/esrubld/convect2.F, subroutine'
'SELCOR1, where the index numbers held in the HTC file'
'(what you supply NOW) are then matched with ICOR'
'indicies in HTBOUY. A summary is listed below: '
'IHTC ICOR           ICOR          ICOR'
' 1   1 for vertical, 50 horiz up, 70 horiz down'
' 2   5 for vertical, 50 or 60 horiz up, 70 horiz down'
' 3   6 for vertical, 50 or 61 horiz up, 70 horiz down'
' 4   2 for vertical, 51 horiz up, 71 horiz down'
' 5   3 for vertical, 52 horiz up, 72 horiz down'
' 6   4 for vertical, 53 horiz up, 73 horiz down'
' 7   9 for vertical, 54 horiz up, 74 horiz down'
' '
'The ICOR indices are as follows: '
'1 Alamdari & Hammond for vertical surfaces '
'2 Halcrow time invariant low for vertical surfaces'
'3 Halcrow time invariant high for vertical surfaces '
'4 CIBSE for vertical surfaces '
'5 Khalifa & Marshall for non heated vertical surfaces'
'6 Khalifa & Marshall fan in room or floor heating'
'7 Khalifa & Marshall radiator in room not under window'
'8 Khalifa & Marshall fan heater in room wall oppos fan'
'9 CEN for vertical surface'
'10 Fisher & Pedersen for radial ceiling diffuser'
'11 Fisher for radial ceiling diffuser'
'12 Fisher for free horizontal jet'
'13 Fisher thesis mixed convection'
'14 Awbi and Hatton.'
'15 Molina & Maestre ventilated channels '
'16 Bar-Cohen ventilated channels '
'30 Khalifa & Marshall window over radiator'
'31 onwards - see source code.'
'-1 indicates that a correlation will be chosen based '
'on the simulation toggle. Correlation chosen for '
'surfaces exterior to the building will be ignored. '
*enditem
          CALL EASKI(IH,outs,' (-1.= simulation toggle = default) ? ',
*item EPHCF
*enditem
          CALL EASKI(IH,outs,' (-1.= simulation toggle = default) ? ',
*item EPHCF
'It is possible for the convection calculations to '
'`adapt` as the simulation progresses.  You must assign '
'a `control law` for each interior surface, which '
'defines how the calculations will adapt. The following '
'control laws are available: '
' '
'Law 1: two correlations specified for each surface; '
'one correlation used when plant is heating zone '
'(radiation or convection); other correlation used when '
'zone is unheated. Appropriate when plant system alters '
'convection regime within zone. '
' '
'Adaptive control is only applicable for interior '
'building surfaces. Control laws specified for exterior '
'surfaces will be ignored. As well, a control law '
'specified for an `outside` surface which faces the '
'air-point of an adjacent zone will be ignored: the law'
'specified in the neighbouring zone will take precedence.'
'Specify law `99` in these cases where adaptive control'
'is not applicable. '
' '
'A cancel leaves the current control law unchanged.'
*enditem
          CALL EASKI(Ilaw,outs,' (99=no control for this surface)',
*item EPHCF
'Correlation for ON = correlation to use when plant'
'is heating zone. '
' '
'Correlation for OFF = correlation to use when zone'
'is unheated. '
' '
'Each correlation is identified by an index.  Refer'
'to /usr/esru/src/esp-r/esrubld/convect.F,'
'subroutine HTBUOY, where the index numbers are'
'assigned to ICOR. '
' '
'-1 indicates that a correlation will be chosen'
'based on the simulation toggle. '
*enditem
  102       CALL EASKS(stuff,' correlation indices',
*item EPHCF
'It is possible for the convection calculations to '
'`adapt` as the simulation progresses.  You must assign '
'a `control law` for each interior surface, which '
'defines how the calculations will adapt. The following '
'control laws are available: '
' '
'Law 1: two correlations specified for each surface; '
'one correlation used when plant is heating zone '
'(radiation or convection); other correlation used when '
'zone is unheated. Appropriate when plant system alters '
'convection regime within zone. '
' '
'Adaptive control is only applicable for interior '
'building surfaces. Control laws specified for exterior '
'surfaces will be ignored. As well, a control law '
'specified for an `outside` surface which faces the '
'air-point of an adjacent zone will be ignored: the law'
'specified in the neighbouring zone will take precedence.'
'Specify law `99` in these cases where adaptive control'
'is not applicable. '
' '
'A cancel leaves the current control law unchanged.'
*enditem
          CALL EASKI(Ilaw,outs,' (99=no control for this surface)',
*item EPHCF
'Correlation for ON = correlation to use when plant '
'is heating zone. '
' '
'Correlation for OFF = correlation to use when zone '
'is unheated. '
' '
'Each correlation is identified by an index.  Refer '
'to /usr/esru/src/esp-r/esrubld/convect.F, '
'subroutine HTBUOY, where the index numbers are '
'assigned to ICOR. '
' '
'-1 indicates that a correlation will be chosen '
'based on the simulation toggle. '
*enditem
  103       CALL EASKS(stuff,' correlation for ON',
*item EPHCF
'Default values are: '
' heat flow upwards (floor/ceiling/sloped) 5.0'
' heat flow downwards (floor/ceiling/sloped) 0.7'
' heat flow at walls (inside/partition side/) 2.5'
' heat flow at otherside exterior 8.0 (4+4v) where'
'  v is assumed to be 1m/s'
*enditem
          CALL ASKOK('This is probably your initial description for',
*item EPHCF
'CEN standards impose specific hc values for surfaces'
'facing specific directions and if the surface is a '
'floor or ceiling the direction of heat flow is taken'
'into account. The hc at surfaces facing the outside '
'tends to be a standard value. '
' '
'In this facility you can over-ride the standard values'
'in case there are country-specific values. '
' '
'If you want to take the standard published values then'
'the task is only to identify which surface in the zone'
'is considered the typical floor and which surface is '
'a typical ceiling (CEN needs to know this). '
' '
'Default values are: '
' heat flow upwards (floor/ceiling/sloped) 5.0'
' heat flow downwards (floor/ceiling/sloped) 0.7'
' heat flow at walls (inside/partition side/) 2.5'
' heat flow at otherside exterior 8.0 (4+4v) where'
'  v is assumed to be 1m/s'
' '
'Sometimes CEN tests require you to lump radiant and'
'convective values at the outside (typically in con-'
'junction with zero emissivity at the outside) and '
'in this case you would need to edit the standard '
'value of 8.0. '
*enditem
            CALL ASKOK('The base and top surfaces of the room have',
*item EPHCF
*enditem
          CALL PHELPD('CEN conv coef data',20,'-',0,0,IER)
*item EPHCF
*enditem
          CALL EASKSUR(IZ,IS,'A','Select surface for base of room.',
*item EPHCF
*enditem
          CALL EASKSUR(IZ,IS,'A','Select surface for top of room.',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc for upwards heat flow at floors?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc for downwards heat flow at floors?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc at outside (exterior) floors?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc for upwards heat flow at ceilings?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc for downwards heat flow at ceilings?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc at outside (exterior) ceilings?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc for upwards heat flow at sloped?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc for downwards heat flow at sloped?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc at outside (exterior) sloped?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc at inside face of walls?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc at other (partition) face of walls?',
*item EPHCF
*enditem
          CALL EASKR(V1,' ','Hc at outside (exterior) walls?',
*subroutine HVACGIN
*item HVACGIN
'A hvac file holds the definition for an idealized      '
'building hvac system, which can supply the building    '
'with heating, cooling, and/or ventilation.             '
'The file is optional.                                  '
' '
'The browse option presents a list of files in the      '
'project `hvac` folder. If you do not select one then it'
'is assumed that you do not want an hvac system.        '
'If you cancel then nothing will be changed.            '
*enditem
          CALL EASKS2CMD(def_hvacfile,'HVAC file? (suggested name)',' ',
*item HVACGIN
'A hvac file holds the definition for an idealized      '
'building hvac system, which can supply the building    '
'with heating, cooling, and/or ventilation.             '
'The file is optional.                                  '
'The dereference option dereferences the hvac file from '
'your model but does not delete it. Your may re-        '
'establish this hvac by referencing the hvac file at a  '
'later time.                                            '
' '
'The browse option presents a list of files in the      '
'project `hvac` folder. If you do not select one then it'
'is assumed that you do not want an hvac system.       '
'If you cancel then nothing will be changed.           '
*enditem
          CALL EASKS2CMD(def_hvacfile,'HVAC file? (see help)',
*item HVACGIN
*enditem
            call EASKAB(' File not found.','Options:',
*item HVACGIN
*enditem
            CALL EASKR(site_altitude,
*item HVACGIN
'Please select whether there is an air conditioning'
'unit in addition to the furnace.'
*enditem
              call EASKABC('Furnace',' ','With A/C','Without A/C',
*item HVACGIN
 'Now entering options for associated a/c'
*enditem
              CALL PHELPD('Airconditioning',1,'-',0,0,ier)
*item HVACGIN
'Please select whether the ASHP is used for heating,'
 'cooling, or both. You will have the option to add'
 'a furnace backup in the next option'
*enditem
              call EASKABCD('Please select unit use',' ','Heating',
*item HVACGIN
 'You have reached the maximum number of hvac '
 'systems. Please delete an hvac system manually '
 'if you would like to add another.'
*enditem
                CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
*item HVACGIN
 'Please select whether there is a furnace backup'
 'for the air source heat pump.'
*enditem
                call EASKABC('Select backup',' ','Furnace backup',
*item HVACGIN
 'You have reached the maximum number of hvac '
 'systems. Please delete an hvac system manually '
 'if you would like to add another.'
*enditem
                CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
*item HVACGIN
 'If you did not choose heating & cooling'
 'when you initially defined this system'
 'Please exit this menu and choose either only'
 'heating or cooling, and add in the second'
 'system afterwards, otherwise another system '
 'may be overwritten.'
*enditem
                  CALL PHELPD('Possible Overwrite',2,'-',0,0,ier)
*item HVACGIN
*enditem
                  CALL EASKAB('', ' ','Continue (dangerous)', 'Go back',
*item HVACGIN
'Begin entering options for associated heating'
 'cycle'
*enditem
                  CALL PHELPD('Heating Cycle',2,'-',0,0,ier)
*item HVACGIN
'Now entering options for cooling cycle'
*enditem
                  CALL PHELPD('Cooling Cycle',1,'-',0,0,ier)
*item HVACGIN
'Please select whether the GSHP is used for heating,'
'cooling, or both. You will have the option to add a'
 'furnace backup in the next option'
*enditem
              call EASKABCD('Please select unit use',' ','Heating',
*item HVACGIN
 'You have reached the maximum number of hvac '
 'systems. Please delete an hvac system manually '
 'if you would like to add another.'
*enditem
                CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
*item HVACGIN
 'Please select whether there is a furnace backup'
 'for the ground-source heat pump.'
*enditem
                call EASKABC('Select backup',' ','Furnace backup',
*item HVACGIN
 'You have reached the maximum number of hvac '
 'systems. Please delete an hvac system manually '
 'if you would like to add another.'
*enditem
                CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
*item HVACGIN
 'If you did not choose heating & cooling'
 'when you initially defined this system'
 'Please exit this menu and choose either only'
 'heating or cooling, and add in the second'
 'system afterwards, otherwise another system '
 'may be overwritten.'
*enditem
                  CALL PHELPD('Possible Overwrite',2,'-',0,0,ier)
*item HVACGIN
*enditem
                  CALL EASKAB(' ', ' ','Continue (DANGEROUS! Eek!!!)',
*item HVACGIN
'Begin entering options for associated'
 'heating cycle'
*enditem
                CALL PHELPD('Heating Cycle',2,'-',0,0,ier)
*item HVACGIN
'Begin entering options for associated'
 'cooling cycle'
*enditem
                CALL PHELPD('Cooling Cycle',2,'-',0,0,ier)
*subroutine HVAC_type
*item HVAC_type
'Select the primary HVAC component - You will have the     '
'option to add additional information in the next section. '
'                                                          '
'Furnace:                                                  '
'You can choose with or without a/c in the next menu.      '
'                                                          '
'Baseboard Heating:                                        '
'                                                          '
'Air-source heat pump:                                     '
'You can choose with or without furnace backup             '
'in the next menu.                                         '
'                                                          '
'Ground-source heat pump:                                  '
'You can choose with or without furnace backup             '
'in the next menu.                                         '
'                                                          '
'                                                          '
'                                                          '
*enditem
      CALL EPICKS(hvac_selections,hvac_choice,
*subroutine FURNOPT
*item FURNOPT
*enditem
        CALL EASKI(ipriority(i),'Specify the system priority',
*item FURNOPT
 'Select furnace type.  Only certain fuels can be matched'
 'with each furnace type.  If a furnace has only one'
 'acceptable fuel type, it will be assigned automatically'
 'otherwise you will be presented with a list of fuel'
 'options to choose from.'
*enditem
      CALL EPICKS(ipck,chosen_sys,' ','Select a furnace type:',30,
*item FURNOPT
'Not all furnace types work with each fuel type.'
 'Electric'
 'Electric forced-air.'
 ' '
 'Natural gas or propane'
'Spark-iginition with and without damper,continuous'
'pilot, condensing furnace, and induced draft.'
 ' '
'Oil'
'Flame retention head, flue vent damper,condensing'
 'Mid efficiency, and oil furnace or boiler.'
 ' '
 'Wood'
 'Advanced air tight wood stove, catalytic'
 'converter, wood furnace.'
*enditem
          CALL EPICKS(ipck, chosen_fuel, ' ','Select fuel type:',30,
*item FURNOPT
 'Please reenter a valid fuel type'
*enditem
              CALL PHELPD('Incorrect combination', 1, '-',0,0, ier)
*item FURNOPT
 'Please reenter a valid fuel type'
*enditem
            CALL PHELPD('Incorrect combination', 1, '-',0,0, ier)
*item FURNOPT
*enditem
      CALL EASKI(num_sys_zones(i),' ',
*item FURNOPT
 'Enter the number of zones that the furnace system'
 'serves. Your model may be split into several zones,'
 'with different HVAC systems serving different zones.'
 'Number of zones chosen must be equal to'
 'or less than the number of zones in the model.'
 'Once number of zones being supplied has been'
 'picked, the fraction of supplied energy to each'
 'zone must be stated.'
*enditem
      CALL EPICKS(ival, sys_zone_number, ' ',
*item FURNOPT
 'Enter the fraction of the system capacity associated'
 'with this zone.  The sum of the fractions to all zones'
 'must be equal to 1'
*enditem
        CALL EASKR(sys_zone_cap_frac(i,k),
*item FURNOPT
 'Fractions must equal to one.  You will be redirected'
 'to re-enter zone number and their respective'
 'fractions.'
*enditem
          CALL PHELPD('Unequated fractions',3,'-',0,0,ier)
*item FURNOPT
*enditem
      CALL EASKR(ss_capacity(i),'Steady state capacity of the system',
*item FURNOPT
 'Enter the steady state efficiency of the system.'
*enditem
      CALL EASKR(ss_efficiency(i), ' ',
*item FURNOPT
 'Primary system should have same fan mode as backup'
 'system.'
*enditem
      CALL EASKABCD(' ','circulation fan mode', 'No Fan Associated',
*item FURNOPT
 'Enter the fan power of the system in Watts.'
 'If -1 is entered, the power is estimated internally.'
 'If the fan is in continuous mode, fan power need to'
 'be included as internal gain in the ESP-r opr file.'
*enditem
        CALL EASKR(fan_power(i), ' ', 'Fan power (W)', -1.,'F',1.E4,'F',
*item FURNOPT
 'If the fan is in continuous mode, fan power need to'
 'be included as internal gain in the ESP-r opr file.'
*enditem
        CALL PHELPD('Continuous Mode Operation of Fan',2,'-',0,0,ier)
*item FURNOPT
 'Enter the draft fan power of the system in Watts.'
 'If unknown, a selection of 75W is suggested.'
*enditem
        CALL EASKR(draft_fan_power(i), ' ', 'Draft fan power (W)', -1.,
*item FURNOPT
 'Enter the pilot power. If not known, 500W is suggested.'
*enditem
        CALL EASKR(pilot_power(i),' ','Pilot power (W)',0.1,'F',1000.,
*item FURNOPT
 'Specify whether there is a duct system associated'
 'with the HVAC system.  This is not used now but the'
 'value is needed.'
*enditem
      CALL EASKI(iduct_sys_flag(i),'Specify if there is a duct system',
*subroutine BASEBOARD_INPUTS
*item BASEBOARD_INPUTS
 'Select whether the baseboard system is a primary'
 'system, or whether it serves as a backup system'
 'in the zones.'
*enditem
C        CALL EASKI(ipriority(i),'Specify the system priority',
*item BASEBOARD_INPUTS
 'Enter the number of zones that the baseboard system'
 'serves. Your model may be split into several zones,'
 'with different HVAC systems serving different zones.'
*enditem
      CALL EASKI(num_sys_zones(i),' ',
*item BASEBOARD_INPUTS
 'Number of zones chosen must be equal to'
 'or less than the number of zones in the model.'
 'Once number of zones being supplied has been'
 'picked, the fraction of supplied energy to each'
 'zone must be stated.'
*enditem
      CALL EPICKS(ival, sys_zone_number, ' ',
*item BASEBOARD_INPUTS
 'Enter the fraction of the system capacity associated'
 'with this zone.  The sum of the fractions to all zones'
 'must be equal to 1'
*enditem
        CALL EASKR(sys_zone_cap_frac(i,k),
*item BASEBOARD_INPUTS
 'Fractions must equal to one.  You will be redirected'
 'to reenter zone number and their respective'
 'fractions.'
*enditem
          CALL PHELPD('Unequated fractions',3,'-',0,0,ier)
*item BASEBOARD_INPUTS
 'Enter the steady state capacity of the system in Watts.'
*enditem
      CALL EASKR(ss_capacity(i),'Steady state capacity of the system',
*item BASEBOARD_INPUTS
 'Enter the steady state efficiency of the system.'
*enditem
      CALL EASKR(ss_efficiency(i),
*item BASEBOARD_INPUTS
 'If the baseboard is a backup, this should be the same'
 'as that for the primary system except when the primary'
 'system has a fan and the baseboard has no fan.  In this'
 'case, select no fan for the backup baseboard here, and'
 'then choose auto or continuous mode for the primary'
 'system. '
*enditem
      CALL EASKABCD(' ','circulation fan mode', 'No Fan Associated',
*item BASEBOARD_INPUTS
 'Enter the fan power of the system in Watts.'
 'If -1 is entered, the power is estimated internally.'
 'If the fan is in continuous mode, fan power need to'
 'be included as internal gain in the ESP-r opr file.'
*enditem
        CALL EASKR(fan_power(i), ' ', 'Fan power (W)',-1.,'F',1.E4,'F',
*item BASEBOARD_INPUTS
 'If the fan is in continuous mode, fan power need to'
 'be included as internal gain in the ESP-r opr file.'
*enditem
        CALL PHELPD('Continuous Mode Operation of Fan',2,'-',0,0,ier)
*subroutine HPHOT
*item HPHOT
 'Select whether the heat pump system is a primary'
 'system, or whether it serves as a backup system'
 'in the zones.'
*enditem
        CALL EASKI(ipriority(i),'Specify the system priority',
*item HPHOT
'If the heating system is an air source heat pump, select'
 'whether it is typical, good, or poor.'
*enditem
        CALL EASKABC(' ', 'Enter the heat pump unit type',
*item HPHOT
 'Enter the number of zones that the system'
 'serves. Your model may be split into several zones,'
 'with different HVAC systems serving different zones.'
*enditem
      CALL EASKI(num_sys_zones(i),' ',
*item HPHOT
 'Number of zones chosen must be equal to'
 'or less than the number of zones in the model.'
 'Once number of zones being supplied has been'
 'picked, the fraction of supplied energy to each'
 'zone must be stated.'
*enditem
      CALL EPICKS(ival,sys_zone_number,'','Select zones being supplied',
*item HPHOT
 'Enter the fraction of the system capacity associated'
 'with this zone.  The sum of the fractions to all zones'
 'must be equal to 1'
*enditem
        CALL EASKR(sys_zone_cap_frac(i,k),
*item HPHOT
 'Fractions must equal to one.  You will be redirected'
 'to reenter zone number and their respective'
 'fractions.'
*enditem
          CALL PHELPD('Unequated fractions',3,'-',0,0,ier)
*item HPHOT
 'Enter the steady state capacity of the system in Watts.'
*enditem
      CALL EASKR(ss_capacity(i),'Steady state capacity of the system',
*item HPHOT
 'Enter the heat pump COP'
 'Max = 50'
*enditem
      CALL EASKR(ss_cop(i),' ','Heat pump COP', 0., 'F', 1000., 'F',
*item HPHOT
 'If flow rate set < 0, value is set internally'
 'This is the flow rate that occurs during the actual'
 'operation of the heat pump system.'
*enditem
      CALL EASKR(flow_rate(i),' ','Flow Rate',-1., 'F', 10.0, 'F', 0.,
*item HPHOT
 'If flow rate set < 0, value is set internally'
*enditem
      CALL EASKR(flow_rate_r(i),' ',
*item HPHOT
 'Primary system should have same fan mode as backup'
 'system.'
*enditem
      CALL EASKABCD(' ','circulation fan mode', 'No Fan Associated',
*item HPHOT
 'Currently not used but value needed.'
 '1 - Blow through'
 '2 - Draw Through'
*enditem
        CALL EASKI(ifan_position(i),
*item HPHOT
 'Enter the circulation fan power of the system in Watts.'
 'If -1 is entered, the power is estimated internally.'
 'If the fan is in continuous mode, fan power need to'
 'be included as internal gain in the ESP-r opr file.'
*enditem
        CALL EASKR(fan_power(i), ' ', 'Circulation Fan power (W)',
*item HPHOT
 'If the fan is in continuous mode, fan power need to'
 'be included as internal gain in the ESP-r opr file.'
*enditem
        CALL PHELPD('Continuous Mode Operation of Fan',2,'-',0,0,ier)
*item HPHOT
 'This is the fan for the outdoor evaporator of the heat'
 'pump. Not used for ashp in heating but value needed.'
*enditem
        CALL EASKR(outdoor_fan_power(i), ' ', 'Outdoor Fan power (W)',
*item HPHOT
 'This is the fan power associated with auto mode.'
 'Not used for heat pump in heating but value needed.'
*enditem
        CALL EASKR(fan_power_auto(i),' ',
*item HPHOT
 'Currently not used but value needed.'
 '1 - Blow through'
 '2 - Draw Through'
 'Position of circulation fan with respect to heat'
 'exchanger (heating or cooling) during rating test'
*enditem
        CALL EASKI(ifan_position_r(i),
*item HPHOT
 'This is the circulation fan power during the rating'
 'test. Not used for heat pump in heating but value'
 'needed. If flow rate set < 0, value is set internally'
*enditem
        CALL EASKR(fan_power_r(i),' ',
*item HPHOT
 'Temperature Control'
 '1 - Balanced Point'
 '2 - Restricted'
 '3 - Unrestricted'
*enditem
      CALL EASKI(itemp_control(i), 'Temperature Control',
*item HPHOT
 'Cutoff Temperature in C'
*enditem
      CALL EASKR(cutoff_temp(i),' ','Cutoff T in C',-1., 'F', 50.,'F',
*subroutine HPCOLD
*item HPCOLD
 'Select whether the heat pump system is a primary'
 'system, or whether it serves as a backup system'
 'in the zones.'
*enditem
        CALL EASKI(ipriority(i),'Specify the system priority',
*item HPCOLD
'If the heating system is an air source heat pump, select'
 'whether it is typical, good, or poor.'
*enditem
        CALL EASKABC(' ', 'Enter the heat pump unit type',
*item HPCOLD
 'Enter the number of zones that the system'
 'serves. Your model may be split into several zones,'
 'with different HVAC systems serving different zones.'
 'Enter the number of zones that the heat pump system'
 'serves. Your model may be split into several zones,'
 'with different HVAC systems serving different zones.'
*enditem
      CALL EASKI(num_sys_zones(i),' ',
*item HPCOLD
 'Number of zones chosen must be equal to'
 'or less than the number of zones in the model.'
 'Once number of zones being supplied has been'
 'picked, the fraction of supplied energy to each'
 'zone must be stated.'
*enditem
      CALL EPICKS(ival, sys_zone_number, ' ',
*item HPCOLD
 'Enter the fraction of the system capacity associated'
 'with this zone.  The sum of the fractions to all zones'
 'must be equal to 1'
*enditem
        CALL EASKR(sys_zone_cap_frac(i,k),
*item HPCOLD
 'Fractions must equal to one.  You will be redirected'
 'to reenter zone number and their respective'
 'fractions.'
*enditem
          CALL PHELPD('Unequated fractions',3,'-',0,0,ier)
*item HPCOLD
 'Enter the steady state capacity of the system in Watts.'
*enditem
      CALL EASKR(ss_capacity(i),'Steady state capacity of the system',
*item HPCOLD
 'Enter the heat pump COP'
 'Max = 50'
*enditem
      CALL EASKR(ss_cop(i),' ','Heat pump COP', 0., 'F', 1000., 'F',
*item HPCOLD
 'If flow rate set < 0, value is set internally'
 'This is the flow rate that occurs during the actual'
 'operation of the heat pump system.'
*enditem
      CALL EASKR(flow_rate(i),' ','Flow Rate',-1., 'F', 10.0, 'F', 0.,
*item HPCOLD
 'If flow rate set < 0, value is set internally'
*enditem
      CALL EASKR(flow_rate_r(i),' ',
*item HPCOLD
 'If the hp is a backup, this should be the same'
 'as that for the primary system except when the primary'
 'system has a fan and the hp has no fan.  In this'
 'case, select no fan for the backup hp here, and'
 'then choose auto or continuous mode for the primary'
 'system. '
*enditem
      CALL EASKABCD(' ','circulation fan mode', 'No Fan Associated',
*item HPCOLD
 'Currently not used but value needed.'
 '1 - Blow through'
 '2 - Draw Through'
*enditem
        CALL EASKI(ifan_position(i),
*item HPCOLD
 'Enter the circulation fan power of the system in Watts.'
 'If -1 is entered, the power is estimated internally.'
 'If the fan is in continuous mode, fan power need to'
 'be included as internal gain in the ESP-r opr file.'
*enditem
        CALL EASKR(fan_power(i), ' ', 'Circulation Fan power (W)',
*item HPCOLD
 'If the fan is in continuous mode, fan power need to'
 'be included as internal gain in the ESP-r opr file.'
*enditem
        CALL PHELPD('Continuous Mode Operation of Fan',2,'-',0,0,ier)
*item HPCOLD
 'This is the fan for the outdoor evaporator of the heat'
 'pump. Not used for ashp in heating but value needed.'
*enditem
        CALL EASKR(outdoor_fan_power(i), ' ', 'Outdoor Fan power (W)',
*item HPCOLD
 'This is the fan power associated with auto mode.'
 'Not used for heat pump in heating but value needed.'
*enditem
        CALL EASKR(fan_power_auto(i),' ',
*item HPCOLD
 'Currently not used but value needed.'
 '1 - Blow through'
 '2 - Draw Through'
 'Position of circulation fan with respect to heat'
 'exchanger (heating or cooling) during rating test'
*enditem
        CALL EASKI(ifan_position_r(i),
*item HPCOLD
 'This is the circulation fan power during the rating'
 'test. Not used for heat pump in heating but value'
 'needed. If flow rate set < 0, value is set internally'
*enditem
        CALL EASKR(fan_power_r(i),' ',
*item HPCOLD
 'This is capacity at ARI rating conditions (26.7 oC Tdb'
 'and 19.4 Twb oC).'
*enditem
      CALL EASKR(shrr(i),' ','Sensible Heat Ratio',
*item HPCOLD
*enditem
      CALL EASKI(icooling_type(i),'Cooling Type',
*item HPCOLD
 'This is the number of different day types for the'
 'description of the outdoor air schedule through the'
 'duct system'
*enditem
        CALL EASKI(num_out_air_day_types(i),' ',
*item HPCOLD
'This is the number of periods that make up this day'
'type.'
*enditem
          CALL EASKI(num_outside_air_day_periods(i,day),
*item HPCOLD
 'This is a number out of 8760. The hour indicates the'
 'hour of the year after which day type 1 is not valid'
 'anymore.'
*enditem
          CALL EASKI(iend_hour_out_air_daytype(i,day),
*item HPCOLD
'This is an hour number up until 24. This is the hour'
 'after which the given period for the given day type'
 'is not valid anymore.'
*enditem
            CALL EASKI(iend_hour_out_air_dayperiod(i,period_counter),
*item HPCOLD
 'Outdoor air flow rate for given period of given day'
 'type. In m3/s'
*enditem
            CALL EASKR(day_period_out_air_flow(i,period_counter),
*item HPCOLD
 '1. Indoor/Outdoor Temp integrated compressor control '
 'and option of outdoor dry-bulb temp limit control. This'
 'is a temperature based control with the compressor and'
 'the economizer running together to meet the load when'
 'the economizer can not meet the load by itself.'
 ' '
'2. Indoor/Outdoor Temp non-integrated compressor control'
 'and option outdoor dry-bulb temp limit control. This is'
 'a temperature based control with the compressor and the'
'economizer not allowed to run together to meet the load'
 'when the economizer can not meet the load by itself.'
 ' '
 '3. Enthalpy integrated compressor control and enthalpy'
 'limit control. This is an enthyalpy based control with'
 'the compressor and the economizer running together to'
'meet the load when the economizer can not meet the load'
 'by itself.'
 ' '
 '4. Enthalpy non-integrated compressor control and'
 'enthalpy limit control. This is an enthalpy based'
 'control with the compressor and the economizer not'
 'allowed to run together to meet the load when the'
 'economizer can not meet the load by itself.'
*enditem
        CALL EASKI(ieconomizer_control(i), 'Economizer Control Type ',
*item HPCOLD
 'Economizer minimum outdoor air flow. M3/S'
*enditem
        CALL EASKR(economizer_min_out_air_flow(i),
*item HPCOLD
 'Economizer indoor space set point. C.'
'This is the indoor temperature set point below which the'
 'economizer is tuned off.'
*enditem
        CALL EASKR(economizer_ind_temp_setpoint(i),
*item HPCOLD
 'Economizer outdoor temperature limit. C.'
 'This is the outdoor dry bulb temperature above which'
 'the economizer is turned off.'
*enditem
          CALL EASKR(economizer_out_temp_limitcon(i),
*item HPCOLD
 'Economizer outdoor enthalpy limit control. J/kg.'
 'This is the outdoor air enthalpy above which'
 'the economizer is turned off.'
*enditem
          CALL EASKR(economizer_out_enth_limitcon(i),
*item HPCOLD
'The control function type in the ESP-r ctl file that is'
'associated with the heat pump operation in cooling mode'
'must be listed here.'
'It can be found either in the ctl module of the ESP-r'
'interface, or in the .ctl file itself.'
*enditem
      CALL EASKAB(' ',
*subroutine HVAC_MAIN_SUMMARY
*item HVAC_MAIN_SUMMARY
'Displays the various systems present in the hvac file '
'and options for adding a new system (maximum of 5) or '
'saving the current file. To view a summary of specific'
'system characteristics within the hvac file, click on '
'the desired system.                                   '
' '
'Further options to edit each individual system are    '
'available in the next menu once the desired system is '
'chosen.                                               '
*enditem
          CALL ASKOK('You will lose new info. if file hasnt been saved',
*item HVAC_MAIN_SUMMARY
*enditem
          call PHELPD('Main HVAC Summary Menu:',9,'-',0,0,IER)
*item HVAC_MAIN_SUMMARY
 'You have reached the maximum number of hvac systems'
 'Please delete an hvac system manually if you would'
 'like to add another.'
*enditem
            CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
*subroutine HVAC_SYS_SUMMARY
*item HVAC_SYS_SUMMARY
'The system summary menu shows a summary of system   '
'characteristics of the system chosen from the main  '
'HVAC menu. This menu is not interactive, as many of '
'the system characteristics are interdependent. To   '
'change a system property, choose the edit option and'
'find the property in question. All other default    '
'suggestions will be the current system properties.  '
' '
'Note: Not all system properties are shown here, to  '
'ensure that the system will operate as expected     '
'choose edit and accept the default suggestions.     '
*enditem
          call PHELPD('System Summary Menu:',11,'-',0,0,IER)
*item HVAC_SYS_SUMMARY
*enditem
          call PHELPD('Currently not an option, but will be added',9,
*subroutine ADDSUR
*item ADDSUR
'Vertex is used in an existing edge. It'
'probably should also be removed but you'
'are asked to confirm this action (so that'
'the edge topology is consistent). '
*enditem
c              call askok(outs,
*item ADDSUR
*enditem
          CALL EASKGEOF('Select source zone to copy from:',
*item ADDSUR
*enditem
          CALL EASKS(T14,'Revised surface name','(duplicate found)',
*item ADDSUR
'Actions: '
' Shift surface along (+=outwards) surface normal.'
' Transform vertices by X,Y,Z metres.'
' Rotate surface about one of its vertices.'
' Invert ordering (to swop front & back faces).'
' Do several operations to the surface.'
' Continue with no action.'
*enditem
          CALL EASKATOG(' Actions to take on the new surface :',' ',
*item ADDSUR
'Distance along the normal (+=out) in metres.'
'Transform vertices by X,Y,Z metres.'
'Rotate surface about one of its vertices (index).'
'Rotation angle (degrees) '
' '
'If you leave transform values and/or rotation as'
'zero then that transform will have no effect. '
*enditem
 552        CALL EASKS(hold64,
*item ADDSUR
'Distance along the normal (+=out) in metres.'
*enditem
            CALL EASKR(vdis,' Distance along the normal (metres): ',
*item ADDSUR
*enditem
 152        CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
*item ADDSUR
'The rotation is applied around one vertex of'
'the surface. The index is to the 1st, 2nd, 3rd,'
'vertex in the surface. '
' '
'The rotation is applied around at and positive'
'is anticlockwise. '
' '
'A cancel leaves skips the rotation step. '
*enditem
            CALL EASKI(IRV,'Rotate about which vertex index: ',' ',
*item ADDSUR
*enditem
            CALL EASKR(ANGR,' ',' Rotation (deg + = anticlockwise) ?',
*item ADDSUR
'Vertex is close to an existing edge. It'
'probably should also be included in the'
'list of the adjacent surface (so that'
'the edge topology is consistent). '
*enditem
                        call askok(
*item ADDSUR
'You can swop the front:back faces of a surface. This'
'is necessary for partitions copied from another '
'zone or where you are creating back-to-back surfaces'
'to represent internal mass. '
*enditem
              CALL EASKAB(' Reverse the edge ordering of',
*item ADDSUR
'Often the transforms that are required for one'
'surface should also be applied to the other'
'surfaces that you copied.  '
' '
'Double check the zone after you have finished'
'copying the surfaces to ensure they are located'
'correctly and face the correct direction. '
*enditem
            CALL ASKOK(outs,'(see help)',DDOK,dok,7)
*item ADDSUR
'The number of vertices must be less than 24. '
'A surface is composed of a list of vertices. Type'
'this list in order (anticlockwise viewed from the'
'outside).  Note: the last line of the polygon is'
'from the last vertex to the start vertex. '
' '
'Or click mouse on existing vertices, ending with an '
'` e `. A match is assumed if within 5 pixels.'
'You will be given an oportunity to confirm the list. '
*enditem
          CALL EASKS(HOLD,
*item ADDSUR
*enditem
              CALL EASKS248(t248,' Associated vertices (type indices)?',
*item ADDSUR
*enditem
              CALL EASKS248(t248,' Associated vertices (type indices)?',
*item ADDSUR
*enditem
            CALL EASKS248(t248,'Associated vertices (type indices)?',
*item ADDSUR
*enditem
 52     CALL EASKS(T14,'Surface name','(unique word <=12char):',
*subroutine ADDMASS
*item ADDMASS
'If you accept the rectangle it will be converted into '
'a surface within the zone. If you elect to revise it'
'you will be presented with several options. '
*enditem
        CALL EASKABC('Options for this rectangle:',' ',
*subroutine ADDVERT
*item ADDVERT
'The vertex coordinates should be in metres. '
'It is not advisable for Z to be negative.'
*enditem
          CALL EASKS(HOLD,' Vertex  X  Y  Z (in metres): ',
*item ADDVERT
'Vertex is close to an existing edge. It'
'probably should also be included in the'
'list of the adjacent surface (so that'
'the edge topology is consistent). '
*enditem
                        call askok(
*item ADDVERT
'The vertex coordinates should be in metres. '
'Exact duplicate vertices should be avoided.'
'It is not advisable for Z to be negative.'
*enditem
        CALL EASKS(HOLD,outs,' X  Y  Z (in metres): ',
*item ADDVERT
'Vertex is close to an existing edge. It'
'probably should also be included in the'
'list of the adjacent surface (so that'
'the edge topology is consistent). '
*enditem
                      call askok(
*subroutine CKVERT
*subroutine INSREC
*item INSREC
'When adding a rectangular opening (e.g. a window or'
'door) to a surface you specify its position within'
'the parent surface. For a window, this is an X Y'
'distance from the lower left hand corner of the parent'
'surface (when looking at the outside face of the parent'
'surface) to the lower left hand corner of the opening.'
'The opening will be the specified width and height.'
' '
'More complex shaped openings might begin as a rectangle'
'and then be modified via a combination of adding more'
'vertices and using the surface list & edges menu to'
'link them into the child and parent surfaces.'
' '
'For a door the position is given as a single distance'
'from the left edge of the parent surface (when looking '
'at the outside face) and a width and height.'
' '
'The percentage of facade supports the insertion of'
'an opening (window) into a surface as a percentage of'
'the facade area.'
'Openings will be inserted at the centre of the'
'NOTE: The function can only be applied for rectangular'
'and vertical surfaces.'
*enditem
      CALL EASKABCD(' Insert rectangular surface:','(see help)',
*item INSREC
'The X offset is the distance from the lower left '
'corner of the parent surface (looking at the'
'outside face) to the left side of the new surface.'
'The X offset should be at least 20mm. '
' '
'The Z offset is the distance from the bottom  '
'edge of the parent surface (looking at the '
'outside face) to the bottom of the new surface.'
'The Z offset should be at least 20mm.'
' '
'The opening width and height are in metres. The'
'opening dimensions should be at least 100mm. '
*enditem
        CALL EASKS(hold,
*item INSREC
'The X offset is the distance from the left edge'
'of the parent surface (looking at the outside '
'face) to the left side of the new surface. It should'
'be at least 25mm (the edge generation will not be '
'correct with a zero offset)! '
' '
'The opening width and height are in metres. The'
'door dimensions should be at least 100mm.'
*enditem
        CALL EASKS(hold,
*item INSREC
'Define the surface area of the opening as a percentage'
'value of the parent surface (e.g. 40%).'
'The new surface will be located in the centre of the'
'parent surface. For best results choose a percentage'
'between 5 and 95.'
' '
'The logic assumes that the parent surface is rectangular'
'and may result in strange shapes if it is not. '
*enditem
        CALL EASKR(PERC,'Percentage of parent surface.',
*item INSREC
'If the location appears to be correct in the preview'
'you can accept it by saying yes. If you are in doubt'
'then say no for a chance to modify it. '
*enditem
        CALL ASKOK('Position OK?','(see help)',OK,dok,3)
*item INSREC
'Well named surfaces (e.g. call a door a door) '
'can help you understand a model better! '
*enditem
        CALL EASKS(T14,' ',' Inserted surface name (12 char max):',
*item INSREC
'The topology of the current surface indicates that '
'there is probably an existing `hole` in the surface'
'(typically used for glazing). '
' '
'Polygons in esp-r are defined as a continuous line,'
'so the addition of a second `hole` requires that the'
'bounding surface be revised to flow around the new'
'surface.  '
' '
'You will be asked which corner of the new surface'
'and the vertex in the bounding surface to link to.'
'If the first `hole` linked to the lower left corner'
'(as indicated by a diagonal line) the new surface '
'might link to the lower right corner of the '
'bounding surface.  This convention will hopefully '
'limit the chance of the edges crossing. '
' '
'The bounding surface must be wrapped around new one'
'so you will be asked for additional information.'
' '
'If you cancel when asked about connecting to a'
'vertex in the bounding surface, the first point'
'of the bounding surface will be assumed. Please'
'resolve this issue at a later point!'
*enditem
          CALL PHELPD('tmc insert warning',24,'-',0,0,IER)
*item INSREC
*enditem
          CALL EASKAB('There is already a `hole` in the surface - ',
*item INSREC
*enditem
 8795     CALL EASKI(IVH,
*item INSREC
'The vertex is close to another edge. To'
'maintain the edge topology you probably want'
'to update the edges of the adjacent surface.'
*enditem
                    call askok(
*item INSREC
'The modifications to the geometry of the zone, surface'
'attributes and topology which have been made need to'
'be checked closely.  For example the original surface'
'topology must have a link between the outer boundaries'
'and the `hole` so that it is a proper polygon. '
*enditem
        CALL PHELPD('surface details',5,'-',0,0,IER)
*subroutine ITINSRT
*item ITINSRT
'In order to find items in the TDF db a unique name'
'must be assigned to each entry. This name is a '
'string up to 12 characters long with no blanks.'
'The word UNKNOWN is not acceptable.'
*enditem
      CALL EASKS(TTAG,' ','Name for entry? ',
*subroutine MFPROB
*item MFPROB
'The flow network file holds the definition of network'
'flow regime for this project. The file is optional.'
'The dereference option clears the name of the network '
'file but does not alter information within the network'
'description. You can re-establish the network by '
'including the file name and then re-linking to thermal '
'zones. '
*enditem
      CALL EASKSCMD(LTMP,' Flow network file ?',
*item MFPROB
'A listing of the current flow network is available.'
*enditem
        CALL ASKOK('Display a synopsis of the flow network?',' ',
*item MFPROB
'The Project Manager could not find this file please'
'ensure that the filename and path are entered correctly.'
*enditem
        CALL EASKABCD(' File not found.','Options:',
*item MFPROB
'Begin the network description by specifying a'
'few nodes, components and connections.  Once'
'this is done save the network. You can '
'the go on to expand and update the network. '
' '
'The description of a flow network begins with the'
'description of flow nodes. A functioning network '
'must have at least three nodes. '
' '
'You can select the zones to be included in the network'
'the program will then automatically generate the '
'internal nodes associated with those zones.'
'  '
'You also automatically generate internal connections'
'between the nodes in your network, but define the '
'linking components (door, vents) first. '
' '
'  a) REMEMBER to include boundary nodes in your '
'  b) network. These are NOT auto generated at the '
'     moment. Also remember to connect them into your '
'     network!  '
*enditem
          CALL PHELPD('create net',22,'-',0,0,IER)
*item MFPROB
'A flow network can be all air, all water or '
'a mix (as long as the fluids do not mix) '
*enditem
          CALL EASKABC(' Is the new network:',' ',
*item MFPROB
'This option scans existing zone operations files'
'and creates (at a minimum) one node for each zone'
'with the same name as the zone.'
' '
'It creates fixed volume flow rate components'
'to represent simple infiltration patterns (it finds'
'the peak value of infiltration in each zone) and'
'names the component infil.xxxx where xxxx is the'
'flow rate in m3/s. '
' '
'It creates fixed volume flow rate components to'
'represent simple ventilation patterns (via the '
'peak ventilation rate) and names the components '
'vent.xxxx where xxxx is the flow rate in m3/s. '
' '
'It creates a source boundary wind pressure node'
'and a sink boundary wind pressure node as well'
'as a set of orifices from each zone to the sink'
'to allow exfiltration. Note that because the'
'flow into the zone via infiltration is represented'
'as a volume flow rate component the orientation '
'of the boundary node is a guess as wind pressures '
'are not taken into account in such components. '
' '
' '
'This is only a rough network, it will need to '
'be checked. '
' '
'Many zone operation files where ventilation and/or'
'infiltration rates change during the day will'
'require flow controls to be created. This is not'
'yet done automatically. '
' '
'Zone operation control of infiltration & ventilation'
'are not yet supported.  '
*enditem
          CALL PHELPD('create oper net',35,'-',0,0,IER)
*item MFPROB
*enditem
          CALL ASKOK('Do you want to auto-generate flow nodes?',
*item MFPROB
'Esp-r simulates one-dimensional fluid flow '
'in building and/or plant configurations. '
'This involves the calculation of fluid flow through'
'branches and nodes in a network which represents the'
'building and/or plant configuration. The nodes and '
'branches define boundary pressure points, internal '
'node characteristics and flow restrictions. '
' '
'Esp-r uses an iterative mass balance approach in '
'which nodal pressures are adjusted until the mass'
'residual of internal nodes satisfies some criterion.'
' '
'Fluid flow network description data summary '
'Fluid flow NODE data:'
'  Name (up to 12 characters with no blanks) '
'  Fluid (1=air, 2=water) '
'  Type  (0=internal; unknown pressure '
'         1=internal; known total pressure '
'         2=boundary; known total pressure  * '
'         3=boundary; wind induced pressure *) '
'  Reference height above datum (m)         * '
'  Fluid temperature (C)'
'     optionally equal to temperature of some node'
'     if type=2: optionally equal to outside temp.'
'        type=3: outside air dry bulb temperature'
'  Supplementary data'
'     if type=0: volume (m^3)'
'        type=1: pressure (Pa) & volume (m^3)'
'        type=2: pressure & node fluid temp flag'
'        type=3: wind pressure index & surf azimuth'
' * note that pressure of a type 3 node includes '
'   stack pressure evaluated with P=0 at height=0. '
' '
'Mass flow network description data summary  '
'Fluid flow COMPONENT data: '
'  Name (up to 12 characters with no blanks)'
'  Type (from current list)'
'  Number of supplementary data items '
'  Supplementary data: '
'     (number of data items depends on component type;'
'      first item always fluid type) '
' '
'Fluid flow LINKAGE data: '
'  Name of 1st node (+ve side of connection) '
'  Height of linkage point relative to 1st node (m) '
'  Name of 2nd node (-ve side of connection) '
'  Height of linkage point relative to 2nd node (m) '
'  Name of linking fluid flow component '
' '
'Local WIND speed REDUCTION factor : '
'  (= ratio of local wind speed at roof height'
'     and measured wind speed) '
' '
'Converting zone infiltration and ventilation schedules'
'into a (roughly) equivalent flow network is also an'
'option. This is useful when you started a model with'
'schedules and want to increase resolution/complexity'
'or better track flow rates. '
'The current network description will be lost if you '
'read in a new network file or create a new network.'
'If it is ok to loose the current data say yes. '
*enditem
        CALL ASKOK(' Reading or creating a new model file will',
*item MFPROB
*enditem
          CALL EASKS(LTMP,' Fluid flow network file ? ',
*item MFPROB
'You now have the option of automatically generating'
'flow nodes from the building description. Select'
'the zones you wish to include in the flow network and'
'a corresponding flow node will be generated with'
'the same name and with the correct volume.'
' '
'Note: a flow network should include all of the zones in'
'your model. Any information about infiltration and'
'ventilation in zone operation files will be ignored.'
*enditem
          CALL ASKOK('Do you want to auto-generate flow nodes?',
*item MFPROB
*enditem
        CALL ASKNOD(' Nodes','M',IS,IER)
*item MFPROB
*enditem
        CALL ASKCMP(' Components','M',IS,IER)
*item MFPROB
'You have the option of automatically generating'
'flow connections from your building model.'
'However, you should have up-to-date building '
'connections information and defined the linking '
'components (doors, vents, etc.) you will need before'
'commencing the automatic connection generation. '
' '
'If you have not done either then DO NOT select the '
'auto detection option.  '
*enditem
          CALL ASKOK('Auto-generate flow connections?','(see help)',
*item MFPROB
*enditem
        CALL ASKCON(' Connections','M',INODPS,INODNE,IS,IER)
*item MFPROB
'You can have nodes which are not linked to a '
'thermal zone, but if you do link nodes and zones '
'then their temperature will match the zone. '
*enditem
            CALL EASKABC(outs,' ','accept',
*item MFPROB
*enditem
              call ASKRNOD(' available nodes','-',IC,IER)
*item MFPROB
*enditem
            CALL EASKAB(outs,' ','accept','select a node',iacc,3)
*item MFPROB
*enditem
              call ASKRNOD(' available nodes','-',IC,IER)
*item MFPROB
*enditem
   80   CALL EASKS(ltmp,' Fluid flow network file ? ',
*item MFPROB
*enditem
        CALL PHELPD('network data summary',58,'-',0,0,IER)
*item MFPROB
'Recent changes to the network may be lost if you do'
'not save the changes. '
*enditem
        CALL ASKOK('Do you want to save any changes?',' ',OK,dok,2)
*item MFPROB
*enditem
   81     CALL EASKS(ltmp,' Fluid flow network file ? ',
*subroutine MFNDES
*item MFNDES
'Node names should be <= 12 characters and have '
'no blanks. Use logical names for clarity.'
*enditem
        CALL EASKS(T12,' ',' Node name (<= 12 characters): ',12,
*item MFNDES
'You cannot have duplicate node names in a flow '
'network. This is a chance to correct this. '
*enditem
            call askok('This a duplicate name...','Try again?',
*item MFNDES
'For a node related to a building select air as the '
'fluid type. Water nodes are only required in hydronic '
'plant systems. '
*enditem
            CALL EASKAB(outs,'(currently air)','air','water',IW,3)
*item MFNDES
*enditem
            CALL EASKAB(outs,'(currently water)','air','water',IW,3)
*item MFNDES
*enditem
            CALL EASKAB(outs,'(currently undefined)','air','water',IW,3)
*item MFNDES
'The node types are as follows: '
' '
'internal:unknown - a node describing a volume of air'
'inside the building (usually a zone) the pressure'
'and (usually) temperture of this node are unknown '
'and is solved at each time step. This is the most '
'commonly used fluid flow node.'
' '
'internal:known - another node describing a volume of'
'air  inside the building (usually a zone) the pressure'
'is fixed and specified by the user (e.g. the outlet of'
 'a fan could be specified as an internal:known node.)'
' '
'boundary:known - a node describing conditions at the '
'boundary of the flow network. The pressure of this node'
'(and sometimes temperature) is assigned by the user. '
' '
'internal:wind induced - another node describing the'
'conditions at the boundary of the network. In this case'
'the pressure of this node is generated by wind '
'impinging upon a surface. The pressure is a function of'
'wind velocity, wind direction and a pressure '
'coefficient, Cp, (assigned based on the orientation and'
'geometry of the surface): P=f(V,D,Cp).'
*enditem
        CALL EASKATOG(prt,' ',
*item MFNDES
'An internal node is usually associated with a thermal'
'zone (i.e. takes that zones temperature). If this is'
'is what you want say yes.'
' '
'Additional internal nodes can be used to implement'
'controls (e.g. an extra node to allow for components'
'in series). These additional nodes are not associated'
'with the thermal zone, but take their temperature from'
'a node that is associated with a thermal zone. If the'
'you want to create is an additional node then say no'
'and later you will be asked which flow node to take'
'its temperature from. '
*enditem
          CALL ASKOK('Is this node associated with a zone?',
*item MFNDES
*enditem
            CALL ASKZONE(IC,0,OUTS,'Select zone:','-','mfn locate',IER)
*item MFNDES
'To aid results recovery when the user is interested'
'in reporting in the context of ACH it is necessary to'
'associate a volume with internal nodes.  Ideally this '
'should match that of any linked thermal zone. '
*enditem
          CALL EASKR(ZVOL,' ',' Node volume (m^3) ? ',
*item MFNDES
'Specify the pressure of this node - usually gauge '
'pressure (Pa) '
*enditem
          CALL EASKR(VAL,' ',' Node pressure (Pa) ? ',
*item MFNDES
'To aid results recovery when the user is interested'
'in reporting in the context of ACH it is necessary to'
'associate a volume with internal nodes.  Ideally this '
'should match that of any linked thermal zone. '
*enditem
          CALL EASKR(ZVOL,' ',' Node volume (m^3) ? ',
*item MFNDES
*enditem
   60     CALL EASKR(VAL,' ',' Node pressure (Pa) ? ',
*item MFNDES
*enditem
          CALL EASKAB(' ','temperature flag indicating: ',
*item MFNDES
'You have selected a wind-induced pressure node: wind'
'impinging upon, or flowing over a surface creates '
'a pressure difference with the inside of the building,'
'driving infiltration and exfiltration through any '
'openings in that surface. '
' '
'You should select the zone and surface subjected to '
'this wind pressure.'
*enditem
          CALL PHELPD('wind-pressure surface',8,'-',0,0,IER)
*item MFNDES
*enditem
          CALL ASKZONE(IZ,0,OUTS,'Select zone','-','wpn locate',IER)
*item MFNDES
*enditem
          CALL EASKSUR(IZ,ISO,'-',OUTS,' ',IER)
*item MFNDES
'To enable the calculation of wind-induced surface'
'pressures (as required by ESP-r`s fluid flow'
'simulators), a database of angle dependent'
'pressure coefficients is provided.'
'The default ESP-r set contains wind pressure coeffi-'
'cients for surfaces in typical positions and within '
'several different exposure categories.'
'They can be used (with care) for low-rise buildings.'
'See the ESP manual for additional info.'
' '
'It is also possible to calculate pressure coeffi-'
'cients using CpCalc (see database maintenance).'
' '
'Select the pressure coefficient from this list, '
'which is most appropriate for the location of the '
'external node.'
' '
'Notes about pressure coefficients: '
'The first 27 data sets in the standard pressure coef'
'database are from the Air Infiltration & Ventilation'
'Centre Handbook called <Air Infiltration Calculation'
'Techniques - An Applications Guide>. The 27 data '
'sets are only applicable for buildings up to 3 '
'storeys andcome with the usual warnings about usage'
'of the data. '
' '
'Each data set is described with the following terms:'
' a) facade or roof at different roof pitch angles'
' b) the ratio of the building length to width and'
'    for a non square building there will be a long'
'    and a short wall to select'
' c) site shielding as follows:'
'   exposed - open countryside with no obstructions'
'   simi-exposed - rural with some obstructions'
'   sheltered - urban, surrounded on all sides by'
'     obstructions of similar size.'
*enditem
            CALL PHELPD('databases overview',36,'-',0,0,IER)
*item MFNDES
'Chance to correct an erronious selection. '
*enditem
          CALL ASKOK(t72,'as the pressure coefficient set?',OK,dok,1)
*item MFNDES
'This angle is used to derive the boundary pressure, '
'which is angular dependent, from the pressure coef db'
'and the current wind speed and direction.'
*enditem
          CALL EASKR(VAL,' ',
*item MFNDES
'Height is used to support buoyancy calculations.'
'and is the height above some arbitrary datum'
'usually ground level (height=0.0m).'
*enditem
   21   CALL EASKR(VALH,' ',' Node reference height above datum (m)?',
*item MFNDES
'The inital temperature is the temperature assumed for'
'the node at the beginning of the simulation. If the'
'flow network is part of a thermal model then this'
'temperature is updated with calculated values as the'
'simulation progresses. Otherwise this value is fixed'
'as the nodal temperature. '
' '
'If "Set to temperature of another node" is chosen then'
'this node will pick up the temperature of a designated'
*enditem
          CALL EASKAB('Node temperature: ','(see help)',
*item MFNDES
*enditem
            CALL EASKR(VAL,' ','Node temperature (C) ? ',
*item MFNDES
*enditem
            call ASKRNOD('  associated node','-',I,IER)
*item MFNDES
'The current node can either take the volume of the'
'associated node or have a nominal volume. It only'
'affects the reported air change rates. It should not'
'matter to the flow solver. '
*enditem
            call askok('Use volume of associated node?',' ',OK,dok,4)
*item MFNDES
'When deleting a node any connections associated with'
'that node must also be deleted.'
*enditem
        CALL ASKOK('Delete connections associated with this node?',
*item MFNDES
'Node names should be <= 12 characters and have '
'no blanks. Use logical names for clarity.'
*enditem
        CALL EASKS(T12,' ',' Node name (<= 12 characters): ',12,
*subroutine MFCDES
*item MFCDES
'Component names should be <= 12 characters and '
'have no blanks. Use logical names for clarity.'
*enditem
        CALL EASKS(T12,' ',' Component name (<= 12 characters):',
*item MFCDES
' This list includes all available mass flow components.'
*enditem
        CALL EPICKS(INPIC,IVALC,' Select a component: ',prompt,
*item MFCDES
'When deleting a component, any connections with that'
'component must also be deleted.'
*enditem
        CALL ASKOK('Delete connections associated with component?',
*item MFCDES
'Component names should be <= 12 characters and '
'have no blanks. Use logical names for clarity.'
*enditem
        CALL EASKS(T12,' ',' Component name (<= 6 characters):',
*subroutine MFLDES
*item MFLDES
*enditem
        call ASKRNOD(outs,'-',IS,IER)
*item MFLDES
*enditem
        call ASKRNOD(outs,'-',IE,IER)
*item MFLDES
'You still cannot connect a node to itself. To correct'
'this say yes. '
*enditem
          call askok('You cannot connect a node to itself...',
*item MFLDES
'The fluid at the start and end of this connection does'
'not match. Check the components as well. '
*enditem
          call askok('Fluid types to not match...','try again?',
*item MFLDES
'An existing connection between the two nodes has'
'been detected. If your network requires parallel'
'flow paths (such as an orifice and a crack) then'
'answer yes. '
*enditem
                CALL ASKOK
*item MFLDES
'Some types of components should not be used'
'in parallel between two nodes. This is a chance'
'to correct this. '
*enditem
                  CALL ASKOK(
*item MFLDES
*enditem
        CALL EASKR(VAL,outs,' ? ',
*item MFLDES
*enditem
        CALL EASKR(VAL,outs,' ? ',
*item MFLDES
*enditem
        call ASKRCMP(outs(1:lnblnk(outs)),'-',ICMP,IER)
*item MFLDES
'Some types of components should not be used'
'twice between two nodes. This is a chance'
'to correct this. '
*enditem
            CALL ASKOK(
*item MFLDES
*enditem
          call ASKRNOD('  supplementary node','-',ISN,IER)
*item MFLDES
*enditem
          call ASKRNOD(' 2nd supplementary node','-',ISN2,IER)
*subroutine MFWRED
*item MFWRED
'Edit / input local wind speed reduction factor'
' -------------------------------------------- '
'which is the ratio of local wind speed at roof'
'height (= reference level for wind pressure) '
'and coefficients the measured wind speed, as '
'read from the climate file.  '
*enditem
      CALL ASKOK(outs,' edit this (see help)?',OK,dok,6)
*item MFWRED
' Wind calculation models: '
' 0: input wind speed reduction factor directly'
'    or calculate it, on the basis of: '
' 1: powerlaw wind profile '
' 2: logarithmic wind profile '
' 3: LBL air infiltration model wind profile'
*enditem
      CALL EASKABCD('Which calculation model: ','(see help)',
*item MFWRED
'This is a value between 0.0-1.0'
*enditem
  88    CALL EASKR(WRED,' ',' Local wind speed reduction factor ? ',
*item MFWRED
'The roof height is a parameter required'
'for this calculation. Please select the '
'zone containing the roof.'
*enditem
      CALL PHELPD('wind model',6,'-',0,0,IER)
*item MFWRED
*enditem
      CALL ASKZONE(IZ,0,'Select the zone containing the roof.',
*item MFWRED
*enditem
      CALL EASKSUR(ISZONE,ISO,'-',OUTS,' ',IER)
*item MFWRED
'Height is in metres. '
*enditem
  89  CALL EASKR(ROOFH,' ',' Roof height ? ',
*item MFWRED
' '
' [powerlaw] wind profile : '
'      U/Um = K.z**a   {BS5925} '
' '
' eg.: terrain                       K    a '
'   open flat country              0.68  0.17'
'   country, scattered wind breaks 0.52  0.20'
'   urban                          0.35  0.25'
'   city                           0.21  0.33'
*enditem
        CALL EASKR(CF1,'(see help)',' K factor: ',
*item MFWRED
*enditem
        CALL EASKR(CF2,'(see help)',' a factor: ',
*item MFWRED
'Please confirm the derived value.'
*enditem
        CALL ASKOK(outs,' is this OK ?',OK,dok,1)
*item MFWRED
' '
' Logarithmic wind profile:'
'    U    {Us ln((z-d)/z0)}loc  '
'    -- = --------------------  '
'    Um   {Us ln((z-d)/z0)}met  '
' '
'    ------------------------------------  '
' eg.: terrain                       z0    d  '
'   open flat country               0.03  0.0'
'   country, scattered wind breaks  0.1   0.0'
'   rural                           0.5   0.7h'
'   urban                           1.0   0.8h'
'   city                           >2.0   0.8h'
*enditem
        CALL EASKR(CF1,'(see help)',' z0 for local site: ',
*item MFWRED
*enditem
        CALL EASKR(CF2,'(see help)',' d  for local site: ',
*item MFWRED
*enditem
        CALL EASKR(CF3,'(see help)',' z for meteo site [~ 10]   : ',
*item MFWRED
*enditem
        CALL EASKR(CF4,'(see help)',' z0 for meteo site [~ 0.03]: ',
*item MFWRED
*enditem
        CALL EASKR(CF5,'(see help)',' d for meteo site [~ 0.0]  : ',
*item MFWRED
'Please confirm the derived value.'
*enditem
        CALL ASKOK(outs,' is this OK ?',OK,dok,1)
*item MFWRED
' '
' wind profile - '
' LBL model  : U    {a (z/10)**b}loc  '
'              -- = ----------------  '
'              Um   {a (z/10)**b}met  '
' ----------------------------------  '
' eg.: terrain                     a     b  '
'      open flat country        1.00  0.15  '
'      rural                    0.85  0.20  '
'      urban                    0.67  0.25  '
'      city                     0.47  0.35  '
*enditem
        CALL PHELPD('Logarithmic wind profile.',11,'-',0,0,IER)
*item MFWRED
*enditem
        CALL EASKR(CF1,' ',' a for local site: ',
*item MFWRED
*enditem
        CALL EASKR(CF2,' ',' b  for local site: ',
*item MFWRED
*enditem
        CALL EASKR(CF3,' ',' z for meteo site [~ 10]   : ',
*item MFWRED
*enditem
        CALL EASKR(CF4,' ',' z0 for meteo site [~ 1.0]: ',
*item MFWRED
*enditem
        CALL EASKR(CF5,' ',' d for meteo site [~ 0.15]  : ',
*item MFWRED
'Please confirm the derived value.'
*enditem
        CALL ASKOK(outs,' is this OK ?',OK,dok,1)
*subroutine MFNAUTO
*item MFNAUTO
'Select the zones to be included in the flow network.'
*enditem
        CALL EPICKS(IZN,IVALS,' ',OUTS,12,NCOMP,zname,'zone list',IER,1)
*item MFNAUTO
*enditem
              CALL EASKABC(OUTS,'Make this a fluid flow link?',
*item MFNAUTO
*enditem
                CALL ASKRCMP('Select connecting component:','-',IS,IER)
*item MFNAUTO
'Select the zones to be included in the flow network.'
*enditem
        CALL EPICKS(IZN,IVALS,' ',OUTS,12,NCOMP,zname,'zone list',IER,1)
*subroutine MF010I
*item MF010I
'Type 10 is a power law volume flow resistance.'
'Power law relationships are correlations rather than'
'physical law.  It is a convenient characterization of'
'openings for building air infiltration calculations'
'and much data is available in this form.'
'See ESP-r manual section 3.6.'
' '
'  (m = rho . a . dP^b [m^3/s]) '
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water), '
'  (2) flow coef a, '
'  (3) flow exponent b.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,14)
*item MF010I
*enditem
  43  CALL EASKS(hold,'Coef `a` and exponent `b` in Q=a.dP^b(m^3/s) ?',
*subroutine MF011I
*item MF011I
'Type 11 approximates self regulating devices which have'
'a rated flow rate of 15m3/h at 20 Pa. or 30m3/h.'
' '
'These devices are designed to maintain flow close to these'
'rates over a range of pressure differences. The component'
'uses a polynomial to predict flows at other pressures. '
' '
'  (Q = Nb devides*(a6*DP**6+a5*DP**5++...a1*DP) '
' '
'Supplemental data: '
 ' '
'  (2) air flow at 20 Pa, 15 or 30 m3/h'
'  (3) number of devices'
' '
'Based on work by Armando Pinto. See mfmach code MF011C'
'for details of the method.'
*enditem
      CALL PHELPD('comp 11',17,'-',0,0,IER)
*item MF011I
*enditem
  43  CALL EASKS(hold,
*subroutine MF015I
*item MF015I
'Type 15 is a power law mass flow resistance component.'
'Power law relationships are correlations rather than'
'physical law. See discussion of type 10 as well as'
'ESP-r manual section 3.6.'
' '
'(m = a . dP^b [kg/s]) '
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water),'
'  (2) flow coef a,'
'  (3) flow exponent b.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,12)
*item MF015I
*enditem
  43  CALL EASKS(hold,'Coef `a` and exponent `b` in m=a.dP^b [kg/s]?',
*subroutine MF017I
*item MF017I
'Type 17 is a power law mass flow component.'
'Power law relationships are correlations rather than'
'physical law. See discussion of type 10 as well as'
'ESP-r manual section 3.6.'
'  '
'(m = a.rho^1/2.dP^b [kg/s]) '
'  '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water),'
'  (2) flow coef a, '
'  (3) flow exponent b.'
'  '
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,13)
*item MF017I
*enditem
  43  CALL EASKS(hold,
*subroutine MF020I
*item MF020I
'Type 20 is a quadratic law volume flow component.'
'Quadratic law relationships are included because some'
'sources regard this is a superior form for building'
'fabric infiltration as it allows consideration of both'
'the laminar and turbulent flow. Type 20 is more com-'
'monly encountered in the literature than type 25.'
' '
'(dP = a.m/ro+b.(m/ro)^2) '
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water),'
'  (2) flow coef a (Pa.s/m^3),'
'  (3) flow exponent b (Pa.(s/m^3)^2).'
' '
'See ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,16)
*item MF020I
*enditem
  43  CALL EASKS(hold,
*subroutine MF025I
*item MF025I
'Type 25 is a quadratic law mass flow component which'
'is similar to type 20.'
' '
'dP = a.M + b.M^2 (Pa/(kg/s)^2)  '
' '
'Supplemental data: '
' (1) fluid type (1=air, 2=water),'
' (2) flow coef a (Pa.s/kg),'
' (3) flow exponent b (Pa.(s/kg)^2).'
' '
'See ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,12)
*item MF025I
*enditem
  43  CALL EASKS(hold,
*subroutine MF030I
*item MF030I
'Type 30 is a constant flow rate component which is'
'included as a convenient constant flow inducer'
'which can be combined with other components.'
' (m = rho . a)'
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water), '
'  (2) flow rate in m^3/s.'
' '
'The flow rate can be derived from litres/s/person, '
'or m^3/hr or air changes per hour based on the volume '
'associated with a particular node. '
' '
'The flow rate can be modified by the use of a range'
'based controller (see control definition facility) or'
'by application of an on-off controller. '
'For other details see ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,18)
*item MF030I
*enditem
      CALL EASKABCD(prompt,' ','direct edit','l/s/person',
*item MF030I
*enditem
   20   CALL EASKR(VAL,prompt,'(help for synopsis)',0.,'W',0.,'-',1.,
*item MF030I
*enditem
  43    CALL EASKS(hold,' litres/sec/person and number of people?',
*item MF030I
*enditem
        call askok(prompt,' Is this ok? ',OK,dok,18)
*item MF030I
*enditem
   21   CALL EASKR(VAL2,prompt,'(help for synopsis)',0.,'W',0.,'-',10.,
*item MF030I
*enditem
        call askok(prompt,' Is this ok? ',OK,dok,18)
*item MF030I
*enditem
        call ASKRNOD(' volume from which node','-',IV,IER)
*item MF030I
*enditem
   22   CALL EASKR(VAL2,prompt,'(help for synopsis)',0.,'W',0.,'-',
*item MF030I
*enditem
        call askok(prompt,' Is this ok? ',OK,dok,18)
*subroutine MF035I
*item MF035I
'Type 35 is a constant flow rate component which is'
'included as a convenient constant flow inducer which'
'can be combined with other components.'
'  (m = a)'
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water), '
'  (2) flow rate in kg/s.'
' '
'The flow rate can be modified by the use of a range'
'based controller (see control definition facility) or'
'by application of an on-off controller. '
'For other details see ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,14)
*item MF035I
*enditem
   20 CALL EASKR(VAL,prompt,'(help for synopsis)',0.,'W',0.,'-',1.,
*subroutine MF040I
*item MF040I
'Type 40 is a common orifice flow component which is a'
'basic expression for turbulent flow through relatively'
'large openings such as a vent in the case of buildings'
'or a pipe restriction in a hydronic network.'
' '
'Supplemental data: '
' (1) fluid type (1=air, 2=water), '
' (2) opening area (m^2), '
' (3) discharge factor (-).'
' '
'The opening area can be modified by the use of a range'
'based controller (see control definition facility) or'
'by application of an on-off controller. '
'For other details see ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,15)
*item MF040I
*enditem
  43  CALL EASKS(hold,' Opening area (m^2) and discharge factor (-)?',
*subroutine MF050I
*item MF050I
'Type 50 is a laminar pipe flow component which is a'
'basic expression for laminar flow through relatively'
'long flow paths.  A warning is given if the '
'Reynolds-number exceeds 2320 during simulation.'
'  '
' (m = rho (dP/(8 mu L)) pi R**4) '
'  '
'Supplemental data: '
' (1) fluid type (1=air, 2=water), , '
' (2) path length (m),'
' (3) opening radius (m).'
' '
'See ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,14)
*item MF050I
*enditem
  43  CALL EASKS(hold,' Length of flow path (m) & opening radius (m)?',
*subroutine MF110I
*item MF110I
'Type 110 is an air flow opening (type 40) with the'
'fluid type set to air and a discharge factor of 0.65.'
' '
'Supplemental data: opening area(m)'
' (1) fluid type (air only)'
' (2) opening area (m).'
' '
'The opening area can be modified by the use of a range'
'based controller (see control definition facility) or'
'by application of an on-off controller. '
'For other details see ESP-r manual section 3.6.'
*enditem
   20 CALL EASKR(VAL,'(help for synopsis)',prompt,0.,'F',0.,'-',1.,
*subroutine MF120I
*item MF120I
'Type 120 is an air flow crack component.'
' '
'Supplemental data:'
' (1) fluid type (air only)'
' (2) crack width (mm),'
' (3) crack length(m)'
' '
'See ESP-r manual section 3.6.'
*enditem
  43  CALL EASKS(hold,' Crack width (mm) and length (m) ?',
*subroutine MF130I
*item MF130I
'Type 130 is an air flow door component which is '
'applicable to vertical opening where bi-directional'
'flow may exist. Based on an expression by Cockroft.'
' '
'Supplemental data:'
' (1) fluid type (air only)'
' (2) door width (m)'
' (3) door height (m), '
' (4) vertical distance (m) between base of door and'
'     adjacent air nodes (nodes at each side should be '
'     at the sameheight). If this component type is used'
'     in several locations with different vertical heights'
'     you should create multiple door components.'
' (5) discharge factor (-) typically 0.6 but can be smaller'
'     to represent a door that is partially open.'
' '
'See ESP-r manual section 3.6.'
*enditem
  43  CALL EASKS(hold,
*subroutine MF210I
*item MF210I
'Type 210 is a general flow conduit component which'
'takes into account frictional and dynamic losses'
'within a duct or pipe assuming a uniform x-section,'
'no pressure gain from a pump or fan and steady-state'
'conditions.  This type is widely supported in the'
'literature and can be combined with component types'
'220, 230, 240 & 250 to form complex networks.'
' '
'Supplemental data:'
' fluid type (1=air or 2=water),'
' conduit hydraulic diam (m) which is:'
'   (4*x-section area)/perimeter of conduit'
' x-section area (m^2)'
' conduit length (m), absolute wall roughness(mm),'
' sum of local dynamic loss factors (suggest looking'
'   this up in a handbook)'
'See ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,17)
*item MF210I
*enditem
  43  CALL EASKS(hold,
*item MF210I
*enditem
   60 CALL EASKR(VAL,' Sum of local dynamic loss factors',
*subroutine MF211I
*item MF211I
 'Type 211 represents roof top ventilation cowl which is'
 'based on experimental data and which takes into account'
 'head losses and wind effects. '
 ' '
 'The method is based on the work of Armando Pinto and '
 'implements experiments reported in: '
 ' Gonzalez M.A. On the aerodynamics of natural ventilators'
 ' London. Pergamon Press, 1984, Building and environment.'
' Vol 19 No 3.'
' '
'Please read the paper if you want to understand the types'
'of cowls that this component can represent. '
'The paper mentions 7 different cowels models and Table 1'
'tgives several of the coefficients:'
' Model 1 coef B between 0.72 and 1.28 by wind direction'
'         coef n between 0.51 and 0.26 by wind direction'
' Model 2 coef B between 0.37 and 0.80 by wind direction'
'         coef n between 0.31 and 0.40 bt wind direction'
' Model 3 coef B 0.25  coef n 0.16'
' Model 4 coef B 0.12  coef n 0.17'
' Model 5 coef B 0.37  coef n 0.10'
' Model 6 coef B 0.21  coef n 0.19'
' Model 7 coef B 0.28  coef n 0.45'
' '
' Supplemental data: '
'  - fluid type (1=air)'
'  - Cowl hydraulic diameter (m)'
'  - local dynamic loss factors (-)'
'  - coefficient of cowl B (see above)'
'  - coefficient of cowl n (see above)'
'   Wind effect '
'     0 no wind effect '
'     1 include wind effect '
*enditem
      CALL PHELPD('comp 211',30,'-',0,0,IER)
*item MF211I
*enditem
  44  CALL EASKS(hold,
*item MF211I
*enditem
   20 CALL EASKR(VAL,' ',prompt,0.,'W',0.,'-',1.,'flow in comp',IER,14)
*subroutine MF220I
*item MF220I
'Details of this flow component are available if you'
'answer yes. '
*enditem
      CALL ASKOK(outs,'Synopsis of this component type?',OK,dok,2)
*item MF220I
'Type 220 is a variant of a general flow conduit which'
'ends in a converging 3-leg junction.  It represents'
'only half of a junction and the branch must be rep-'
'resented by a similar component.  It is well supported'
'in the literature.  Supplemental data:'
' '
' fluid type, conduit hydraulic diam, x-section area'
' conduit length, wall roughness, sum of local dynamic'
' loss factors, x-sectional area of common junction '
' section, Ccp coefficients a0 - a5 in:'
' '
'    Ccp = a0+a1.X+a2.X.X+a3.Y+a4.Y.Y+a5.X.Y  '
'where X is the ratio between the volume flow rate in'
'this conduit and the common section, respectively and'
'Y is the ratio between the volume flow rate in the '
'other entrance of the junction and the common. '
' '
'See ESP-r manual section 3.6.'
*enditem
      if(OK) CALL PHELPD('comp 220',19,'-',0,0,IER)
*item MF220I
*enditem
   20 CALL EASKR(VAL,
*item MF220I
*enditem
        CALL EASKR(VAL,outs,' ? ',0.,'-',0.,'-',0.,'Cf a0',IER,19)
*subroutine MF230I
*item MF230I
'Details of this flow component are available if you'
'answer yes. '
*enditem
      CALL ASKOK(outs,'Synopsis of this component type?',OK,dok,2)
*item MF230I
'Type 230 is a variant of a general flow conduit which'
'ends in a diverging 3-leg junction. '
' '
'Supplemental data:'
' fluid type (1=air or 2=water),'
' conduit hydraulic diam (m) which is:'
'   (4*x-section area)/perimeter of conduit'
' x-section area (m^2)'
' conduit length (m), absolute wall roughness(mm), '
' sum of local dynamic loss factors, '
' x-sectional area of common junction section,'
' '
' Ccp coefficients a0 - a5 in:'
'    Ccp = a0+a1.X+a2.X.X+a3.Y+a4.Y.Y+a5.X.Y  '
'where X is the ratio between the volume flow rate in'
'this conduit and the common section, respectively and'
'Y is the ratio between the volume flow rate in the '
'other entrance of the junction and the common. '
' '
'See discussion of type 210 & 220 as well as'
'the ESP-r manual section 3.6.'
*enditem
      if(OK) CALL PHELPD('comp 230',22,'-',0,0,IER)
*item MF230I
*enditem
   20 CALL EASKR(VAL,
*item MF230I
*enditem
        CALL EASKR(VAL,outs,' ? ',
*subroutine MF240I
*item MF240I
'Details of this flow component are available if you'
'answer yes. '
*enditem
      CALL ASKOK(outs,'Synopsis of this component type?',OK,dok,2)
*item MF240I
'Type 240 is a variant of a general flow conduit which'
'ends in a converging 4-leg junction. '
' '
'Supplemental data:'
' fluid type (1=air or 2=water),'
' conduit hydraulic diam (m) which is:'
'   (4*x-section area)/perimeter of conduit'
' x-section area (m^2)'
' conduit length (m), absolute wall roughness(mm),'
' sum of local dynamic loss factors (suggest looking'
'   this up in a handbook)'
' x-sectional area of common junction section'
' '
' Ccp coefficients a0 - a9 in:'
'    Ccp = a0+a1.X+a2.X.X+a3.Y+a4.Y.Y+a5.X.Y  '
'            +a6.Z+a7.Z.Z+a8.X.Z+a9.Y.Z'
'where X is the ratio between the volume flow rate in'
'this conduit and the common section, respectively and'
'Y & Z are the ratios between the volume flow rate in '
'the other entrances of the junction and the common. '
' '
'See discussion of type 210 & 220 as well as Hensen'
'the ESP-r manual section 3.6.'
*enditem
      if(OK) CALL PHELPD('comp 240',24,'-',0,0,IER)
*item MF240I
*enditem
   20 CALL EASKR(VAL,
*item MF240I
*enditem
        CALL EASKR(VAL,outs,' ? ',
*subroutine MF250I
*item MF250I
'Details of this flow component are available if you'
'answer yes. '
*enditem
      CALL ASKOK(outs,'Synopsis of this component type?',OK,dok,2)
*item MF250I
'Type 250 is a variant of a general flow conduit which'
'starts with a diverging 4-leg junction. '
' '
'Supplemental data:'
' fluid type (1=air or 2=water),'
' conduit hydraulic diam (m) which is:'
'   (4*x-section area)/perimeter of conduit'
' x-section area (m^2)'
' conduit length (m), absolute wall roughness(mm),'
' sum of local dynamic loss factors (suggest looking'
'   this up in a handbook)'
' x-sectional area of common junction section,'
' '
'  Ccp coefficients a0 - a9 in:'
'    Ccp = a0+a1.X+a2.X.X+a3.Y+a4.Y.Y+a5.X.Y  '
'            +a6.Z+a7.Z.Z+a8.X.Z+a9.Y.Z'
'where X is the ratio between the volume flow rate in'
'this conduit and the common section, respectively and'
'Y & Z are the ratios between the volume flow rate in '
'the other entrances of the junction and the common. '
' '
'See discussion of type 210 & 220 as well as'
'the ESP-r manual section 3.6.'
*enditem
      if(OK) CALL PHELPD('comp 250',26,'-',0,0,IER)
*item MF250I
*enditem
   20 CALL EASKR(VAL,
*item MF250I
*enditem
        CALL EASKR(VAL,outs,' ? ',
*subroutine MF310I
*item MF310I
'Type 310 is a general flow inducer which approximates '
'a pump or fan by a performance curve (cubic polynomial)'
'which relates the total pressure rise to the volume '
'flow rate for a given fan or pump speed and fluid'
'density.'
' '
' (dP = SUM (i=0 to 3) ai.(m/ro)^i; which is '
'               only valid for q,min <= m/ro <= q,max )'
'Supplemental data:'
' (1) fluid type (1=air, 2=water) '
' (2,3) volume flow rate lower and upper limits (m^3/s),'
' (4-7) flow coef a0 (Pa),     a1 (Pa/(m^3/s)),'
'           a2 (Pa.(m^3/s)^2), a3 (Pa.(m^3/s)^3)'
' four or more coordinates read off a performance curve'
' in which case flow coef are not required'
' '
'See ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,20)
*item MF310I
*enditem
   20 CALL EASKR(VAL,
*item MF310I
*enditem
   30 CALL EASKR(VAL,' ',
*item MF310I
*enditem
      CALL EASKAB(' ',prompt,'coefficients','perf curve',IIW,20)
*item MF310I
*enditem
  43    CALL EASKS(hold,
*item MF310I
' Coordinates entered should be over the '
' entire range of the performance curve. '
' (Not just the preferred operating range)'
' Ideally values for near max and near min'
' flow should also be used.'
' '
'Cancel option not yet implemented. '
*enditem
        CALL PHELPD('curve fit',5,'-',0,0,IER)
*item MF310I
*enditem
 88     CALL EASKI(IVAL,
*item MF310I
*enditem
 63       CALL EASKS(HOLD,
*item MF310I
'Chance to correct the data if incorrect. '
*enditem
        CALL ASKOK(' ',' Accept values?  ',OK,dok,1)
*item MF310I
'Chance to adjust the values you edited.'
*enditem
        CALL ASKOK(' ',' Accept this?  ',OK,dok,1)
*subroutine MF410I
*item MF410I
'Type 410 is a general flow corrector or variable '
'flow resistance such as a valve or damper. Actuation'
'of this component requires a configuration control '
'file otherwise it is assumed the valve (or damper) is'
'open.'
' '
'Supplemental data: '
' (1) fluid type (1=air, 2=water),   choice of'
' (2) fluid density rho 0 (kg/m^3),'
' (3) presure drop dP0 (Pa),'
' (4) linear (1) or logarithmic (2)position dependency,'
' (5) volume flow when fully open  k,vs (m^3/s), '
' (6) theoretical flow when closed, k,v0 (%)'
' (7) lower validity limit k,vr (%).'
' '
'There is a lengthy discussion of this in the '
'ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,18)
*item MF410I
*enditem
   20 CALL EASKR(VAL,
*item MF410I
*enditem
   30 CALL EASKR(VAL,
*item MF410I
*enditem
      CALL EASKAB(' ',' Characteristic index: ',
*item MF410I
*enditem
   50 CALL EASKR(VAL,' ',
*item MF410I
*enditem
   60 CALL EASKR(VAL,' ',
*item MF410I
*enditem
   70 CALL EASKR(VAL,' ',
*subroutine MF420I
*item MF420I
'Type 420 is a flow corrector or variable flow resis-'
'tance such as a valve or damper which is represented'
'as a polynomial. This approach is as if it were a'
'conduit with local dynamic losses dependent on the '
'correctors relative position. For actuation in'
'this component the configuration control file must be'
'used together otherwise the valve (or damper) is kept'
'open during the whole simulation.'
' '
'Supplemental data: '
' (1) fluid type (air|water), , polynomial '
' (2) cross-sectional area (m^2)'
' (3-6) polynomial coefficients a0 - a3 (-) in:'
' '
'    C = a0+a1.(H/H100)+a2.(H/H100)^2+a3.(H/H100)^3'
' where H/H100 is the relative valve/damper position'
' (ie. valve stem displacement of damper blade angle),'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,18)
*item MF420I
*enditem
   20 CALL EASKR(VAL,
*item MF420I
*enditem
  43  CALL EASKS(hold,
*subroutine MF460I
*item MF460I
'Type 460 is a fixed flow rate device, which unlike'
'types 30 or 35  responds to a wide range of signals'
'which are defined by the user.  A typical use of this'
'component is an an early design stage substitute for'
'a fan or pump in order to characterise flow rates'
'before specifying a specific device. For actuation in'
'this component the configuration control file must be'
'used together otherwise the flow rate will be equal'
'to the value above setpoint.'
' '
'Supplemental data: '
' (1) fluid type (air|water),'
' (2) flow (m^3/s) below setpoint, '
' (3) flow (m^3/s) above setpoint.'
' '
'See ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,16)
*item MF460I
*enditem
  43  CALL EASKS(hold,' Flows when S < Ssp and S > Ssp (m3/s) ?',
*subroutine MF500I
*item MF500I
'Type 500 is a multiple configuration flow component.'
'It assumes the properties of three PREVIOUSLY DEFINED'
'components depending upon control action at simulation'
'run time. For example it can assume the action of a '
'window opening at control action 1, a smaller window'
'opening at control action 2 and a crack at control '
'action 3. Thereby removing the need for three different'
'connections and corresponding control loops'
' '
'Supplemental data:  '
' (1) fluid type (air|water),'
' (2) component number one'
' (3) control action setting for component one'
' (4) component number two'
' (5) control action setting for component two'
' (6) component number three'
' Component one is active above control action 1'
' Component two is active between control action 1 and 2'
' Component three is active below control action 2'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,21)
*item MF500I
*enditem
        call ASKRCMP('select component','-',ICOMPN,IER)
*item MF500I
'Type 500 is a multiple configuration flow component.'
'It assumes the properties of three PREVIOUSLY DEFINED'
'components depending upon control action at simulation'
'run time. For example it can assume the action of a '
*enditem
          CALL EASKR(VAL,'Enter control action for this component',
*subroutine MMGFUN
*item MMGFUN
'Assessment period choices allow you to do quick'
'checks of your model for the month of January or'
'April or July. And eventually you MUST do the'
'annual assessment REQUIRED by the code.'
*enditem
      CALL EASKABCD(' ','Initial assessment period (see help)',
*item MMGFUN
'This facility takes information provided in the model'
'context menu NCM descriptions and will use it to'
'create several alternative models and optionally run'
'a series of assessments to confirm the performance of the'
'design.'
' '
'If the model is incomplete you may need to supply'
'additional information or return to the model context'
'or zone geometry menus. '
' '
'1. Generate models (with standard constructions'
'   and glazing areas) and usage patterns, run '
'   assessments and generate EPC.'
' '
'2. If you did not have time to run the assessments in'
'   step one you can use the model variants and run the'
'   assessments for the energy performance certificate'
'   EPC and/or generate BRUKL specific information.'
' '
'3. Scan existing results from assessments and re-generate'
'   the NCM file (for testing purposes).'
' '
'If you plan on using existing models and or existing'
'assessments check that you have loaded your ORIGINAL'
'model prior to asking for assessments or reports.'
' '
'If you are running your assessments on a Linux or OSX or'
'under the Cygwin emulation environment you will have to'
'transfer the BRUKL.inp and EPCGen.inp files to a Windows'
'computer to complete the final step. '
' '
'Remember to make backup copies of your models!'
*enditem
      CALL EASKABCD('Options (see help): ',' ',
*item MMGFUN
'You are using new UK NCM stripped, notional,'
'reference and typical models. In order to generate'
'EPC and BRUKL (UK building regulations) specific'
'information annual simulations for all these models'
'need to run and may take some time. You may choose not'
'to run simulations at this time and run these at a'
'later time (via the 2nd option).'
*enditem
        CALL ASKOK(
*item MMGFUN
'You are using existing UK NCM stripped, notional,'
'reference and typical models. In order to generate'
'EPC and BRUKL (UK building regulations) specific'
'information annual simulations for all these models'
'need to run and may take some time. If you picked this'
'choice in error just say no.'
*enditem
        CALL ASKOK(
*item MMGFUN
'You are using existing save level 6 files from'
'stripped, notional, reference and typical model runs.'
'In order to generate EPC and BRUKL (UK building'
'regulations) data will be re-scanned. FOR TESTING'
*enditem
        CALL ASKOK(
*subroutine sbmedit
*item sbmedit
 'You have chose to configure you model for UK NCM based'
 'calculations to generate Energy Performance Certificate'
 '(EPC_ Make sure that the original model follows the'
 'following assumptions: '
 '1. Exterior surfaces that have other surfaces within them'
 '   are called parents. Parents may have more surfaces '
 '   within them. Only a three tier hierarchy is allowed '
 '   i.e. only parent, child and grandchild are allowed '
 '   e.g. a wall with a frame and a window). '
 '  '
 '2. Each exterior surface needs to have a usage. You will'
 '   be asked to provide it if not already defined in the'
 '   geometry and attributions menu.'
 '  '
 '   Only the following usages can be associated with '
 '   exterior surfaces that are parents: '
 '   - if exterior & vertical & opaque = WALL '
 '   - if exterior & horiz UP & opaque = ROOF FLAT'
 '   - if exterior & horiz DOWN & opaque = not allowed'
 '   - if exterior & pitched & opaque = ROOF PITCHED'
 '   - if facing ground & horizontal = GROUND'
 '   - if facing another room & any orientation = PARTN'
 '  '
 '   Usages associated with child and grandchild surfaces'
 '   (e.g. not walls and roofs) :'
 '   - if exterior & horiz UP & transp = WINDOW SKYLIGHT'
 '   - if exterior & pitched & transp = WINDOW SKYLIGHT'
 '   - if exterior & vertical & transp = WINDOW'
 '   - if exterior & vertical & opaque = FRAME or DOOR'
 '   - if facing another room = FRAME or DOOR'
 '  '
 '3. Exterior surfaces should   | |                      '
 '   avoid extreme L shapes.    | |  obtuse interior     '
 '   Surfaces with lots of      | | /   angle here       '
 '   edges can cause problems.  | |/_____                '
 '   (e.g. ceiling of passage)  |________                '
 '  '
 '4. Only one child surface is allowed per parent, if more '
 '   child surfaces are required divide a parent into two '
 '   surfaces and make one child in each.'
 ' '
 'When generating the notional model all areas for parents'
 '& children that are not glazed are conserved. Additional'
 'glazing is added to all exterior surfaces as per UK NCM. '
 '* if parent surface is not wall/roof no glazing is added'
 '(This is exceptional and is discouraged)'
 'In order to calculate the required glazed area, gross  '
 'parent area is used (e.g. if a wall has a door in it then'
 'the glazed area is some % of (wall area + door area))'
 ' '
 'If glazing area in original is more than required for  '
 'notional then the same area is retained in notional model'
 ' '
 '5. If you have not attributed some use (eg door) to zone'
 '   surfaces then do so before defining a notional model.'
 ' '
 'For interior surfaces it is assumed that all vertical '
 'surfaces are walls. Horizontal interior surfaces are '
 'internal roofs/ceilings. '
*enditem
      CALL PHELPD('SBEM Assumptions',59,'-',0,0,IER)
*item sbmedit
*enditem
      CALL ASKOK('Continue with UK NCM setup/calculations?',
*item sbmedit
'UK NCM calculations require a number of inputs from'
'the user. You are presented with several sections'
'to document the project and specify the type of building'
'as well as standard occupancy profiles within the'
'building. If you have all of the relevant information'
'you can complete these discriptions in the current'
'session. If not you can continue in later sessions.'
' '
'The building, owner and certifier information forms '
'part of the energy certificate and is required. '
' '
'You must select a buidling type from the list provided'
'as well as select the region of the UK (there are'
'some differences in the calculations between regions).'
' '
'One or more HVAC system types need to be defined and'
'these need to be linked to the zones in the model.'
' '
'DHW use is associated with the activity assoicated with'
'each zone. If DHW is produced separately from the HVAC'
'system then define them. The link DHW systems option'
'allows you to define additional DHW use beyond what is'
'assumed in the zone activity schedules.'
' '
'Each zone in the model must be assigned with one of the'
'standard room activity profiles. Regardless of what'
'was defined in the original model, standard profiles of'
'occupancy, lighting and small power will be imposed along'
'with assumptions about infiltration.'
' '
'It is a GOOD IDEA to use the display current information'
'choice to review the current contents before proceeding'
'to the `setting up required models` stage. '
' '
'Facade surfaces in the model must be attributed for their'
'USE e.g. WINDOW DISPLAY prior to setting up the models.'
'It is recommended that you FIRST define the information'
'in the first three menu items (to register the model as'
'being used for code assessments and THEN return to the'
'zone attribution menu and define the surface USE'
'attributes (only certain USE types are allowed). '
' '
'It is a good idea to back up your model after you have'
'setup the required models. '
*enditem
      CALL EPICKS(IX,KSTR,' ','Define UK NCM data',
*item sbmedit
'You have been editing NCM data. If you want to save'
'recent changes in the model configuration say yes.'
*enditem
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
*item sbmedit
'You have been editing NCM data. If you want to save'
'recent changes say yes. '
*enditem
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
*item sbmedit
'You have been editing NCM data. If you want to save'
'recent changes say yes. '
*enditem
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
*item sbmedit
'You have been editing NCM data. If you want to save'
'recent changes say yes. '
*enditem
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
*item sbmedit
*enditem
          CALL PHELPD('DHW help not defined (yet)',2,'-',0,0,IER)
*item sbmedit
*enditem
          CALL EASKABC('Choose option',' ',
*item sbmedit
*enditem
            CALL EASKS(DHWNAME(NDHWSYS),'DHW system name',
*item sbmedit
*enditem
 909        CALL EPICKS(IY,KSYS,' ','Select DHW system type',
*item sbmedit
*enditem
            CALL EASKABC('Was the DHW generator built before 1998',
*item sbmedit
*enditem
            CALL EASKR(HWEF(NDHWSYS),
*item sbmedit
*enditem
 910        CALL EPICKS(IDA,JSTR,
*item sbmedit
*enditem
              CALL EASKABC('Is there a water storage system',
*item sbmedit
*enditem
                CALL EASKABC('Which of the following do you know',
*item sbmedit
*enditem
                  CALL EASKR(DHWSPD(NDHWSYS,1),
*item sbmedit
*enditem
                  CALL EASKR(DHWSPD(NDHWSYS,2),
*item sbmedit
*enditem
                CALL EASKABC('Is there a water circulation loop',
*item sbmedit
*enditem
                  CALL EASKAB('Do you know circulation losses (W/m)',
*item sbmedit
*enditem
                    CALL EASKR(DHWSPD(NDHWSYS,3),
*item sbmedit
*enditem
                  CALL EASKAB('Do you know pump power (kW)',
*item sbmedit
*enditem
                    CALL EASKR(DHWSPD(NDHWSYS,4),
*item sbmedit
*enditem
                  CALL EASKAB('Do you know loop length (m)',
*item sbmedit
*enditem
                    CALL EASKR(DHWSPD(NDHWSYS,5),
*item sbmedit
*enditem
 911        CALL EPICKS(IDA,JSTR,
*item sbmedit
*enditem
          CALL EASKS(DHWNAME(IDHWSYS),'DHW system name',
*item sbmedit
*enditem
 912      CALL EPICKS(IY,KSYS,' ','Select DHW system type',
*item sbmedit
*enditem
          CALL EASKABC('Was the DHW generator built before 1998',
*item sbmedit
*enditem
          CALL EASKR(HWEF(IDHWSYS),
*item sbmedit
*enditem
 913      CALL EPICKS(IDA,JSTR,
*item sbmedit
*enditem
          CALL EASKABC('Is there a water storage system',
*item sbmedit
*enditem
            CALL EASKABC('Which of the following do you know',
*item sbmedit
*enditem
              CALL EASKR(DHWSPD(IDHWSYS,1),
*item sbmedit
*enditem
              CALL EASKR(DHWSPD(IDHWSYS,2),
*item sbmedit
*enditem
            CALL EASKABC('Is there a water circulation loop',
*item sbmedit
*enditem
              CALL EASKAB('Do you know circulation losses (W/m)',
*item sbmedit
*enditem
                CALL EASKR(DHWSPD(IDHWSYS,3),
*item sbmedit
*enditem
              CALL EASKAB('Do you know pump power (kW)',
*item sbmedit
*enditem
                CALL EASKR(DHWSPD(IDHWSYS,4),
*item sbmedit
*enditem
              CALL EASKAB('Do you know loop length (m)',
*item sbmedit
*enditem
                CALL EASKR(DHWSPD(IDHWSYS,5),
*item sbmedit
'You have been editing NCM data. If you want to save'
'recent changes say yes. '
*enditem
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
*item sbmedit
*enditem
 914        CALL EPICKS(IA,JSTR,' ','Link zones to HVAC systems',
*item sbmedit
*enditem
            CALL EPICKS(IA,JSTR,' ','Link zones to DHW systems',
*item sbmedit
*enditem
 916            CALL EPICKS(IA,KSYS,' ',
*item sbmedit
*enditem
          CALL EASKR(DEADLEG(IZ),
*item sbmedit
*enditem
            CALL EPICKS(IX,KSYS,' ',OUTS(1:LNBLNK(OUTS)),
*item sbmedit
'You have been editing NCM data. If you want to save'
'recent changes say yes. '
*enditem
          CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
*item sbmedit
*enditem
          CALL EASKABC(
*item sbmedit
*enditem
            CALL EASKR(light_input_watt,
*item sbmedit
*enditem
            CALL EPICKS(IY,LSYS,' ',OUTS(1:LNBLNK(OUTS)),
*item sbmedit
*enditem
            CALL EASKABCD('Choose lighting control type for',
*item sbmedit
*enditem
              CALL EASKAB('Type of photoelectric control in zone',
*item sbmedit
*enditem
              CALL EASKAB('Type of photoelectric control sensor',
*item sbmedit
'Photoelectric controls are based on one sensor at'
'the front of the room or front and back sensors '
'in the room. '
*enditem
              CALL EASKABC('Choose lighting sensor location for',
*item sbmedit
'If you selected a standalone sensor then parasitic'
'power is assumed to be 0.3W/m2. If the sensor is '
'addressable (advanced) the PP is assumed to be 0.57'
'W/m2. If you have other data please supply it now. '
*enditem
              CALL EASKR(PE_sensor_PP(iz),
*item sbmedit
'This is equivalent to the choices offered by the UK'
'iSBEM application which is minimally documented in'
'the UK SBEM technical manual table 20. Your choice'
'will set an occupancy modifier which is used in '
'the control.  '
' '
'For systems without automatic presence or absence '
'detection the following options are allowed: '
' Manual on/off switching  Foc=1.0 '
' Manual on/off switching with additional automatic'
'   sweeping extinction signal  Foc=0.95'
' '
'For systems with automatic presence and/or abscence'
'detection the following options are allowed: '
' '
' Auto On with dimming on absence   Foc=0.95'
' Auto On with off on absence       Foc=0.90'
' Manual On with dimming on absence Foc=0.90'
' Manual On with off on absence     Foc=0.82'
*enditem
            CALL EASKATOG(
*item sbmedit
*enditem
              CALL EASKR(Occ_sensor_PP(iz),
*item sbmedit
'You have been editing NCM data. If you want to save'
'recent changes say yes. '
*enditem
          CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
*item sbmedit
'You can add renewable energy in this menu'
' '
' '
' '
' '
' '
*enditem
          CALL ASKOK('Edit this component?',' ',OK,dok,6)
*item sbmedit
*enditem
          CALL EASKABC('Choose action',' ','add','delete','cancel',IA,6)
*item sbmedit
*enditem
          CALL PHELPD('Renewables help',6,'-',0,0,IER)
*item sbmedit
*enditem
            CALL EASKS(RENNAME(INDEX),'Name of renewable energy system',
*item sbmedit
*enditem
            CALL EASKS(RENNAME(INDEX),'Name of renewable energy system',
*item sbmedit
*enditem
          call MENUATOL('Choose renewable energy system',
*item sbmedit
*enditem
              CALL EPICKS(IX,LSTR,'Choose which DHW system ',
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,2),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,3),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,4),
*item sbmedit
*enditem
            call MENUATOL('Choose PV type','Choose PV type',
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,2),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,3),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,4),
*item sbmedit
*enditem
            call MENUATOL('Choose terrain type',
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,2),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,3),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,4),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,1),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,2),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,3),
*item sbmedit
*enditem
            CALL EASKR(RENDATA(INDEX,4),
*item sbmedit
*enditem
 993        CALL EPICKS(IDA,JSTR,
*item sbmedit
'Are there any controls for the specific HVAC system?'
'This is only used in the recommendations report for'
*enditem
          CALL EASKAB('Define controls for system: ',
*item sbmedit
'Select systems controls that apply to the specific'
'HVAC system. These are based on the HVAC Non-Domestic'
'guide. They are only used for the Energy Performance'
'Recommendations report and they are not currently '
'affecting the calculated values for the energy loads.'
'This is in accordance with iSBEM vers. 3.2b '
*enditem
            CALL EPICKS(IPICKS,iselected,' ',
*item sbmedit
'This option is password protected because it is'
'only meant to be used for testing DSM against'
'requirements set accrediting the software. They'
'do not have any practical use. The differences'
'when this flag is set are related with overheating'
'and the calculation of the auxiliary energy.'
*enditem
        call easki(IPASS,' ','Password?',
*item sbmedit
'default 0: stripped does NOT follow the rules of '
'the notional/reference building.'
'if equal to 1: stripped follows the rules of the '
'notional building. '
'if equal to 2: stripped follows the rules of the '
'reference building. '
*enditem
          call easki(iDsmTestingFlag,' ','DSM tests flag (see help)?',
*subroutine LSTNCM
*subroutine edsbmsys
*item edsbmsys
'Help text for adding UK NCM HVAC systems'
'This message still needs to be generated'
*enditem
        CALL PHELPD('NCM HVAC help',2,'-',0,0,IER)
*item edsbmsys
*enditem
        CALL EASKABC('Choose option',' ','add','delete','cancel',JC,2)
*item edsbmsys
'Choose the type of HVAC environment control system'
'that satisfies / comes closest to your requirements'
'(see section 7.6.2 of the iSBEM users guide). The'
'available selections are summarized below: '
' '
'Central heating using water: radiators '
'  Centrally generated heat with water distribution'
'  using radiators in rooms. Natural vent assumed.'
' '
'Central heating using water: convectors '
' '
'  As above but using convectors in rooms.'
' '
'Central heating using water: floor heating '
'  As above but with under floor heating.'
' '
'Central heating with air distribution '
'  As above but with air distribution.'
' '
'Other local room heater - fanned. Includes gas'
'  fires, gas convectors, direct electric heaters,'
'  electric storage (with fans). Large units should'
'  be treated as forced convection air heaters.'
' '
'Other local room heater - unfanned. Includes gas'
'  fires, gas convectors, direct electric heaters,'
'  electric storage (w/o fans).'
' '
'Unflued radiant heater - high temperature overhead'
'  radiant (electric or gas) without flue.'
' '
'Flued radiant heater - high temperature overhead'
'  radiant (electric or gas) with flue.'
' '
'Multi-burner radiant heaters - high temperature'
'  overhead gas units'
' '
'Flued forced-convective air heaters - optional fan'
'  to assist combustion.'
' '
'Unflued forced-convective air heaters - typically'
'  called direct gas heaters. Adequate ventilation'
'  must be provided.'
' '
'continued... '
*enditem
          CALL PHELPD('SBEM HVAC choices',45,'-',0,0,IER)
*item edsbmsys
'Air based HVAC systems follow... '
' '
'Single-duct VAV - all air system where volume is'
'  adjusted to match cooling load. Reheat optional.'
'  Assumed to provide heating. Optional perimeter'
'  heating.'
' '
'Dual-duct VAV - as above except separate hot and'
'  cold air ducts.'
' '
'Indoor packaged cabinet (VAV) - local cooling &'
'  heating units supplying to room or floor or'
'  ceiling voids. Optional locally varied recirc'
'  rate and electric top-up heating.'
' '
'Fan coil system - local fanned terminal unit (in'
'  ceiling/on wall/on floor) with central chilled'
'  water. 2/3/4-pipe. Assumed to provide heating.'
' '
'Induction system - high pressure central supply'
'  air with heating and cooling within terminal'
'  unit. 2/3/4-pipe. Assumed to provide heating.'
' '
'Constant volume system with fixed fresh air - '
'  Fixed air volume units w/o terminal reheat.'
'  Assumed to provide heating.'
' '
'Constant volume system with vairable fresh air -'
'  As above but with free cooling economiser.'
' '
'Multizone hot deck/cold deck - central AHU with a'
'  single duct to each room. Provides heating.'
' '
'Terminal reheat - Central chilled air supply with'
'  reheat at terminal. Assumed to provide heating'
'  and optional perimeter heating.'
' '
'Dual duct (constant volume) - separate hot and '
'  cold air supplies locally mixed at each zone.'
'  Assumed to provide heat, optional perimeter.'
' '
'Chilled ceilings or passive chilled beams - A '
'  combination of chilled ceiling or passive'
'  chilled beam with separate tempered ventilation'
'  air. Heating via LTHW. Assumes displacement vent.'
' '
'Active chilled beams - typically induction units'
'  via central high pressure air supply. Heating'
'  via LTHW. May include local fans.'
' '
'Water loop heat pump - local heat pumps served by'
'  common water loop. Central heating or cooling '
'  plant used. Assumed to provide heating.'
' '
'Split or multi-split system - outdoor and indoor'
'  units connected via refrigerant. No mechanical'
'  vent. Also for ducted split systems.'
' '
'Single room cooling - integral units w/o ducts. '
*enditem
          CALL PHELPD('SBEM HVAC choices',59,'-',0,0,IER)
*item edsbmsys
*enditem
          CALL EASKS(HVACNAME(NCMSYS),'HVAC system name',
*item edsbmsys
*enditem
 906      CALL EPICKS(IY,KSYS,' ','Select system type',
*item edsbmsys
*enditem
          CALL EPICKS(IY,KSYS,' ','Select heat generator',
*item edsbmsys
'You will be asked for system efficiency/COP next'
'For the district heating option note that default'
'emission factor specified in iSBEM v3.4.a is 0.293'
'kgCO2/kWh. Default efficiency of the system is '
'set to 0.65, this corresponds to natural gas as fuel'
'for aforementioned emission factor.'
*enditem
            CALL PHELPD('SBEM HVAC exceptions',6,'-',0,0,IER)
*item edsbmsys
'You will be asked for system efficiency/COP next'
'For heat pumps values for natural gas are quoted as'
'default values. The same values are applicable to '
'oil as well. If electricity is being used as fuel '
'then it is appropriate to multiply the COP with 2.5'
'(following iSBEM ver 3.4.a)'
*enditem
            CALL PHELPD('SBEM HVAC exceptions',6,'-',0,0,IER)
*item edsbmsys
*enditem
          CALL EASKR(HGEF(NCMSYS),
*item edsbmsys
*enditem
          CALL EPICKS(IY,KSYS,' ','Select fuel type',
*item edsbmsys
*enditem
 456        CALL EASKATOG(' Choose cooling system',' ',SYSNAME(MPT-4),
*item edsbmsys
*enditem
              CALL EASKABCD('Enter power rating of system (kW)',' ',
*item edsbmsys
*enditem
              CALL EASKAB('Is this system in the ECA list',
*item edsbmsys
*enditem
            CALL EASKR(CGEF(NCMSYS),
*item edsbmsys
*enditem
            CALL EASKR(SFPHS(NCMSYS),
*item edsbmsys
'If supply/extract then additional ventilation '
'losses will be taken for the heating loads plus'
'additional auxiliary loads.'
' '
'Choose centralised system for centralised balanced'
'mechanical ventilation system including air supplies'
'to centralised air conditioning system'
''
'Choose zonal supply for where the fan in remote from'
'the zone such as ceiling void or roof mounted units'
''
'Choose zonal extract where the fan is remote from the'
*enditem
          CALL EASKABCD('Zone ventilation type (see help)',
*item edsbmsys
*enditem
          CALL EASKAB('Does system have local ventilation only units',
*item edsbmsys
*enditem
            CALL EASKR(SFPHS(NCMSYS),
*item edsbmsys
 'Choose HVAC system to delete or simply exit without'
 'making any choice to retain all defined systems'
*enditem
          CALL EPICKS(IZ,KSYS,' ','HVAC system to delete',
*item edsbmsys
 'Choose HVAC system to replace current system'
 '(see text feed back area) or exit to retain current'
*enditem
        CALL EASKS(HVACNAME(IHO),'HVAC system name',
*item edsbmsys
*enditem
        CALL EPICKS(IY,KSYS,' ','Select system type',
*item edsbmsys
*enditem
        CALL EPICKS(IY,KSYS,' ','Select heat generator',
*item edsbmsys
'You will be asked for system efficiency/COP next'
'For the district heating option note that default'
'emission factor specified in iSBEM v3.4.a is 0.293'
'kgCO2/kWh. Default efficiency of the system is '
'set to 0.65, this corresponds to natural gas as fuel'
'for aforementioned emission factor.'
*enditem
          CALL PHELPD('SBEM HVAC exceptions',6,'-',0,0,IER)
*item edsbmsys
'You will be asked for system efficiency/COP next'
'For heat pumps values for natural gas are quoted as'
'default values. The same values are applicable to '
'oil as well. If electricity is being used as fuel '
'then it is appropriate to multiply the COP with 2.5'
'(following iSBEM ver 3.4.a)'
*enditem
          CALL PHELPD('SBEM HVAC exceptions',6,'-',0,0,IER)
*item edsbmsys
*enditem
        CALL EASKR(HGEF(IHO),
*item edsbmsys
*enditem
        CALL EPICKS(IY,KSYS,' ','Select fuel type',
*item edsbmsys
*enditem
 457        CALL EASKATOG(' Choose cooling system',' ',SYSNAME(MPT-4),
*item edsbmsys
*enditem
              CALL EASKABCD('Enter power rating of system (kW)',' ',
*item edsbmsys
*enditem
              CALL EASKAB('Is this system in the ECA list',
*item edsbmsys
*enditem
            CALL EASKR(CGEF(IHO),
*item edsbmsys
*enditem
          CALL EASKR(SFPHS(IHO),
*item edsbmsys
'If supply/extract then additional ventilation '
' losses will be taken for the heating loads plus'
' additional auxiliary loads.'
*enditem
          CALL EASKAB('Zone ventilation type',
*item edsbmsys
*enditem
            CALL EASKR(SFPHS(IHO),
*subroutine edsbmbld
*item edsbmbld
'This menu allows the definition of project'
'details. These will be used by BRUKL/EPC for'
'reporting purposes and are required data.'
' '
'The enter all details will ask for for all the details'
'shown in the menu (in sequence).'
*enditem
        CALL PHELPD(HEAD,6,'-',0,0,IER)
*item edsbmbld
'Input a succinct description of the project name here.'
*enditem
        CALL EASKS(pjname,'project name?','(20 characters maximum)',
*item edsbmbld
'Input the building street address.'
*enditem
        CALL EASKS(baddress,'building address?','(<64 characters)',
*item edsbmbld
'Input the names of the town/city of the building.'
*enditem
        CALL EASKS(bcity,'building city?','(<64 characters)',
*item edsbmbld
'Input for: building post code'
*enditem
        CALL EASKS(buildingPC,'building post code?',
*item edsbmbld
'Input a succinct description of the owner name here'
*enditem
        CALL EASKS(ownername,'Name of owner?','(<64 characters)',
*item edsbmbld
'telephone number of the owner'
*enditem
        CALL EASKS(ownertel,'Phone of owner?','(<64 characters)',
*item edsbmbld
'Street address of the owner'
*enditem
        CALL EASKS(owneraddr,'Address of owner?','(<64 characters)',
*item edsbmbld
'City (where the owner is located)'
*enditem
        CALL EASKS(ownercity,'City of owner?','(<64 characters)',
*item edsbmbld
'Post code (where the owner is located)'
*enditem
        CALL EASKS(ownerPC,'Post code for owner?','(<64 characters)',
*item edsbmbld
'certifier name'
*enditem
        CALL EASKS(certifname,'Name of certifier?','(<64 characters)',
*item edsbmbld
'certifier telephone number'
*enditem
        CALL EASKS(certTel,'Phone of certifier?','(<64 characters)',
*item edsbmbld
'certifier street address'
*enditem
        CALL EASKS(certaddress,'Address of certifier?',
*item edsbmbld
'Name of city of the certifier.'
*enditem
        CALL EASKS(certcity,'City of certifier?','(<64 characters)',
*item edsbmbld
'certifier post code'
*enditem
        CALL EASKS(certPC,'Post code of certifier?',
*item edsbmbld
'Input a succinct description of the project name here.'
*enditem
        CALL EASKS(pjname,'project name?','(20 characters maximum)',
*item edsbmbld
'Input the building street address.'
*enditem
        CALL EASKS(baddress,'building address?','(<64 characters)',
*item edsbmbld
'Input the names of the town/city of the building.'
*enditem
        CALL EASKS(bcity,'building city?','(<64 characters)',
*item edsbmbld
'Input for: building post code'
*enditem
        CALL EASKS(buildingPC,'building post code?',
*item edsbmbld
'Input a succinct description of the owner name here'
*enditem
        CALL EASKS(ownername,'Name of owner?','(<64 characters)',
*item edsbmbld
'telephone number of the owner'
*enditem
        CALL EASKS(ownertel,'Telephone of owner?','(<64 characters)',
*item edsbmbld
'Street address of the owner'
*enditem
        CALL EASKS(owneraddr,'Address of owner?','(<64 characters)',
*item edsbmbld
'City (where the owner is located)'
*enditem
        CALL EASKS(ownercity,'City of owner?','(<64 characters)',
*item edsbmbld
'Post code (where the owner is located)'
*enditem
        CALL EASKS(ownerPC,'Post code for owner?','(<64 characters)',
*item edsbmbld
'certifier name'
*enditem
        CALL EASKS(certifname,'Name of certifier?',
*item edsbmbld
'certifier telephone number'
*enditem
        CALL EASKS(certTel,'Phone of certifier?','(<64 characters)',
*item edsbmbld
'Certifier street address'
*enditem
        CALL EASKS(certaddress,'Address of certifier?',
*item edsbmbld
'Name of city of the certifier.'
*enditem
        CALL EASKS(certcity,'City of certifier ?','(<64 characters)',
*item edsbmbld
'certifier post code'
*enditem
        CALL EASKS(certPC,'Post code of certifier?',
*subroutine edsbmassor
*item edsbmassor
'This menu allows the definition of'
'project details. These will be used by'
'BRUKL/EPC for reporting purposes'
' '
'The Unisque Property Reference Number is applicable'
'in England, Wales & Northern Ireland.'
'<< help message is work-in-progress >> '
*enditem
        CALL PHELPD(HEAD,6,'-',0,0,IER)
*item edsbmassor
'Input the Unique Property Reference Number (UPRN) here.'
'Applicable only for England, Wales & Northern Ireland.'
*enditem
        CALL EASKS(UPRN,'Unique Property Reference Number (UPRN)?',
*item edsbmassor
'Input the month and the day of the month of the '
'inspection. Applicable only for England, '
'Wales & Northern Ireland.'
*enditem
        CALL EASKI(D_inspect,' ','Day of inspection?',
*item edsbmassor
*enditem
        CALL EASKI(M_inspect,' ','Month of inspection?',
*item edsbmassor
'Input the year of the inspection. Applicable '
'only for England, Wales & Northern Ireland.'
*enditem
        CALL EASKI(Y_inspect,' ','Year of inspection?',
*item edsbmassor
'Input certifier/energy assessor accreditation scheme.'
'Applicable only for England, Wales & Northern Ireland.'
'This is the scheme name from CIBSE or BRE. '
*enditem
        CALL EASKS(Accr_Scheme,'Accreditation scheme ?',
*item edsbmassor
'The assessor registration number should be in the'
'form of CCCCNNNNNN where C is character and N is a'
'number such as ABCD123456.'
*enditem
        CALL EASKS(assessRegNumber,
*item edsbmassor
'The employer or the trading name of the energy'
'assessor. Applicable only for England, '
'Wales & Northern Ireland.'
*enditem
        CALL EASKS(empl_Trading_name,'Employer/trading name ?',
*item edsbmassor
'The employer or the trading address of the energy'
'assessor. Applicable only for England, '
'Wales & Northern Ireland.'
*enditem
        CALL EASKS(addr_empl_Trading,'Employer/trading address ?',
*item edsbmassor
'Any related party disclosure by the energy'
'assessor. Applicable only for England, '
'Wales & Northern Ireland.'
*enditem
        CALL EASKS(party_disclosure,'Party disclosure ?',
*item edsbmassor
'Qualifications of the energy assessor.'
'Applicable only for England, Wales & '
'Northern Ireland. There are 3 choices: '
'NOS3, NOS4 and NOS5'
*enditem
        CALL EASKABC(' ','Energy assessor qualifications:',
*item edsbmassor
'Name of the insurance company. Applicable '
'only for England, Wales & Northern Ireland.'
*enditem
        CALL EASKS(insurer_Company,'Name of insurance company ?',
*item edsbmassor
'Enter insurance policy number. Applicable '
'only for England, Wales & Northern Ireland.'
*enditem
        CALL EASKS(policyNumberInsurance,'Policy number ?',
*item edsbmassor
'Input the date for start of the insurance. '
'Applicable only for England, Wales & Northern'
*enditem
        CALL EASKI(S_Dinsur,' ','Insurance start (day)?',
*item edsbmassor
*enditem
        CALL EASKI(S_Minsur,' ','Insurance start (month)?',
*item edsbmassor
*enditem
        CALL EASKI(S_Yinsur,' ','Insurance start (year)?',
*item edsbmassor
'Input the date for the expiry of the insurance. '
'Applicable only for England, Wales & Northern'
*enditem
        CALL EASKI(E_Dinsur,' ','Insurance expiry (day)?',
*item edsbmassor
*enditem
        CALL EASKI(E_Minsur,' ','Insurance expiry (month)?',
*item edsbmassor
*enditem
        CALL EASKI(E_Yinsur,' ','Insurance expiry (year)?',
*item edsbmassor
'Input the insurance policy cover limit. '
'Applicable only for England, Wales & Northern'
*enditem
        CALL EASKI(pi_limit,' ','Insurance cover limit?',
*item edsbmassor
'Complexity level of the project. Applicable only for'
'England, Wales & Northern Ireland.'
'There are 4 choices: '
' Undefined - no opinion (yet)'
' Level 3 less than 100kW heating & less than 12kW cooling'
' Level 4 more than 100kW heating & 12kW cooling'
' Level 5 building cannot be done via sBEM.'
*enditem
        CALL EASKABCD(' ','Complexity level ?',
*subroutine edsbmregs
*item edsbmregs
*enditem
 902  CALL EPICKS(IX,JSTR,' ','Define building regulations to use',
*item edsbmregs
*enditem
 903  CALL EPICKS(IX,JSTR,' ','Define building regulations to use',
*item edsbmregs
*enditem
 904    CALL EPICKS(IX,JSTR,' ','Define building type',
*item edsbmregs
*enditem
        CALL EASKABC('Is the building built/designed following',
*item edsbmregs
*enditem
      CALL EASKR(BINF50,
*item edsbmregs
*enditem
      CALL EASKABC(
*item edsbmregs
*enditem
c      CALL EASKABC(
*item edsbmregs
*enditem
        CALL EPICKS(IX,JSTR,' ','CIBSE building selection',
*item edsbmregs
*enditem
        CALL EPICKS(IX,JSTR,'Pick storeys and floor area ',
*item edsbmregs
'Air leakage rates can be specified for'
'for every zone in terms of air changes per hour. '
*enditem
        CALL PHELPD('AIR LEAKAGE',2,'-',0,0,IER)
*item edsbmregs
*enditem
        CALL EASKR(Air_infilt,' ',
*item edsbmregs
'For the UK National Calculation Method you are required'
'to select one of these building types. '
' '
'Depending on the type of building the notional model will'
'have different assumptions about glazing areas. The '
'building type will also help in the selection of room '
'use patterns. '
*enditem
 905  CALL EPICKS(IX,IVALSS,' ','Building type:',
*subroutine EMKSTRIPPED
*item EMKSTRIPPED
 ' Control file exists. Choose to overwrite in '
 ' question that will follow '
*enditem
          CALL PHELPD('File exists',2,'-',0,0,IER)
*item EMKSTRIPPED
'Temporal data file exists. Choose to overwrite in '
'question that will follow '
*enditem
          CALL PHELPD('File exists',2,'-',0,0,IER)
*subroutine EMKSBM
*item EMKSBM
 'You have not defined NCM details about the building. '
 'These can be defined by choosing model context in the '
 'browse / edit / simulate menu and then choosing  '
 'option UK NCM specifications. '
 'You are being returned to the NCM editing facility. '
*enditem
        CALL PHELPD('NCM details undefined!',5,'-',0,0,IER)
*item EMKSBM
'A problem was found when scanning the origial'
'model geometry. You may need to alter the original'
'model in order to proceed.'
'You are being returned to the NCM editing facility. '
*enditem
          CALL PHELPD('NCM details undefined!',4,'-',0,0,IER)
*item EMKSBM
'A problem was found when copying origial'
'model files. Check if you have write permission.'
'You are being returned to the NCM editing facility. '
*enditem
          CALL PHELPD('NCM details undefined!',3,'-',0,0,IER)
*item EMKSBM
'A problem was found - the NCM building type'
'was not defined. Please do this and try again.'
*enditem
        CALL PHELPD('NCM building type undefined!',2,'-',0,0,IER)
*subroutine RSL6TF
*item RSL6TF
'name of the text result file'
*enditem
        CALL EASKS(LTXTF,'Name of text results file?',
*subroutine defLeakage
*item defLeakage
'This menu allows the definition of ductwork'
'and Air Handling Unit details. These will '
'be used for the Auxiliary Energy calculation'
'for the stripped building. The defaults will'
'use the worse case options: this for the '
'ductwork question is "Class Worse than A"'
'and for AHU is "Class worse than L3".'
*enditem
          call phelpd(head,7,'-',0,0,IER)
*item defLeakage
'The default is the same as Class Worse than A.'
'Class B is the best option here. See '
'EN 13779 Standard for more details.'
*enditem
          call easkabcd(' ',
*item defLeakage
'The default is the same as Class Worse than L3.'
'Class L1 is the best option here. See EN 13779'
'Standard for more details.'
*enditem
          call menuatol('Define AHU leakage',
*subroutine epltnet
*item epltnet
'This facility is used to define or edit a plant '
'network. The items in the main menu have the following'
' functions:'
' '
' (1) Allows you to define a new plant network.'
'     Before you proceed with the network '
'     definition, you will be asked to specify'
'     the network file name.'
' '
' (2) Allows you to modify an existing plant '
'     network. You will be asked to specify'
'     the network file name.'
' '
' (?) Displays this message.'
' (-) Exits to project description.'
'Graphical network definition is currently  '
'functional but is still at an early  '
'stage of development. Hence for the safety'
'of the novice user graphical network '
'definition is password protected.'
' '
'If you do not know the password select cancel'
'and you will be given a change to try again with '
'the text/menu based interface.'
*enditem
        call easki(ians,' ','Password: ',0,'-',0,'-',0,'Password',
*item epltnet
*enditem
         CALL PHELPD('pdf opening',15,'-',0,0,IER)
*subroutine edcomp
*item edcomp
'Each plant component has numerous parameters '
'associated with it. These are grouped into two sets:    '
' '
'heat flow parameters - these are associated with the heat'
'transfers in the plant component.'
' '
'fluid flow parameters - these are associated with pressure'
'driven fluid flow in the component and are necessary ONLY'
'if a fluid flow connection(s) is/are mapped to the plant '
'component. Each RECIEVING connection to the plant '
'component requires a set of fluid flow parameters, e.g.'
'the mixing box, with two incoming connetions, requires'
'two fluid flow parameter sets. '
' '
'All parameters can be edited by the user to suit their'
'particular component.'
*enditem
      CALL EASKABC('What do you want to edit? ',' ',
*item edcomp
'You can designate a meaningful name for the selected'
'component. This name will be used in the current '
'problem. The name must not exceed 15 characters.'
' '
*enditem
        CALL EASKS(t15,
*item edcomp
'A control variable may be subjected to control action.'
'For example, in a heating coil model, the heat'
'injected to the air may be an elected control variable.'
'If no control loop is defined, a realistic value must'
'be assigned to this variabel otherwise its value is '
'determined on the basis of some sensed condition and'
'the active control law.'
' '
*enditem
          CALL EASKR(value,' ',txt,0.,'-',0.,'-',0.,
*item edcomp
*enditem
   20   call askpar(itm,ival,ipcomp)
*item edcomp
*enditem
            call easkr(value,' ',txt,0.,'-',0.,'-',dvalue,
*item edcomp
*enditem
        call askmfpar(ipcomp)
*subroutine ASKPCMP
*item ASKPCMP
'The list shows the (currently) available components '
'defined in the plant network which is being edited. '
'Components can be added to the list only in the '
'component editing menu. Deletion is allowed'
'only during the editing phase, when an individual  '
'component is chosen from the displayed list. '
'Choose a component from the list or "Exit".'
*enditem
        CALL PHELPD('node connection selection',7,'-',0,0,IER)
*item ASKPCMP
'Supply the index of the plant component. '
' '
'A cancel continues without a component. '
*enditem
  96    CALL EASKI(IV,' ',' Index of component ? ',
*item ASKPCMP
*enditem
            CALL EASKABCD('Choose an option or continue ',' ','Add',
*item ASKPCMP
'If this is the item you want to edit say ok. If not'
'say no and try again. '
*enditem
          CALL ASKOK('Edit this item?',' ',OK,dok,2)
*subroutine ASKPCON
*item ASKPCON
'The list shows the (currently) available connections'
'defined in the plant network being edited/defined.'
'Connections can be added to the list only in the '
'connection editing menu. Connections deletion '
'is allowed only during the editing phase, when an '
'individual connection is chosen from the displayed'
'list. Choose a connection from the list or "Exit".'
*enditem
        CALL PHELPD('node connection selection',7,'-',0,0,IER)
*item ASKPCON
'Supply the index of the plant component. '
' '
'A cancel continues without a component. '
*enditem
  96    CALL EASKI(IV,' ',' Index of component ? ',
*item ASKPCON
*enditem
        CALL EASKABCD('Select option or continue',' ','Add ','Delete',
*item ASKPCON
' '
' '
*enditem
          CALL ASKOK('Edit this connection?',' ',OK,dok,2)
*subroutine ASKCONT
*item ASKCONT
'The list shows the  available containments defined'
'in the current plant network being edited/defined. '
'Containments can be added to the list only during '
'editing. Containment deletion is allowed only during'
'the editing phase, when an individual containment  '
'is chosen from the displayed list. '
'Choose a containment from the list or "Exit". '
*enditem
        CALL PHELPD('node connection selection',6,'-',0,0,IER)
*item ASKCONT
'Supply the index of the plant component. '
' '
'A cancel continues without a component. '
*enditem
  96    CALL EASKI(IV,' ',' Index of component ? ',
*item ASKCONT
*enditem
          CALL EASKABCD('Containment options:',' ','Add ','Delete',
*item ASKCONT
' '
' '
*enditem
          CALL ASKOK('Edit this containiment',' ',OK,dok,2)
*subroutine LISTPNF
*subroutine opnpdb
*item opnpdb
'The plant component database binary file holds the'
'description of available components. If the name'
'given matches an existing file, it will be read in'
'and the components data will be available for'
'listing and editing. If there is no such file then'
'a new one will be created to hold data for new'
*enditem
          CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
*enditem
          CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
*enditem
          CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
*enditem
        CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
*enditem
        CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
'An error occurred wheb opening the plant template'
'template database. Check that the file exists and has'
'not been corrupted. '
*enditem
            CALL ASKOK('Error occurred on opening file',
*item opnpdb
'An error occurred when opening the plant template'
'template database. Check that the file exists and'
'that the name you supplied is correct. '
*enditem
            CALL ASKOK(' Plant database file does not exist.',
*item opnpdb
'The file exists, but is either not a plant db file'
'or has been corrupted. This might happen if the file'
'was generated on a different type of computer.'
*enditem
            CALL ASKOK(' Not a plant data base file.',
*subroutine cpcdat
*item cpcdat
'The data is needed by CPCALC to calculate the pressure'
'distribution around a building.  '
' '
'Building width,depth and hight are the OVERALL '
'dimensions if the building. Roof type can be a flat'
'roof (type 0), a single sloped roof (type 1) or'
'a double sloped roof (type 2).'
'The surrounding buildings hight and plan area density '
'are related to the average hight and the layout'
'pattern of the buildings surrounding the building'
'under examination.'
'The wind velocity profile defines the terrain'
' '
'Detailed information about the points on the facade '
'where pressure coefficients are calculated should be '
'defined in the pressure coefficients database of the'
'database maintenence facility. '
*enditem
        CALL PHELPD('prim convers',18,'-',0,0,IER)
*item cpcdat
'The width (with no rotation) is along the x-axis.'
'Note that for a tilted roof this is the facade'
'with the roof ridge!'
*enditem
        CALL EASKR(ble,' ','Overall building width:',
*item cpcdat
'The depth (with no rotation) is along the y-axis.'
'Note that for a tilted roof this is the facade'
'with the gable!'
*enditem
        CALL EASKR(bwi,' ','Overall building depth:',
*item cpcdat
'Give the OVERALL hight of the building.'
'Note that for a building with a tilted roof the hight '
'of the building is defined from the bottom of the'
'building to the bottom of the roof (eaves).'
*enditem
        CALL EASKR(bhi,' ','Overall building hight:',
*item cpcdat
'This is the origin of the CPCALC domain that is used by'
'CPCALC to calculate the pressure coefficients.'
'It will define its south-westerly corner.'
'With the definition of the orientation the box'
'gets positioned at the exact place.'
'(this is in the same coordinate system as the zones)'
*enditem
        CALL EASKS(HOLD,'Origin of CPCALC domain (X Y Z metres):',
*item cpcdat
 'The orientation of the CPCALC domain is given in  '
 'a clockwise direction (i.e. 0 rotation is length  '
 'along X axis). The rotation point is x (see below).'
 'Rotation can be in between 0 and 180 degree.      '
 '                                                  '
 '   *****************                              '
 '   *               *      NORTH                   '
 '   *               *        ^                     '
 '   *  <-length->   *        |                     '
'   x****************        |                     '
*enditem
        CALL EASKR(orient,' ','Orientation of the building:',
*item cpcdat
'Choose one roof type. '
'The double slope roof is also known as a gable roof.'
'Note that for a building with a tilted roof the facade'
'along the length dimension (x-axis if no rotation) is '
'the one with the roof ridge!'
 '        ridge                                     '
 '   **.............**                              '
 '   *      or       *      NORTH                   '
 '   * ...ridge..... *        ^                     '
'   *  <-length->   *        |                     '
'   x****************        |                     '
*enditem
        CALL EASKABC('Choose one roof type: ',' ','flat roof',
*item cpcdat
'The roof tilt angle is measured from the horizontal'
'plane containing the reference flat roof.'
'The roof tilt angle has to be in between 0 - 50 degree'
*enditem
          CALL EASKR(ra,' ','Roof tilt angle:',
*item cpcdat
'The roof tilt angle is measured from the horizontal'
'plane containing the reference flat roof.'
'The roof tilt angle has to be in between 0 - 50 degree'
*enditem
          CALL EASKR(ra,' ','Roof tilt angle:',
*item cpcdat
'The surrounding buildings hight is related to the '
'average hight of the buildings surrounding the model'
'zones under examination.'
*enditem
        CALL EASKR(sbh,' ','Surrounding buildings hight:',
*item cpcdat
'The plan area density (PAD) is related to the layout'
'pattern of the buildings surrounding the building under'
' '
'PAD=(Building Area/Total Area)*100'
'[where total area is the overall site area (m^2) and '
' building area is the ground contact area of buildings'
' (m^2) within the overall site].'
' '
'The extension of the radius to be considered can be'
'calculated with the radius formula R:'
' '
'R=(7.67-PAD)/2.7*building height'
' '
'Wind tunnel test data shows that the radius of the'
'built area surrounding the building, and affecting the'
'wind pressure distribution on its envelop, is inversely'
'proportional to the plan area density. This is why a'
'greater PAD lead to a greater radius to be considered:'
'A PAD of 12 results in a considered radius of 240'
'and a PAD of 40 results in a considered radius of 135.'
' '
'If the area surrounding the buildings does not have an'
'homogeneous density - as often happens - homogeneous'
'sectors should be defined according to the average'
'density of their building blocks. The PAD value to '
'insert in the program is the average value of all'
' '
'This help message was extracted from the CPCALC user'
' '
*enditem
        CALL EASKR(pad,'Plan area density: ','(see help)',
*item cpcdat
'The wind velocity profile defines the terrain roughness.'
' '
'The following list shows reference values taken from'
'the CPCALC user menue:'
' '
'Level surface, surface of water basin, grass land:'
'-> 0.10'
'Flat open country few, very small and scattered'
'-> 0.14'
'Rolling or level surfaces broken by numerious'
'obstructions such as trees or small houses:'
'-> 0.22'
'Heterogeneous surface with obstacles larger than'
'one story:'
'-> 0.28'
'Low density suburban areas:'
'-> 0.34'
'Medium-high density urban areas:'
'-> 0.40'
'Very high density inner city areas:'
'-> 0.45'
' '
*enditem
        CALL EASKR(wvpe,' ',' Wind velocity profile:',
*subroutine EDCPFAC
*item EDCPFAC
'Here you can define the coordinates for which'
'CPCALC is going to calculate the pressure'
'"Add coordinates" allows a manual input of the '
'coordinates, "generate coordinates" will search the '
'model for windows and suggest a position.'
'Delete coordinates allows to remove allready defined'
*enditem
        CALL PHELPD('input cpcalc coordinates',8,'-',0,0,IER)
*item EDCPFAC
*enditem
 878    CALL EASKS(LTMP,' Facade coordinates file ? ',
*item EDCPFAC
*enditem
        CALL EASKS(LTMP,' Facade coordinates file ? ',
*item EDCPFAC
'You can delete one coordinate set'
*enditem
        CALL EPICKS(IX,IVAL,'Delete which one?',' ',
*item EDCPFAC
'Chance to not delete this cooordinate set. '
'(in case you picked the wrong set) '
*enditem
        CALL ASKOK(' ',' Are you sure? ',OK,dok,2)
*item EDCPFAC
'You can eiter provide the coordinates by manual input'
'or search the model for windows.'
'Windows are transparent external surfaces.'
*enditem
        CALL EASKAB('Options: ',' ','manual input',
*item EDCPFAC
*enditem
          CALL EASKGEOF('Select a zone for coords:',CFGOK,IC,'-',IER)
*item EDCPFAC
*enditem
 256      CALL EASKSUR(IC,ISO,'-','with respect to which external ',
*item EDCPFAC
'The X offset is the horizontal distance from the '
'lower left corner of the surface (looking from'
'the outside) to the considered point.'
*enditem
          CALL EASKR(DX1,' ',' X offset: ? ',
*item EDCPFAC
'The Z offset is the vertical distance from the '
'lower left corner of the surface (looking from'
'the outside) to the considered point.'
*enditem
          CALL EASKR(DZ1,' ',' Z offset: ? ',
*item EDCPFAC
'Chance to not use this cooordinate set.'
'(in case the location is incorrect) '
*enditem
          CALL ASKOK(t28,'Use this coordinate?',OK,dok,2)
*item EDCPFAC
'Give a name for the cordinates. This names will then'
'later also be used for the definition in the pressure'
'coefficient database.'
*enditem
            CALL EASKS(HOLD2,'Name cpcalc cordinates',
*item EDCPFAC
'Respond with ok if you want another cooordinate set.'
*enditem
          CALL ASKOK(' ','Define another point for this zone?',OK,dok,1)
*item EDCPFAC
'Chance to not use this cooordinate set.'
'(in case the location is incorrect) '
*enditem
                CALL ASKOK(t28,'Use this coordinate?',OK,dok,2)
*item EDCPFAC
'Give a name for the cordinates. This names'
'will then later also be used for the defi-'
'nition in the pressure coefficient database.'
*enditem
                  CALL EASKS(HOLD2,'Name cpcalc cordinates',
*subroutine CPCACAL
*item CPCACAL
'ESP-r will check whether the coordinates that '
'have been defines as locations to calculate the '
'pressure coefficients are close to one of the surfaces '
'of the CPCALC domain.'
'Here you can give a tolerance that will be applied'
'for this check.'
*enditem
      CALL EASKR(ditol,'maximum tolerance between the absolut',
*item CPCACAL
'ESP-r will project the coordinates that have been'
'defines as locations to calculate the pressure'
'coefficients on the surface of the CPCALC domain'
'with similar orentation and  elevation (projection '
'direction normal to the surface of the CPCALC domain).'
'As a control meachanism it compares the orentation of'
'the zone surface from which these coordinates had been'
'derived with the orentation of the surface of the'
'CPCALC domain. Here you can define the maximum'
'difference between these two values.'
*enditem
      CALL EASKR(aztol,
*item CPCACAL
'ESP-r will project the coordinates that have been'
'defines as locations to calculate the pressure'
'coefficients on the surface of the CPCALC domain'
'with similar orentation and  elevation (projection '
'direction normal to the surface of the CPCALC domain).'
'As a control meachanism it compares the elevation of'
'the zone surface from which these coordinates had been'
'derived with the elevation of the tilted roof of the'
'CPCALC domain. Here you can define the maximum'
'difference between these two values.'
*enditem
        CALL EASKR(eltol,
*item CPCACAL
'You can either append the data to the currently used '
'database or you can save it as a new database.'
'If you are using the default pressure coefficent'
'database ESP-r will suggest a file in your directory'
'to save the data since you do not have writing'
'permission to the default one. This file will then'
'include the default pc-sets but also the ones you'
*enditem
      CALL ASKOK(
*item CPCACAL
*enditem
        CALL EASKAB('How do you want to save the data?',' ',
*item CPCACAL
'To which file do you want to write the pressure data?'
' '
' '
*enditem
              CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
*enditem
              CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
*enditem
              CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
*enditem
            CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
*enditem
            CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
'To which file do you want to write the data?'
*enditem
C          CALL EASKS(LTMP,' Pressure coefficients database?',
*subroutine EMKAPCDB
*subroutine EDPCDB
*item EDPCDB
'To enable the calculation of wind-induced surface'
'pressures (as required by ESP-r`s fluid flow'
'simulators), this database of angle dependent'
'pressure coefficients is provided.'
' '
'Wind pressure coefficients are pressure coefficients'
'for surfaces in typical positions and within several'
'different exposure categories. '
' '
'The first 27 data sets in the standard pressure coef'
'database are from the Air Infiltration and Ventilation'
'Centre Handbook called <Air Infiltration Calculation'
'Techniques - An Applications Guide>. The 27 data sets'
'are only applicable for buildings up to 3 storeys and'
'come with the usual warnings about usage of the data.'
' '
'Each data set is described with the following terms: '
' a) facade or roof at different roof pitch angles'
' b) the ratio of the building length to width and'
'    for a non square building there will be a long and'
'    a short wall to select'
' c) site shielding as follows:'
'   exposed - open countryside with no obstructions'
'   simi-exposed - rural with some obstructions'
'   sheltered - urban, surrounded on all sides by'
'     obstructions of similar size.'
' '
'Here you can change the data of an existing pressure'
'coefficient set (by clicking on it), add/delete/copy'
'a set, list the file contents of the existing pc-file'
'or update changes you have made.'
'Recent changes to the coefficients might be lost if'
'you do not save it to the database. '
*enditem
          CALL ASKOK(' ',
*item EDPCDB
*enditem
        CALL PHELPD('pc help menue',31,'-',0,0,IER)
*item EDPCDB
'The continue option allows you to cancel choice. '
*enditem
        call easkatog('Modify sets:',' ','add (manually)',
*item EDPCDB
'Parameter a to j are general building parameters'
'required by CPCALC and are defined in the model'
'In "facade coordinates" the user can define for which'
'coordinates he wants to calculate pressure'
'"Calculate pressure coefficients" runs CPCALC.'
*enditem
            CALL PHELPD('cpcalc in mfs',7,'-',0,0,IER)
*item EDPCDB
'You can delete one pressure coefficient set'
*enditem
          CALL EPICKS(IX,IVAL,'Delete which one?',' ',
*item EDPCDB
'Chance to abort deletion of pressure coef set.'
*enditem
          CALL ASKOK(' ',' Are you sure? ',OK,dok,1)
*item EDPCDB
*enditem
          CALL EPICKS(IX,IVAL,'Copy which one?',' ',
*subroutine EDPCST
*item EDPCST
'Give a name for the pressure coefficient set'
*enditem
      CALL EASKS(HOLD2,'Name of pressure coefficient set',
*item EDPCST
'The values for the pressure coefficients should be '
'between -1.5 and 1.5.'
'The first pressure coefficient is defined as NORMAL'
'to the surface (see drawing) and the following'
'coefficients are defined at steps of 22.5 degree'
'in a clockwise direction.'
'   _____ '
'        |'
'        |'
'        |  <----'
'        | The first pressure coefficient is defined'
'   _____| as NORMAL to the surface'
*enditem
      CALL EASKS(HOLD,outs,' ',72,
*item EDPCST
*enditem
      CALL EASKS(HOLD,outs,' ',72,
*subroutine ERPRCDB
*subroutine prj
*item prj exit_without_save
'If you exit without saving, recent changes could be'
'lost. If you selected this option in error select'
*enditem
          CALL EASKABC('There are unsaved changes in the model.',
*item prj prj_welcome
'Welcome to the ESP-r Project Manager, a tool to'
'help you specify, appraise and evolve your energy'
'system designs.'
' '
'If you are new to ESP-r, you might like to start'
'by selecting the tutorial button and browsing the'
'information available at www.esru.strath.ac.uk. There'
'is also a paper manual included with the source code'
' '
'Please contact ESRU at the email address shown in the'
'header should you require further information or wish'
'to suggest tool enhancements.'
' '
'To list the invocation options supported by this tool'
'enter `esp-r -help` at the command line prompt.'
' '
'If you need to work with complex models then '
'you will need to update the parameters in the '
'source include folder, re-compile ESP-r and '
'then test it on increasingly complex models. '
' '
'The version of prj supports models of the following'
'(maximum) complexity: '
' '
*enditem
        CALL PHELPD('Introduction',35,'gen_esp_intr',0,0,IER)
*item prj prj_exemplar_or_other
'The ESP-r system includes a number of example models'
'that demonstrate different modelling capabilities.'
'Alternatively, you can select another existing model,'
'perhaps one you created earlier or have received from'
'a colleague.'
*enditem
        CALL EASKABC(' ','Model selection options:',
*item prj command_line_cfg_file
'The model configuration file holds the definition'
'of the model to be simulated, including the names'
'of the composing files.  A configuration file'
'has been passed to the Project Manager as a command'
'line argument.'
' '
'If you selected this option in error click cancel. '
*enditem
            CALL EASKABC(outs,' ','use it as the model',
*item prj model_root_name
'This root name will be used to create the'
'ESP-r model folder structure that holds key'
'files such as the system configuration file.'
'  '
'If you have altered the name of the configuration'
'file you may want to modify the root name as well.'
*enditem
          CALL EASKS(t24,' ','Project root name (<24 chars)?',
*item prj prj_model_title
'Each model has an associated descriptor (<72 chars),'
'which should be suitably informative, e.g.:'
' '
' PV-facade office, daylight controlled, base case.'
*enditem
          CALL EASKS(ltmp,' ','Model description?',
*item prj updated_cfg_file_name
'The current model description will be copied'
'into this file.'
*enditem
   89     CALL EASKS(ltmp,' Updated configuration file?',
*item prj model_cnn_file_name
'The surface topology of the model is held'
'in a connections file.'
*enditem
              CALL EASKS(ltmp,' Surface connections file name?',' ',
*subroutine simula
*item simula prj_simulation_menu
' option p: Normally an integrated simulation is invoked by which'
'   the heat, fluid, electrical power and light flows within'
'   combined building/plant models may be evaluated.'
'  '
'   The integrated simulation option computes the pressure'
'   induced fluid flow within a network of connected flow'
'   components representing the building and/or plant'
'   system in whole or part.' '
'  '
' option r: fluid flow only invokes the mass flow solver if'
'   one exists and it uses fixed boundary conditions during'
'   the solution.  This can be useful for checking whether'
'   a flow network will solve.
'   If a CFD domain is defined then a CFD only 2D or 3D steady'
'   state or transient assessment will be started based on'
'   fixed boundary conditions and bouyancy effects. For models where'
'   this assumption is inappropriate, the Integrated simulation'
'   option should be used.'
'  '
' option s: this starts up the utility application e2r to generate'
'   a Radiane visual model from the current ESP-r model.'
'  '
' option t: If you have previously defined an Integrated Performance'
'   View (IPV) this option can be used to run the associated'
'   assessments and extract the required performance metrics and'
'   write them to an IPV report file. Some users use this to'
'   automate assessment tasks (it can run up to 5 simulations with'
'   no user interactions) or to break huge model assessments into'
'   managable seasonal results files.'
'  '
' option u: In the UK this can be used to automatically create the'
'   model variants (notional, reference etc.) and run the assessments'
'   used by the UK National Calculation Method.'
*enditem
        CALL PHELPD('Simulation',14,'-',0,0,IER)
        CALL EASKABC('Fluid flow analysis via:',' ','Nodal Network',
        CALL ASKOK('  ',' Proceed with parameter definitions?',
        CALL EASKABC(' ','Simulation interaction options:',
*item simula prj_sim_set_name
'Typical names are winter spring summer. You could also'
'give specific names such as test22 as long as it is less'
'than eight characters.'
*enditem
            CALL EASKS(de,'Name for set?',' ',8,'win','set name',IER,1)
*item simula prj_sim_set_menu
'Simulation options can be defined in advance with this facility and'
'and these preferences can be recorded in named sets (e.g. winter|'
'spring|summer|hottest) so that specific assessments can be invoked.'
'A simulator command line option uses these preferences to drive the'
'assessment silently or to provide defaults for interactive dialogs.'
'  '
'There is a relationship between Integrated Performance Views (IPV)'
'(see the model context menu) and simulation parameter sets. If'
'an IPV has been defined its directives will populate this menu.'
'  '
' option a: use this to select an existing parameter set (its values'
'   will be displayed and will be used if a simulation is requested.'
'  '
' option b: use this to name/re-name a set. You can use up to 8 char'
'   (no spaces). If an IPV has been defined these set names will be'
'   set and should not be edited.'
'  '
' option c: the pre-simulation start-up period is required to'
'   isolate the effects of initialisation assumptions from'
'   the simulation results. The suggested value, which is'
'   computed automatically, may be overridden.'
'  '
' option d: building-side timesteps range from 1 to 60 per hour.'
'   If the model includes temporal definitions data then'
'   you are advised, if possible, to set the building-side time step'
'   to match the value used for the temporal definitions.'
'  '
'   You will also be asked whether you want to save predictions'
'   at each timestep or as averaged data once per hour. This can'
'   save lots of disk space - but looses some of the reporting'
'   resolution in sub-hourly assessments. Consider this for short'
'   timestep runs where disk space is limited.'
'  '
' option e: Plant-side time step is an integer subdivision'
'   of the active building side time steps per hour. If you have'
'   a 6 tsph on the building side and 10 plant-side timesteps the'
'   plant will be assessed once per minute.'
'  '
' option f: the save level determines how much information is'
'   written to the zone results library:'
'   Level 0 - summary table written to an ASCII file'
'   Level 1 - zone temperatures and plant demand only'
'   Level 2 - as 1 + zone surface temperatures'
'   Level 3 - as 2 + zone construction node temperatures'
'   Level 4 - as 3 + zone and surface energy balances'
'   Level 6 - summary database friendly format or csv file'
'  '
' option g: the simulation period of the current assessment set'
'  '
' options h/i/j/k/l/m: you can pre-define the names of the results'
'   files that are to be created (great for simplifying scripts and'
'   enforcing naming strategies). If you defined an IPV these names'
'   will already have been determined.'

'After running an assessment, your next step is to explore the'
'predictions via the results analysis module the correct results file'
'should be identified automatically. NOTE: if you have run several '
'assessments, you should select the correct parameter set first. '
*enditem
          CALL PHELPD('Simulation sets',20,'-',0,0,IER)
          CALL EASKI(isstupt,' ',
        CALL EASKI(isbnstept,' ','Zone-side time steps per hour?',
        call askok(' Hourly results integration:',' ',hri,
          CALL EASKI(ispnstept,' ',
        CALL EASKI(issavet,' ','Results save level (0-4 & 6)?',
        call EASKPER('Assessment period:',ISDS,ISDF,IFDAY,IER)
        CALL EASKS(t72,' ','Building results library?',72,
          CALL EASKS(t72,' ','Network flow results library?',72,
          CALL EASKS(t72,' ','Plant results library?',72,
          CALL EASKS(t72,' ','Moisture results library?',72,
          CALL EASKS(t72,' ','Electrical results library?',72,
*item simula prj_ipv_res_file
'If you request an IPV assessment (option t) then as the performance'
'data is recovered from the ESP-r results files they are written into'
'an ASCII file which can later be accessed via an IPV report viewer'
'or opened up in a text editor.'
*enditem
          CALL EASKS(t72,' ','IPV transfer file name?',72,
*subroutine ipvactions
*item ipvactions prj_ipv_options
'An Integrated Performance View (IPV) is a collection'
'of standard performance indicators that have been'
'pre-defined. Some of the underlying assumptions may'
'be changed via the IPV facility in the Model Context menu.'
'  '
'If there is sufficient information to undertake assessments'
'(e.g. the model is syntactically correct and the IPV definition'
'if complete then you will be offered the following:'
' '
'The option to run required simulations will invoke '
'as many simulations as required, saving the results '
'to the files specified in the simulation parameter '
'sets.  '
'  '
'Interactive mode uses simulation parameters as defaults'
'which you can then confirm. The silent running mode uses'
'the parameters to run in automatic mode.'
'  '
'Extracting IPV reports is done by invoking the res module'
'with specific command line parameters. Results extraction'
'is usually done in a silent mode as there is minimal user'
'interaction required. '
'  '
'The recovery option you will want to select is ALL (the'
'intermediate step is no longer required).
'  '
'You can compare two IPV reports, extracting and reporting'
'on the differences found. The report includes both nominal'
'and whole building values for the following performance metrics:'
' '
' *for each variant it reports heating demand kWh/m^2/a'
'  and for the whole model (kWh/a), heating capacity kW/m^2'
'  and for the whole model (kW/a diversified).'
' *for each variant it reports heating therms (converted'
'  as kWh * 0.0341296)'
' *for each variant it reports cooling demand kWh/m2/a'
'  and for the whole model (kWh/a), cooling capacity kW/m^2'
'  and for the whole model (kW/a)'
' *difference in heating, therms and cooling by area and'
'  for the whole building.'
'  '
'When generating the comparison report you have the option of'
'using different delimeters:'
'  - spaces (use spaces to lineup columns);'
'  - single space between columns;'
'  - comma separator (e.g. for excel);'
'  - tab separator (e.g. for excel);'
'  - tagged (marked up data).'
'  '
'After defining the delimeter to be used to report the'
'results of the comparison you will be asked to provide'
'the names of the IPV rpoert for the base case model'
'(or the model you want to reference against).'
'  '
'And then you are asked for the second IPV report file.'
*enditem
      CALL PHELPD('IPV message',4,'-',0,0,IER)
      CALL EASKABCD(' ','IPV options:',
      CALL EASKABC(' ','Simulation options:',
      CALL EASKABC(' ','IPV extraction options:',
      call easkabcd('IPV recovery options:',' ','intermediate',
      CALL EASKATOG('Column delimeter:',' ',
      CALL EASKF(basefile,'IPV base case report file ?',
      CALL EASKF(variantfile,'IPV variant report file ?',
      CALL EASKAB('Comparison options:',' ','return to menu',
*subroutine checkmodel
*item checkmodel has_unknown_attributes
'A model with UNKNOWN surface construction attributes'
'cannot be simulated. You can see where by clicking ok.'
*enditem
        call askok(
        CALL PHELPD('lacking construction attrib',lh,'-',0,0,IER)
        call askok(
        CALL PHELPD('questioned boundary attrib',lh,'-',0,0,IER)
*item checkmodel  has_unknown_connects
'A model with inconsistent surface topology attributes'
'might fail when simulated. This will list where.'
*enditem
        call askok(
          CALL PHELPD('questioned boundary attrib',lh,'-',0,0,IER)
        CALL PHELPD('boundary checks',lh,'-',0,0,IER)
*item checkmodel has_unknown_files
'The model was scanned for missing files. These are:'
*enditem
        CALL PHELPD('geometry checks',lh,'-',0,0,IER)
        CALL PHELPD('operations checks',lh,'-',0,0,IER)
        CALL PHELPD('constructions checks',lh,'-',0,0,IER)
*item checkmodel has_unknown_shading
'The model was scanned for missing or corrupt shading files:'
*enditem
        CALL PHELPD('shading checks',lh,'-',0,0,IER)
*subroutine imgdisp
*subroutine CFGVER
*item CFGVER
'Images can be associated with a model for various'
'purposes: '
' * document conditions at the physical site'
' * document assumptions in the model'
' * indicate what performance is expected'
'   '
'Images are added to a model via the context->images'
'with a model. '
'Images of type GIF and XBM and JPG are supported.'
 'This menu supports the creation of design variants.'
 'The assumption is that a working model exists from'
 'which other permutations can be derived.'
 ' '
 'Variants may be created in the following ways.'
 ' '
 'Project Variant: asks specific questions about the '
 'changes the user wishes to make to the model. The'
 'changes once implemented are saved to new model'
 'files, i.e. the original model is preserved.'
 ' '
 'For example, a variant corresponding to a different'
 'location will require a different climate file,'
 'modified ground temperatures and recalculated shading'
 'factors.'
 ' '
 'As another example, a variant with alternative'
 'constructions may requires new geometry, construction'
 'and optical property files.'
 ' '
 'Several changes may be applied within a single'
 'variant.'
 ' '
 'A five character postfix is requested from the'
 'user and this is appended to the names of new files.'
 ' '
 ' '
 '*****SBEM Notional Model*****'
 ' ESP-r creates the SBEM notional model in compliance with'
 ' CIBSE TM33 ??? This creates a model with the postfix'
 ' _not [i.e. filname.cfg is copied to filename_not.cfg]'
 ' '
 ' Details of how the notonal building relates to the '
 ' original building and plant model is defined in relevant'
 ' SBEM documentation'
 ' '
*enditem
        CALL EASKS(APP,' ',
*item CFGVER
*enditem
        CALL EASKS(modeltitle,' ','Description for this variant?',
*item CFGVER
'Change options:'
' global tasks - work in progress - use with caution.'
' '
' site exposure & ground reflectivity - modifies these'
'   values within revised configuration file.'
' '
' geometry & attribution - copies zone files so that'
'   subsequent changes are saved to new files. If there'
'   are viewfactor, shading, obstruction, hc regime or'
'   or casual gain ctl files these are copied as'
'   well as revised configuration and connections files.'
' '
' shading - if selected will duplicate and then update'
'   existing shading files e.g. a change in site.'
' '
' climate data & latitude/longitude - finds dependencies'
'   associated with such changes (ground temps, shading,'
'   IPV) and updates the model accordingly.'
' '
' pressure distributions - either alters cp definitions'
'   (so-called cpcalc method) or copies and then edits'
'   pressure distributions database.'
' '
' glazed area - not yet operational'
' '
' zone constructions - copies geometry, construction '
'   and tmc files to hold subsequent changes by the'
'   user. Also creates variant connections and model'
'   configuration file. If number of surfaces will'
'   be altered select `geometry & attribution` first.'
' '
' materials database - makes copy of current database'
'   to hold subsequent changes by the user.'
' '
' cfd domain - makes copy of current domains to hold'
'   subsequent changes by the user.'
' '
' ground temperature profiles - select this if site'
'   details are being altered.'
' '
' convection regimes - make copy of current regimes'
'   to hold subsequent changes by the user'
' '
' active materials - not yet implemented'
' adaptive gridding - not yet implemented'
' '
' building integrated reneuables - not yet implemented'
' '
' integrated performance view - select this to update'
'   documentation and title (probably should be done'
'   in conjunction with any other variant task).'
' '
' flow network - copy current network to hold'
'   subsequent user changes.'
' '
' schedules - copy current zone operations to hold'
'   subseuent user changes.'
' '
*enditem
          CALL PHELPD('version tasks',58,'-',0,0,IER)
*item CFGVER
*enditem
        CALL PHELPD('version intro',36,'-',0,0,IER)
*subroutine VERMAN
*item VERMAN
'global tasks currently not supported'
*enditem
        CALL PHELPD('global tasks not supported',1,'-',0,0,IER)
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
'The site exposure defines the relative view factors'
'between a vertical surface and the sky, ground and'
'surrounding buildings.  These data are used in the'
'calculation of external longwave radiation exchanges.'
*enditem
        CALL EPICKS(IX,IVALSS,' ',' Site exposure:',
*item VERMAN
'0 <= Sky view factor <= .99'
*enditem
  290     CALL EASKR(skyview,' ',' Sky view factor?',
*item VERMAN
'0 <= Ground view factor <= .99'
*enditem
          CALL EASKR(groundview,' ',' Ground view factor?',
*item VERMAN
'0 <= Surroundings view factor <= .99'
*enditem
          CALL EASKR(buildingview,' ',' Surroundings view factor?',
*item VERMAN
'0 <= ground reflectance <= .99'
*enditem
        CALL EASKR(groundrefl,' ',' Ground reflectance?',
*item VERMAN
'There are no current instructions to evaluate detailed'
'shading and/or insolation patterns. '
' '
'You can nominate zones which you want to include an'
'insolation analysis (i.e. track direct solar radiation'
'within zones). '
' '
'You can nominate zones which you want to create solar'
'obstructions in so that shading and insolation can'
'be assessed.'
' '
'Selecting continue at this point you will be asked'
'if you want to make any other changes to the model'
'before the information is written out. '
*enditem
          CALL EASKABC(
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
'The model includes detailed evaluations of'
'shading and/or insolation patterns. '
' '
'You can nominate zones which you want to dereference'
'the insolation analysis (select from provided list)'
' '
'You can nominate zones which you want to dereference'
'obstruction(s). Note: does not remove the file only'
'the reference to the obstruction file. '
' '
'You can nominate zones which you want to dereference'
'both obstructions and shading files. Note: does not'
'remove the files only the reference.'
' '
'You can either modify existing obstruction files '
'or create obstructions for zones which do not'
'have any. In both cases place-holder shading'
'files will also be created.'
' '
'Note: modifications to obstructions files does not'
'have an impact on zone geometry files. '
' '
'Selecting continue at this point you will be asked'
'if you want to make any other changes to the model'
'before the information is written out. '
*enditem
          CALL EASKATOG(
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
'Area weighted is a simplified techniques that is'
'appropriate where geometry has been approximated.'
'Otherwise choose ray traced, which is accurate'
'(but time consuming).'
*enditem
          CALL EASKABC('View factor options:',' ',
*item VERMAN
*enditem
          CALL EASKS(ipvtitl,'Enter project title for this variant?',
*item VERMAN
*enditem
          CALL EASKS(ipvvers,'Enter project version for this variant?',
*item VERMAN
*enditem
          CALL EASKS248(ipvsynop,'Synopsis',' ',72,
*item VERMAN
 'Pressure coefficients are used to calculate pressure'
 'distribution. These are defined at two levels.'
 'Building parameters include overall dimensions, roof'
 'detail, plan area etc. Invoking this facility will'
 'allow these values to be changed.'
 'The database option defines pressure coefficients that'
 'are used where an air flow network exists.'
*enditem
        CALL EASKABC('Change to be made to:',
*item VERMAN
*enditem
          CALL ASKOK('  ','Edit database now?',OK,DOK,5)
*item VERMAN
'glazing area currently not supported'
*enditem
        CALL PHELPD('glazing area not supported',1,'-',0,0,IER)
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
*enditem
          CALL ASKOK('  ','Edit CFD data now?',OK,DOK,5)
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
'active materials currently not supported'
*enditem
        CALL PHELPD('active mat not supported',1,'-',0,0,IER)
*item VERMAN
'adaptive gridding currently not supported'
*enditem
        CALL PHELPD('adaptive gridding not supported',1,'-',0,0,IER)
*item VERMAN
'renewables currently not supported'
*enditem
        CALL PHELPD('renewables not supported',1,'-',0,0,IER)
*item VERMAN
*enditem
          CALL EASKS(ipvtitl,' Enter project title for this variant?',
*item VERMAN
*enditem
          CALL EASKS(ipvvers,' Enter project version for this variant?'
*item VERMAN
*enditem
          CALL EASKS248(ipvsynop,'Synopsis',' ',72,
*item VERMAN
*enditem
          CALL EASKS(ipvtitl,' Enter project title for this variant?',
*item VERMAN
*enditem
          CALL EASKS(ipvvers,' Enter project version for this variant?'
*item VERMAN
*enditem
          CALL EASKS248(ipvsynop,'Synopsis',' ',72,
*item VERMAN
'electrical network currently not supported'
*enditem
        CALL PHELPD('electrical net not supported',1,'-',0,0,IER)
*item VERMAN
'plants currently not supported'
*enditem
        CALL PHELPD('plant not supported',1,'-',0,0,IER)
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
'casual gains currently not supported'
*enditem
        CALL PHELPD('Not supported',1,'func not supported',0,0,IER)
*item VERMAN
'event profiles currently not supported'
*enditem
        CALL PHELPD('Not supported',1,'func not supported',0,0,IER)
*item VERMAN
'Moulds and mycotoxins not currently supported.'
*enditem
        CALL PHELPD('Not supported',1,'func not supported',0,0,IER)
*item VERMAN
'You may wish to make a number of changes to the'
'model variant. If so, select another option.'
' '
'Remember all the affected files will have the variant'
'extension characters in their file name.'
*enditem
      CALL ASKOK(' ','Make more changes?',OK,DOK,5)
*subroutine FNCNGR
*subroutine PRJDMDS
*item PRJDMDS
'Each model has a master calendar which indicates the'
'day type for each Julian day (initially based on the'
'year and a basic Weekday Saturday Sunday scheme. '
' '
'No calendar has been defined so if you want the basic '
'Weekday Saturday Sunday scheme it will be created. If '
'you want to setup a more specific calendar then you '
'should do that first. '
*enditem
        CALL EASKABC('Calendar options','(see help) :',
*item PRJDMDS
'A project demands file contains project level info'
'on fans, pumps, lifts, DHW demands which may '
'be applied to an integrated performance view. '
*enditem
      CALL EASKS(ltmp,' Project demands file name: ',
*item PRJDMDS
'Dispersed demands are casual gains which are not'
'associated with a specific zone in the model.'
'Examples are fans and lifts and their electrical'
'requirements are often taken into account in '
'reports on building energy use. '
' '
'This facility allows you to define schedules for'
'seven types of dispersed gains either as W/m2 '
'or in absolute W. '
' '
'If the calendar of the model (see Model context)'
'includes the standard Weekday Saturday Sunday day '
'types then you may work at that resolution. If you'
'have also defined holidays then dispersed gains can '
'also be assigned (UNDER TESTING) '
' '
' '
'The data requirements are summarized below :- '
' 1) Description '
' 2) For each calendar day type e.g. Weekday, Saturday,'
'    Sunday, holiday (etc.) demands data:'
'       Start and finish hours for each period'
'       Casual gain type:'
'         type 1: usually occupant demands'
'         type 2: usually lighting demands'
'         type 3: usually small power demands'
'         type 4: usually fan demands'
'         type 5: usually pump demands'
'         type 6: usually lift demands'
'         type 7: usually DHW demands'
'       Sensible and Latent magnitudes'
'       Radiant and Convective portions'
'The dispersed demand periods do not cover the entire'
'day or might have gaps or overlaps. You should correct'
'this prior to leaving this facility. If you say no then'
'the dispersed demands might be mis-interpreted. '
*enditem
          CALL askok(
*item PRJDMDS
'Recent changes might be lost if you do not save the'
'data. '
*enditem
          CALL askok(' Before exiting do you wish to save any',
*item PRJDMDS
'A project demands file contains project level info'
'on fans, pumps, lifts, DHW demands which may '
'be applied to an integrated performance view. '
*enditem
          CALL EASKS(LTMP,' Project demands file name: ',
*item PRJDMDS
'Project demands schedules have notes'
'(<248 char) which will be included in reports.'
*enditem
        CALL EASKS248(tcname,' Dispersed demands notes: ',' ',
*item PRJDMDS
'Optional base area associated with each demand type. '
'This will be used to support IPV creation for period '
'data which is per m^2. '
*enditem
        CALL EASKS(hold,
*item PRJDMDS
'A project demands file contains building level info'
'on fans, pumps, lifts, DHW casual gains which may '
'be applied to an integrated performance view. '
*enditem
        CALL EASKS(LTMP,' Dispersed demands file name: ',
*item PRJDMDS
'Older file format does not include a date stamp.'
'If you say ok then a newer format will be used. '
*enditem
          CALL askok(
*item PRJDMDS
'A problem was encountered while trying to save the'
'demands to file. Check that you have permission to'
'update the file and that you have sufficient disk '
'space. '
*enditem
            CALL ASKOK(' ',
*item PRJDMDS
*enditem
        CALL PHELPD('demands help 1',35,'-',0,0,IER)
*subroutine EDBCAS
*item EDBCAS
'Casual gains are defined via one or more periods, the'
'magnitude at a given time being the summation of the '
'gains in all periods which include that time.  In '
'this way complex patterns may be described. '
' '
'Please note that neither the order in which periods'
'are described nor their position in the display is'
'important.  You may use an `additive` or `sequential`'
'approach or a combination as you choose. '
' '
'You may insert or delete a period at any point in '
'the list by selecting it`s key  (a,b,c...).'
' '
'See section 3.4 of the users manual for more info. '
*enditem
        CALL PHELPD('gains menu',14,'-',0,0,IER)
*item EDBCAS
'You can apply a scaling factor to all entries of a '
'particular casual gain type (useful for parametric '
'studies on profiles which have been imported).'
*enditem
        CALL EASKATOG('Apply scaling factor to which casual gain type?',
*item EDBCAS
*enditem
        CALL EASKR(VAL,' ',' Factor to be applied (0.1 to 5.0) ',
*item EDBCAS
*enditem
        CALL EASKAB(' ','Modify list:','delete period','insert period',
*item EDBCAS
'Period during which demand applies. '
*enditem
        CALL EASKS(hold,outs,' : ',40,' 0 24 ','st-fn hr',IER,1)
*item EDBCAS
'The type of demand can be one of those listed in the '
'selections. '
*enditem
        CALL EASKATOG('Which casual gain type?',
*item EDBCAS
*enditem
        call easkab('Are values',' ','absolute','per m^2',IW,8)
*item EDBCAS
'Sensible and latent demands are specified in '
'Watts. '
'Also supply the radiant and convective fraction for'
'the sensible load (should sum to ~1.00) '
*enditem
        CALL EASKS(HOLD,
*subroutine SBCASL
*item SBCASL
'Any one of the profiles may be selected.'
*enditem
      CALL EPICKS(IX,IPRVAL,' ',' Profiles in database: ',
*item SBCASL
'Project level demands can be be designated to be '
'of one of four user-defined types so that for example '
'pump demands can be separately tracked from that of '
'other equipment.  Values from 1 to 4 are accepted'
'and can have any meaning that the user chooses. '
*enditem
      CALL EASKATOG(' ','Type of casual gain: ',ll1,ll2,ll3,ll4,ll5,
*item SBCASL
*enditem
      call easkab('Are values',' ','absolute','per m^2',IW,5)
*item SBCASL
'In order to expand the profile into energy values the'
'sensible and latent load in Watts equivalent to 100% is'
' required. '
' '
'Also supply the radiant and convective fraction for the'
'sensible load (these normally should sum to 1.00) '
*enditem
      CALL EASKS(HOLD,
*subroutine PRJFMK
*item PRJFMK
'The zone operations file was not found or has not'
'yet been created. The file contains schedules of air'
'flow and casual gains. Air flows may have thermostatic'
'or wind speed control. If electrical details are'
'included then casual gains and electrical loads are'
'combined into a `zone load`.'
' '
'The browse option presents a list of files in the'
'project `zones` folder in case you want to share.'
'the same definition as used by another zone.'
*enditem
          CALL EASKSCMD(LTMP,' ','Zone operations file options:',
*item PRJFMK
*enditem
          CALL EASKS2CMD(LTMP,' ','Zone operations file options:',
*item PRJFMK
'Operations details have already been defined for this'
'zone so if you want to use and/or modify the current'
'definition accept the presented file.'
' '
'A zone operations file contains schedules of air flow'
'and casual gains. Air flows may have thermostatic or'
'wind speed control. If electrical details are included'
'then casual gains and electrical loads are combined'
'into a `zone load`.'
' '
'The browse option presents a list of files in the'
'project `zones` folder in case you want to associate'
'another operations file with the current zone In that'
'case you the file will be shared between zones so that'
'any change to its contents will affect more than one'
*enditem
          CALL EASKSCMD(LTMP,' ','Confirm zone operations file:',
*item PRJFMK
*enditem
          CALL EASKS2CMD(LTMP,' ','Confirm zone operations file:',
*item PRJFMK
*enditem
            CALL EASKS(LTMP,' ','Zone operations file name?',
*item PRJFMK
*enditem
          CALL EASKS(LTMP,' ','Zone operations file name?',
*item PRJFMK
'Options: '
' define from scratch - you are asked to define all'
'   casual gain periods for each day type as well as'
'   schedules of infiltration and ventilation.'
' '
' import air flow schedules - you select a zone with an'
'   air flow schedule pattern and it is copied into this'
'   zone, optionally with adjustments if the zone'
'   volumes are different. You can then define the'
'   casual gains.'
' '
' import casual gains - you select a zone with casual'
'   gain patterns and they are copied into this zone,'
'   optionally with adjustments if the zone base areas'
'   differ.'
' '
' import air flows and casual gains - both of the above'
'   and you will be given the option to import air'
'   flow schedules casual gains from different zones'
'   (You may wish to note which zones you used and'
'   include this in the documentation of the zone'
'   operations file.)'
' '
' import < pattern - has the same functionality as above'
'   except that the list of operations files are taken'
'   from a folder within the standard ESP-r distribution'
'   located on your computer. Files placed in this'
'   folder serve as a resource for often-used patterns'
'   of casual gains and scheduled air flows.'
' '
' nothing happens in the zone - does just this. It fills'
'   the file with zero occupants, lights, small power'
'   and no infiltration or ventilation for all day types.'
' '
'After initiating one of the above actions you can edit'
'the data as required. '
'A zone operation file contains schedules of air flow'
'and casual gains.  Air flows may have thermostatic'
'or wind speed control. '
*enditem
          CALL EASKS(LTMP,' ','Zone operations file name?',
*item PRJFMK
*enditem
          CALL PHELPD('operation choices',36,'-',0,0,IER)
*item PRJFMK
*enditem
            call askzone(isource,izdef,
*item PRJFMK
*enditem
          CALL EASKABC(' ','Options:','all flow schedules & ctl',
*item PRJFMK
*enditem
          CALL EASKABC(' ','Infiltration import:','preserve ac/h',
*item PRJFMK
*enditem
            CALL EASKABC(' ','Ventilation import:','preserve ac/h',
*item PRJFMK
'New operations for this zone. Please check your notes'
'and provide initial casual gain period start times'
'for each day type (Weekday, Saturday, Sunday etc.) and'
'for each casual gain type (occupants, lighting and'
'small power). Do not include periods to be imported'
'from events profiles.'
' '
'Example of a schedule including 6 periods:'
' '
'       |       ________               '
' Watts |       |      |___            '
'       |    ___|         |____        '
'       |   |   schedule       |       '
'       |___|____..____________|_______'
'       0   7  10..    13  14  18    24'
'                   Time'
' '
'The default assumption is that there is one period'
'(from 0h00 to 24h00) with zero sensible and latent'
'gains for each casual gain type on each day type.'
'This ensures that nothing is happening in the zone'
'until you provide relevant information (e.g. insert'
'at least one period and define a casual gain).'
*enditem
          CALL PHELPD('operation setup',23,'-',0,0,IER)
*item PRJFMK
*enditem
            call askzone(isource,izdef,'Casual gains from which zone?',
*item PRJFMK
*enditem
          CALL EASKABC(' ','Casual gain import:','preserve Watts',
*item PRJFMK
'An automated process has been used to manage the imported'
'schedules. It is recommended that you confirm that the'
'resulting file is correct. '
' '
'One approach is to generate a new QA report and check this'
'against the previous model and then run a short assessment'
'to confirm that performance is as expected.'
*enditem
          CALL PHELPD('operation import confirm',7,'-',0,0,IER)
*item PRJFMK
'A summary of the data held within a zone operations file'
'follows.'
' '
' 1) Operations description - up to 248 characters'
'    summarising what is happening in the zone.'
'  '
' 2) Weekday, Saturday, Sunday (& other day types if '
'    defined) air flow data:  start and finish hours '
'    for each period infiltration and ventilation rates '
'    (ACH) coupling index: '
'         > 0 is coupled zone number'
'         = 0 source at specified temperature'
'  '
' 3) Air flow thermostatic control definition:'
'       sensed zone number '
'       upper and lower limits'
'       upper and lower air flow rates'
' '
'The relationship between control and schedules is'
'as follows.                          '
' '
'      |       ________               '
' ac/h |       |      |___            '
'      |    ___|         |____        '
'      |   |   scheduled rate |       '
'      |___|____:_____________|_______'
'               : <- time ->          '
'      |        :                     '
' ac/h |flow |  V     | flow | flow | '
'      |__x__|________|___y__|__z___| '
'       low   default   high  extreme '
'         <-  temperature ranges  ->  '
' '
' 4) Weekday, Saturday and Sunday (& other day types if '
'    defined) casual gains data: start and finish hours '
'    for each period casual gain type:'
'         1: usually occupants'
'         2: usually lighting'
'         3: usually equipment'
'       sensible and latent load magnitudes'
'       radiant and convective portions'
' '
'Where electrical data are associated with a particular'
'zone load (to enable electrical simulation), the'
'required data items are: power factor,load type'
'(inductive or capacative), real power consumption,'
'operational voltage and the generator phase to which'
'the load is connected.'
'You are asked this question because periods'
'might have been altered and require re-sorting. '
*enditem
            CALL ASKOK(
*item PRJFMK
'You are asked this question because changes were'
'detected in the zone operations schedules and '
'you might loose this information if you exit without'
'saving the changes.'
*enditem
          CALL ASKOK('Before exiting do you wish to',
*item PRJFMK
'Notes (<248 char) for schedules of zone air flow and'
'casual gains can be included in the model. Use this'
'facility to clarify what is happening in the zone.'
*enditem
          CALL EASKS248(tcname,' ','Zone operations notes:',
*item PRJFMK
'Notes (<248 char) for schedules of zone air flow can'
'be included in the model. Use this facility to'
'clarify what is happening in the zone.'
*enditem
          CALL EASKS248(tcname,' ','Zone scheduled air notes:',
*item PRJFMK
'Notes (<248 char) for schedules of zone air flow and'
'casual gains can be included in the model. Use this'
'facility to clarify what is happening in the zone.'
*enditem
          CALL EASKS248(tcname,' ','Zone operations notes:',
*item PRJFMK
'A zone operations file contains schedules of air flow'
'and casual gains.  Air flows may have thermostatic'
'or wind speed control. If electrical details are  '
'included then casual gains and electrical loads are'
'combined into a single zone load.'
*enditem
        CALL EASKS(LTMP,' ','Zone operations file name?',
*item PRJFMK
'You were presented with this message because a'
'problem was detected while trying to update the'
'zone operations file. Check that you have sufficient'
'disk space and/or permission to update the model'
*enditem
            CALL ASKOK('Problem encountered saving data!',
*item PRJFMK
*enditem
        CALL PHELPD('operation help',48,'-',0,0,IER)
*subroutine EDAFCTL
*item EDAFCTL
'This facility supports basic scheduled control of air'
'infiltration and ventilation based on temperatures or'
'wind velocity.'
*enditem
      CALL ASKOK(' ','Is air flow thermostatically controlled?',
*item EDAFCTL
'Control of air flow can be based on one of the'
'following parameters: '
' '
'* air temperature within the current zone;'
'* air temperature within another modelled zone;'
'* external air temperature;'
'* external wind velocity.'
' '
'Note that thermostatic or wind velocity control'
'applies to all days within a simulation.'
*enditem
      CALL EPICKS(IX,IVAL,' ','Air Flow Control Options',
*item EDAFCTL
'Air flow control can be restricted to infiltration'
'(outside), to ventilation (from another zone or at'
'specified temperature) or to both.'
*enditem
   12 CALL EPICKS(IX,IVALS,' ','Air flow control scope:',
*item EDAFCTL
'For temperature control the limit is in degC.'
'For wind speed control the limit is in m/s.'
' '
'Lower limit: point below which an alternative flow'
'  rate takes effect (e.g. closing windows when the'
'  lower limit is rached).'
' '
'Middle limit: point above which the 1st stage of an'
'  alternative flow regime takes effect).'
' '
'High limit: point above which a 2nd stage flow'
'  regime takes effect. (Set high, e.g. 100degC,'
'  to prevent use.)'
*enditem
      CALL EASKS(HOLD,' ',
*item EDAFCTL
'Infiltration is defined in terms of air changes per'
'hour. This value is used below the lower set point.'
*enditem
      CALL EASKR(VAL,' ','Lower range infiltration rate?',
*item EDAFCTL
'Ventilation is defined in air changes per hour. The'
'source can be another modelled zone or a constant'
'temperature source. In both cases the volumer flow'
'rate is relative to the current zone volume.'
*enditem
        CALL EASKABC(' ','Ventilation options:',
*item EDAFCTL
*enditem
          call askzone(iv,IVL(icomp),'Ventilation from which zone?',
*item EDAFCTL
*enditem
          CALL EASKR(VAL,outs,outs2,0.0,'F',200.0,'W',1.0,'lwr vnt',
*item EDAFCTL
*enditem
          CALL EASKR(VAL,' ','Lower range ventilation rate?',
*item EDAFCTL
*enditem
          CALL EASKR(V,' ',
*item EDAFCTL
'Infiltration is defined in air changes per hour. This'
'value is used if the temperature is above the mid-leve'
'set point but below the high level set point.'
*enditem
        CALL EASKR(V,' ','1st stage infiltration rate?',
*item EDAFCTL
'Mid level ventilation is imposed when the sensed'
'condition is between the middle and high set points.'
'Ventilation (zone coupled air flow) is defined as'
'air changes per hour. The source can be another'
'zone or at a specified constant temperature. In both'
'cases the volume flow rate is relative to the volume'
'of the current zone.'
*enditem
        CALL EASKABC(' ','First stage ventilation options:',
*item EDAFCTL
*enditem
          call askzone(iv,IVU(icomp),'Ventilation from which zone?',
*item EDAFCTL
*enditem
          CALL EASKR(VAL,outs,outs2,0.0,'F',200.0,'W',1.0,'mid vnt',
*item EDAFCTL
*enditem
          CALL EASKR(VAL,' ','Mid-range ventilation rate?',
*item EDAFCTL
*enditem
          CALL EASKR(V,' ','Mid range ventilation source temperature?',
*item EDAFCTL
'Infiltration is defined in air changes per hour and is'
'used when conditions exceed the high set point. If not'
'needed make the set point high, e.g. 100degC.'
*enditem
        CALL EASKR(V,' ','High stage infiltration rate?',
*item EDAFCTL
'High level ventilation is imposed when the sensed'
'condition exceeds the high set point. Ventilation'
'(zone coupled air flow) is defined as air changes per'
'hour. The source can be another zone or at a specified'
'constant temperature. In both cases the volume flow '
'rate is relative to the volume of the current zone.'
*enditem
        CALL EASKABC(' ','High stage ventilation options:',
*item EDAFCTL
*enditem
          call askzone(iv,IVH(icomp),'Ventilation from which zone?',
*item EDAFCTL
*enditem
          CALL EASKR(VAL,outs,outs2,0.0,'F',200.0,'W',1.0,'high vent',
*item EDAFCTL
*enditem
          CALL EASKR(VAL,' ','High-range ventilation rate?',
*item EDAFCTL
*enditem
          CALL EASKR(V,' ',
*subroutine EDAIR2
*item EDAIR2
'Air flows are defined via one or more sequential'
'periods, the magnitude at a given time being the'
'flow specified a period that includes that time.'
' '
'In cases where ventilation will occur with more'
'than one modelled zone then a fluid flow network'
'or temporal definition file should be employed.'
' '
'Note that large changes in flow rates between'
'periods can result in unacceptable interpolation'
' '
'The add/delete/copy/import option are as follows.'
' add - adds a period to one or all day types. BE SURE'
'   to read the extended help messages in this dialog'
'   to understand how to use the add function to insert'
'   a period into a profile.'
' '
' delete - deletes one or more periods (within a list'
'   of all periods in all days).'
' '
' copy - copies Weekdays to Saturdays or Weekdays -> '
'   Sundays or Saturdays -> Sundays'
' '
' import - copies infiltration, ventilation and control'
'   (or a subset of these data) from another zone.'
' '
'When importing you can specify whether to:'
' a) preserve the ac/h being imported, e.g. 1.5 ac/h in'
'    the source zone is 1.5 ac/h in the destination zone;'
' b) preserve the volume of air implied by the ac/h in'
'    the source zone, e.g. 1.5 ac/h in a 50m^3 source'
'    zone becomes 1.07 ac/h in a 70m^3 destination zone.'
*enditem
        CALL PHELPD('flows menu',33,'-',0,0,IER)
*item EDAIR2
'The options: '
'The add/delete/copy/import option are as follows.'
' add - adds a period to one or all day types. IF'
'   there is already a defined period which overlaps'
'   this period then the volumes of air flow will be '
'   summed.  For example: if there is a period from'
'   8h00-24h00 with 1ach infiltration and you want to '
'   add a period 20h00-24h00 with 0.5 the time from '
'   20h00-24h00 will become 1.5 ach.'
' '
'   If you want to adjust the profile so the inserted'
'   period has a different value then initailly'
'   give 0.0 for the flows. After the periods have'
'   been revised then edit the newly created period.'
'  '
'   The alternative approach is to edit the start and'
'   end time of the existing period so that a gap is'
'   created and then use the add facility to fill in'
'   the gap.'
' '
' delete - deletes one or more periods (within a list'
'   of all periods in all days).'
' '
' copy - copies Weekdays to Saturdays or Weekdays -> '
'   Sundays or Saturdays -> Sundays'
' '
' import - copies infiltration, ventilation and control'
'   (or a subset of these data) from another zone.'
' '
'When importing you can specify whether to:'
' a) preserve the ac/h being imported, e.g. 1.5 ac/h in'
'    the source zone is 1.5 ac/h in the destination zone;'
' b) preserve the volume of air implied by the ac/h in'
'    the source zone, e.g. 1.5 ac/h in a 50m^3 source'
'    zone becomes 1.07 ac/h in a 70m^3 destination zone.'
*enditem
        CALL EASKATOG(' ','Options (see help):',
*item EDAIR2
*enditem
          CALL EASKAB(' ','Add period to ','one day type',
*item EDAIR2
*enditem
            CALL EPICKS(IX,KSTR,' ','choose daytype to add period in'
*item EDAIR2
*enditem
            call askzone(isource,izdef,
*item EDAIR2
*enditem
          CALL EASKABC(' ','Import:','all flow schedules & ctl',
*item EDAIR2
*enditem
          CALL EASKABC(' ','Infiltration import:','preserve ac/h',
*item EDAIR2
*enditem
            CALL EASKABC(' ','Ventilation import:','preserve ac/h',
*subroutine EDAIR3
*item EDAIR3
'Air flows are defined via one or more sequential'
'periods, the magnitude at a given time being the'
'flow specified a period that includes that time.'
' '
'In cases where ventilation will occur with more'
'than one modelled zone then a fluid flow network'
'or temporal definition file should be employed.'
' '
'Note that large changes in flow rates between'
'periods can result in unacceptable interpolation'
' '
'The add/delete/copy/import option are as follows.'
' add - adds a period to one or all day types. BE SURE'
'   to read the extended help messages in this dialog'
'   to understand how to use the add function to insert'
'   a period into a profile.'
' '
' delete - deletes one or more periods (within a list'
'   of all periods in all days).'
' '
' copy - copies periods for different days e.g. Weekdays ->'
'   Sundays or Saturdays -> Sundays'
' '
' import - copies infiltration, ventilation and control'
'   (or a subset of these data) from another zone.'
' '
'When importing you can specify whether to:'
' a) preserve the ac/h being imported, e.g. 1.5 ac/h in'
'    the source zone is 1.5 ac/h in the destination zone;'
' b) preserve the volume of air implied by the ac/h in'
'    the source zone, e.g. 1.5 ac/h in a 50m^3 source'
'    zone becomes 1.07 ac/h in a 70m^3 destination zone.'
*enditem
        CALL PHELPD('flows menu',33,'-',0,0,IER)
*item EDAIR3
'The options: '
'The add/delete/copy/import option are as follows.'
' add - adds a period to one or all day types. IF'
'   there is already a defined period which overlaps'
'   this period then the volumes of air flow will be '
'   summed.  For example: if there is a period from'
'   8h00-24h00 with 1ach infiltration and you want to '
'   add a period 20h00-24h00 with 0.5 the time from '
'   20h00-24h00 will become 1.5 ach.'
' '
'   If you want to adjust the profile so the inserted'
'   period has a different value then initailly'
'   give 0.0 for the flows. After the periods have'
'   been revised then edit the newly created period.'
'  '
'   The alternative approach is to edit the start and'
'   end time of the existing period so that a gap is'
'   created and then use the add facility to fill in'
'   the gap.'
' '
' delete - deletes one or more periods (within a list'
'   of all periods in all days).'
' '
' copy - copies periods for different days e.g. Weekdays'
'   -> Sundays or Saturdays -> Sundays'
' '
' import - copies infiltration, ventilation and control'
'   (or a subset of these data) from another zone.'
' '
'When importing you can specify whether to:'
' a) preserve the ac/h being imported, e.g. 1.5 ac/h in'
'    the source zone is 1.5 ac/h in the destination zone;'
' b) preserve the volume of air implied by the ac/h in'
'    the source zone, e.g. 1.5 ac/h in a 50m^3 source'
'    zone becomes 1.07 ac/h in a 70m^3 destination zone.'
*enditem
        CALL EASKATOG(' ','Options (see help):',
*item EDAIR3
*enditem
          CALL EASKAB(' ','Add period to ','one day type',
*item EDAIR3
*enditem
            CALL EPICKS(IX,KSTR,' ','choose daytype to add period in'
*item EDAIR3
*enditem
            call askzone(isource,izdef,
*item EDAIR3
*enditem
          CALL EASKABC(' ','Import:','all flow schedules & ctl',
*item EDAIR3
*enditem
          CALL EASKABC(' ','Infiltration import:','preserve ac/h',
*item EDAIR3
*enditem
            CALL EASKABC(' ','Ventilation import:','preserve ac/h',
*subroutine EDAIRFL
*item EDAIRFL
'Period during which air flow applies.'
*enditem
        CALL EASKS(HOLD,OUTS,' ',16,' 0 24 ','air st-fn hr',IER,1)
*item EDAIRFL
'An air flow rate can be specified in air change per '
'hour or m^3/s.'
*enditem
        CALL EASKAB(' ','Air flow specified in:','AC/h',
*item EDAIRFL
'Supply the infiltration rate in ac/h.'
*enditem
            call EASKR(XACH,' ','Infiltration rate?',
*item EDAIRFL
'Supply the ventilation rate in ac/h relative'
'to the volume of the receiving zone.'
*enditem
            call EASKR(XACH,' ','Ventilation rate?',
*item EDAIRFL
'Supply the infiltration rate in m^3/s.'
*enditem
            call EASKR(XACH,' ','Infiltration rate?',
*item EDAIRFL
'Supply the ventilation rate in m^3/s relative.'
'to the volume of the receiving zone.'
*enditem
            call EASKR(XACH,' ','Ventilation rate?',
*item EDAIRFL
*enditem
          CALL EASKABC(' ','Ventilation air temperature:',
*item EDAIRFL
*enditem
            call askzone(IV,IPTX,'Ventilation from which zone?',
*item EDAIRFL
'Supply the ventilation air temperature in degC.'
*enditem
            call EASKR(XTA,' ','Supply temperature?',
*subroutine ADDAFP
*subroutine CDAIRFL
*item CDAIRFL
'One or more of the periods may be deleted.'
*enditem
        call EPICKS(ilistlen,IVERT,' ','Air flow period(s) to delete:',
*item CDAIRFL
'All the casual gains associated with a specified day type'
'can be copied to another day type.'
*enditem
        CALL EPICKS(IX,KSTR,' ','choose daytype to copy periods from',
*item CDAIRFL
*enditem
        CALL EPICKS(IX,KSTR,' ','choose daytype to copy periods to',
*subroutine COPYAIRFL
*item COPYAIRFL
'This is the suggested name for the file that will'
'hold the imported air flow schedules data. '
*enditem
          CALL EASKS(ltmp,' New zone operations file: (confirm) ',
*item COPYAIRFL
'Because this is a pattern file there is no associated'
'zone and to do a ratio we need an assumed volume. '
*enditem
          CALL EASKR(VAL,' ','Assumed volume of source?',
*subroutine CHKAIRFL
*subroutine PLTAIR
*subroutine EDCAS
*item EDCAS
'You were presented with this message because the'
'file is in an older format which might have overlaps'
'in the casual gain periods. The current definition'
'of casual gain periods does not support overlapping'
'periods and stores the periods by time and day type.'
' '
'It is recommended that you say YES and then check that'
'the updated periods are correct.'
*enditem
          call askok(' ','Sort and remove overlaps from casual gains?',
*item EDCAS
'Casual gains are defined via one or more periods, the'
'magnitude at a given time being the summation of the '
'gains in all periods which include that time.  In '
'this way complex patterns may be described. '
' '
'You may use an `additive` or `sequential` approach or'
'a combination as you choose.  The total gain is '
'displayed in the graphic feedback window.'
'  '
'If electrical definitions are included the menu will'
'show the power consumption of the load and the power'
'factor. The graphs will continue to show the casual'
'gains to the zone.'
'  '
'Import casul gains - you select a zone with casual'
'gains patterns and they are copied into this zone,'
'optionally with adjustments if the zone base areas'
*enditem
        CALL EPICKS(IX,KSTR,' ','Import a profile for which day type?',
*item EDCAS
'If you choose to incorporate electrical data into '
'the operations file you will be asked to specify '
'additional data items for each casual gain. With '
'the extra data items casual gains are now zone '
'loads - zone loads contain both thermal and '
'electrical information. Type definitions remain '
'the same as for casual gains. '
*enditem
         call easkabc('Do you wish to include definition of electrical',
*item EDCAS
*enditem
          call easkab(' Do you wish to remove definition of  ',
*item EDCAS
*enditem
        CALL PHELPD('gains menu',18,'-',0,0,IER)
*item EDCAS
'You can apply a scaling factor to all entries of a '
'particular casual gain type (useful for parametric '
'studies on profiles which have been imported).'
'If you are not scaling gains choose all gains and then'
'choose a factor of 1.0'
*enditem
        CALL EASKATOG('Apply scaling factor to which casual gain type?',
*item EDCAS
*enditem
          call EASKABC('Import profile for one or all day types',
*item EDCAS
*enditem
            CALL EPICKS(IX,KSTR,' ',
*item EDCAS
*enditem
          CALL EASKR(VAL,outs,'(typically between 0.1 and 5.0)',
*item EDCAS
'The options: '
' add - adds a period to one or all day types'
' '
' delete - deletes one or more periods (within a list'
'   of all periods in all days).'
' '
' copy - copies periods from one day type to another  '
'   Currently it adds the copied periods to the '
'   destination in addition to existing periods already'
'   present in the destination day type '
' '
' import - imports casual gain patterns for all gains'
'   and day types from another zone (overwrites).'
' '
' import pattern - imports casual gain patterns for all'
'   gains and day types from file outwith the model '
'   (overwrites)'
' '
'When importing you can specify whether to:'
' a) preserve the absolute W being imported e.g. 123W'
'    in the source zone is also 123W in destination'
' b) preserves W/m^2 implied by the source zone and'
'    destination zone base areas e.g. 123W in source'
'    zone of 2.3m^2 becomes 267W in a 5.0m^2 base area'
'    zone.'
*enditem
        CALL EASKATOG('Casual gain period options:','(see help)',
*item EDCAS
*enditem
          CALL EASKABCD('New casual gain of which type?',' ',
*item EDCAS
*enditem
            call EASKABC('Add period for one or all day types',
*item EDCAS
*enditem
              CALL EPICKS(IX,KSTR,' ',outs,12,NBDAYTYPE,
*item EDCAS
*enditem
            call askzone(isource,izdef,'Casual gains from which zone?',
*item EDCAS
*enditem
          CALL EASKABC('Casual import:',' ','preserve absolute W',
*item EDCAS
'An automated process has been used to manage the imported'
'schedules. It usually does it as intended and, as with all'
'automated processes it is recommended that you confirm '
'that the resulting file is correct. '
' '
'One approach is to generate a new QA report and check this'
'against the previous model and then run a short assessment'
'to confirm that the predictions are as expected. '
*enditem
          CALL PHELPD('operation import confirm',8,'-',0,0,IER)
*item EDCAS
'Casual gains have initial type labels which may not'
'be appropriate for your project. You can adapt the '
'labels if it clarifies your model. '
*enditem
        call askok(' ','Change type labels?',OK,dok,3)
*item EDCAS
'Select a label which describes the gain/load type'
'i.e. equip - equipment, light - lighting etc..   '
*enditem
            call easks(TYPSTR,' ',outs,8,
*subroutine SCASL
*item SCASL
'Any one of the profiles may be selected.'
*enditem
      CALL EPICKS(IX,IPRVAL,' ','Profiles in events db: ',
*item SCASL
'Casual gains within a zone can be be designated to be '
'of one of three user-defined types so that for example '
'occupant gains can be separately tracked from that of '
'lighting or equipment.  The types listed can have any'
'meaning that the user chooses (type labels can be edited'
'in the main operations menu.'
*enditem
      CALL EASKABC(' ','Type of casual gain: ',ll1,ll2,ll3,ICGTX,6)
*item SCASL
'In order to expand the profile into energy values the'
'sensible and latent load in Watts equivalent to 100% is'
' required. '
' '
'Also supply the radiant and convective fraction for the'
'sensible load (these normally should sum to 1.00) '
' '
'The radiant and convective split of lighting fixtures is'
'listed below(CIBSE Consice Handbook Table A6.5) : '
'  fluorescent radiant = 30  convective = 70'
'  tungsten    radiant = 85  convective = 15'
'  HP mercury sodium radiant = 50 convective = 50'
'  low pressure sodium radiant = 43 convective = 57'
' '
'The position of lamps determines the distribution of '
'heat into room or ceiling void (CIBSE Table A6.4) '
'  recessed open fixture  upwards = 38 downwards = 62'
'  recessed with louvre   upwards = 45 downwards = 55'
'  recessed with diffuser upwards = 53 downwards = 47'
'  surface mount open fixt upwards = 12 downwards = 88'
'  surface mount enclosed prismatic up= 22 down = 78'
'  suspended near ceiling enclosed prismatic upwards = 6'
'     downwards = 94'
'  suspended or wall mounted or desk lamp upwards = 0'
' '
'The radiant and convective split for office equipement'
'is typically: (CIBSE Table A6.9) '
' desktop computer radiant = 14 convective = 86'
' monitor (type not defined) radiant = 35 conv = 65'
' laser printer  radiant 33 convective 67'
*enditem
      CALL EASKS(HOLD,
*item SCASL
'If the sum is less than 0.98 or greater than 1.00 then'
'the sensible load may not be well represented in your '
'model. Tweaking this is for experts only! '
*enditem
        call askok(' The Sum of radiant and convective fractions is',
*item SCASL
'Electrical data (e.g. power factor, leading/lagging'
'loads, real power, phase) might be used by electrical'
'engineers and in models where other power components'
'are being defined. If not just say no. '
*enditem
        CALL ASKOK('Include electrical data with this profile?',
*item SCASL
'Enter a power factor between 0.-1.'
'Power factor is the ratio of real to apparent'
'power drawn by the load.'
*enditem
          CALL EASKR(PPF,' ','Power factor? [0-1] ? ',
*item SCASL
'A lagging load is one with an inductive'
'component i.e. flourescent lighting, a '
'leading load is one with a capacative  '
'element. Unity loads are purely resistive'
'i.e. incandescent lighting.'
' '
'A cancel leaves the model without electrical data'
'for this item. '
*enditem
          CALL EASKI(ippft,'Lagging -1, Leading 1 or Unity 0?',
*item SCASL
'To expand the profile into energy values it'
'is necessary to supply the power consumption'
'equivalent to 100%.'
*enditem
          CALL EASKR(PE,' ','Power consumption? (W) ? ',
*item SCASL
'At what voltage does the load operate ?'
*enditem
          CALL EASKR(PBVOLT,' ','Operational voltage ? (W) ? ',
*item SCASL
'Which phse of the three phse supply is the load'
'connected to ? (1-3) or 4 - all three i.e. for'
'a large induction motor.'
' '
'A cancel leaves the model without electrical data'
'for this item. '
*enditem
          CALL EASKI(IPPHAST,'Supply phase 1-3 or 4 ?','(see help)',
*subroutine EDCASGN
*item EDCASGN
'Period during which casual gains applies.'
*enditem
      CALL EASKS(hold,outs,' ',24,' 0 24 ','cas st-fn hr',IER,1)
*item EDCASGN
'A gain can be specified as:'
' Watts - explicitly set the gain.'
' Watts per square meter - will use the floor area of the '
'  zone to calculate the total gain.'
' Watts per object - gain/object and number of objects are'
'  required (an object could be a person or computer).'
' Square meters per object - will use the floor area of the'
'  zone to calculate the total gain. For the particular'
'  case of an occupant there is an assumption that each'
' person is 95W sensible and 45W latent.'
' '
'ESP-r asks for fixed sensible and latent values. The'
'values for occupants are really a function of the current'
'zone temperature (CIBSE Concise Handbook Table 6.1)'
'If possible pick a value for the likely temperature rnage.'
'For an adult and average mix '
'                   Tot 15C sen lat 20C sen lat 24C sen lat'
'Seated inactive    115     100  15     90  25      75  40'
'       avg mix     100      87  13     78  22      65  35'
'Seated light work  140     110  30    100  40      80  60'
'       avg mix     126      99  27     90  36      72  54'
'Seated office work 140     110  30    100  40      80  60'
'       avg mix     130     102  28     93  37      74  56'
'Standing light work 160    120  40    110  50      85  75'
'       avg mix      141    106  35     97  44      75  66'
'Light factory work 235     150  85    130 105     100 135'
'       avg mix     209     133  76    116  93      89 121'
'Medium factory work 265    160 105    140 125     105 160'
'       avg mix      249    150  99    132 117      99 150'
'Heavy factory work 440     220 220    190 250     135 305'
'       avg mix     440     220 220    190 250     135 305'
' '
*enditem
      CALL EASKABCD('Gain to be specified as: (see help)',' ','Watts',
*item EDCASGN
' '
'ESP-r asks for fixed sensible and latent values. The'
'values for occupants are really a function of the current'
'zone temperature (CIBSE Concise Handbook Table 6.1)'
'If possible pick a value for the likely temperature rnage.'
'For an adult and average mix '
'              Total W 15C sen lat 20C sen lat 24C sen lat'
'Seated inactive   115     100  15     90  25      75  40'
'       avg mix    100      87  13     78  22      65  35'
'Seated light work 140     110  30    100  40      80  60'
'       avg mix    126      99  27     90  36      72  54'
'Seated office work 140    110  30    100  40      80  60'
'       avg mix     130    102  28     93  37      74  56'
'Standing light work 160   120  40    110  50      85  75'
'       avg mix      141   106  35     97  44      75  66'
'Light factory work 235    150  85    130 105     100 135'
'       avg mix     209    133  76    116  93      89 121'
'Medium factory work 265   160 105    140 125     105 160'
'       avg mix      249   150  99    132 117      99 150'
'Heavy factory work 440    220 220    190 250     135 305'
'       avg mix     440    220 220    190 250     135 305'
'Supply the sensible and latent gain in Watts.'
' '
' '
*enditem
        call EASKS(HOLD,'Sensible and latent gain (W):',
*item EDCASGN
'Supply the sensible and latent gain in Watts/m^2.'
' '
' '
*enditem
        call EASKS(HOLD,'Sensible and latent gain (W/m^2):',
*item EDCASGN
'The number of objects for the current gain type is '
'required. For example the number of computers.'
' '
*enditem
        CALL EASKI(NOBJ,' ','Number of objects (e.g. people)?',
*item EDCASGN
'Supply the sensible and latent gain in Watts.'
' '
' '
*enditem
        call EASKS(HOLD,'Object sensible and latent gain (W):',
*item EDCASGN
'The floor area per object for the current gain type is '
'required. For example the area per person assuming that'
'for people the sensible is 95W and latent is 45W. '
*enditem
        call EASKR(XFLA,'Floor area per object (e.g. people)?','  ',
*item EDCASGN
'Supply the sensible and latent gain in Watts/object.'
' '
' '
*enditem
            call EASKS(HOLD,'Sensible and latent gain (W/object):',
*item EDCASGN
'Supply the radiant and convective fraction for'
'the sensible load (should be <=1.00) '
' '
'The radiant and convective split of lighting fixtures is'
'listed below(CIBSE Consice Handbook Table A6.5) : '
'  fluorescent radiant = 30  convective = 70'
'  tungsten    radiant = 85  convective = 15'
'  HP mercury sodium radiant = 50 convective = 50'
'  low pressure sodium radiant = 43 convective = 57'
' '
'The position of lamps determines the distribution of '
'heat into room or ceiling void (CIBSE Table A6.4) '
'  recessed open fixture  upwards = 38 downwards = 62'
'  recessed with louvre   upwards = 45 downwards = 55'
'  recessed with diffuser upwards = 53 downwards = 47'
'  surface mount open fixt upwards = 12 downwards = 88'
'  surface mount enclosed prismatic up= 22 down = 78'
'  suspended near ceiling enclosed prismatic upwards = 6'
'     downwards = 94'
'  suspended or wall mounted or desk lamp upwards = 0'
' '
'The radiant and convective split for office equipement'
'is typically: (CIBSE Table A6.9) '
' desktop computer radiant = 14 convective = 86'
' monitor (type not defined) radiant = 35 conv = 65'
' laser printer  radiant 33 convective 67'
*enditem
      call EASKS(HOLD,'Radiant & convective fraction: (see help)',
*item EDCASGN
'Setting the total radiant and convective split of a'
'casual gain to less than 0.9 can lead to confusion'
'(600W with 0.4 rad and 0.4 conv is 480W total) and '
'should only be done by experts.'
*enditem
        CALL ASKOK(outs,
*item EDCASGN
'Electrical data (e.g. power factor, leading/lagging'
'loads, real power, phase) might be used by electrical'
'engineers and in models where other power components'
'are being defined. If not just say no. '
*enditem
        call ASKOK(' ','Does this load need electrical data?',OK,DOK,4)
*item EDCASGN
' Power factor will vary between 0 - 1.0'
*enditem
          call EASKR(pft,' ','Load power factor?',
*item EDCASGN
'The load will either be capacitive, leading current,'
'or reactive with a lagging current, most loads take '
'a lagging current.'
' '
'A (*) flags an existing value. '
*enditem
              call EASKAB('Is the load current leading or lagging?',
*item EDCASGN
*enditem
              call EASKAB('Is the load current leading or lagging?',
*item EDCASGN
*enditem
              call EASKAB('Is the load current leading or lagging?',
*item EDCASGN
'What is the real power consumption in watts?'
'This might be the same as the sensible load for'
'some devices (please check). '
*enditem
          call EASKR(pwrt,'Real power consumption ?','  ',
*item EDCASGN
' What voltage does the load operate at i.e. 220V'
*enditem
          call EASKR(bvoltt,' ','Operational voltage?',
*item EDCASGN
'To which phase of the 3-phase supply is the load '
'connected, 1-3 or 4-all three.'
' '
'A cancel leaves the electrical data unchanged.'
*enditem
          call EASKI(IPHAST,'Which phase is load connected to?',
*subroutine CDCASGN
*item CDCASGN
*enditem
        CALL EPICKS(IX,KSTR,' ',
*item CDCASGN
*enditem
        CALL EPICKS(IX,KSTR,' ',
*item CDCASGN
'One or more of the periods may be deleted (removed).'
*enditem
        call EPICKS(ilistlen,IVERT,' ',
*item CDCASGN
'All the casual gains associated with a specified day type'
'can be copied to another day type.'
*enditem
        CALL EPICKS(IX,KSTR,' ',
*item CDCASGN
*enditem
        call EPICKS(IXX,IVERT,' ','Casual gain period(s) to copy:',
*subroutine IMPORTZCASG
*item IMPORTZCASG
'This is the suggested name for the file that will'
'hold the imported casual gain data. '
*enditem
          CALL EASKS(ltmp,' New zone operations file: (confirm) ',
*item IMPORTZCASG
'Because this is a pattern file there is no associated'
'zone and to do a ratio we need an assumed area. '
*enditem
          CALL EASKR(VAL,' ',' Assumed floor area of source ? ',
*item IMPORTZCASG
*enditem
          call askok('Use the source documentation?',' ',OK,DOK,0)
*item IMPORTZCASG
'Notes (<248 char) for schedules of zone air flow and'
'casual gains can be included in the model. Use this'
'facility to clarify what is happening in the zone.'
*enditem
          CALL EASKS248(oprdescc,'Operations notes (please edit):',
*subroutine PLTCASGN
*subroutine insdelcasper
*subroutine initcasday
*item initcasday
'For the current day type specify how many periods'
'for each casual gain type (occupants, lights and'
'small power). Do not include periods for gain types'
'which you will be importing from an Events Profiles'
' '
'If you set the number of periods for a type to zero'
'you can update it later. The number of periods should'
'cover the whole day (i.e. from 0h00 to 24h00). For '
'example, if there are gains between 8h00 and 18h00'
'and nothing at other times, define this as three'
'periods - 0h00 to 8h00 with no gains, 8h00 to 18h00'
'with gains and 18h00 to 24h00 with no gains.'
'Period start times should be in ascending order.'
*enditem
        CALL EASKS(HOLD,VOUTS,
*subroutine initcasper
*item initcasper
'If you define actual start times the subsequent'
'editing tasks will be easier.'
*enditem
      CALL EASKS(CSTR,' ',msg,72,' 0  5  6  8 ','time starts',IER,2)
*subroutine prjqa
*item prjqa
'Normally reports are generated from a standard pattern'
'and edited to fit the current project. The `notes` file'
'is created during project registration and should be '
'updated as the project evloves.'
' '
'The graphing tool can be invoked after exporting'
'performance data from the assessment tool.'
' '
'If you wish to view bitmapped images oor capture '
'images from the screen use option `h`. '
' '
'The preview tool has a default assumption that the '
'report uses the troff typesetting convention. '
' '
'This menu also defines the contents of a QA report for'
'the current model. '
' '
'A number of topics can be selected for inclusion in the'
'report and each topic can be reported in a compact or'
'verbose format.'
' '
'Topics which are not included in the current model will'
'show up as not applicable.'
' '
'One use of this report is to track the progress of a'
'model (comparing reports generated as the model evolves).'
' '
'Another use of this report is to confirm that different'
'different versions of a model have been correctly'
'defined. '
' '
'The primary use of this report is as an aide to check'
'models and provide a text based synopsis of the model'
'composition. '
' '
'Once you generate a QA report file you can select the'
'`edit QA report` option and an editor will be launched.'
*enditem
        CALL PHELPD('QA overview',37,'-',0,0,IER)
*item prjqa
'The project log file contains descriptive text about'
'the project.  Keep it up to date via a text editor.'
*enditem
          CALL EASKS(ltmp,
*item prjqa
'When attempting to preview the log file a problem'
'was reported so check the spelling and location or'
'type of file before trying again. '
*enditem
              CALL ASKOK(' Problem detected while trying to preview',
*item prjqa
'No file by that name or in that location was found.'
'Check the spelling and location of the file name'
'before trying again. '
*enditem
            CALL ASKOK(' Problem detected while trying to open',
*item prjqa
'If you have a editor associated with ESP-r you can'
'use it to edit this file.  '
*enditem
          CALL ASKOK(' ',' Edit this file?',OK,dok,2)
*item prjqa
' Pick one, several or all zones to include.'
*enditem
          CALL EPICKS(INPIC,IVALS,' ',' Which zones to summarise:',
*item prjqa
'Often it is convenient to review which surfaces in a '
'project have particular attributes.'
' '
'The following dialogue will allow you to define a '
'subset of surfaces via filters for position,  '
'orientation, opacity, etc. '
*enditem
        CALL PHELPD('global search by attribute',6,'-',0,0,IER)
*item prjqa
'You may filter for already attributed surfaces or'
'surfaces marked UNKNOWN. '
*enditem
        CALL EASKABCD(' Filter for surface composition:',' ',
*item prjqa
'You may filter for opaque surfaces, transparent surfaces'
'or both. '
*enditem
        CALL EASKABCD(' First filter--surface opacity:',' ',
*item prjqa
'You may filter for surfaces which face the outside,'
'partitions (internal) etc. '
*enditem
        call EASKATOG(' Second filter--surface contiguity:',' ',
*item prjqa
'You may filter for surfaces which have a particular'
'orientation. '
*enditem
        call EASKATOG(' Third filter--surface orientation:',' ',
*item prjqa
'The QA report file can be edited using the current'
'defined text editor (as defined in the default file).'
*enditem
          CALL EASKF(LFIL,'ASCII file name?',
*item prjqa
*enditem
          CALL EASKF(llitem,'ASCII file name?',
*item prjqa
*enditem
          CALL EASKF(LFIL,'ASCII file name?',
*subroutine mupdate
*item mupdate
'Older models should be updated to take advantage of'
'extended geometric data structures and file formats'
' '
'An update will also reduce the number of model '
'files which have to be managed. '
*enditem
        call askok('The current model uses an out-of-date format for',
*item mupdate
'Older models should be updated to take advantage of'
'extended documentation and quality assurance facilities'
'as well as enhanced databases.'
'An update will also reduce the number of descriptive '
'files which have to be managed. '
' '
'Older models with seaparate IPV (integrated performance'
'view files will have this data moved into the cfg file.'
' '
*enditem
        call askok('The current model uses an out-of-date format for',
*item mupdate
'Older shading files should be recalculated to reflect'
'changes in the allowable number of surfaces in each'
'zone. Each affected zone will be done in turn.'
' '
'Recent versions of the ish module are able to make a'
'backup copy of shading databases in ASCII format. '
*enditem
        CALL EASKABC(' Update of shading options:',' ',
*subroutine SDDEF001
*item SDDEF001
'Pick the required material. '
'   '
'Exit will return to the main menu '
'without saving any data. '
*enditem
      CALL EPICKS(IEPIC,IVALE,' ',' Which material : ',
*item SDDEF001
'Pick the required property. '
'   '
'Exit will return to the main menu '
'without saving any data. '
*enditem
      CALL EPICKS(IPPIC,IVALP,' ',' Which property : ',
*item SDDEF001
*enditem
      call EASKAB('Define parameter bounds:','  ',
*subroutine SDDEF002
*item SDDEF002
*enditem
      call EASKAB('Which composite construction parameter? ','  ',
*item SDDEF002
'Pick the required material. '
'   '
'Exit will return to the main menu '
'without saving any data. '
*enditem
        CALL EPICKS(INPIC,IVALE,' ',' Which material : ',
*subroutine SDDEF003
*item SDDEF003
'Pick the required parameter. '
'   '
'Exit will return to the main menu '
'without saving any data. '
*enditem
      CALL EPICKS(INPIC,IVALP,' ',' Which parameter : ',
*subroutine SDDEF004
*item SDDEF004
*enditem
      call EASKAB('  ','Which scheduled parameter? ',
*item SDDEF004
*enditem
        call EASKABC('  ','Which casual gain? ',
*item SDDEF004
*enditem
        call EASKATOG('Which property? ',' ','Sensible','Latent',
*item SDDEF004
*enditem
        call EASKATOG('Which property? ',' ','Infiltration',
*subroutine SDDEF005
*item SDDEF005
*enditem
      call EASKAB('Only Halcrow time invarient enabled ! ','  ',
*subroutine SDDEF101
*item SDDEF101
*enditem
      call EASKAB('Only zone air volume enabled ! ','  ',
*subroutine SDDBOUND
*item SDDBOUND
'The upper and lower values that the parameter can '
'take are defined via one of three processes:'
'1) Percentage change: the upper and lower values will'
'   be the base case value +/- the percentage change.'
'2) Absolute change: the upper and lower values will be'
'   the base case value +/- the absolute change.'
'3) Explicitly: the upper and lower values will be '
'   defined explicitly.'
*enditem
        call EASKABC(' Define parameter bounds',' via:',
*item SDDBOUND
' A value greater than 0.00 is required. '
*enditem
          call EASKR(PERC,' ',' Percentage change value? ',
*item SDDBOUND
' A value greater than 0.00 is required. '
*enditem
          call EASKR(ABS,' ',' Absolute change value? ',
*item SDDBOUND
' The upper and lower values are required. '
' There is no checking of these values, except that '
' the upper value is greater than the lower. '
*enditem
22        call EASKR(EXPU,' ',' Explicit definition of upper value? ',
*item SDDBOUND
*enditem
          call EASKR(EXPL,' ',' Explicit definition of lower value? ',
*item SDDBOUND
'The upper and lower values that the parameter can '
'take are defined via one of three processes:'
'1) Percentage change: the upper and lower values will'
'   be the base case value +/- the percentage change.'
'2) Absolute change: the upper and lower values will be'
'   the base case value +/- the absolute change.'
*enditem
        call EASKAB(' Define parameter bounds',' via:',
*item SDDBOUND
' A value greater than 0.00 is required. '
*enditem
          call EASKR(PERC,' ',' Percentage change value? ',
*item SDDBOUND
' A value greater than 0.00 is required. '
*enditem
          call EASKR(ABS,' ',' Absolute change value? ',
*subroutine SDDFLT001
*item SDDFLT001
'The classifications shown in the display include up to'
'18 elements. To get a listing of the items included'
'select one of the classifications.'
*enditem
        CALL PHELPD('materials menu',3,'-',0,0,IER)
*item SDDFLT001
*enditem
        call EASKS(t32,outs,'default uncertainties:',32,d32,
*subroutine UNCERTA
*item UNCERTA
*enditem
        CALL EASKAB(' You are working in a remote folder... ',
*item UNCERTA
*enditem
      call EASKS(LTEMP,' Uncertainty definitions file name ?',
*item UNCERTA
'Uncertainties are defined in a three stage process '
'analogous to mass flow.'
'  '
'1. A distribution for a chosen parameter is defined.  '
'   Minimum one distribution.'
'  '
'2. A physical location in the model is defined; zone,  '
'   surface etc. Minimum one location.'
'  '
'3. Distributions and locations are linked to define an '
'   uncertainty.  The validity of the uncertainty is '
'   checked at simulation time. Minimum one uncertainty.'
*enditem
        CALL PHELPD('Uncertainty definitions file',12,'-',0,0,IER)
*subroutine DISPOPT
*item DISPOPT
'To create a new definition select + add entry. '
'To edit an existing entry then select it.'
'To remove an existing entry select = delete entry and'
'  then the entry you wish to delete.'
*enditem
        CALL PHELPD('UA file entries',4,'-',0,0,IER)
*item DISPOPT
*enditem
          call EPICKS(INDEL,IDEL,' ',' ',15,NICNG,LCNG,
*item DISPOPT
*enditem
          call EPICKS(INDEL,IDEL,' ',' ',15,NILOC,LLOC,
*item DISPOPT
*enditem
          call EPICKS(INDEL,IDEL,' ',' ',15,NIACT,ta15,
*subroutine DEFUAL
*subroutine CNGDEF
*item CNGDEF
'Pick the required uncertainty category. You will then '
'be asked further questions to define the uncertainty '
'distribution.  '
'   '
'Exit returns to the main menu without saving any data. '
*enditem
        CALL PHELPD('Uncertainty categories',5,'-',0,0,IER)
*item CNGDEF
'A descriptive name (up to 15 characters) is required.'
*enditem
        CALL EASKS(t15,' ',' Name for uncertainty ? ',
*item CNGDEF
*enditem
        CALL EASKS(t15,' ',' Name for uncertainty ? ',
*subroutine LOCDEF
*item LOCDEF
'The location of the uncertainty can be:'
' - spatial and in all temporal locations.'
' - temporal and in all spatial locations.'
' - both.  Only use this option if both domains have'
'   a restriction'
' '
'If you select cancel (where a number is requested) '
'the current model data will not be changed. '
*enditem
      CALL EASKABC(' ',
*item LOCDEF
'Pick one, several or All zones for inclusion in a'
'graph or tabular listing from the list provided. '
'You may choose them in any order. '
*enditem
          CALL EPICKS(INPIC,IVALZ,' ',' Which zones to include: ',
*item LOCDEF
' Pick one, several or all surfaces for inclusion.'
*enditem
          call EPICKS(INPIC,IVALS,' Which surfaces to include: ',
*item LOCDEF
'The period when uncertainty is applicable requires '
'starting and finishing dates. '
'If you select cancel (where a number is requested) '
'the current model data will not be changed. '
*enditem
        call EASKI(IDST,' ','Start day? ',1,'F',365,'F',9,
*item LOCDEF
*enditem
        call EASKI(IHST,' ','Start hour? ',1,'F',24,'F',1,
*item LOCDEF
*enditem
        call EASKI(IDFT,' ','Finish day? ',1,'F',365,'F',15,
*item LOCDEF
*enditem
        call EASKI(IHFT,' ','Finish hour? ',1,'F',24,'F',24,
*item LOCDEF
'A descriptive name (up to 15 characters) is required.'
*enditem
      CALL EASKS(t15,' ',' Name for location ? ',
*subroutine LINKDEF
*item LINKDEF
'Pick the required uncertainty definition(s).'
'  '
'Exit returns to the main menu without saving any data. '
*enditem
      CALL EPICKS(INPIC,IVALC,' ',' Which uncertainty definition : ',
*item LINKDEF
'Pick the required location definition.'
'  '
'Exit returns to the main menu without saving any data. '
*enditem
      CALL EPICKS(INPIL,IVALL,' ',' Which location definition : ',
*subroutine UPELM
*subroutine SETUP
*item SETUP
'This menu allows the display format for dates and'
'times to be changed.  The active year can also be'
'defined as required by controllers that require day'
'of the week information.'
' '
'One option lists a specified ASCII file - sometimes'
'useful if you have need to directly view the contents'
'of a problem describing entity such as the system'
'configuration file or a zone geometry file.'
' '
'The wireframe view option allows you to set a different'
'initial wireframe view.'
' '
'The external editor is currently defined to be:'
'This can be re-defined in your .esprc file.'
' '
'The feedback level allows you to see more or less'
'information as model files are being scanned. '
' '
'As ESP-r evolves file formats change. Use the toggle'
'to maintain the current state, save to an eariler'
'format or save files to a newer format (if available).'
' '
'The edit `defaults` file allows you to change where'
'ESP-r looks for certain files. TAKE CARE when editing'
'this file. '
' '
'The edit `exemplars` file allows you to change where'
'ESP-r looks for example models. TAKE CARE when editing'
'this file. '
' '
'The edit `3rd party application` allows you to specify'
'a text editor, image display tool, CAD tool and the '
'location of example models and where the `defaults` '
'file (above) is located. '
' '
'The test button is for scanning the ESP-r meta file.'
'Only use this if no other model is loaded. '
'Unless other wise specified the initial view of the'
'model is a standard default. If a user defined view '
'is more appropriate then specify this now. '
*enditem
        CALL EASKABCD(' Initial view position options',' :',
*item SETUP
'The eyepoint is in metres in the coordinate system '
'of the site. '
*enditem
          CALL EASKS(HOLD32,' Eye point  X  Y  Z (in metres): ',
*item SETUP
'The viewpoint is in metres in the coordinate system'
'of the site and defaults to the centre of gravity '
'of the body. '
*enditem
          CALL EASKS(HOLD32,' Viewpoint  X  Y  Z (in metres): ',
*item SETUP
'The angle of view is in degrees, allowable values'
'are from 1 to 89 degrees. '
*enditem
          CALL EASKR(ANGI,' ',' New angle of view ? ',
*item SETUP
'The specified ASCII file will be read and displayed'
'in the text window page by page.'
*enditem
  6     CALL EASKXORGTKF(LFIL,'ASCII file name?',' ',
*item SETUP
'Either the file did not exist or included characters'
'which would not print. '
*enditem
          CALL ASKOK(' Problem detected while trying to open',
*item SETUP
'An ASCII format file can be edited using the current'
'defined text editor (as defined in the default file).'
*enditem
        CALL EASKXORGTKF(LFIL,'ASCII file name?',' ',
*item SETUP
'The edit `defaults` file allows you to change where'
'ESP-r looks for certain files. TAKE CARE when editing'
'this file. The key words are:'
' '
' *ipth - where ESP-r is installed. This was set during'
'         in intial Installation and compile sequence.'
'         Leave this alone!'
' '
'Names of default files (typically used ford demos)'
' *cfg - a default model to open'
' *ctl - a default zone control definition'
' *mfn - a default mass flow network'
' *dfd - a default CFD domain'
' *pnf - a default plant-only model'
' *res - a default simulation results file'
' *mfr - a default mass flow simulation results file'
' '
'Names of databases initially associated with models'
'edit these so as to be appropriate for your region'
' *clm - initial climate file'
' *prs - initial wind-pressure coefficients database'
' *prm - initial materials database'
' *mlc - initial constructions database'
' *opt - initial optical properties database'
' *env - initial event profiles database'
' *pdb - initial plant component template database'
' *ecdb - initial electrical component database'
' *mcdb - initial active materials database'
' *icdb - initial icons for the net module'
' *mldb - initial micotoxin database'
' *sbem - initial UK National Calculation Method'
'         database (or code complience rules)'
' '
'After edting and saving the information is available'
'the next time applications are invoked. '
' '
'NOTE: do not change the name of the default file! '
*enditem
        CALL EASKXORGTKF(defdbfl,'ESP-r default files?',' ',
*item SETUP
'The edit `esprc` file allows you to change 3rd party'
'tools used by ESP-r. A standard esprc file is included'
'in the installation folder. ESP-r also checks for a '
'.esprc (note the dot) file in the users home folder'
'for user specific settings.  '
' '
'        TAKE CARE when editing this file. '
' '
'Data in the file are comma separated. The first token'
'in each line is a key, the second is (typically) a '
'label followed by a command or exedutable to invoke.'
' '
'Key words in thefile are: '
' *ESPRC  - first line tag (leave alone)'
' '
' *gprn line specifies an application to invoke for'
'    capturing a portion of the graphic display. For'
'    Linux and OSX and Solaris the `import` tool in'
'    Imagemagik is suggested.'
' '
' *cad  line specifies a CAD application to start. There'
'   are 3 tokens after the tag, a user description, a'
'   file format and the name of the executable.'
' '
' *image_display line(s) define how specific image types'
'    can be displayed. The 2nd token is TIF XMBP GIF XWD'
'    and the 3rd token is the name of the executable'
' '
' *journal is a line specifying whether a detailed log'
'    should be kept of the users actions. The 2nd'
'    token is OFF or ON'
' '
' *editor line specifies what text editor to invoke'
'    the 2nd token is a label and the 3rd token is'
'    the application to start. Typically on Windows'
'    the WordPad works well and notepad does not work'
'    well. On Linux/Solaris nedit is a good choice.'
' '
' *exemplars line provides the path to the list of '
'    exemplar models.'
' '
' *validation_stds line provides the path to the list'
'    of standard validation models.'
' '
' *db_defaults line provides the path to the file that'
'    holds default database and model files as well as'
'    default constructions to use.'
' '
' *db_climates line provides the path to the file that'
'    holds list of climate files.'
' '
' *end  the last line of the file (leave alone)'
*enditem
        CALL EASKXORGTKF(esprc,'ESP-r esprc file?','(see help)',
*item SETUP
'The edit `climatelist` file allows you to change the'
'list of climate files available for browsing. TAKE CARE'
'when editing this file. '
' '
'The blocks of text that form an entry within this file'
'are typically created within the clm module and both'
'the text block and the climatelist file can be edited'
'clm. '
' '
'Key words in the file are: '
' '
' *CLIMATE_LIST  - 1st line identifier (leave alone)'
' '
' *group <tab> text for menu'
' '
' *item'
'    marks the start of one climate'
' '
' *name <tab> text for menu'
' '
' *aide <tab> description of climate'
' '
' *dbfl <tab> full path to the climate file'
' '
' *winter_s  winer season tab has 4 numbers for:'
'    winter begining January 1 and 4 numbers for'
'    winter ending 31 Dec. Each set of 4 is:'
'   start day, start month, finish day, finish month'
' '
' *spring_s has 4 numbers representing start and end'
'     of spring and 4 numbers representing start and'
'     end of autumn season'
' '
' *summer_s has 4 numbers representing start and end'
'     of summer season'
' '
' *winter_t is like *winter_s but for a typical period'
' *spring_t is like *spring_s but for typical periods'
' *summer_t is like *summer_s but for typical period'
' '
' *avail <tab>  ONLINE'
' '
' *help_start'
'    signals start of a block of contextual help'
' '
' *help_end'
'    signals end of a block of contextual help'
' '
'After edting and saving the information is available'
'the next time applications are invoked. '
*enditem
        CALL EASKXORGTKF(cdblfil,'ESP-r climatelist file?',
*item SETUP
'The edit `exemplars` file allows you to change the list'
'of example models. TAKE CARE when editing'
'this file. The key words are:'
' '
' *EXEMPLARS - fist line identifier (leave alone)'
' *help <tab> some text'
' '
' *label <tab> label text'
' '
' *group <tab> name of group'
' '
' *item'
'    marks the start of the model information'
' '
' *name <tab> some text for the menu'
' *cfg <tab> full path to model configuration file'
' *root <tab> full path to model folder'
' '
'To add an additional item find the relevant group and'
'add in the *item line, *cfg line and *root line '
' '
'After edting and saving the information is available'
'the next time applications are invoked. '
*enditem
        CALL EASKXORGTKF(exemfl,'ESP-r exemplars?','(see help)',
*item SETUP
'If you want to scan in all of the model geometry files'
'and save them out to the new format without having to'
'edit each one this is the place.'
*enditem
          CALL EASKABC('Geometric upgrade options',' :',
*item SETUP
'ESp-r can process a file with so-called meta file'
'instructions to create one or more zones with'
'minimal user intervention. '
' '
'You can ask for a synopsis of the file or process'
'the information in the file. '
*enditem
        CALL EASKABCD(' Silent file options',' :',
*item SETUP
'ESp-r can process a file with so-called meta file'
'instructions to create one or more zones with'
'minimal user intervention. '
*enditem
        CALL EASKXORGTKF(LFIL,'ESP-r meta file name?',' ',
*item SETUP
*enditem
        CALL PHELPD('general preferences',39,'-',0,0,IER)
*subroutine tdfedit
*item tdfedit
'The selected format for the input of time is currently'
'set as a fraction of a day 0.4271 (eq 10h15).'
*enditem
        CALL EASKR(TIMEJD,' Time (as julian day) to start recovery? ',
*item tdfedit
*enditem
        CALL EASKI(incr,' Number of steps to recover ',' ? ',
*item tdfedit
'The ESRU Temporal Definition supports the creation'
'and management of temporal data from 3rd party'
'experiments or 3rd party software. It can also hold'
'scheduling for short timestep casual gains, air'
'movement and boundary conditions. It is also useful'
'for data that changes at each timestep.'
' '
'Preferences : file names & types, periods, import/export'
'             files & date display.'
'Save : Update the TDF file and/or convert between ascii.'
'       and binaray versions. '
' '
'Currently the following item types are offered: '
' ALLCLMT - all climate data (includes next 6 items)'
' BDTEXTT - ambient temperature'
' WINDVLT - wind velocity'
' WINDDRT - wind direction'
' RELHUMT - ambient relative humidity'
' DIFHSLT - diffuse horizonal radiation'
' GLOHSLT - global horizonal radiation'
' DIRSOLT - direct normal solar radiation'
' SETPTTT - control setpoint temperature'
' CASUALT - zone casual gains (combined gains)'
' CASUAL3T -zone casual gains (Occup/Lights/SM Pwr)'
' ACTIVITY -global database: gains,setpoints, etc.'
' BIDIRSET -alternate bidirectional datasets'
' HTCLSETP -Specify columns to read H/C setpoints.'
' DBTZNM   - measured zone db temperature'
' SURTM    - measured surface temperature'
' '
'To create a new file, select option 1 and follow the'
'instructions given. You will be asked for the year '
'and the period and the timesteps per hour and then '
'for an initial temporal type. '
' '
'Insert by selecting an insertion point, the list will'
'expand and you can select a generic type. '
' '
'Delete by selecting a slot and the list will contract.'
' '
'Copy by selecting source and then destination.'
'The destination data will be overwritten - so you need'
'to have created a destination item to overwrite before'
'you ask for a copy. '
' '
'The TDF file is the main temporal file.'
'The period shown is related to all tabular data'
'and includes any `startup` time required by the'
'simulation.  Example: for a simulation at half hour '
'intervals over 10 days and with 2 startup days the '
'temporal file should include 288 timesteps. '
' '
'Note on file headers:'
'Older asci temporal files may start with `TDFdatabase2`'
'before using them please change 1st line to use the'
'identifier ASCIITDF2'
'Newer ascii files will start with `ASCIITDF3`.'
'Also note that binary/scratch temporal files are'
'machine dependant and are not always safe for use on'
'another computer.'
'The TDF file is the name of an ascii file which holds'
'the attributes and temporal (short timestep) data of '
'casual gains, boundary conditions, flow measurements etc.'
' '
'While editing temporal data in this module or using the'
'data during a simulation or as results are being'
'recovered, a scratch (binary) file is created. '
' '
'I you supply the name of a binary version of the '
'temporal file it will be translated into an ascii '
'version and a new scratch file created. '
' '
'Note: if you need to create a new binary temporal file'
'from an ESP-r ascii temporal file use the command line'
'option to do the conversion: '
'tdf -file xx.tdf -act import -actf yy.tdf.a '
'  where xx.tdf is the name of the new binary file to'
'  create and yy.tdf.a is the asci temporal file to'
'  be read in.'
*enditem
        CALL EASKS(tfile,' Temporal file name? ',
*item tdfedit
'No temporal file was found so a minimal file '
'will be created if you say yes. '
' '
'If you say no, you can create one later. '
*enditem
            CALL ASKOK(outs,' Create a new scratch & asci file?',
*item tdfedit
'Initial setup prompts you for the necessary data to'
'setup a new temporal definition. You can also do it'
'manually. '
*enditem
          CALL EASKAB(' Empty file. Options:',' ',
*item tdfedit
*enditem
        CALL PHELPD('tdf opening',60,'-',0,0,IER)
*item tdfedit
'You may save the current binary file or'
'import or export a ASCII version. '
*enditem
        CALL EASKATOG(' File options:',' ','save ascii file',
*item tdfedit
'File name for ascii version of the temporal file.'
*enditem
          CALL EASKS(afil,' Ascii export file name? ',' ',
*item tdfedit
'The selected format for the input of time is currently'
'set as a fraction of a day 0.4271 (eq 10h15).'
*enditem
          CALL EASKR(TIMEJD,' Time (as julian day) to start recovery?',
*item tdfedit
*enditem
          CALL EASKI(incr,' Number of steps to recover ',' ? ',
*item tdfedit
*enditem
          CALL EASKS(afil,' Ascii export file name? ',' ',
*item tdfedit
'Adding an item - placed at the end of the list. '
'Deleting an item (irreversable) shifts subsequent '
' items up in the list. '
'Copy of item will overwrite the contents of the  '
' destination item. '
*enditem
        CALL EASKABC('Entry options:',' ',
*item tdfedit
'In order to find items in the TDF db a unique name'
'must be assigned to each entry. This name is a '
'string up to 12 characters long with no blanks.'
*enditem
            CALL EASKS(TTAG,' ','Name for entry? ',
*item tdfedit
'Choose an item to delete.'
*enditem
          CALL EPICKS(INPIC,itemval,' ',' Which item to delete?',
*item tdfedit
'Choose an item to copy. You will then be asked'
'for a destination (which must already exist).'
*enditem
          CALL EPICKS(INPIC,itemval,' ',' Which item to copy?',
*item tdfedit
'Choose a destination item.'
*enditem
          CALL EPICKS(INPIC,itemval,
*subroutine CLRTABC
*subroutine glbset
*item glbset
 'Period of the temporal file:'
 'The year is required. It should match that of '
 'the climate file used in a simulation and can hold'
 'data for a few days up to a year. '
 ' '
 'The start day applies to all of the items in the '
 'file.  Example:'
 ' '
 ' A week long simulation in July (say 7-14th) requires'
' a 4 day startup period. A minumum TDF db would be'
' 3-14 July.'
' '
'If you are planning on importing timestep data'
'from an external file then the TDF start date '
'includes the startup period. SORT THIS OUT BEFORE'
'importing data (or it might be truncated).  '
'Check initial help on dates. '
*enditem
        CALL EASKI(itdyear,' ',' What is the year?',
*item glbset
*enditem
        CALL EASKPER('Period:',itdbdoy,itdedoy,IFDAY,IER)
*item glbset
'Frequency of data:'
'Timestep data in your file will be at a fixed'
'timestep which should match that of the'
'simulation timestep.'
' '
'If you are planning on importing TABULAR (timestep) '
'data then the TDF timestep and that of the other '
'file should match. '
*enditem
        CALL EASKI(NTSPH,' ','No of timesteps/hour ? ',
*item glbset
'The file holds two documentation lines.  Such '
'documentation can save a lot of grief later.....'
*enditem
        CALL EASKS(tmp72,' 1st line of documentation ?',
*item glbset
*enditem
        CALL EASKS(tmp72,' 2nd line of documentation ?',
*item glbset
'In order to find items in the TDF db a unique name must'
'be assigned to each entry. This name is a character'
'string up to 12 characters long with no blanks.'
*enditem
        CALL EASKS(TTAG,' ','Name for entry? ',
*subroutine extracts
*subroutine SETUPTDF
*item SETUPTDF
'The import facility is available to allow users with '
'tabular data in a text file to select one or more '
'columns of such information and associate it with a '
'DB item which is of type TABULAR.  First define the '
'import file and its format in this menu, then select '
'the item which is to be filled and issue an import  '
'command. '
' '
'The export command... '
' '
'The date and time formats may be used to alter the '
'display as well as that of any exported data. '
'It is possible to import temporal information via an'
'ASCII file with columns of data.'
*enditem
        CALL EASKABC('Import options:',' ',
*item SETUPTDF
'One import source file will be assumed throughout this'
'session. If this needs to be altered then the user'
'should return to this menu to give the new name.'
*enditem
        CALL EASKS(tfile,' Import file name? ',
*item SETUPTDF
'It is possible to export information from the db via'
'a number of file formats (ASCII currently available).'
*enditem
        CALL EASKI(ITEXP,' Several export formats are available: ',
*item SETUPTDF
'One export file will be used as the default name which'
'the user may override.  Return to this menu to change'
'the default name.'
*enditem
        CALL EASKS(tfile,' Export file name? ',
*item SETUPTDF
*enditem
        CALL PHELPD('tdf preferences',12,'-',0,0,IER)
*subroutine TMPLOT
