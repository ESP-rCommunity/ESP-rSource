*help_text prj
*subroutine Initialise
*subroutine Deallocate
*item Deallocate
*enditem
*item AIM2_Inputs AIM2_main_menu
'This is the main menu for the empirical air '
'Alberta Infiltration Model (AIM2).  This model applies'
'only to low rise (up to 3 storey) detatched single family'
'residendial buildings.'
' '
'  a. Blower door test data to describe leakage or'
'     defined by air tightness type.'
'  b. Leakage distribution to ceiling, wall and'
'     floor.'
'  c. Terrain at weather station and building site,'
'     shielding at walls and flue, and anemometer height'
'     are all used to calculate the wind speed correction'
'     factor.'
'  d. Height of building eves is used to define the height'
'     of the eaves. The height of the building eaves'
'     defaults to 2.5m*(# of storeys) + 0.5m, based on the'
'     number of storeys indicated in the house '
'     specifications description. This value may be '
'     overwritten. If the number of storeys is '
'     subsequently changed, esp-r defaults the eaves'
'     height accordingly. '
'  e. Fireplace and DHW flue diameters are used to specify'
'     the diameter of the flue on a combustion type water '
'     heater. Esp-r will assign a default value based on '
'     the tank type. This default value can be overwritten'
'     at any time.'
'  f. Reference zone for infiltration calculation,'
'     and zone indexing of zones receiving '
'     infiltration.'
*enditem
        CALL PHELPD('AIM2 model menu',30,'-',0,0,IER)
*subroutine AIM2_Interface
*item AIM2_Interface AIM2_attributes_a
'A number of attributes are needed to carry out an assessment'
'based on the AIM method. You are asked about the following:'
'  '
' Anemometer Height is the height at which the wind speed'
'   was measured at the weather station.  A default of 10m'
'   is assumed, and should not be changed unless a user-'
'   defined weather file is used and the anemometer was at'
'   a different height.'
'  '
' Flue diameters (mm) may be required for the furnace flue'
'   as well as up to two fireplaces.'
'  '
' If there is a primary DHW system that has a flue then its'
'   flue diameter in mm is requested. If there is a secondary'
'   DHW system supply the data for that as well.'
'  '
' Height of the building eaves (m). Values betwen 1 and 10'
'   are allowed. A building can only have one eves height.'
'  '
'If you change any of the parameters please remember to save'
'these changes to the file of the information will be lost.'
*enditem
           CALL EASKR(Temp,' ',
           CALL EASKR(Temp,' ',
           CALL EASKR(Temp,' ','Diameter of furnace flue (mm)?'
           CALL EASKR(Temp,' ','Diameter of #1 fireplace flue (mm)?'
           CALL EASKR(Temp,' ','Diameter of #2 fireplace flue (mm)?'
           CALL EASKR(Temp,' ',
           CALL EASKR(Temp,' ',
           CALL ASKOK(' Do you wish to save your changes?',' ',OK,
*subroutine LeakageMenu
*item LeakageMenu AIM_leakage_menu
'The Air Tightness Type is used to indicate the natural'
'infiltration rate. Air tightness is measured in air '
'changes per hour (ACH). The user has the option of '
'entering blower door test values to determine the flow'
'coefficient or specifying an air tightness category where'
'air change rate and the equivalent leakage area are '
'automatically calculated by esp-r.'
' '
'For further information on the blower door tests see'
'1. Canadian General Standards Board (CGSB) standard'
'   Determination of the Airtightness of Building '
'    Envelopes by the Fan Depressurization Method '
'2.  Airtightness tested in accordance with the EnerGuide'
'    for Houses <as operated> airtightness test procedure'
'    in EnerGuide for Houses: Energy Advisor Workshop'
'    Manual, Module 3 Conducting a Blower Door Test. '
*enditem
        CALL PHELPD('Leakage description',16,'-',0,0,IER)
*subroutine AirTightnessTypeMenu
*item AirTightnessTypeMenu AIM_tightness_menu
'The Air Tightness Type is used to indicate the natural'
'infiltration rate. Air tightness is measured in air '
'changes per hour (ACH). The options are:'
'  Loose (10.35 ACH @ 50 Pa)       '
'  Average (4.55 ACH @ 50 Pa)      '
'  Present (3.57 ACH @ 50 Pa)      '
'  Energy Tight (1.5 ACH @ 50 Pa)  '
'  '
'By specifying one of these air tightness categories, the'
' air change rate and the equivalent leakage area are '
 'automatically calculated by esp-r.'
*enditem
        CALL PHELPD('Leakage description',10,'-',0,0,IER)
*subroutine BlowerDoorInputMenu
*item BlowerDoorInputMenu AIM_blower_door_menu
'The blower door test values entered determine the flow'
'coefficient.  The blower door test results consist of the'
'Air Change Rate @ 50 Pa. and the Equivalent Leakage Area'
'(ELA). These results are used to determine the amount of'
'air leaking through the envelope when an interior/'
'exterior air pressure differential of 50 Pa air pressure'
'is applied. Esp-r uses the blower door test data to '
'generate an air infiltration rate, which provides a '
'relatively accurate indication of the air leakage '
'characteristics of the building. The ELA may be specified'
'at either 10 Pa. or 4 Pa. If the ELA is set to zero (0),'
'the program estimates the ELA at the specified pressure '
'based on the ACH @50, and an assumed flow exponent of '
'  '
'You are asked to provide information on:'
'  building fabric flow coef [m^3/(s Pa^n)]'
'  building flow exponent [-]'
'  '
'You may be asked about:'
'  Air change rate @50 Pa (between 1 and 30).'
'  The pressure difference in Pa'
'  The equivalent leakage area (ELA) in cm^2 (between 0.1 and'
'    7999.).
'  The discharge coefficient for the ELA (between 0. and 1.)'
'  '
'If you have had a blower door test these information are'
'usually supplied.'
*enditem
        CALL EASKR(Temp,' ',
        CALL EASKR(Temp,' ',
        CALL EASKR(Temp,' ',
        CALL EASKR(Temp,' ','Pressure difference (Pa)?',
        CALL EASKR(Temp,' ',
        CALL EASKR(Temp,' ',
        CALL PHELPD('Leakage description',14,'-',0,0,IER)
*subroutine LeakageDistribution
*item LeakageDistribution AIM_leak_distr_menu
'Leakage Fraction for Ceilings, Walls, and Floors'
'The leakage fractions are used to define the fraction of'
'the total building air leakage to attribute to the '
'ceilings, walls and floors.'
'  '
'If use defaults is selected, the default values are set '
'by esp-r and are based on the house type, number of'
'storeys, and the type of foundation (crawl space, '
'basement) specified for the house.'
'  '
'Otherwise the user must specify the leakage fractions '
'to ceilings, walls, and floors. The desired leakage '
'fractions must be entered as decimal values, and must '
'total 1.0.'
*enditem
      CALL EASKAB(
      CALL EASKR(Temp,' ',
      CALL EASKR(Temp,' ',
      CALL EASKR(Temp,' ',
*subroutine ShieldingAndTerrainMenu
*item ShieldingAndTerrainMenu AIM_terrain_menu
'The weather station terrain is used to specify the '
'terrain at the weather station and the building site'
'terrain is used to specify the local terrain for the'
'building.  The default for the weather station is'
' opton c) Open Flat terrain, grass.'
'  '
'The two terrains are used to calculate the wind speed'
'correction factor. This is a function of the surface'
'roughness lengths at the building site and weather '
'station, the height of the eaves, and the height of '
'the anemometer at the weather station. '
'This is equation 27 from Bradley (1993, p8).'
*enditem
        CALL PHELPD('Shielding and terrain description',11,'-',0,0,IER)
*subroutine TerrainMenu
*item TerrainMenu AIM_terrain_options
'The weather station terrain is used to specify the '
'terrain at the weather station and the building site'
'terrain is used to specify the local terrain for the'
'building.  The default for the weather station is'
' option c) Open Flat terrain, grass.'
'  '
'The two terrains are used to calculate the wind speed'
'correction factor. This is a function of the surface'
'roughness lengths at the building site and weather '
'station, the height of the eaves, and the height of '
'the anemometer at the weather station. '
'This is equation 27 from Bradley (1993, p8).'
*enditem
        CALL PHELPD('Terrain selection',11,'-',0,0,IER)
*subroutine ShieldingMenu
*item ShieldingMenu AIM_shielding_options
'Local Shielding Walls and Flue'
'The Local Shielding Walls and Flue fields are used to '
'specify how well both the walls and the flue are shielded'
'from the wind.  The options are:'
'1. None: no local shielding (i.e. no obstructions)'
'2. Light: local shielding having few obstructions within '
'   two house heights'
'3. Heavy: local shielding having many large obstructions'
'   within two house heights'
'4. Very Heavy: local shielding having many large '
'   obstructions within one house height'
'5. Complete (by large buildings): local shielding having'
'   large buildings immediately adjacent'
*enditem
        CALL PHELPD('Shielding selection',13,'-',0,0,IER)
*subroutine InfiltrationZonesMenu
*item InfiltrationZonesMenu AIM_zone_for_infil
'The reference zone is the number of the zone whose '
'temperature is used as reference for infiltration '
'calculations.'
' '
'The infiltration zones are the zone numbers of zones '
'that receive infiltration.'
' '
'The basement zone is the ESP-r zone describing '
'the basement as basements have different infiltration '
'air flow allocations to that of living space. If no '
'basement is selected from the list, it is assumed that '
'there is no basement.'
' '
'The crawlspace zone is an ESP-r zone describing'
'the crawlspace as crawlspaces are not included in the'
'house volume for infiltration calculations.  If no crawl'
'space is selected from the list, it is assumed that there'
'is no crawl space.'
' '
'The attic zone is an ESP-r zone describing the'
'attic as infiltration to attics is not calculated'
'with AIM-2 model. If no attic is selected from the list,'
'it is assumed that there is no attic.  '
*enditem
          CALL ASKZONE(Zone,Zone,
          CALL ASKMULTIZONE(AIM2_num_zones_infil,InfilZones,
          CALL ASKOK('Do you wish to revert to having no basement?',
          CALL EPICKS(1,IVALS,' ','Basement Zone?',
          CALL ASKOK('Do you wish to revert to having no crawlspace?',
          CALL EPICKS(1,IVALS,' ','Crawl space Zone?',
          CALL ASKOK('Do you wish to revert to having no attic?',
          CALL EPICKS(1,IVALS,' ','Attic Zone?',
          CALL PHELPD('Infiltration Zones',23,'-',0,0,IER)
*subroutine SAVE_AIM2
*item SAVE_AIM2 AIM_file_name
'You are asked for a file name. The suggested name is related to'
'the root name of the model. If this is ok, just accept it.'
*enditem
      CALL EASKF(LAIM2,' What is the AIM2 file name?',' ',
*subroutine BASESIMP_INPUTS
*item BASESIMP_INPUTS basesimp_opening
'One or more surfaces in the current zone may have been'
'attributed with the boundary condition BASESIMP. Or you'
'may wish to define the basement criteria and then attribute'
'the surfaces in the zone.'
'  '
'A .bsm file must be created or referenced.'
'You may select one from a list, create a new one, or'
'de-reference an exising definition (the file will be'
'kept for use later). '
'  '
'If a file exists in the model ../bsm directory, you may'
'select and use this file. Otherwise, create a new  '
'file and input the parameters or use the defaults. '
'                                                   '
'For the current .bsm file you have several options:'
' - You may use the values in the file as is (so no '
'   further actions are taken).'
' - You may choose to edit it and save the changes.'
' - You can defererence the BASESIMP definition (in'
'   which case the file is preserved for later use).'
'  '
'The following types of information are needed:'
'  Depth: distance from the top of the floor slab to'
'    the grade level. Must be between 0.05 and 2.4m '
'  '
'  Height: distance from the top of the floor slab to '
'    the top of the basement structural wall.'
'    Must be at least 0.1m greater than the depth.'
'    Must also be between 1.0 and 2.5m'
'  '
'  Width: exterior-of-structural-wall to exterior-of- '
'    structural-wall distance. Must be less than or equal'
'    to the length. Value must be between 2.0 and 20m.'
'  '
'  Length: exterior-of-structural-wall to exterior-of-'
'    structural-wall distance. Must be greater than or'
'    equal to the width.'
'  '
'  Insulation overlap: value must be given but only'
'    used for BCCN_1 and BCCN_2 combination cases.'
'    Height of the wall covered by both interior and'
'    exterior wall insulation (between 0 and 2.4m). '
'  '
'  Insulation thermal resistance:  enter the rsi '
'    value (m2K/W). (must be between 0 and 20 m2K/W.)'
'  '
'  Thermal conductivity of soil surrounding the foundation'
'    (W/mK). Must be between 0.1 and 10 W/mK.'
'  '
'  Water table depth: defines location of horizontal thermal '
'    boundary. The deeper the water table, the lower the '
'    foundation heat loss will be. Must be between 5 and 20m.'
*enditem
      CALL EASKABCD('Edit existing *.bsm?',' ','yes','no ',
      CALL EASKABCD('Create new *.bsm?',' ','yes','no ',
      CALL EASKABC('Use current .bsm values or edit? ',' ',
      CALL EASKR(bsmtDepth,' ',' Depth of the basement (m) ? ',
      CALL EASKR(bsmtHeight,' ',' Height of the basement (m) ? ',
      CALL EASKR(bsmtWidth,' ',' Width of the basement (m) ? ',
      CALL EASKR(bsmtLength,' ',' Length of the basement (m) ? ',
      CALL EASKR(Insul_Overlap,' ',' Insulation overlap (m)? ',
      CALL EASKR(Insul_rsi,' ',' Insulation rsi (m2K/W)? ',
      CALL EASKR(Soil_Cond,' ',' Soil conductivity (W/mK) ? ',
      CALL EASKR(Water_Table,' ',' Water table depth (m) ? ',
*item BASESIMP_INPUTS basesimp_moore_method
'If you choose to use the Moore Method,'
'TGavg, TGamp, TGps ground temperature parameters'
'will be calculated. Otherwise, you must enter'
'values for these parameters or use the defaults.'
' '
' TGavg: Average ground temperature (degC) (between -10 and'
'   20 (degC)'
'  '
' TGamp: Amplitude of the ground temperature (degC) (between'
'   0 and 25(degC)'
'  '
' TGps: Phase lag of ground temperature (radians) (between'
'  0 and 1 radians).'
'  '
'If you alter any information you will be asked to confirm'
'the name of the BASESMP .BSM file. If your project contains'
'the standard folder set, the file will be stored in a new '
'folder ../bsm '
*enditem
      CALL EASKABC('Method for handling ground temp:',' ',
      CALL EASKR(TGavg,' ',' TGavg (degC) ?',
      CALL EASKR(TGamp,' ',' TGamp (degC) ?',
      CALL EASKR(TGps,' ',' TGps (radians) ?',
      CALL EASKF(bsmFile,'Confirm filename:',' ',72,bsmFile,
*subroutine LKMENU
*item LKMENU adjustable_thermal_cond
'The menu options allow the definition of construction'
'layers whose thermal conductivity is of the nominated'
'type.  By default the thermal conductivity of all'
'construction layers is type CONSTANT.'
'  '
'The menu options are:'
' a constant thermal conductivity'
' b thermal conductivity determined as a funtion of'
'   layer temperature'
' c thermal conductivity determined as a funtion of'
'   layer moisture content'
' d thermal conductivity determined as a funtion of'
'   layer temperature and moisture content'
' < thermal conductivity of all layers set to constant'
' ! list conductivity of construction layers'
' ? display this help message'
' - return to calling menu.'
'  '
'   Note: when exiting this facility, if there are potential'
'   problems you will be warned. Best to fix these so that'
'   subsequent simulations run smoothly.'
*enditem
        CALL PHELPD('Thermal Conductivity',17,'-',0,0,IER)
        CALL ASKOK(' WARNING messages were detected',
*subroutine DFNMNU
*item DFNMNU focus_of_thermal_cond
'You can focus where thermal conductivity is adjusted at'
'from within the current zone or a specific surface or'
'within a specific surface.'
*enditem
        CALL PHELPD('conductivity focus',2,'-',0,0,IER)
*subroutine SURFMN
*item SURFMN focus_of_surf_cond
'You are presented with a list of surfaces from which'
'the conductivity will be adjusted.'
*enditem
      CALL EPICKS(INPICK,IVALS,' ',' ',20,NZSUR(icomp),ITEM,
*subroutine LAYRMN
*item LAYRMN focus_of_layer_cond
'You are presented with a list of layers in which'
'the conductivity will be adjusted.'
*enditem
      CALL EPICKS(INPICK,IVALL,' ',' ',20,NE(I), ITEM,'Layers',IER,2)
*subroutine TRMMSG
*item TRMMSG surf_cond_warning
'This message was presented because of prior warnings '
'or confusion about the model. If you do not want to '
'proceed agree to terminate. '
'  '
'You will be asked for the number of the warning messages'
'after which the termination option will be available.'
'If you cancel the value will not be altered. '
*enditem
      CALL ASKOK('There might be a problem...',
      CALL EASKI(ICNTMT,'After how many re_defining warning messages',
*subroutine KCHKMN
*item KCHKMN message_for_surf_cond
'Changing this will remove the temperature or moisture'
'dependency.'
*enditem
      CALL ASKOK(MSG1,MSG2,OK,dok,2)
*subroutine THMENU
*item THMENU non_linear_thrm_prop
'ESP_r allows defining the thermal properties of'
'materials to be linearly or non-linearly temperature'
'dependent .'
'For defining linear dependency of thermal conductivity:'
'option (k) of simulator menu is recommended du to its'
'flixibility .    '
'       '
'Via this menu you can descripe the variation (or'
'change) of the thermal properties (1: conductivity, '
'2:density, 3:heat capacity) of any layer (except air'
'gaps) as a function of temperature.  You can also '
'describe the variation of any thermal property of a '
'layer by more than one thermal functions (i.e. each'
'thermal function will be valid only for the temperature'
'range associated with it). Show me more has details. '
'  '
' The available options are :'
'  (a)  Show the next available thermal function'
'  (b)  Define the actuator location for displayed '
'       thermal function (via  other menues )'
'       The actuator location is required to define the'
'       range of layers for which the thermal equations,'
'       of the same thermal function, are applied.'
'       options are:'
'         complete building, selected zone, seleted construction'
          or selected layer'
'  '
'  (c)  define the thermal equation for  displayed '
'       thermal function  (via  other menues )'
'  '
'  (d)  creat a new thermal function which will be'
'       displayed in  NON-LINEAR PROPERTIES  menu'
'  '
'  (e)  delete the displayed thermal function and all'
'       data associated with it '
'  '
'  (f/g/h) manage the thermal configuration file which'
'       holds the user directives for these properties.'
'  '
'  (!)  list the complete  description of  thermal'
'       configuration defined so far '
'  (?)  display this window'
'  (-)  exit from then menu.'
'  '
'Note, when exiting from this facility if there have been'
'warnings or errors reported you should fix them if possible'
'so subsequent simulations run cleanly.'
*enditem
        CALL EPICKS(INPICK,IVAL2,' ',' ',24,4,ITEM2,
        CALL EPICKS(INPICK,IVAL3,' ',' ', 20,NCOMP,ITEM3,
        CALL EPICKS(INPICK,IVAL4,' ',' ',20,NC,ITEM4,
        CALL EPICKS(INPICK,IVAL5,' ',' ',20,NEL,ITEM5,
        CALL EASKS(ltmp,' Thermal configuration file name ?',' ',
        CALL EASKS(ltmp,' Thermal configuration file name ?',' ',
        CALL PHELPD('non-linear',30,'non-linear  ',0,0,IER)
        CALL ASKOK(' WARNING messages were detected',
        CALL ASKOK(' ',
*subroutine THRMEQ
*item THRMEQ thermal_equation_edit
'This menu is used to creat and/ or modify the thermal'
'equations of the thermal functions.  Modifying a'
'thermal equation is acheived by selecting it.'
'The available thermo-physical property types are:'
' '
'1 thermal conductivity'
'2 density'
'3 thermal capacity.'
' '
'The thermal equation is defined by:'
'               b       c       d       e'
'   P = A + B * T + C * T + D * T + E * T'
'   '
'where each thermal equation defines the dependence of'
'the property for the temperature range provided.'
'  '
' option c provides a list of the current equations.'
'  '
' options d/e/f/g are used to manage the thermal file which'
'   holds the user directives on linear/non-linear thermal'
'   properties.'
'  '
'When you create or edit an equation you are asked to give'
'it a title (up to 72 characters). It is recommended that'
'this title includes the material and thermo-physical'
'property names.'
*enditem
        CALL EASKS(EQNTXT,EQNMSG,' ',72,' ','thermal data',IER,12)
        CALL EASKS(EQNTXT,EQNMSG,' ',72,' ',' data ',IER,13)
        CALL EASKS(THFIL,' Thermal data file name ?',' ',72,' ',
        CALL EASKI(INUM,
        CALL EASKS(TITLE,' Title for this thermal equation?',' ',
        CALL PHELPD('equation mods',3,'-',0,0,IER)
*subroutine ADDCNTL
*item ADDCNTL ctl_manage_loops
'Controls are referenced by their index. '
'If you select cancel then you will be returned to '
'control menu. '
*enditem
        CALL EASKI(ID,' ',' Which control index to delete? ',
*item ADDCNTL ctl_add_loops
'Control day types allows different control patterns on'
'different days. Days are allotted to be weekdays, saturdays,'
'sundays holiday by default. New day types (e.g.'
'system_maintenance) can be defined and days linked to these'
'new day types via the calendar option in the Model Context'
'Menu. Please setup day types PRIOR to starting to define'
'zone controls.'
'  '
'If you choose to follow calendar day types you will have'
'the choice of imposing different control regimes on '
'different day types as default week/sat/sun/hol or as '
'defined from the calendar in the Model Context Menu. '
'If you choose [just one day type] then the '
'same control regime will be used for all day types.'
'If you choose [calendar day types] or [just one day type]'
'then these day types are assumed to be valid all '
'year long. '
'  '
'The [dates of validity] is a legacy facility which allowed'
'you to define a start-end period within which to apply control'
'e.g. for summer and winter. You can use calendar day types to'
'achieve the same purpose.  Dates of validity should cover the'
'whole year and be continuous. If you do not intend to control'
'during any gap period add a free floating controller with an.'
'appropriate period of validity for the gap.'
'  '
'When adding a control loop you are asked for the number'
'of periods for each day type. The default is one period'
'starting at midnight and a free-float control.'
'You can specify that there will be several periods in'
'the day and then supply details later or add or delete'
'periods or adapt the timing.'
'  '
'If you cancel when specifying periods in the day type'
'the control loop will be removed. '
*enditem
          CALL EASKABC(outs,'(see help)',
	  CALL EASKI(IVP,'No of user defined control periods ',
          CALL EASKPER('Dates of validity:',IBDY,IEDY,IFDY,IER)
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
          CALL EASKABC(outs,'(see help)',
	  CALL EASKI(IVP,'No of user defined control periods ',
          CALL EASKPER('Dates of validity:',IBDY,IEDY,IFDY,IER)
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
          CALL EASKABC(outs,'(see help)',
          CALL EASKI(IVP,'No of user defined control periods ',
          CALL EASKPER('Dates of validity:',IBDY,IEDY,IFDY,IER)
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
          CALL EASKABC(outs,'(see help)',
          CALL EASKABC(outs,'(see help)',
	  CALL EASKI(IVP,'No of user defined control periods ',
          CALL EASKPER('Dates of validity:',IBDY,IEDY,IFDY,IER)
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
          CALL EASKABC(outs,' ',
          CALL EASKI(IV,'No of user defined control day types',' ',
          CALL EASKI(IP,outs,'(default is 1 period free floating)',
*item ADDCNTL ctl_copy_loops
'Control functions are referenced by their index. You are asked'
'to identify which existing control loop to copy.'
'A cancel returns you to the main control menu. '
*enditem
        CALL EASKI(ICC,' ',' Which control function index to copy? ',
*subroutine ADDCTLD
*item ADDCTLD ctl_add_day_type
'You can modify the existing control day types in the model'
'by deleting a day type or adding a day type or copying a day'
'type.'
'  '
'If you ask to delete you are asked to provide the index of the day'
'type to act on.'
'  '
'If you ask to add a day type the default treatment is to'
'create one period in that day and set the control logic to'
'free-float. However you can specify several periods in the'
'new day type and period details that you can later change.'
'  '
'If you ask to copy a day type you are asked to identify which'
'one to copy. This is a rarely used option.'
'  '
'If you select continue then you will be returned to'
'the main control menu without any changes. '
*enditem
      CALL EASKABCD('Options: ',' ','delete day type',
      CALL EASKI(ID,' ',' Which day type (index)? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IP,' How many periods in this day type? ',
      CALL EASKI(IDC,' ',' Which day type to copy ? ',
*subroutine ADDCTLDP
*item ADDCTLDP ctl_period_manage
'You can modify the existing control period in the model'
'by deleting a period or adding a period.'
'  '
'If you ask to delete you are asked to provide the index of the'
'period to act on.'
'  '
'If you ask to add a period you are asked its start time'
'and the initial assumption is for a free-float control law.'
'New periods are added at the end of the list (there is no'
'insert period function).
'  '
'It saves time if you set the time carefully when you are'
'first asked for it rather than attempting to edit it later.'
*enditem
      CALL EASKI(IP,' ',' Which period to delete ? ',
*subroutine initperi
*item initperi period_start_hour
'If you edit in actual start times acurately the subsequent '
'editing tasks will be easier. Currently the facility'
'does not support more than 24 periods. '
*enditem
      CALL EASKS(CSTR,' Start hour of each period',
*subroutine initperr
*item initperr period_start_hour
'If you edit in actual start times the subsequent '
'editing tasks will be easier. Currently the facility'
'does not support more than 24 periods. '
*enditem
      CALL EASKS248(CSTR,' Start time of each period',
*subroutine CONTRL
*item CONTRL sys_ctl_file_name
'The system control file holds the definition of the'
'building/plant control systems. The file is optional.'
'  '
'If your model already includes a control file then the'
'dereference option removes knowledge of the file without'
'removing the file.'
'  '
'The browse option presents a list of files in the'
'project [ctl] folder. If you do not select one then'
'it is assumed that you do not want any control.'
'If you cancel then nothing will be changed.'
*enditem
        CALL EASKS2CMD(LASCI,'Control file? (suggested name)',' ',
        CALL EASKS2CMD(LASCI,'Control file? (see help)',
        CALL EASKAB(' File not found.','Options:',
*item CONTRL sys_ctl_overview
'In order to provide realistic controls for zones,'
'plant systems and flow networks, a configuration'
'control file must be created. If this is not done'
'then the simulation will free float.'
' '
'Toggle the control focus to switch between controlled'
'entities. Select a control definition to edit it.'
' '
'The required data  are as follows.'
' + control system title; then for each sub-system'
'   (zones, plant, flow & global):'
'     + title & number of control loops; then for'
'       each loop:'
'         + sensor & actuator location, number of'
'           day types; then for each day type:'
'             + start & finish dates of validity,'
'               number of control periods; then for'
'               each period:'
'                + controller type, control law,'
'                  start time, number of data items'
'                  associated with control law and'
'                  value of each data item.'
'  '
'To edit a control loop select it.'
'  '
' option b: description of the overall control (<248 characters)'
'   for the model
'  '
' option c: documentation of the current domain control '
'   (<248 characters) so in combination there is space for recording'
'   the intent of control within the model.'
'  '
' option d: if zone control this creates associations between'
'   the zones in the model and the control loops. A zone with'
'   no associated control loop is assumed to free-float. A loop'
'   which is not used just takes up space but otherwise does no'
'   harm - so it is ok to create control loops for future use.'
'   You are asked for an index of the control loop that you want'
'   to associate with each zone. A zero specifies no control.'
'  '
' control loops: each control loop is defined by a number of'
'   attributes - which define where the sensor is located, where'
'   the actuator is located, periods when the control is valid'
'   as well as period data. Each of these can be edited separately.'
'  '
' option +:  manages control loops so you can add new controls'
'   delete control loops and copy control loops. You will be'
'   asked for the index of the control you want to act on.'
'  '
' option !: list the current contents of the control loops. The'
'   indicies are decoded into descriptive phrases.'
'  '
' option >: save control data THIS IS IMPORTANT because any'
'  changes are only held in memory until you write to file.'
'  '
'When you exit this facility if you have not specified any links'
'between zones and control loops you are warned (so you can change'
'this if required.'
'  '
*enditem
        CALL EASKS248(t248,' ','Control system description?',
        CALL EASKS248(t248,' ','Zone control description?',
        CALL EASKS248(t248,' ','Plant control description?',
        CALL EASKS248(t248,' ','Flow control description?',
        CALL EASKS248(t248,' ','Global control description?',
        CALL EASKS248(t248,' ','Electrical control description?',
        CALL EASKS248(t248,' ',' Optical control description?',
        CALL EASKS248(t248,' ',' Complex fen. control description?',
        CALL EASKI(ICA,'Associated control function',
        CALL EASKI(ICA,'Associated control function',outs,
        CALL ASKOK('Control functions have not yet been',
        CALL ASKOK(' ','Save changes to control file?',OK,dok,2)
        CALL PHELPD('control help',24,'-',0,0,IER)
        CALL EASKS(LASCI,'Control file?',' ',72,' ','Control file',
        CALL EASKABC(' ','Options:',
        CALL EASKATOG(' ','Options:','delete control loop',
        call MENUATOL(outs,'Editing Options',
        call MENUATOL(outs,'Editing Options',
*subroutine totctlper
*subroutine EBCNTRL
*item EBCNTRL sys_bctl_periods
'A number of control periods can be defined for each'
'control day type. Each period has a start time (N.B'
'periods may not overlap), a sensed property, an actuated'
'property, a control law and miscellaneous data items'
'defining available capacity, set-points etc.'
'  '
' editing common control period data: '
'   start time - a hour plus fraction 10h30 is 10.5'
'     the initial period of a control loop must start at'
'     midnight e.g. 0.0 hours.'
'  '
' option * control periods can be managed by adding a period'
'   at the end of the list of periods (there is no insert'
'   function) or a control loop can be deleted. The only'
'   way to insert a period is to add at the end and then'
'   redefine the earlier priods.'
'   Next time plan your control periods carefully so as to'
'   avoid the need to insert a period.'
*enditem
       CALL PHELPD('control period help',5,'-',0,0,IER)
       CALL EASKABC(' ','Options:',
*item EBCNTRL sys_bctl_types
'The basic zone controller is an ideal controller that will inject'
'or extract sufficient flux (subject to the defined heating and'
'cooling capacities) to ensure the heating and/or cooling set point'
'is reached. It is a good initial controller for use in establishing'
'demand patterns without the need for tuning of PID controllers.'
' '
'A free float controller allows the zone temperature to reach'
'whatever temperature is consistent with the heat gains and losses'
'in the zone. No environmental control is applied. A typical free'
'float might be used in the evening if no frost protection is'
'required.'
' '
'The ideal fixed injection controller represents systems which'
'operate with a fixed input when heating and/or cooling is requested.'
' '
'An ideal proportional controller with optional integral and/or'
'derivative action time allowing full PID control.'
' '
'A control which links a zone with a system network'
' '
'A multi-stage controller with hysteresis allows the specification'
'of heating and cooling capacities for different stages.'
' '
'Variable supply temperature with limit constraints is an idealised'
'air based control that delivers air at a fixed flow rate (same for'
'heating & cooling operation). The heating supply temperature varies'
'up to a maximum setpoint and the cooling supply temperature varies'
'down to a minimum setpoint. '
' '
'Control with separate on/off setpoints allows separate flux ON and'
'flux OFF set points for heating and cooling via and ON until OFF'
'set-point has been reached logic.'
' '
'Time proportioning control with separate on/off setpoint for heating'
'and cooling extends the functionality with cycle time limits. '
' '
'The floating action (three-position) controller uses an open switch'
'and shut switch differential (C) for heating and cooling as well as'
'timestep rate of change for heating and cooling.'
' '
'The optimum start controller allows for three modes of operation'
'(each with rewind): '
' (1) default start at 4:00;'
' (2) start at user defined time;'
' (3) time estimate using Birtles & John equation.'
' '
'Proportional capacity slave controller. Typically a slave control is'
'used to represent an environmental control with a thermostat in one'
'zone and actions in other zones.'
' '
'Match sensed values (ideal:2 setpoints) control law: this is a'
'combination of the ideal controller and control law 11 where values'
'from the temporal file are used to set the setpoints for heating'
'and cooling. '
*enditem
  63    CALL EPICKS(IX,IVALS,' ','Control law:',
        CALL EASKR(tcps,' ','Period start time?',
*item EBCNTRL sys_bctl_thermo_sub
'One specialized control (which is usually a nested control)'
'allows up to three surfaces in a zone to have alternative MLC'
'used as long as the alternative has the same number of layers.'
'These are the indices of the multi-layer constructions'
'for the 1st, 2nd and 3rd surfacesmto which substitutions'
'are to be made. If less than 3 surfaces then assign zero to'
'the remaining slots.'
*enditem
          CALL EASKR(cm(2),outs,' Substitution: 0) off, 1) on?',
          CALL EASKS(HOLD,' ','MLC index for 1st/2nd/3rd surfaces?',
*item EBCNTRL
'The number of data items required is either 5 or 7 and'
'depends on whether there is an extract component (e.g fan).'
' data are:'
'   supply component (select from list) and node index'
'  '
'   coupling type index depends upon the component that'
'   connects the plant to the building zone.'
'     For warm/cool air-based systems use type 1.'
'     While the ESP-r simulator can use an iterative method to'
'     solve the combined buidling and plant systems, it is often'
'     acceptable to solve the two domains sequentially. In this'
'     case the building domain is solved first. The results are'
'     then saved and the simulation moves on to the next time step.'
' '
'     Since the plant domain is solved after the buildng domain,'
'     the building domain solver must use the plant injection'
'     temperature from the previous time step when calculating the'
'     amount of heat injected into the zone. Two methods are offered'
'     for calculating the amount of heat injection/extraction:'
' '
'     1) Sequential boundry conditions: the Simulator uses the'
'       plant boundary conditions from the previous time step but'
'       zone boundary conditions from the present time step (to'
'       solve the zone-side energy balance). This approach can'
'       lead to inequality between the heat flux injected into the'
'       zone and the amount extracted from the plant, especially'
'       at large time steps.'
'  '
'     2) Concurrent boundary conditions: the Simulator uses the'
'       zone and plant conditions from the pervious time step to'
'       calcuate the heat injection that prevailed over the'
'       previous timestep, and injects this into the zone at the'
'       current time step.  This approach ensures that the heat'
'       flows calculated in the building and plant domains can be
'       reconciled over the sumulation period'
' '
'     For radiators, heated floors, etc. use type 2. '
'  '
'   max heating (W) to roughly match component capacity'
'   max cooling (W) to roughly match component capacity'
'   extract component index and variable type
*enditem
          CALL EASKR(cm(1),'Number of miscellaneous','data items?',
          CALL ASKPCMP(' Supply plant component ? ',
          CALL EASKR(cm(4),'  Coupling type',
          CALL EASKAB(
          CALL EASKR(cm(5),' ','Maximum heating flux (W)?',
          CALL EASKR(cm(6),' ','Maximum cooling flux (W)?',
          CALL ASKPCMP(' Extract plant component ? ',
          CALL EASKR(cm(2),' Iteration index',
*item EBCNTRL sys_bctl_heat_pipe
'A specialized control approximates the heat transfer of'
'a heat pipe buried within a construction. You are asked for:'
'  iteration index - zero is none, one allows iteration'
'  index of surface in the zone'
'  index of outer node of heatpipe'
'  index of inner node of heatpipe'
'  critical temperature degrees C'
'  maximum number of iterations'
'  flux difference tollerance to meet (W)'
'  flag for trace zero is none, one is trace on'
*enditem
          CALL EASKR(cm(3),' ',' Surface no with heat pipe ? ',
          CALL EASKR(cm(4),' ',' Outer node for heatpipe ? ',
          CALL EASKR(cm(5),' ',' Inner node for heatpipe ? ',
          CALL EASKR(cm(6),' ',' Critical temperature ? ',
          CALL EASKR(cm(7),' ',' Maximum no of iterations ? ',
          CALL EASKR(cm(8),' ',' Flux difference tolerance ? ',
          CALL EASKR(cm(9),' Trace flag...',
*item EBCNTRL sys_bctl_11
'ESP-r allows you to control to a temperature based on one or'
'two sensor locations (defined as three numbers each) or from'
'a column of timestep information in a temporal file.'
' '
'This is an ideal controller (there is a separate ON/OFF'
'multi-sensor controller as control 12).'
' '
' The number of data items required is in the range 10 to 16'
' and depends on the auxiliary sensor mode selected.'
'  '
'                                   |no. of| |no. of|'
'          Function                 |aux sn| |items |'
 '---------------------------------------------------'
' greatest val of auxiliary sensors     1       10 '
'                                       2       14 '
' least val of auxiliary sensors        1       10 '
'                                       2       14 '
' mean val of auxiliary sensors         1       10 '
'                                       2       14 '
' weighting of auxiliary sensors        2       16 '
'  '
'PLUS 1 item for scaling factor (i.e. a % offset)'
'PLUS 1 item for offset factor (absolute offset) '
' '
'NOTE: if you are using this control to get a setpoint'
'from a temporal file a zone control might already have'
'created within the model context->temporal data menu.'
' '
'Heat delivery is normally set high so that the target'
'temperature is attained. The heating minimum is normally'
'0 but if > 0 then heating will continue at the minimum'
'even when the temperature is reached.'
'  '
'In the unlikely event that you want to control to another'
'temperature but allow no cooling capacity the control may'
'not work properly.'
' '
'At present, this control is limited to 2 auxiliary sensors'
'which may be located outside or in other zone(s).'
'If just one sensor it is assumed to be the mean condition.'
'If multiple sensors then you have the option of:'
' 1: (ref sensor)-(greatest value of aux sensors)'
' 2: (ref sensor)-(least value of aux sensors)'
' 3: (ref sensor)-(mean value of aux sensors)'
' 4: (ref sensor)-(weighting of aux sensors)'
*enditem
        CALL EASKR(cm(1),' ','Number of misc data items (see help)',
        CALL EASKS(HOLD,
        CALL EASKR(cm(6),' ','No of auxiliary sensors?',
        CALL EASKR(cm(7),' ','Multi-sensor mode (see help)?',
*item EBCNTRL bctl_11_aux_sens
'The sensor details are essentially the same as required in'
'a control point sensor ie. '
' 1st aux item >0 is a zone and or surface, =0 any zone,'
'   = -1 measuring plant component,  '
'   = -2 measuring mix air:radiant,'
'   = -3 ambient where the 2nd item is:'
'        0 = db, 1 = sol-air, 2 = wind velo, '
'        3 = wind dir, 4 = diffuse rad, '
'        5 = direc norm rad, 6 = RH'
'  = -5 an item in a temporal file AND the 2nd aux item is'
'       the column of the temporal item.'
'       NOTE: these would already be set for you if you used'
'       the context->temporal data menu option to associate'
'       a temporal setpoint item with a model.'
' '
' 2nd item is used to further specify the location '
' 3rd item is used to further specify the location '
' 4th item is always zero '
'  '
'The sensor weightings must total exactly 100.0. This allows'
'you to discount one of the sensors.'
'  '
'Lastly you can apply a scaling factor to the sensed value'
'derived from the weighted multiple sensors:'
'  sensor scaling factor is applied to the sensed'
'    value at each timestep e.g. (20C sensed x 1.1) would'
'    request a 10% rise over measured.'
'  sensor offset allows you to modify the sensed'
'    value by a fixed amount. '
*enditem
          CALL EASKR(cm(ndx),' ',
          CALL EASKR(cm(ndx+1),' ',' Aux sensor detail 2nd item?',
          CALL EASKR(cm(ndx+2),' ',' Aux sensor detail 3rd item?',
          CALL EASKR(cm(ndx+3),' ',
          CALL EASKR(cm(ndx),' ',
          CALL EASKR(cm(ndx),' ',' Scaling factor?',
          CALL EASKR(cm(ndx+1),' ',' Offset factor?',
*item EBCNTRL sys_bctl_12
'ESP-r allows you to control to a temperature based on one or'
'two sensor locations (defined as three numbers each) or from'
'a column of timestep information in a temporal file.'
' '
'This is an On/Off controller (there is a separate ideal'
'multi-sensor controller as control 11).'
' '
' The number of data items required is in the range 10 to 16'
' and depends on the auxiliary sensor mode selected.'
'  '
'                                   |no. of| |no. of|'
'          Function                 |aux sn| |items |'
 '---------------------------------------------------'
' greatest val of auxiliary sensors     1       10 '
'                                       2       14 '
' least val of auxiliary sensors        1       10 '
'                                       2       14 '
' mean val of auxiliary sensors         1       10 '
'                                       2       14 '
' weighting of auxiliary sensors        2       16 '
'  '
'Heat delivery is normally set high so that the target temperature'
'is attained. The heating minimum is normally 0 but if > 0'
'then heating will continue at the minimum even when the'
'temperature is reached.'
'  '
'In the unlikely event that you want to control to another'
'temperature but allow no cooling capacity the control may'
'not work properly.'
' '
'At present, this control is limited to 2 auxiliary sensors'
'which may be located outside or in other zone(s).'
'If just one sensor it is assumed to be the mean condition.'
'If multiple sensors then you have the option of:'
' 1: (ref sensor)-(greatest value of aux sensors)'
' 2: (ref sensor)-(least value of aux sensors)'
' 3: (ref sensor)-(mean value of aux sensors)'
' 4: (ref sensor)-(weighting of aux sensors)'
*enditem
          CALL EASKR(cm(1),' ',' No. of misc data items ',
          CALL EASKS(HOLD,
          CALL EASKR(cm(6),' ',' No of auxiliary sensors ? ',
          CALL EASKR(cm(7),' ',' Multi-sensor mode ? ',
*item EBCNTRL bctl_12_aux_sens
'The sensor details are essentially the same as required in'
'a control point sensor ie. '
' 1st item >0 is a zone and or surface, =0 any zone,'
'   = -1 measuring plant component,  '
'   = -2 measuring mix air:radiant,'
'   = -3 ambient where the 2nd item is:'
'        0 = db, 1 = sol-air, 2 = wind velo, '
'        3 = wind dir, 4 = diffuse rad, '
'        5 = direc norm rad, 6 = RH'
' '
' 2nd item is used to further specify the location '
' 3rd item is used to further specify the location '
' 4th item is always zero '
'  '
'The sensor weightings must total exactly 100.0. This allows you'
'to discount one of the sensors.'
*enditem
            CALL EASKR(cm(ndx),' ',' Aux sen detail 1st item ?',
            CALL EASKR(cm(ndx+1),' ',' Aux sen detail 2nd item ?',
            CALL EASKR(cm(ndx+2),' ',' Aux sen detail 3rd item ?',
            CALL EASKR(cm(ndx+3),' ',
            CALL EASKR(cm(ndx),' ',' Aux sensor weighting ? ',
*item EBCNTRL sys_bctl_opt_stop
'An optimal stop controller is implemented which requires'
'the following data:'
'  maximum heating capacity (W)'
'  maximum cooling capacity (W)'
'  heating setpoint (C)'
'  cooling setpoint (C)'
'  desired temperature when occupants depart (C)'
'  throttling range (C)'
'  occupancy departure time (hour.fraction)'
'  minimum time difference (fraction of hour)'
'  initial guess for optimal stop time (hour.fraction)'
'  '
'If the difference between successive estimates is less then'
'the [Min. Time Diff], then the latest time is accepted as'
'the [Optimum Stop Time].'
*enditem
          CALL EASKR(cm(2),' ',' Maximum heating capacity (W) ? ',
          CALL EASKR(cm(3),' ',' Maximum cooling capacity (W) ? ',
          CALL EASKR(cm(4),' ',' Htg Set pt ? ',
          CALL EASKR(cm(5),' ',' Clg Set pt ? ',
          CALL EASKR(cm(6),' ',' Desired temp ? ',
          CALL EASKR(cm(7),' ',' Throtl range ? ',
          CALL EASKR(cm(8),' ',' Occpy dept time ? ',
          CALL EASKR(cm(9),' ',' Min time diff ? ',
          CALL EASKR(cm(10),' ',' Initial guess ? ',
*item EBCNTRL sys_bctl_fuzzy
'ESP-r implements two types of fuzzy logic controls.'
'The control attributes holds all the information about the fuzzy'
'membership functions. At least one such set MUST exist if this'
'control law is to used.'
' '
' The control mode may be one of the following:'
' 1:= Fuzzy logic PI control;'
' 2:= Fuzzy logic PD control.'
'  '
' You are asked for a single set point temperature (C).
'  '
' There is a choice of two defuzzification methods:'
' 1:= Mean-of-Max method;'
' 2:= Centre-of-Area method.'
'  '
' Error scale and a change of error scale are used to tune'
' the fuzzy controller.'
'  '
' Lastly there is a output scale value required.'
'  '
'Note: there are no working examples of fuzzy logic in the exemplar'
'models so you may need to study the code in order to arrive at'
'a working fuzzy controller.'
*enditem
          CALL EASKR(cm(2),' ',' Referenced data set ? ',
          CALL EASKR(cm(3),' ',' Control Mode ? ',
          CALL EASKR(cm(4),' ',' Set point ? ',
          CALL EASKR(cm(5),' ',' Defuzzification method ? ',
          CALL EASKR(cm(6),' ',' Error scale ? ',
          CALL EASKR(cm(7),' ',' Change of Error scale ? ',
          CALL EASKR(cm(8),' ',' Output scale ? ',
*item EBCNTRL sys_bctl_multi_sensor
'A multi-sensor control is used to inject/extract heat in one zone'
'(termed source) based on conditions in other locations (termed'
'auxilliary sensors).'
' '
'If any of the auxilliary sensors demands heat then heat will be'
'injected in the source zone. For cooling heat will be extracted'
'from the source. If there are simultaneous demands for heating'
'and cooling nothing will happen.'
' '
'A classic use is to condition a mixing box/air handler used'
'within an air flow network to deliver heating or cooling to'
'an occupied space. '
' '
'If you are using a multi-sensor controller to enable a chilled'
'ceiling (represented as a zone) or a radiant heating panel'
'or a Korean Ondol thin floor heater (represented as a zone)'
'then these set  points are the temperature of the working fluid in'
'the radiant panel. Later you will be asked for the set points'
'for the occupied space(s). '
' '
'If you do not wish cooling use a high set point such as 100C'
'A 0 deg C cooling setpoint does not turn cooling off. '
' '
'Example: to heat a radiant panel to 70C in order to get a'
'temperature of 21C in adjacent room(s).'
' '
'Heat delivery may be less than the max. If minimium'
'heating > 0 then heating will continue at a reduced level'
'even when the setpoint is reached. If there is no cooling'
'then use zero values in conjunction with a high cooling setpoint.'
' '
'Note this type of control is an ON/OFF control and thus you'
'should use an appropriately short timestep of one or two minutes'
'if there is not much mass in the radiant panel or if there is a'
'considerable air air flow rate. '
' '
'Note: set the sensor at the air node rather than mixed rad/conv.'
' '
'Also for both heating and cooling panels it is common to inject'
'at the air node and to use a heat transfer coefficient regime '
'at the surfaces to ensure flux is transferred to the panel. '
'For a mixing box it is usually not necessary to use a hc regime.'
' '
'The aux sensor details are the usual 4 values:'
'  Example: to sense air temperature is 3rd zone'
'    3.0  0.0  0.0  0.0'
' '
'This data is followed - per sensor - by the heating set-point'
'and cooling set-point for that auxiliary sensor.'
' '
'Thus the number of control data items is thus 7 + 6 * no. of sensors'
' '
' Example: to sense air temperature in 3rd zone which'
'    needs to be heated to 21.1C and no cooling'
'    3.0 0.0 0.0 0.0 21.1 100.0 '
'  '
'It is worth gathering information on sensor locations and carefully'
'checking the data/QA report afterwards.'
*enditem
          CALL EASKS(HOLD,' Max & Min heat capacity, Max & Min cool ',
          CALL EASKS(HOLD,
          CALL EASKI(I8,' ',' Number of aux sensors (see help)',
          CALL EASKR(cm(ndx),' ',' Aux sensor detail 1st item ?',
          CALL EASKR(cm(ndx+1),' ',' Aux sensor detail 2nd item ?',
          CALL EASKR(cm(ndx+2),' ',' Aux sensor detail 3rd item ?',
          CALL EASKR(cm(ndx+3),' ',
          CALL EASKR(cm(ndx+4),' ',' Aux sensor heating set-point ?',
          CALL EASKR(cm(ndx+5),' ',' Aux sensor cooling set-point ?',
*item EBCNTRL sys_bctl_wetted_surf
'A wetted surface can either be a wet opaque surface in the zone or'
'the floor of the zone can contain a swimming pool, some additional'
'data is required from user for this option.'
'  '
'If you choose to incorporate a swimming pool model into this'
'zone 1) the floor internal convective heat transfer coefficient and'
'emissivity are set to small values (i.e. 0.001) and that'
' 2) the external boundary condition is set to adiabatic.'
'Please do this after defining the pool controller.'
'  '
'Data requirements: '
' 1) pool surface area m^2'
' 2) pool surface convective htc W/m^2K'
' 3) pool surface radiative htc W/m^2K'
' 4) pool set point temperature degC'
' 5) surrounding ground temperature degC'
' 6) pool water supply rate kg/s'
' 7) pool water supply temperature degC'
' 8) submerged wall surface area m^2'
' 9) submerged wall surface U-value W/m^2'
' '
'If you choose cancel the controller data will not be'
'altered and you will be returned to the main menu. '
*enditem
          CALL EASKAB('Wetted surface options:',' ',
          call phelpd('pool control help',7,'-',0,0,IER)
          CALL EASKS(HOLD,'Pool surface area(m^2), convective and',
          CALL EASKS(HOLD,'Pool temperature and ground temperature',
          CALL EASKS(HOLD,'water supply rate (kg/s), water supply ',
          CALL EASKS(HOLD,'submerged wall surface area (m^2), ',
*item EBCNTRL sys_bctl_fall_through
'You have selected an unknown controller. So supply the number of'
'control data that you will type in followed by the data values.'
' '
'If you choose cancel the controller data will not be'
'altered and you will be returned to the main menu. '
*enditem
          CALL EASKI(NITEMS,' ',' No of control law data items ?',
          CALL EASKR(cm(MM),outs,' value: ',
*subroutine EOCNTRL
*item EOCNTRL optical_ctl_menu
'ESP-r will in the future implement an optical controller.'
'This facility is work-in-progress...'
'  '
'A number of control periods can be defined for each control day'
'type. Each period has a start time (i.e. they do not overlap),'
'a sensed property, an actuated property, a control law and'
'miscel. data which defines capacity, setpoints, etc.'
'  '
'Periods are added to the end of the list. '
'  '
'Optical controls act as a staged controller - it changes to'
'another stage if sensed value is greater than a set point.'
'Other laws may be added in the future.'
'  '
'Help text for commented out sections of the optical control:'
'  Sensor setpoint (between -1000 and 1000) relative to the'
'  type of sensor.'
'  '
'You will be asked to select the optical property if the sensed'
'value is exceeded.'
'  '
'Bidirectional data is held as sets and you are asked which'
'of these sets to use if the sensed value is exceeded.'
'  '
'You can provide the set-point and the bidirectional dataset'
'(e.g. at a specific slat angle) that will be used above the'
'set-point. The order of the set-points here does not matter'
'as they will be sorted when they will be processed. It is,'
'however, recommended for QA purposes to start from the top'
'using the higher setpoint and carry on following a descending'
'order.'
'  '
'Dataset 1 will always be used unless the control condition is met.'
' '
'The value given should relate to the type of sensor (e.g. in'
'degree C for temperature sensor, in W/m2 for radiation sensor, etc.).'
'  '
'The value given should relate to the bidirectional dataset that'
'will be used above the specified setpoint.'
'  '
'Note: if no change required in an item then accept the current value.'
*enditem
        CALL PHELPD('control period help',8,'-',0,0,IER)
        CALL EASKABC('Options:',' ',
        call MENUATOL(outs,' Available laws',
        CALL EASKR(tcps,' ',' Period start time ? ',
C          CALL EASKR(cm(2),' Set point:',' ',
C          CALL EPICKS(IX,IGVAL,' ',' Glazing types: ',
C          CALL EASKR(cm(2),' Set point:',' ',
C          CALL EASKI(I3,' ','Which bidirectional set to use (1-40)?',
        CALL EASKR(cmlocal(ivert*2),' Set-point:',' ',
        CALL EASKI(I3,' ','Which bidirectional set to use (1-40)?',
        CALL PHELPD('bidirectional control help',9,'-',0,0,IER)
*subroutine edit_CFC_control
*item edit_CFC_control optical_CFC_ctl_menu
'Zones which make use of CFC representations of glazing have'
'control options which are defined in the current facility.'
'  '
'A number of control periods can be defined for each control day'
'type. Each period has a start time (N.B periods may not overlap),'
'a sensed property, an actuated property, a control law and'
'miscellaneous data items defining available capacity, set-points etc.'
'  '
' editing a period control law: select a controller type based'
'   on the nature of the sensor and actuator you will be using.'
'   After you select the controller type you will be asked for'
'   its attributes during the current period.'
'  '
'   The current control types are:'
'     senses temp.      actuates shade ON/OFF'
'     senses temp.      actuates slat angle'
'     senses sol-rad    actuates shade ON/OFF'
'     senses sol-rad    actuates slat angle'
'     senses wind speed actuates shade ON/OFF'
'     senses wind dir.  actuates shade ON/OFF'
'     no sensor (schedule only)'
'  '
'   The current control laws are: basic control or schedule.'
'   If you select no sensor then also select schedule.'
'  '
' option * to add or delete a period. New periods are added'
'   to the end of the list (there is no insert facility). If'
'   you delete a period the list is compacted.'
'  '
*enditem
       CALL PHELPD('control period help',5,'-',0,0,IER)
        CALL EASKABC(' ','Options:',
  64    CALL EPICKS(IX,IVALS,' ',' Controller type: (see help)',
  65    CALL EPICKS(IX,IPVALS,' ',' Complex fen. control law: ',
  62    CALL EASKR(tcps,' ','Period start time?',
*subroutine EPCNTRL
*item EPCNTRL plant_ctl_menu
'ESP-r allows you to specify controls for detailed system'
'components in a plant network. The pattern for setting'
'up control loops is similar to that used for other domains.'
'  '
'A number of control periods can be defined for each control day'
'type. Each period has a start time (i.e. they do not overlap),'
'a sensed property, an actuated property, a control law and'
'miscel. data which defines capacity, setpoints, etc.'
'  '
' editing common control period data: '
'   start time - a hour plus fraction 10h30 is 10.5 the initial'
'     period of a control loop must start at midnight e.g. 0.0 hours.'
'  '
'   control types: Broadly, you want to select based on what is'
'     to be actuated and what is being sensed. There are 42'
'     combinations which can be selected.
'     Sensor choices:'
'       dry bulb temperature, enthalph, 1st phase mass flow,'
'       2nd phase mass flow, additional plant output data (depends'
'       on the specific component) pressure in flow networks,'
'       mass flow, solar radiation, wind speed, wind direction,'
'       and relative humidity in zones and outside. Plus'
'       the DIFFERENCE in temperature, pressure and absolute'
'       pressure'
'     Actuator choices:'
'       flux, flow, variable within a component, mass (diversion)'
'       ratios and other control loops.'
'  '
'This control type information will be used later when setting the'
'control actions as well as the control logic that can applied.'
'  '
' option * control periods can be managed by adding a period at the'
'   end of the list of periods (there is no insert function) or a'
'   control loop can be deleted. The only way to insert a period is'
'   to add at the end and then redefine the earlier priods.'
'   Next time plan your control periods carefully so as to avoid'
'   the need to insert a period.'
'  '
'Note: if no change required in an item then accept the'
'current value.'
*enditem
        CALL PHELPD('control period help',8,'-',0,0,IER)
        CALL EASKABC('Options:',' ',
        CALL EPICKS(IX,IVALS,' ',' Controller type: (see help)',
*item EPCNTRL sys_plant_types
'The [type] numbers relate to the selection you made in the'
'previouos step. Here is a reminder: '
' '
' type 0 is senses dry bulb actuates flux'
' type 1 is senses dry bulb actuates flow'
' type 2 is senses enthalpy actuates flux'
' type 3 is senses enthalpy actuates flow'
' type 4 is senses 1st ph mass flow actuates flux'
' type 5 is senses 1st ph mass flow actuates flow'
' type 6 is senses 2nd ph mass flow actuates flux'
' type 7 is senses 2nd ph mass flow actuates flow'
' type 8 is senses adl plant output actuates flux'
' type 9 is senses adl plant output actuates flow'
' type 10 is senses RH actuates flux'
' type 11 is senses RH actuates flow'
' type 12 is senses dry bulb actuates variable'
' type 13 is senses enthalpy actuates variable'
' type 14 is senses 1st ph flow actuates variable'
' type 15 is senses 2nd ph flow actuates variable'
' type 16 is senses plant output actuates variable'
' type 17 is senses RH actuates variable'
' type 18 is senses dry bulb actuates mass ratio'
' type 19 is senses enthalpy actuates mass ratio'
' type 20 is senses 1st ph flow actuates mass ratio'
' type 21 is senses 1st ph flow actuates mass ratio'
' type 22 is senses plant o/p actuates mass ratio'
' type 23 is senses RH actuates mass ratio'
' type 24 is senses temp diff actuates flow'
' type 25 is senses abs temp diff actuates flow'
' type 26 is senses pressure actuates flow'
' type 27 is senses press diff actuates flow'
' type 28 is senses abs press diff actuates flow'
' type 29 is senses abs mass flow actuates flow'
' type 30 is senses wind speed actuates flow'
' type 31 is senses wind direction actuates flow'
' type 32 is senses dir nor sol rad actuates flow'
' type 33 is senses dif hor sol rad actuates flow'
' type 34 is senses ext rel hum actuates flow'
' type 35 is senses wind speed actuates flux'
' type 36 is senses wind direction actuates flux'
' type 37 is senses dir nor sol rad actuates flux'
' type 38 is senses dif hor sol rad actuates flux'
' type 39 is senses ext rel hum actuates flux'
' type 33 is senses contaminant conc actuates flow'
' type 41 is senses other loops actuates either'
*enditem
        CALL EPICKS(IX,IPVALS,' ',' Plant control law: ',
        CALL EASKR(tcps,' ',' Period start time ? ',
*item EPCNTRL plant_must_be_multi
'This control type only works with multisensing of control loops.'
'The control type will be set to sensing other control loops
'action (type 41) '
*enditem
          CALL PHELPD('control type help',3,'-',0,0,IER)
*item EPCNTRL plant_ctl_pid_flux
' Mode options are:'
' 1: P, PI, PD, PID non-recursive positional control'
' 2: P, PI, PD, PID recursive positional control'
' 3: PI recursive velocity control (rect. integration)'
' 4: PID recursive velocity control (rect. integration)'
' 5: PID recursive velocity control(trapez integration)'
' Note: negate mode number for cooling'
'  '
' The PID flux control data items are in the range'
' 6 to 9 and depends on the PID mode selected, i.e.,'
' For modes 1, -1 , 2, -2 :- '
'     Positional P              -   7 items required,'
'     Positional PI             -   8 items required,'
'     Positional PD             -   8 items required,'
'     Positional PID            -   9 items required,'
' For mode 3, -3:-'
'     Rect. Velocity PID        -   6 items required,'
' For mode 4, -4, 5, -5:-'
'    Trap. Velocity PID        -   7 items required,'
' NOTE: if [AHU dynamic set point] option '
' selected (set point = -1001) then add 7 data'
' items to above.'
' '
'The next questions relate to heating and cooling capacity. Heating/'
'cooling delivery may be less than the max. If min heating/cooling'
'> 0 then heating/clooling will continue at a redued level even '
'when the setpoint is reached. '
' '
'The set point may be specified to be :-'
'(a) a fixed constant value;'
' or'
'(b) determined automatically, in a dynamic manner,'
'    at each simulation times-step, by means of a '
'   psychometric-based algorithm within the program.'
'The latter method (denoted by a setpoint of -1001) should be used'
'when simulating air conditioning refer to'
' ...../esp-r/training/plant/AHU/humidity_ctl in the training folder.'
'  '
'The integral action flag must be specified: 1 if required; 0 uf'
'not required. The integral action time [sec] and derivitive action'
'time [sec] may also be requested. A derivitive action flag must be'
'set: 1 if required; 0 if not required.'
'  '
*enditem
          CALL EASKR(cm(2),' ',' PID mode ? ',
          CALL EASKR(cm(1),' ',' No. of misc data items ?',
          CALL EASKS(HOLD,
          CALL EASKR(cm(7),' ',' Integral action flag?',
          CALL EASKR(cm(8),' ',' Integral action time [sec]?',
          CALL EASKR(cm(9),' ',' derivative action flag?',
          CALL EASKR(cm(10),' ',' Derivative action time [sec]?',
          CALL EASKR(cm(8),' ',' derivative action flag?',
          CALL EASKR(cm(9),' ',' Derivative action time [sec]?',
          CALL EASKR(cm(7),' ',' Integral action time [secs]?',
          CALL EASKR(cm(8),' ',' Integral action time [secs]?',
          CALL EASKR(cm(11),' ',' Derivative action time [secs]?',
*item EPCNTRL plant_ctl_pid_flow
' Mode options are:'
' 1: P, PI, PD, PID non-recursive positional control'
' 2: P, PI, PD, PID recursive positional control'
' 3: PI recursive velocity control (rect. integration)'
' 4: PID recursive velocity control (rect. integration)'
' 5: PID recursive velocity control(trapez integration)'
' Note: negate mode number for cooling'
'  '
' The PID flow control data items are in the range'
' 6 to 9 and depends on the PID mode selected, i.e.,'
' For modes 1, -1 , 2, -2 :- '
'     Positional P              -   7 items required,'
'     Positional PI             -   8 items required,'
'     Positional PD             -   8 items required,'
'     Positional PID            -   9 items required,'
' For mode 3, -3:-'
'     Rect. Velocity PID        -   6 items required,'
' For mode 4, -4, 5, -5:-'
'    Trap. Velocity PID        -   7 items required,'
' NOTE: if [AHU dynamic set point] option '
' selected (set point = -1001) then add 7 data'
' items to above.'
'  '
'The set point may be specified to be :-'
'(a) a fixed constant value;'
' or'
'(b) determined automatically, in a dynamic manner, at each'
'    simulation times-step, by means of a psychometric-based'
'    algorithm within the program.'
'  '
'The latter method (indicated by a setpoint of -1001) should be used'
'when simulating air conditioning refer to'
' ...../esp-r/training/plant/AHU/humidity_ctl in the training folder.'
'  '
'The integral action flag must be specified: 1 if required; 0 if'
'not required. The integral action time [sec] and derivitive action'
'time [sec] may also be requested. A derivitive action flag must be'
'set: 1 if required; 0 if not required.'
'  '
*enditem
          CALL EASKR(cm(2),' ',' PID mode? ',
          CALL EASKR(cm(1),' ',' No. of misc data items ?',
          CALL EASKS(HOLD,
          CALL EASKR(cm(7),' ',' Integral action flag?',
          CALL EASKR(cm(8),' ',' Integral action time [seconds]?',
          CALL EASKR(cm(9),' ',' derivative action flag?',
          CALL EASKR(cm(10),' ',' Derivative action time [sec]?',
          CALL EASKR(cm(8),' ',' derivative action flag?',
          CALL EASKR(cm(9),' ',' Derivative action time [sec]?',
          CALL EASKR(cm(7),' ',' Integral action time [seconds]?',
          CALL EASKR(cm(8),' ',' Integral action time [seconds]?',
          CALL EASKR(cm(11),' ',' Derivative action time [secs]?',
*item EPCNTRL plant_ctl_numeric_prop
'ESP-r implemnts a so-called numerical proprotional controller.'
'Attributes are:  '
'  Maximum and minimum output, upper and lower setpoints'
'  and output to overcome hysteresis'
'  '
'No other information is available about this controller.'
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_ctl_opti_start
'ESP-r implements an optimal start controller for system '
'components. Its attributes are:'
'  Maximum output, desired time of arrival, desired temperature,'
'  first second and thrid B&J coefficients
'  '
'No other information is available about this controller.'
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_ctl_prop_damper
'ESP-r implements a proportional damper controller. Its '
'attributes are:'
'  Maximum and minimum damper position'
'  Flox at maximum and minimum positions'
'  1st and 2nd connection indicies.'
'  '
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_ctl_duty_cycle
'ESP-r implements a duty cycle controller for system components.'
'Its attributes are:'
'  Duty cycle period, time steps off, first off time-step'
'  in the cycle period.'
'  '
'All time-steps are in terms of plant time-steps. '
' For example, for a cycle period of, say, 5 '
' time-steps, there could be, say, 2 off, with, e.g'
' the 1st off at the 3rd time-step, and thus the '
' 2nd off at the 4th time-step.'
'  '
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_ctl_on_off
'ESP-r implements a simple ON/OFF controller for plant'
'components. Its attributes are:'
'  mode of operation:'
'                            OUTLO'
' MODE = +1        SPTOFF ----------'
'                  SPTON  ----------'
'                            OUTHI'
'  '
'                            OUTHI'
' MODE = -1        SPTON  ----------'
'                  SPTOFF ----------'
'                            OUTLO'

'  on set point (units depends on control type)'
'  off setpoint (units depends on control type)'
'  output at hi, output at lo'
'  '
'  sensor lag (in plant-timesteps)'
'  actuator lag (in plant-timesteps)'
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_multi_on_off
'ESP-r implements an ON/OFF controller which is linked to'
'multiple auxilary sensors. Attributes of the controller:'
'  Output at high status'
'  Output at low status'
'  Mode of operation:'
'    Mode = +1 for [ON] if control point is less than '
'           specified function of auxilary sensor(s). '
'    Mode = -1 for [ON] if control point is greater than'
'           specified function of auxilary sensor(s). '
'  '
'At present, the control is limited to 2 auxiliary sensors.'
'The following combinations of sensors are supported:'
' 1: greatest value of aux sensors '
' 2: least value of aux sensors '
' 3: mean value of aux sensors '
' 4: weighting of aux sensors '
'  '
'   Sensor lag (in plant-timesteps)'
'   Actuator lag (in plant-timesteps)'
'  '
' The number of data items required is in the range 10 to 16'
' and depends on: (1) number of auxiliary sensors (ns);'
' (2) the auxiliary sensor function mode selected:- '
' '
'                                   |no. of| |no. of|'
'          Function                 |aux sn| |items |'
 '---------------------------------------------------'
' greatest val of auxiliary sensors      1       10 '
'                                        2       14 '
' least val of auxiliary sensors         1       10 '
'                                        2       14 '
' mean val of auxiliary sensors          1       10 '
'                                        2       14 '
' weighting of auxiliary sensors         2       16 '
'  '
'The description of an aux sensor is essentially the same as'
'required in a control point sensor: three indices denoting'
'the location of the sensor.'
'  '
'Weightings for the aux sensors must be supplied. The total'
'must add up to 100.'
*enditem
          CALL EASKR(cm(1),' ',' No. of misc data items ',
          CALL EASKR(cm(2),' ',' Output at [hi] status ? ',
          CALL EASKR(cm(3),' ',' Output at [lo] status ? ',
          CALL EASKR(cm(4),' ',' Output mode ? ',
          CALL EASKR(cm(5),' ',' No of auxiliary sensors ? ',
          CALL EASKR(cm(6),' ',' Multi-sensor auxy function ? ',
          CALL EASKR(cm(7),' ',' Sensor lag? ',
          CALL EASKR(cm(8),' ',' Actuator lag ? ',
          CALL EASKR(cm(ndx),' ',' Aux sen detail 1st item ? ',
          CALL EASKR(cm(ndx+1),' ',' Aux sen detail 2nd item ? ',
          CALL EASKR(cm(ndx+2),' ',' Aux sen detail 3rd item ? ',
          CALL EASKR(cm(ndx+3),' ',
          CALL EASKR(cm(ndx),' ',' Aux sensor weighting ? ',
*item EPCNTRL plant_multi_loops
'ESP-r implements a controller which evaluates the state of other'
'plant control loops.'
'  '
'You will be asked to state how many control loops you want to'
'sense for this controller. For each loop that you specify you'
'will asked a logical relationship with the NEXT loop'
'(.AND. or .OR.) e.g. loop 4 .AND. loop 7 will give the logical'
'outcome of loop 4 and 7 based on their states at that time.'
'  '
'You are asked to a signal ON and signal OFF value for each'
'control loop.
'  '
'The actuator for this component will have its control data modified'
'at run time if the multisensor gives an ON signal. The value of this'
'signal must be given alongwith the index of the control data item'
'e.g. whether control data item no. 1 or 2 is being set.'
' '
'Additionally there is provision to set an overrun time'
'(minutes). This is the time for which the component / parameter'
'actuated by this loop will be on after the control loop sensor'
'goes off.'
' '
'If only one control loop is specified then this controller just '
'follows that loop. If the controlling loop number is specified as a'
'-ve number then this loop will actuate a control that is inverse'
'of the controlling loop'
*enditem
          CALL EASKI(NCLP,' ',' No. of control loops to sense ',
          CALL EASKI(ICLN,' ',' Select control loops number',
          CALL EASKAB('Logical relationship with next loop',' ',
          CALL EASKR(TONV,' ',' Signal value at ON ',
          CALL EASKR(TONV,' ',' Signal value at OFF ',
          CALL EASKI(ICDAT,' ','Which control item to set at ON'
          CALL EASKR(TONV,' ',' Overrun time (min)',
*item EPCNTRL plant_wch_simple_PI
'This control law is a simplified PI controller specially'
'adapted to room control of wet central heating (WCH)'
'systems. It can be used to control the BDATA items of a'
'plant component using PI action.'
'  '
'Alternately it can be used in TPMPI (time proportional'
'modulating proportional integral) mode. In this mode BDATA'
'items are not modified but ON time is controlled'
'  '
'For the implementation for which it was developed it was used'
'to control the upper boiler temperature limit of a WCH boiler'
'depending on the output temperature of a ??'
'  '
'Control inputs are: '
'  Setpoint nominal T_st (default value 21)'
'  Sensed condition T_sen (from sensor definition)'
'  Setpoint max T_max (default value 90)'
'  Setpoint min T_min (default value 20)'
'  Proportional band PB (default value 1)'
'  Bdata item number of actuated plant component, the value of this'
'    parameter will be changed by this controller index BDATA'
'    (default value 10)'
'  Integral reset time AIRT (default value 1)'
'  Integral summation of delta SDELTA'
'  '
'At simulation run time BDATA value will be modified according to'
'the following logic:'
'BDATA=(T_max-T_min)*(DELTA/PB+SDELTA/(PB*AIRT)'
'       + 0.5*(T_max+T_min)'
'If BDATA is bigger than T_max it is reset to T_max or If BDATA is'
'smaller than T_min it is reset to T_min'
'  '
'Optionally an additional control loop can be specified. If this'
'loop is active then BDATA item number is reset to a user defined'
'static value, if you dont want to specify an optional loop leave'
'its value = 0. If optional loop no has a negative value, BDATA is set'
'as with a positive value but CDATA is also set to 1 '
'The TPMPI mode of operation becomes active if cycle time is'
'set to be more than zero.'
' '
*enditem
          CALL EASKS(HOLD,
*item EPCNTRL plant_outside_comp
'ESP-r implements a control which can be used to compensate'
'for outside conditions. It does this by modifying the
'BDATA parameters of a plant component at simulation runtime.'
' '
'It was originally used to control boiler upper temperature '
'limit for wet central heating systems.'
'  '
'The following parameters are used:'
'  Coefficients alpha, beta, gamma with default values'
'   (3.5 2. and 0. respectively)'
'  Nominal temperature 1 = T_st1 (default value 20)'
'  Nominal temperature = T_st (default value 21)'
'  Setpoint max T_max (default value 90)'
'  Setpoint min T_min (default value 20)'
'  ambient temperature T_amb (from climate file)'
'  Sensed condition T_sen (from sensor definition)'
'  Bdata item number of actuated plant component, the'
'    value of this parameter will be changed by this '
'    controller index BDATA (default value 10)'
'  '
'At simulation run time the BDATA value will be'
'If BDATA is bigger than T_max it is reset to T_max or'
'If BDATA is smaller than T_min it is reset to T_min'
'Optionally an additional control loop can be specified'
'it this loop is active then BDATA item number is '
'reset to a user defined static value, if you dont'
'want to specify an optional loop leave its value = 0'
'If optional loop number has a negative value, BDATA is set'
'as with a positive value but CDATA is also set to 1 '
*enditem
          CALL EASKS(HOLD,'alpha, beta, gamma',
          CALL EASKS(HOLD,'nominal1, nominal, max, min, BDATA',
*item EPCNTRL ideal_optimal_start
'This control delays the startup of a control. For example if a '
'heating loop comes on at 5am with the intent that a space will be'
'up to temperature for occupancy at 7am, then if it takes 1.5hours'
'to come up to temperature this loop will delay the start up '
'to 5:30am. The time delay between heating/cooling '
'set on and the space reaching set point (1.5 in the example above)'
'is the same as it took the space on the previous day. '
' '
'Inputs to the control are the loop number and period number'
'that is to be optimised (ie control coming on will be'
'delayed for this period) additionally the time at which '
'set point temperature is to be reached is also an input.'
'Currently no sanity checks are made so the time desired '
'temperature is to be reached should be within the control'
'period of the specified control loop'
'Currently this loop can only work with: '
'control type 3 - basic proportional controller control action 12-17'
'control type 5 - basic proportional controller control action 18-23'
'control type 8 - two position (on/off) controller'
*enditem
*item EPCNTRL ideal_optimal_stop
'This control stops a control early based on a revision of the set '
'point. For example for a heating control if the set point is 20degc'
'and the space takes 30min to cool down to 19degC. Then if the set '
'point revision is -1 the heating control will switch off 30minutes'
'before the actual off time.'
'This controller assumes that temperature will drop to the revised '
'set point within the period this control is active. Otherwise optimal'
'stop will not be activated'
'Inputs to this control are control loop and period number and '
'acceptable revision in set point (-1 in example above)'
' '
'The loop to be optimised should not be the last loop on any day'
'Currently this loop can only work with: '
'control type 3 - basic proportional controller control action 12-17'
'control type 5 - basic proportional controller control action 18-23'
'control type 8 - two position (on/off) controller'
*enditem
      asdf
*subroutine EFCNTRL
*item EFCNTRL flow_ctl_menu
'ESP-r allows you to specify controls for components in a'
'flow network (mostly commonly in terms of a component within'
'a specific flow path in the network). The pattern for setting'
'up control loops is similar to that used for other domains.'
'  '
'Control within flow networks is optional. If you have no control'
'then the nominal characteristics of the flow components are'
'used throughout the assessment. If you want doors or windows to'
'open and close or fans to turn off under specific circumstances'
'then you need to define controls.'
'  '
'Flow controls can be used in combinations to approximate almost'
'any situation or logic combination. Planning of networks is'
'essential so that control actions in parallel and in sequence'
'can be implemented.'
'  '
'A number of control periods can be defined for each control day'
'type. Each period has a start time (i.e. they do not overlap),'
'a sensed property, an actuated property (e.g. flow rate or'
'opening area), a control law and miscel. data which defines'
'setpoints, etc.'
'  '
'Periods are added to the end of the list. There is no insert'
'option. Plan your periods before you define the control loop!'
'  '
' editing common control period data: '
'   start time - a hour plus fraction 10h30 is 10.5 the initial'
'     period of a control loop must start at midnight e.g. 0.0 hours.'
'  '
'Available flow control laws:'
'  on/off/fractional controller - turns a component ON or OFF'
'    based on a sensed condition. It can work directly (ON above'
'    setpoint) or indirectly (ON below setpoint) and you can'
'    specify that ON is some fraction of the nominal size'
'    and/or flow rate of the component.'
'  '
'  proportional with hysteresis - signal lower limit and valve'
'    position, signal upper limit and vale position, delta'
'    signal to overcome hysteresis.'
'  '
'  range based controller which is based on three temperatures'
'    and three flow rates. E.g. flow rate 1 if below 1st temp'
'    and flow rate 2 if above 2nd temp and flor rate 3 if above'
'    3rd temp.' 
'  '
'  multi-sensor on/off to implement complex control logic'
'  '
'  human behaviour algorithm controlling windows and fans'
'  '
'  proportional and integral controller without hysterisis'
'  '
'Note: if no change required in an item then accept the'
'current value.'
*enditem
        CALL PHELPD('control period help',8,'-',0,0,IER)
        CALL EASKABC('Options:',' ',
        call MENUATOL(outs,' Available laws','a on/off',
        CALL EASKR(tcps,' ',' Period start time ? ',
*item EFCNTRL flow_ctl_on_off
'Number of items for on/off controller = 3 '
' 1st is setpoint, '
' 2nd is action index 1=direct, -1=inverse'
'   where direct is ON above setpoint.'
'   and inverse  is ON below setpoint.'
' 3rd is fraction of capacity (e.g. if set to 0.5 of the area,'
'   door width or flow rate of the component is 0.5 x its stated'
'   value) valid fractions are between 0.0 and 1.0 for area based'
'   components and 0.1 to 1.0 for door width. A value of 1.0 is'
'   equivalent to a simple ON:OFF control. If a door control action'
'   would cause it to be less than 10mm wide it is reset to 10mm.'
*enditem
          CALL EASKS(HOLD,
*item EFCNTRL flow_ctl_prop_hyster
'Number of items for proportional controller = 5 '
'  1st is signal (what is sensed for this control) lower limit,'
'  2nd is valve position at lower limit (0-100 %),'
'  3rd is signal (what is sensed for this control) upper limit, '
'  4th is valve position at upper limit (0-100 %),'
'  5th delta signal to overcome hysteresis.'
*enditem
          CALL EASKS(HOLD,
*item EFCNTRL flow_ctl_range_based
'The range based controller acts in the same way as the'
'range based control which can be imposed in scheduled'
'infiltration in the zone operations file.'
'  '
'This could close a window if it is cold outside'
'open it a bit more than normal if the temperature rises'
'and then close the window if it is really hot outside.'
'  '
'Or it could be used to allow a fan to boost in stages'
'based on the temperature.'
'  '
'Number of items for range controller = 6 '
' 1st is low setpoint, '
' 2nd is mid setpint'
' 3nd is high setpint'
' which yields 4 ranges as follows:'
'   low range - below low setpoint, '
'   default range - (nominal area or rate of the component)'
'     between low and mid setpoints,'
'   mid range - between mid and hi setpoints,'
'   high range - above high setpoint. '
' 4th is low range ratio (of rate or area), '
' 5th is mid range ratio (of rate or area),'
' 6th is high range ratio (of rate or area)'
' '
'If within default range then the nominal rate or area is used.'
' '
'NOTE: this controller works with sensed conditions such as node'
'temperature and can be used with components 30 (constant vol),'
'35 (constant mass), 40 (common orifice) 110 (specific air opening)'
'and 130 (bi-directional flow). '
'  '
'The range controler should sense a node temperature or outsie db'
'temperature. It returns a ratio of the nominal rate or area'
'associated with each range. '
*enditem
          CALL EASKS(HOLD,
          CALL EASKS(HOLD,
*item EFCNTRL flow_ctl_multi_sensing
'Some types of flow control require complex logic - e.g. opening a'
'window if the inside temperature is within particular limits and'
'the outside temperature is within particular limits. This can be'
'done with several components in sequence, each with its on logic.'
'Or you can use a multi-sensor flow control applied to a single'
'component.'
'  ' 
'Number of items is = 2 + 8 * no. of sensors'
'  1st is default position: (1=open,0=closed)'
'  2nd is number of auxiliary sensors. Then for each auxiliary'
'  sensor 8 items are needed:'
'    4 items for the sensor location followed by'
'    1 item for the set point temperature'
'    1 item for action flag (1=direct, -1=inverse)'
'    1 item for fraction ON (currently not implemented)'
'    1 item for logical action (AND/OR/NOT/SLAVE)'
'  '
'The connection/component will CHANGE from the default position when'
'the sensed value is above the set-point if action flag is DIRECT.'
'In case the action flag is set to INVERSE, the CHANGE will take'
'place when the sensed value is below the set-point.'
' '
'This CHANGE when it takes place will switch the connection from'
'its default position (open or closed) to the inverse.'
' '
'Any sensor defined in the sensor location menu will be overridden.'
'But sensor needs to be defined to pass though error traps therefore'
'define sensor location as usual. '
' '
'The logical action is a means to combine logically the outcomes'
'of the multiple sensors. e.g. if in a multisensor control comprising'
'3 sensors the  logical action of sensor1 is AND, sensor2 is OR '
'and sensor3 is AND then the outcome of the multisensor will be '
'sensor1 AND sensor2 OR sensor3.'
'Note that logical action of sensor3 is irrelevant.'
' '
'If the NOT/SLAVE option is selected the output of this control'
'loop will be inverse/same of flow connection defined. Any controls'
'on this flow connection must be defined before the NOT/SLAVE 
loop (i.e. this loop) '
' '
'The sensor details are essentially the same as required in a'
'control point sensor ie. '
' 1st item >0 is a zone and or surface, =0 any zone,'
'   = -1 measuring a plant component node,'
'   = -2 measuring mix air:radiant,'
'   = -3 ambient where the 2nd item is:'
'      0 = db,       2 = wind velocity, '
'      3 = wind dir, 4 = diffuse radiation, '
'      5 = direc norm rad, 6 = RH'
'   = -4 measuring a flow side condition.'
' '
'Currently only option -3 and -4 are supported and only node'
'temperature is supported for option -4.  Therefore the four'
'items for sensor location are -3 ? 0 0 where ?=0 or 2 to 6'
'depending upon climate variable. OR. -4 ? 0 0 where ?= node'
'number to be sensed.'
*enditem
          CALL EASKI(NSEN,' ',OUTS,
     &    CALL ASKOK('You have chosen just one sensor, the only option',
          CALL EASKAB('Choose whether NOT or SLAVE',' ','NOT','SLAVE'
          CALL EASKAB('Default position? ',' ','closed','open',IW,56)
          CALL EASKAB(OUTS,' ','Climate variable','Node temperature'
          call MENUATOL(' ',' Climate variables','a temperature',
          call ASKRNOD('  sensed flow node','-',INOD,IER)
          CALL EASKR(cm(ndx+4),' ',' Aux sensor set-point ? ',
          CALL EASKAB('Action Flag (see help)',' ','Direct',
C         CALL EASKR(cm(ndx+6),' ',' Aux sensor "fraction ON"? ',
     &    CALL EASKABC('Logical action variable',
          CALL ASKMFCON(INODE,NNPK,ICPK,prmpt1,prmpt2)
*item EFCNTRL flow_ctl_adaptive
'The windowfan algorithm models occupant behaviour and operates'
'windows and fans based on mean operative and outdoor mean'
'temperatures automatically. '
'  '
'Users need to input the running mean response parameter to'
'outside temperature for the building which is a constant '
'from 0-0.99 (Default value 0.8).'
'  '
'The operative (resultant=0.5mean radiant + 0.5dry bulb) temperature'
'is required for this algorithm. User has to specify internal'
'flow node to be used to calculate this.'
'  '
'If you want to use this controller you probably should read the'
'conference paper by Tuohy, Rijal, Humphreys, Nicol, Samuel and'
'Clarke of IBPSA BS 2007.'
*enditem
          CALL EASKR(cm(2),' ',' Running mean response parameter ? ',
          CALL EASKR(cm(3),'  ','Fraction window openable in day ? ',
          CALL EASKR(cm(4),' ','Fraction fan available for day use?',
          CALL EASKR(cm(5),' ','Fraction window openable in night ? ',
          CALL EASKR(cm(6),' ','Fraction AC available for day use?',
          CALL EASKR(cm(7),' ','Fraction heating available ?',
          CALL EASKR(cm(8),' ','Fraction daylight available?',
          CALL EASKR(cm(9),' ','Power rating of the fan W/m2?',
          CALL EASKR(cm(10),' ','Power rating of the lights W/m2?',
          CALL EASKR(cm(11),' ','Fan comfort temperature adjustment?',
          CALL EASKR(cm(12),' ','Deadband for window open?',
          CALL EASKR(cm(13),' ','Deadband for fan on?',
          CALL EASKR(cm(14),' ','Air intake surface ID?',
 545      call ASKMFNOD(INOPT,NNPK,INPK,prmpt1,prmpt2,9)
          CALL PHELPD('node selection help',2,'-',0,0,IER)
*item EFCNTRL
'This control law is a simplified PI controller (it does not'
'include hysterisis).'
'  '
'Control inputs are: '
'  Setpoint nominal T_st (default value 21)'
'  Sensed condition T_sen (from sensor definition)'
'  max flow fraction Q_max (default value 1)'
'  min flow fraction Q_min (default value 0.3)'
'  Proportional band PB (default value 1)'
'  Integral reset time AIRT (default value 1000)'
' '
'At simulation run time controlled value will be modified'
'according to the following logic:'
'  '
'  VALUE=(Q_max-Q_min)*(DELTA/PB+SDELTA/(PB*AIRT))'
'         + 0.5*(Q_max+Q_min)'
'  '
'Where DELTA=T_sen-T_st and SDELTA is the Integral summation'
'of DELTA '
'If VALUE is bigger than Q_max it is reset to Q_max or'
'If VALUE is smaller than Q_min it is reset to Q_min'
' '
'The action flag may be set to direct acting (default) or'
'inverse acting (action of PI will be inverted e.g. instead of'
'closing it will open a valve) '
' '
'Optionally there is capability to sense using a previously defined'
'multisensing loop. When using this option the usual definition of'
'sensor will be overridden and the output of the multi sensor control'
'loop will be used as the sensed parameter'
*enditem
          CALL EASKS(HOLD,
          CALL EASKAB('Action flag (see help)',' ',
          CALL EASKABC('Which sensor to use',' ',
          CALL EASKR(ocli,' ',' control loop index ',
*subroutine EGCNTRL
*item EGCNTRL
'ESP-r allows you to specify global controls which ?'
'  '
'The pattern for setting up global control loops is different'
'to that used for other domains.'
'  '
'A number of control periods can be defined for each control day'
'type. Each period has a start time (i.e.they do not overlap),'
'a sensed property, an actuated property, a control law and'
'miscel. data.'
'  '
' editing common control period data: '
'   start time - a hour plus fraction 10h30 is 10.5 the initial'
'     period of a control loop must start at midnight e.g. 0.0 hours.'
'  '
'The following control laws are offered:'
'  global on-off has an operational mode [definition?] and a'
'    minimum loops on or a setpoint
'  '
'  global capacity controller is based on a global heating and'
'    cooling capacity and a no shed value.'
'  '
'  global schedule on controller asks for a number of scheduled'
'    control loops.'
'  '
'  global multi-sensor controller senses the state of mass flow'
'    and plant control loops and actuates one named control'
'    loop.'
'  '
'Note: if no change required in an item then accept the current value.'
*enditem
        CALL PHELPD('control period help',8,'-',0,0,IER)
        CALL EASKABC('Options:',' ',
        call MENUATOL(outs,' Available laws',
        CALL EASKS(HOLD,' Mode; Min ON [mode_1] or stpt [mode_2]',
        CALL EASKS(HOLD,'Glb htg capy, Glb clg capy, No shed ',
        CALL EASKS(HOLD,'No. of scheduled loops',
*item EGCNTRL global_ctl_multi_sens
'This control senses the state of other control loops and actuates'
'one named control loop -- overriding the original actuation state'
'of the actuated loop. '
'  '
'These are termed sensed & actuated loop respectively. Currently'
'it supports the mass flow and plant domains '
' '
'A logical relationship amongst the sensed loops takes one of the'
'following forms:'
'  '
'AND or OR: Acts on more than one sensed loops and controls the'
'   actuated loop to ON/OFF based on logical output of the AND/OR'
'   relationship'
'  '
'NOT: Acts on one or more loops. The actuated loop is OFF if any'
'   one of the sensed loops is ON and vice versa.'
'  '
'SLAVE: Acts on one or more loops. The actuated loop if OFF if any'
'   one of the sensed loops is OFF and vice versa.'
'  '
'For sensed loops that control fractionally between ON/OFF. The'
'above logical relationships assume ON to be anything that is not'
'OFF. Two mechanisms of fractional control are also provided:'
'  '
'  MAX or MIN: Acts on more than one sensed loops and'
'    controls the actuated loop to maximum/minimum of '
'    sensed loops.'
'  '
'NOTE that MAX/MIN is only applicable to flow domain because control'
'is in terms of relative values. (Control in plant may be in terms'
'of absolute or relative values hence MAX/MIN should not be used here)'
*enditem
          CALL EASKI(nClp,' ','Number of loops to sense ?',
          call MENUATOL(outs(1:iotsl),outs(1:iotsl),
          CALL EASKI(NLPS,' ','Loop number to sense ?',
          CALL EASKATOG('Logical action variable',
          call MENUATOL(outs(1:iotsl),'select actuation domain',
          CALL EASKI(IAPS,' ','Loop number to actuate ?',
*subroutine senloc
*item senloc senslocation_bld
'In the building solution domain sensors for ideal controls can'
'be placed in the locations listed in the menu. This list is'
'similar to but not identical to that of the other domains.'
'  '
'The variety of locations is broad so as to give you maximum'
'flexibility. The location you select tends to define the nature'
'of what is sensed.'
'  '
'Note option a allows you to define a controller which can be'
'  applied to almost any zone in your model.' 
'  '
'Option b needs a more specific location and you will be asked'
'  to identify which zone and where in the zone.'
'  '
'Options c-i use data in the climate file as sensed conditions'
'  the most common is ambient drybulb.'
'  '
'Option j allows you to read in timestep values (setpoints) in a'
'  model temporal file. You are asked for the index of the temporal'
'  item (hint - find this via the context -> use measured data menu.'
'  '
'Option k takes its output from a function generator so that'
'  standard test patterns can be implemented.'
'  The available functions are:'
' '
'   Function          supp1    supp2    supp3   supp4'
'   ================================================ '
'   1. Step:          start    finish   max     min  '
'   2. Ramp:          start    finish   max     min  '
'   3. Square sine:   max      min      freq    ---  '
'   4. Square cosine: max      min      freq    ---  '
'   5: Triangular:    max      min      freq    ---  '
'   6: Saw-tooth:     max      min      freq    ---  '
'   7: Sine:          max      min      freq    shift'
'   8: Cosine:        max      min      freq    shift'
'   9: Sensed propty: inc/dec  ---      ---     ---  '
'  '
'Option l implements switching multi-layer constructions and the'
'  data is overloaded to identify which surfaces the switching will'
'  be applied to.  You are asked for the Upper zone air temperature'
'  limit above which substitution occurs and the lower zone air'
'  temperature below which substitution occurs.'
'  '
'Senses temperature in specific zone - this allows you to be'
'  specific about where in a zone temperatures are sensed. You'
'  will be asked to sepcify the zone and then whether the sensor'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node in the surface.'
'  '
'NESTED CONTROLS - if a question pops up about whether you want'
'nested controls use the default NO. This only applies if you'
'have previously defined a MLC switching controller. And if so'
'you will be asked to idenfity the index of the switching control.'   
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_plant
'In the plant solution domain sensors for control loops can be'
'placed in the locations listed in the menu. This list is similar'
'to but not identical to that of the other domains.'
'  '
'The variety of locations is broad so as to give you maximum'
'flexibility. The location you select tends to define the nature'
'of what is sensed.'
'  '
'Option a allows you to sense one of the output variables in'
'  a plant component - you need to research the component'
'  prior to using this. You are asked for the plant component'
'  index as well as the output type.' 
'  '
'Option b needs a more specific location and you will be asked'
'  to identify which zone and you are asked for a'
'  radiant and convective weighting.'
'  '
'Options c-i use data in the climate file as sensed conditions'
'  the most common is ambient drybulb.'
'  '
'Option j allows you to read in timestep values (setpoints) in a'
'  model temporal file. You are asked for the index of the temporal'
'  item (find this in context -> use measured data menu item).'
'  '
'Option k takes its output from a function generator so that'
'  standard test patterns can be implemented.'
'  The available functions are:'
' '
'   Function          supp1    supp2    supp3   supp4'
'   ================================================ '
'   1. Step:          start    finish   max     min  '
'   2. Ramp:          start    finish   max     min  '
'   3. Square sine:   max      min      freq    ---  '
'   4. Square cosine: max      min      freq    ---  '
'   5: Triangular:    max      min      freq    ---  '
'   6: Saw-tooth:     max      min      freq    ---  '
'   7: Sine:          max      min      freq    shift'
'   8: Cosine:        max      min      freq    shift'
'   9: Sensed propty: inc/dec  ---      ---     ---  '
'  '
'Senses temperature in specific zone - this allows you to be'
'  specific about where in a zone temperatures are sensed. You'
'  will be asked to sepcify the zone and then whether the sensor'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node in the surface.'
'  '   
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_flow
'In the mass flow solution domain sensors for control loops can'
'be placed in the locations listed in the menu. This list is'
'similar to but not identical to that of the other domains.'
'  '
'The variety of locations is broad so as to give you maximum'
'flexibility. The location you select tends to define the nature'
'of what is sensed.'
'  '
'Option a allows you to sense the temperature of a node in'
'  a plant component - you need to research the component'
'  prior to using this. You are asked for the plant component'
'  index as well as the node index. Optionally you can measure'
'  the difference in temperature between two nodes.' 
'  '
'Option b needs a more specific location and you will be asked'
'  to identify which zone and you are asked for a radiant and'
'  convective weighting. Take care when using this. Most users'
'  should use option j.'
'  '
'Options c-i use data in the climate file as sensed conditions'
'  the most common is ambient drybulb.'
'  '
'Option j is the most common choice - sensing flow nodes is'
'  more robust than sensing a zone temperature. In almost all'
'  cases you will be sensing conditions at a flow node rather'
'  than at a specific flow connection (the latter is only used'
'  when the sensed value is to be  1st or 2nd phase mass flow.'
'  Synopsis of sensed properties: '
'  a) Nodes linked to thermal zones will take their temperature'
'     the last know temperature of the zone.  Many users prefer'
'     to sense flow node temperatures rather than sense the'
'     thermal thermal zones directly.'
' '
'  b) enthalpy is know at each node and can be sensed.'
' '
'  c) additional plant output might be something like the demand (W)'
'     of the component.'
' '
'  d/e/g/h) the Delta selections are in the form of the value at'
'     the 1st node of the connection minus the value at the 2nd'
'     node of the connection.'
'     For example: if a window should open if the ambient temperature'
'     is less than a room node temperature and the connection was'
'     defined from ambient to room then the delta T should be'
'     negative for an ON state.'
' '
'  i) contanimate concentration - the units are in g/kg (in other'
'     places you will have used kg/kg)'
'  '
'Senses temperature in specific zone - this allows you to be specific'
'  about where in a zone temperatures are sensed. You will be asked'
'  to sepcify the zone and then whether the sensor is at the air node'
'  or associated with a surface. If a surface then whether at a'
'  surface or at a node in the surface.'
'  '   
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_optical
'In the optical controller sensors for control loops can be placed'
'in the locations listed in the menu. This list is less extensive'
'than other domains.'
'  '
'Note option a allows you to define a controller which can be'
'  applied to almost any zone in your model.' 
'  '
'Option b use data in the climate file'
'  '
'Option c tests the radiation at a specific outside surface.'
'  '
'Option d senses lux. Two methods are available: Light Switch'
' (manual blind control) or Lux level. However, only the second'
' for Lux level is active here. This should be used with care.'
' A tested implementation of both methods is available through'
' the Tranparent Multilayer Control (TMC) files. '
'  '
'Senses temperature in specific zone - this allows you to be'
'  specific about where in a zone temperatures are sensed. You'
'  will be asked to sepcify the zone and then whether the sensor'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node in the surface.'
'  '   
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_CFC
'In the CFC optical controller sensors for control loops can'
'be placed in the locations listed in the menu. This list is'
'less extensive than other domains.'
'  '
'Option b appproximates a comfort sensor and you are asked for'
'  a radiant and convective weighting.' 
'  '
'Option c-h use data in the climate file'
'  '
'Option i tests the radiation at a specific outside surface.'
'  '
'Option j senses lux levels. Two methods are available: Light'
' Switch (manual blind control) or Lux level. However, only the '
' second for Lux level is active here. This should be used with'
' care. A tested implementation of both methods is available'
' through the Tranparent Multilayer Control (TMC) files. '
'  '   
'Depending on the control domain a sensor can be located at one'
'of many places to measure specified parameters of the model.'
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
*item senloc senslocation_nothing
'In the global and power domains sensors are not used.'
'There is nothing much for you to do!'
*enditem
        CALL PHELPD('zone geom file section',3,'-',0,0,IER)
        call askzone(isn1,idef,
        CALL EASKABC('Specific location: ',' ','zone air point',
        call EASKSUR(isn1,isn2,'-','Available surfaces.',' ',IER)
        CALL EASKABC('Specific location in surface: ',' ',
        call asksnode(isn1,isn2,ilayt,isn3t,ier)
        CALL ASKPCMP('Plant component for sensor ? ','-',IP,IER)
        CALL ASKPCMP('Plant component for sensor ? ','-',IP,IER)
        call askzone(isn2T,idef,'Zone for sensor','Select zone','-',
        CALL EASKI(isn3T,' ',' Convective weighting factor (%) ?',
        call askzone(isn1,idef,
        call EASKSUR(isn1,isn2,'-','Available surfaces.',' ',IER)
        call askzone(isn2,idef,
        call EASKSUR(isn2,isn3,'-','Available surfaces.',' ',IER)
        call EASKAB(' ','Available lux level controls:',
        call askzone(isn2,idef,
        call EASKSUR(isn2,isn3,'-','Available surfaces.',' ',IER)
        CALL EASKI(isn2T,'Index of the temporal item to associate with',
        CALL EASKABC(' ',' Flow sensor at:',' flow node (typical) ',
        call MENUATOL(outs,' Sensed Property',
        CALL ASKMFCTM(NCPK,ICPK,'choose','contaminant',NH)
        CALL PHELPD(' ',2,'-',0,0,IER)
        CALL EPICKS(IX,IVALS,' ',' Controller type: ',
        call ASKCON('  flow connections','-',INS,INE,IC,IER)
        CALL EASKI(isn2T,' ',' Required mathematical function ?',
        CALL EASKI(isn2T,' Upper zone air temperature limit',
        CALL EASKI(isn3T,' Lower zone air temperature limit',
        CALL ASKOK(' Are there any nested control functions ?',
        CALL EASKI(isn4T,' ',
*subroutine actloc
*item actloc actlocation_prop_sub
'Up to three surfaces may have substitute properties. The number'
'required is the index in the surface.'
'  '
'A zero signals no substitution as follows: '
'  three non-zero indicies will switcheds three'
'  two non-zero followed by a zero switches two'
'  one non-zero followed by two zeros switches one'
'  '
'If you cancel then data will revert to previous values.'
*enditem
        CALL EASKI(ian1T,' ',' First surface index (see help)?',
        CALL EASKI(ian2T,' ',' Second surface index (see help)?',
        CALL EASKI(ian3T,' ',' Third surface index (see help)?',
*item actloc actlocation_bld
'In the ideal building control domain actuation can be located'
'at one of many locations within the zones of the model.'
'  '
' Available actuation locations:'
'  '
' option a - current zone air point. The controller can be applied'
'   to any zone. The action is pure convective.
'  '
' option b - this requires a specific location and a split between'
'   the radiant and convective injections. The radiant flux will'
'   be distributed to the surfaces in the zone on an area and'
'   emissivity basis. For example, a WCH radiator is really a'
'   mixed radiant and convective source. Depending on its design'
'   it may have up to 60% convective delivery.'
'  '
' actuates specific location - this allows you to be'
'  specific about where in a zone flux is applied. You'
'  will be asked to sepcify the zone and then whether the actuator'
'  is at the air node or associated with a surface. If a surface'
'  then whether at a surface or at a node within the surface.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_plant
'In the plant control domain actuation can be located at one of'
'the nodes within the plant network. You are asked to supply'
'the index of the component as well as the index of the plant'
'node. Do a bit of research on your plant network and components'
'prior to selecting this option.'
'  '
' actuates specific location - this allows you to be specific'
'  about where in a zone flux is applied. You will be asked to'
'  sepcify the zone and then whether the actuator is at the air'
'  node or associated with a surface. If a surface then you are'
'  also asked whether at a surface or at a node within the surface.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_flow
'In the flow control domain actuation can be located at a specific'
'flow connection (e.g. the control is applied to the specific'
'component associated with that connection).'
'  '
'There is also an option to apply control to a component type and all'
'of the places that that component is used. This later option is'
'somewhat more compact but has not been tested recently.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_nothing
'The global control domain and power control domains do not'
'rely on actuation specifications.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_optical
'The optical control domain actuation is focused on the optical'
'properties of surfaces within the model.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
*item actloc actlocation_CFC
'The complex fenistration control domain actuation can cause'
'a change of state in shading layers of a CFC or the slat angle'
'of a slat-type shade within a CFC or schecedule shading and'
'slat angles within a CFC.'
*enditem
        CALL PHELPD('control actuation point',2,'-',0,0,IER)
        CALL EASKABC('Specific location: ',' ','zone air point',
        call EASKSUR(ian1,ian2,'-','Available surfaces.',' ',IER)
        CALL EASKABC('Specific location in surface: ',' ',
        call asksnode(ian1,ian2,ilayt,ian3t,ier)
        CALL ASKPCMP('Plant component for actuator ? ','-',IP,IER)
        call ASKCON(' Flow connection?','-',INS,INE,IC,IER)
        call ASKRNOD('  sensed flow node','-',INOD,IER)
        call ASKRNOD(' 2nd sensed flow node','-',INOD,IER)
        call askzone(ian2,idef,
        call askCFCtype(ian2,ian3,IER)
        call askzone(ian2T,idef,'Zone for actuation','Select zone','-',
        CALL EASKI(ian3T,' ',' Convective weighting factor (%) ?',
        call ASKRCMP(' Flow component?','-',ICMP,IER)
        call ASKRNOD('control on node','-',iv,IER)
        call ASKRNOD(' 1st sensed node name','-',iv,IER)
        call ASKRNOD(' 2nd sensed node name','-',iv,IER)
        call askzone(ian2,idef,
        call askCFCtype(ian2,ian3,IER)
        call askzone(ian2,idef,
        call askCFCtype(ian2,ian3,IER)
*subroutine editctlperiod
*item editctlperiod
*enditem
          CALL ASKOK(' The control period data has changed.',
*item editctlperiod
*enditem
        CALL PHELPD('period control',nctlhelp,'-',0,0,IER)
*item editctlperiod
*enditem
  62    CALL EASKR(tcpst,' ',' Period start time ? ',
*item editctlperiod bld_ctl_period_data
'The zone basic controller is an ideal controller which will inject'
'or extract sufficient heat (subject to the defined heating and'
'cooling capacity) to meet a heating and/or cooling setpoint.'
' '
'A free float controller allows the zone temperature to reach'
'whatever temperature is consistent with the heat gains and losses'
'in the zone. No environmental control is applied. '
' '
'The ideal fixed injection controller represents systems which'
'operate at a fixed rate if heating or cooling is requested. '
' '
'An ideal proportional controller with optional integral (reset)'
'action and/or derivative (rate) action time or to represent full PID.'
' '
'A control which links a zone with a detailed system plant network'
'component.'
' '
'A multi-stage controller with hysteresis has a base heating and'
'cooling capacity and, for each of three stages of incresed '
'capacity for heating and cooling.'
' '
'Variable supply temperature with limit constraints is an idealised'
'air based control that delivers air at a fixed flow rate (same'
'for heating & cooling operation). The heating supply temperature'
'varies up to a maximum setpoint and the cooling supply temperature'
'varies down to a minimum setpoint. '
' '
'Control with separate on/off setpoints allows separate flux ON'
'and flux OFF set points for heating and cooling. It uses an ON'
'until the OFF set-point is reached logic.'
' '
'Time proportioning control with separate on/off setpoints for'
'heating and cooling and extends the standard proportional'
'functionality with cycle time limits.'
' '
'The floating action (three-position) controller which uses an'
'open switch and shut switch differential (C) for heating and'
'cooling as well as timestep rate of change for heating and cooling.'
' '
'The optimum start controller allows for three modes of operation'
'(each with rewind): '
' (1) Default start at 4AM '
' (2) Start at user defined time '
' (3) Birtles & John equation time estimate'
' '
'Proportional capacity slave controller. Typically a slave control'
'is used to represent an environmental control with a thermostat'
'in one zone and actions/actuators in a number of zones. '
' '
'Match sensed values (ideal:2 setpoints) control law: is a combination'
'of ideal controller and ctrl law 11. Values from the temporal file'
'are taken to set setpnts'
'  '
'Further details within each control law interface. '
*enditem
  63    CALL EPICKS(IX,IVALS,' ',' Control law option:',
  64    CALL EPICKS(IX,IVALS,' ',' Control law option:',
        CALL EASKI(ivalue,prompt1(ifoc),prompt2(ifoc),
        CALL EASKR(cmlocal(ifoc),prompt1(ifoc),prompt2(ifoc),
*subroutine stfmenu
*item stfmenu sys_bctl_01_03
'A basic zone controller is an ideal controller that will inject'
'or extract heat (subject to the available heating and cooling '
'capacity) to maintain a given heating and cooling set-point'
'temperature (between these two is considered a dead-band).'
' '
'If there is a deadband then the temperature will float when'
'the sensed condition is between lower and upper'
' '
'If the minimium heating (or cooling) capacity is > 0W then '
'heating (or cooling) will persist even when none is called for.'
' '
'A heating only (or cooling only) scheme may be defined by setting'
'a high cooling such as 100C (or low heating such as 0C) temperature'
'set-point or by defining a zero cooling or heating) capacity.'
'  '
'You can represent a capacity constrained system by specifying a'
'lower capacity for heating or cooling. The control will then try'
'to reach setpoint any you can observe under what conditions it'
'does not does not succeed.'
' '
'In addition to temperature control, it is possible to activate'
'relative humidity (RH) control by:'
' '
'(1) Injection or extraction of moisture (g/s) to the zone.'
'    Humidification and dehumidification capacities are specified'
'    in g/s where 1 g/s of moisture equates to a latent gain/loss of'
'    approximately +/-2.5kW.'
' '
'(2) Heating & cooling the zone. Note however that this approach'
'    will over-ride any temperature control although the defined'
'    heating and cooling capacities will be used. This approach'
'    could be used to check whether a system which is not capable'
'    of moisture injection/extraction can still limit RH swings.'
' '
'Depending on the control method selected, heating or dehumidification'
'will commence if the RH rises above the upper set-point. Likewise, '
'humidification or cooling commences if the RH falls below the lower RH'
' '
'With large thermal capacity system the simulation time step should'
'be constrained to a maximum of 15 minutes to give sufficient control'
'regulation decision points.'
*enditem
*item stfmenu sys_bctl_02
'A free float controller allows the zone temperature to reach'
'whatever value is consistent with the heat gains and losses to'
'the zone. No heating or cooling is applied. This is useful to'
'allow switching between user specified controls and non-controlled'
'periods in a day.  If a zone is never controlled then this can be'
'represented via a link to control loop zero (which represents full'
'time free-float).'
*enditem
*item stfmenu sys_bctl_04
'The ideal fixed injection controller injects a given flux when'
'heating or cooling is requested.'
' '
'This control is best used with a short simulation time-step to'
'avoid temperature oscillation. Depending on the needs of the'
'project this might be 5 minute timesteps or 1 minute timesteps.'
' '
'Heating (or cooling) may be disabled by setting a correspondingly'
'low (or high) set point or by setting the corresponding capacity'
'to zero.'
*enditem
*item stfmenu sys_bctl_05
'This implements an ideal proportional (P) controller with optional'
'integral (I) and/or derivative (D)'
' '
'P action produces an output that is proportional to the sensed'
'deviation from the set point. This can result in an offset.'
' '
'P+I action may be used to elimitate this offset.'
' '
'P+D action is typically used where the heating or coolng system'
'has a fast response. This helps to avoid overshoot. Some users'
'prefer to avoid P+D controls.'
' '
'PID action combines all the above. As with real PID'
'controllers, this controllerneeds to be tuned to the'
'  * overshoots can be caused by excessive integral'
'    action;'
'  * continuous oscillations can be caused by'
'    excessive derivitive action.'
' '
'These controls are best used in association with short simulation'
'time steps (1-3 minutes).'
' '
'If the minimium heating (or cooling) capacity is > 0 then'
'heating (or cooling) will persist even when none is called for.'
' '
'Heating (or cooling) may be disabled by setting a correspondingly'
'low (or high) set point or by setting the corresponding capacity'
'to zero.'
*enditem
*item stfmenu sys_bctl_07
'A multi-stage controller (with hysteresis) has increasing'
'(or equal) heating and cooling capacities defined for'
'several stages. Stage set-points are then defined.'
' '
'The control logic switches to the least stage that will maintain'
'the desired temperature, stepping up and down between stages as'
'appropriate. It can only be in one state each timestep so adjust'
'the timestep if required to ensure better response.'
*enditem
*item stfmenu sys_bctl_08
'This control represents an idealised, air based system that'
'delivers air at a fixed flow rate (same for heating & cooling).'
'The heating supply temperature varies up to a maximum set-point and'
'the cooling supply temperature varies down to a minimum set-point.'
' '
'The room heating and cooling set-points (typically defined so that'
'there is a deadband) are met on the basis of the heating and/or'
'cooling implicit at the defined flow rate and supply temperature,'
'i.e. the capacity and efficiency of the supply is not defined.'
' '
'This control can be used to check whether an air based system is'
'able to meet demand patterns in a room prior to specification of'
'a detailed component based model.'
*enditem
*item stfmenu sys_bctl_10'
'This control allows separate flux ON and flux OFF set points to'
'be specified for heating and cooling.'
' '
'During ON periods the specified flux is applied until the OFF'
'setpoint is reached. When the OFF condition has been reached the'
'flux input is not reactivated until and ON state is agsin reached.'
' '
 'Example: if the temperature goes below 18C turn on heating untill'
'  22C is reached and keep off until the temperature falls below'
'  18C again.'
' '
'Example: if the temperature goes above 26C turn on cooling unti'
'  24C is reached and keep off until the temperature rises to 26C.'
' '
'If the heating OFF and the cooling OFF setpoints verlap then'
'heating and cooling are both ON. '
' '
'Note because the full heating or cooling capacity is used when'
'an ON state is called for a shorter timestep should be used'
'(typically 5 minutes or less). Also the heating and cooling'
'capacity should match the demands of the room otherwise poor temp-'
'erature control will be obtained. '
' '
'This control is an alternative to the basic ideal controller'
'which only has a single setpoint for heating and cooling. '
' '
'You are given the option to discard changes when you exit the period.'
*enditem
*item stfmenu sys_bctl_13
'This control allows separate flux ON and flux OFF set points to'
'be specified for heating and cooling and extends the'
'functionality of the basic separate ON OFF controller by '
'constraining the heating and cooling cycle times. '
' '
'During ON periods the specified flux is applied until the OFF'
'setpoint is reached. When the OFF condition has been reached the'
'flux input is not reactivated until and ON state is again reached.'
' '
 'Example: if the temperature goes below 18C turn on heating until'
'  22C is reached and keep off until the temperature falls below'
'  18C again.'
' '
'Example: if the temperature goes above 26C turn on cooling until'
'  24C is reached and keep off untilthe temperature rises to 26C.'
' '
'Warning: if heating OFF and the cooling OFF setpoints overlap'
'there will be simultaneous operation.'
' '
'This control represents equipment which is constrained by'
'minimum ON and OFF cycle times (minutes) as well as a total'
'cycle period. For example a heating battery which must be on'
'for at least 5 minutes and then must be off for 10 minutes '
'before it can be re-stared and the mfg recommends the heating'
'system only go through three cycles (20 minutes) each hour. '
' '
'The ON and OFF and total cycle times in minutes are defined'
'for heating and then for cooling. The number of minutes of'
'ON and OFF must not exceed the total cycle minutes. '
' '
'Note because the full heating or cooling capacity is used when'
'an ON state is called for a shorter timestep should be used'
'(typically 5 minutes or less). Also the heating and cooling'
'capacity should match the demands of the room otherwise poor temp-'
'erature control will be obtained. '
' '
'If the simulation timestep used is longer than the cycle times'
'then the heating and cooling capacity is reduced to compensate.'
'If the simulation timestep is shorter than the ON OFF cycle times'
'then it is easier to see the control action. '
' '
'IT IS UP TO YOU to set an appropriate simulation timestep. '
' '
'You are given the option to discard changes when you exit the'
'period menu. '
*enditem
*item stfmenu sys_bctl_14
'BCL14 is a floating action (three-position) controller which'
'supports the definition of an open switch and a shut switch'
'differential (C) for heating and cooling as well as timestep'
'rate of change for heating and cooling. '
' '
'This is one of the so-called obscure zone controllers and there'
'might be dragons in the code so take your time and be prepaired'
'for some iteration. '
' '
'The simulation timestep probably should be short e.g.one or two'
'minutes.  The simulation trace facility will report the current'
'state and the prior state for heating and cooling.'
' '
'You are given the option to discard changes when you exit the period.'
*enditem
*item stfmenu sys_bctl_15
'The optimum start controller allows for three modes '
'of operation: '
' (1) Default start at 4AM'
' (2) Start at user defined time'
' (3) Birtles & John equationq estimate which is base on'
'     A New Optimum Start Control Algorithm in Proceedings'
'     of International Symposium on Control and Operation'
'     of Building HVAC Systems in 1985 Trondheim, Norway'
' '
'Note this control is designed for optimum start of heating only.'
'It is one of the lesser used controls - pay attention to the'
'predicted performance.'
' '
'Heating capacity is in W to be used during the optimum startup'
'period. '
' '
'The heating setpoint (C) is the desired temperature at the'
'desired-time-of-arrival. '
' '
'The band of acceptable temperatures (C) is applied to the heating'
'setpoint to provide an upper and lower setpoints. A small band'
'will force tighter control.'
' '
'If the optimal control does not reach the band of acceptable'
'temperature at the desired-time-of-arrival then it will rewind'
'and try again. You can control the time difference between'
'successive trails by setting a minimum-time-difference. '
' '
'The Birtles & John Eqn. asks for three coefficients - the first'
'is a heating constant, the second is a building constant and the'
'third is an exterior temperature constant. Please review the paper'
'in order to understand these coefficients. '
' '
'This control uses a rewind action that resets the simulation'
'timestep and [tries again]. During the simulation the [monitor]'
'facility will get confused and some graphs in the results'
'module might not plot correctly.  Use this control with care. '
' '
'You are given the option to discard changes when you exit the period.'
*enditem
*item stfmenu sys_bctl_21
'Proportional capacity slave controller. Typically a slave control'
'is used to represent an environmental control with a thermostat in'
'one zone and actions in other zones.'
'  '
' Example: a residentail AC system with a central fan delivering'
' to several zones.'
' '
'Flux is delivered to slave control when required by the master'
'control, at same % of base (max) capacity.'
' '
'You are asked for three values:'
'  - index of control loop associated with the master control'
'    (which MUST use a basic ideal controller or a free float'
'    control and the master MUST also sense a specific zone in'
'    the model).'
' '
'  - base (maximum) heating capacity for slave'
'  - base (maximum  cooling capacity for slave.'
' '
'Procedure - first create the master control loop and then create'
'a slave loop for each other zones in the model which are to act'
'as slaves. If the master control loop is for particular day types'
'e.g. weekday Saturday Sunday then each slave control should follow'
'this pattern and the number of periods should also match. '
' '
'The sensor of each slave controller MUST point to the SAME zone'
'that the master controller senses.'
' '
'The actuator of each slave controller MUST point to the slave zone.'
' '
'The simulation timestep should typically be short enough to reflect'
'the cycling of the environmental control system. '
' '
'Example: in a house there is 4kW of heating and the thermostat is'
'in the lounge which has 1kW of heating so the slave capacity in'
'the other zones should total to 3kW. Setting the capacity in each'
'slave zone can be done via different methods:'
' a) as a proportion of the duct flow or radiator size in each'
'    slave zone'
' b) by doing an initial simulation with each zone ideally controlled'
'    and noticing the ratio of the peak demands in each room'
' c) (roughly) as a function of zone volume or floor area.'
' '
'You are given the option to discard changes when you exit the period.'
*enditem
*item stfmenu sys_bctl_22
'This control represents an ideal air based environmental control'
'system that delivers air at a variable flow rate and a fixed supply'
'temperature for cooling to a desired setpoint.'
' '
'In heating mode it reverts to a CAV system at the minimal supply'
'flow rate with terminal reheat applied up to a maximum flux to'
'reach the desired setpoint.'
' '
'There is a single desired room setpoint (C) so the control law will'
'cycle between VAV and CAV model under low-load conditions.'
' '
'It is recommended that a short timestep be used with this control'
'is in the range of 1 - 5 minutes. '
' '
'This control law can be used to check whether an air based system'
'is able to meet demand patterns in a room prior to specification'
'of a detailed component model. If flow rates or supply temperature'
'are not well sepecified then the room temperature will drift '
'as expected. '
' '
'Specification of minimum flow rate is a compromise between what is'
'required for CAV heating and excess cooling in low-load conditions.'
' '
'Typically the maximum flow rate would be equivalent to 12-20 ach'
'in the zone. Low max flow rates can result in failure to meet the'
'desired temperature. And high minimum flow rates can result in'
'overcooling in mild conditions. '
' '
'Additional performance data (e.g. flow rates, reheat) if you'
'invoke control trace at simulation time.'
' '
'NOTE: THIS LAW SHOULD BE CONSIDERED BETA version.'
' '
'You are given the option to discard changes when you exit the period.'
*enditem
*item stfmenu sys_bctl_23
'This control law sets the setpoints based on heating and cooling'
'temperatures as read from a temporal file defined in the model'
'context > impose measured data section of the project manager'
'interface.'
'  '
'Any amount of heating and cooling is added so that the setpoints'
'are met. For clarity, set the capacity to be similar to that'
'actually neede in the zone.'
*enditem
*item stfmenu sys_bctl_24
'Adaptive comfort algorithm models occupant behaviour and operates'
'heating/cooling based on mean operative and outdoor mean temperature'
'automatically.'
'  '
'A comfort temperature is calculated based on the runnig mean'
'response parameter that governs how running mean temperature'
'is calculated. This parameter is a constant from 0-0.99 (Default'
'value 0.8).'
'  '
'The comfort band also needs to be entered, this is the tolerance'
'from calculated comfort temperature and has a default value of 2degC.'
'  '
'This essentially creates a heating and cooling set point of '
'magnitude of comfort band on both sides of the comfort temperature'
'and controls to that temperature based on probability that'
'heating/ccoling will be switched on. '
'  '
'The statically entered set points are currently not used in '
'the calculation but are retained for possible future use. '
*enditem
*item stfmenu sys_bctl_other
'Nothing '
'written '
'yet about '
'this control '
*enditem
*item stfmenu sys_bctl_CFC
'Add explanation about CFC basic shading control should be'
'added here.'
'  '
*enditem
*subroutine exportcad
*item exportcad cad_export_choices
'This facility allows you to export the current model in a format as'
'required by one of the following 3rd party applications.'
' '
'VIEWER, a hidden line perspective program from ABACUS'
'DXF (version 12) file (see the note below)'
'XZIP, an old CAD program from IES'
'RADIANCE, a lighting simulation program from LBL. If your model'
'  includes zone, ground and/or solar obstructions geometry you'
'  can visualise them using RADIANCE. It is assumed that your computer'
'  has the RADIANCE modules installed and their location is defined'
'  in your PATH environment variable. The e2r module does the work.'
' '
'XFIG, a vector plotting program (Linux, OSX and Cygwin) for high-'
'  res wire-frame images. Make sure your model view is correct before'
'  you force a re-draw and export of the wire-frame.'
'MicroGDS, a CAD program, exports a THINGS file with obstructions as'
'  clusters of surfaces.'
'EnergyPlus, (IDF file V3) a building thermal simulation program'
'  from North America. V4 is under testing.'
'VRML Version 2.0, with a matching html file containing surface'
'  attributes which can be viewed with some web browsers.'
'META, transfer file representation of most of an ESP-r model. Used'
'  by a Revit plugin and and ArchiCAD plugin. This file is typically'
'  converted by prj into a standard ESP-r model. This export facility'
'  supports testing of this file format and data structures.'
' '
'General rules assumed in DXF export: '
'* Each thermal zone has a separate layer and the layer name is the'
'  zone name (<12 char without blanks).'
' '
'* If a zone includes shading obstruction blocks then the should be'
'  on a separate layer and the name of the layer should be OBS_'
'  followed by the characters in the zone layer name. Example'
'  the obstructions for layer MANAGER_A are in OBS_MANAGER_A'
' '
'* If you want to identify particular surfaces in a zone as trans-'
'  parent then create and additional layer name starting with TRN_.'
'  Example transparent surfaces in MANAGER_A are in TRN_MANAGER_A.'
'  If you do not create this separate layer then you will have to'
'  manually attribute the glass surfaces in ESP-r.'
' '
'* Shading obstructions are represented via DXF BLOCK entities.'
'  Typically a set of 6 3DFACE objects within each BLOCK. You '
'  could probably also use POLYLINE entities within a BLOCK.'
' '
' * Zone surfaces which have 4 sides use the 3DFACE entity. Zone'
'   surfaces which are triangles or are > 4 sides use POLYLINE'
'   entities. Or you could use POLYLINEs for all zone surfaces.'
' '
'NOTE: if you need to debug the import of CAD data turn the reporting'
'level from silent or standard to detailed.'
' '
'NOTE: if you are useing Native Windows version the paths to the'
'exported files may not work correctly. '
'  '
'Based on which option you select you will be asked for the name of'
'the file to be created. You may need to match specific line'
'endings or file name extensions.'
*enditem
        CALL EASKAB('The model is in a remote folder.',
        CALL EASKS(LFIL,' ','VIEWER file name?',
        CALL EASKS(LFIL,' ','DXF file name?',
        CALL EASKS(LFIL,' ','ZIP file name?',
        CALL ASKOK(' ','Run RADIANCE conversion tool?',OK,dok,6)
        call askok(' ','Is wireframe composition ok?',oke,dok,4)
        call askok(' ','Convert output to xfig format?',ok,dok,1)
        CALL EASKS(LFIL,' ','MicroGDS THINGS file name?'
        CALL EASKS(LFIL,' ','EnergyPlus input file name?',
        CALL EASKR(evert,'EnergyPlus IDF file version?','(3.0)',
        CALL EASKS(LFIL,' ','VRML file name?',
        CALL EASKS(LFIL,' ','ESP-r meta file name?',
       CALL PHELPD('export menu',55,'-',0,0,IER)
*subroutine cadin
*item cadin cad_import_choices
'Executing CAD program by which the zone geometry may be defined.'
'The file created will be requested later for model importing.'
' '
'If the CAD program creates DXF files then PLEASE READ the'
'following section for hints and notes on current options.'
' '
'If the CAD program is able to create ESP compatable files then'
'please assign zone names so that the conversion process will'
'proceed smoothly.'
' '
'ESP-r currently exports and imports a subset of DXF V12. ESP-r'
'only deals with 3D entities. The import process will skip most'
'2D entities because 2D has no meaning within simulation. '
' '
'For a quick exploration of the entity types that ESP-r works with'
'take an existing ESP-r model, export it to DXF and look at the file'
'or import it into a CAD tool.'
' '
'The import facility assumes that you have registered an initail'
'ESP-r model and that there no zones in the model. If your current'
'model has zones you are advised to create a new model and add the'
'existing zones after you have imported the CAD data.'
' '
'General rules: '
'* Each thermal zone has a separate layer and the layer name is the'
'  zone name (<12 char without blanks).'
' '
'* If a zone includes shading obstruction blocks then these should'
'  be on a separate layer and the name of the layer should be'
'  OBS_ followed by the characters in the zone layer name. Example'
'  the obstructions for layer MANAGER_A are in OBS_MANAGER_A'
' '
'* If you want to identify particular surfaces in a zone as'
'  transparent then create and additional layer with the layer name'
'  tstarting with TRN_. Example transparent surfaces in MANAGER_A'
'  are in TRN_MANAGER_A. If you do not create this separate layer'
'  then you will have to manually attribute the glass surfaces.'
' '
'* Shading obstructions are represented via DXF BLOCK entities.'
'  Typically a set of 6 3DFACE objects within each BLOCK. You'
'  could probably also use POLYLINE entities within a BLOCK.'
' '
' * Zone surfaces which are polygons of 4 sides used the 3DFACE'
'   entity. Zone surfaces which are triangles or are > 4 sides'
'   use POLYLINE entities.  Or you could use POLYLINE entities'
'   for all zone surfaces.'
' '
'If the current model includes zones make careful note of any'
'changes you make to the model so that you can restore contiguity'
'when importing from the CAD package. Recommend only using'
'import with new models without zones.'
'  '
'If the file name you supply is not found you are asked to try again.'
*enditem
      CALL PHELPD('CAD warning',58,'-',0,0,IER)
      CALL PHELPD('CAD warning',53,'-',0,0,IER)
      CALL EASKABC('Specify which CAD format to work with',
      CALL EASKS(LFIL,' Put current model into DXF file named: ',
      CALL EASKS(LFIL,' Put current model into ZIP file named: ',
      CALL ASKOK(' ',outs,OK,dok,3)
      CALL ASKOK(' ','Import the CAD transfer file?',OK,dok,2)
      CALL EASKS(LFIL,' File to import ? ',
      call askok(outs,'Try again?',OK,dok,2)
*subroutine rexmpl
*item rexmpl exemplar_menu_help
'These exemplar model sets are available for browsing. Each set'
'comprises a family of models relating to different possible uses'
'of ESP-r.'
' '
'Exemplar models may be used for training purposes or as a record'
'of interesting past projects that might serve as the starting point'
'in some future project.'
' '
'Note to ESP-r Administrators: the [exemplars] file located in'
'directory ~esp-r/training should be kept up to date by appending'
'new models using the key word syntax as explained in the exemplars'
'file.'
'  '
'Exemplar models distributed with ESP-r must conform to a number'
'of requirements which are outlined in the Developers Guide. These'
'are designed to ensure that models are installable on different'
'computer types as well as supporting users who have only minimal'
'skills sets.'
*enditem
        CALL PHELPD('exemplar menu',12,'-',0,0,IER)
*item rexmpl exemplar_set_browse
'To browse one of the exemplar models, simply select it.'
'  '
'You have a choice to BROWSE or OWN IT.'
'  '
'When browsing a model you are prevented from altering its data'
'although you can use it to run simulations. This is enforced in'
'computers running Linux or OSX with looser enforcement on Cygwin'
'and least consistent enforcement in Native Windows i.e. it is'
'likely that the original exemplar files may be corrupted.'
'  '
'If you want to modify the model then the OWN IT option will copy'
'it to a folder you control. On Linux and OSX the $HOME environment'
'variable sets the default location, in Windows $HOMEPATH environment'
'variable sets the default location. Models are copied to this '
'default or a folder you select. NOTE: no checks are made to'
'confirm you have control of the nominated folder).'
'  '
'GTK interface note: the file browser initially points to the home'
'folder, if you click on a folder then what is [selected:] will be'
'used so clear the text in the bottom dialog before you say ok.'
'  '
'Owning a model in Native Windows will most likely copy the model'
'folder to C:/Documents and Setting/user_name. Many models work'
'better if you nominate a place like C:/Esru/Models or C:/Models.'
'  '
'The current set of exemplars: '
*enditem
          CALL PHELPD('exemplar menu',5+nghelp,'-',0,0,IER)
          CALL EASKABCD(exdescr,'Actions:','browse',
*subroutine clickonbitmap
*item clickonbitmap clickon_bitmap_menu
'The click-on-bitmap facility is an alternative geometric input'
'method that can speed up the process. Use only as much detail as'
'required to simplify subsequent attribution and QA tasks. Plan'
'carefully the zoning and critical points that you are going to'
'capture. The following options are available for collecting points:'
'  '
' Zones, ground topology and obstructions can be defined via points'
' from a scanned image of a site plan or floor plan or elevation'
' or one of several predefined grids.'
'  '
' First scan the relevant source and convert it to an X11 (X11'
' monochrome bitmap) file and place this in the project cfg folder.'
'  '
' Ensure that the bitmap is large enough to allow for accurate'
' positioning of the mouse. The bitmap can be larger than the'
' graphic display area (you can pan left right up down within it).'
'  '
' The source image should indicate an origin (X=0.0 Y=0.0),'
' the direction north (optional), and a line of known length'
' (to get scaling pixels to metres from).'
'  '
'Menu options:     '
' Pan: if bitmap larger then display then you can show a portion'
'     of the bitmap and pan around in 50 pixel increments'
' Origin: identifies X=0.0 and Y=0.0 on the bitmap  '
' North: identifies angle between North and Y axis (no'
'     translation/rotation is currently done!)'
' Scaling: select two points a known distance apart (for best'
'     results pick a longer line) and state the distance (m).'
' Gridding: impose a grid overlay and a [snap-to-grid] function.'
'           '
'Input modes:'
'  Adding vertices (with same Z value or different Z) to create'
'  points and later link the vertices to form surfaces.'
'                  '
'  Adding walls - same as a floor plan extrusion. You can input'
'  zones in sequence after defining height of base and top. Note:'
'  grid and the snap-to-grid option is useful here. You must'
'  name the zone prior to creating it (name must be unique) and'
'  supply a descriptive phrase for the zone.'
'                  '
'  Adding vertices for a south or east elevation is supported.'
'  Later you can link them together to form surfaces.'
'                  '
'  Adding vertices to the project ground topology is supported.'
'  Later you can link them together to form surfaces. You will'
'  be asked for a file name to hold the ground topology for'
'  later use by Radiance and viewing in ESP-r.'
' '
'  Adding obstructions for the zones you have created can save time.'
'  Hint: set the gridding small before you start this.'
' '
'Zones and obstructions can be saved or discarded after you type'
'[e] but you must manually save ground topol.'
' '
'HINT: this facility is designed for doing zones and then obstructions'
'in one session.'
'  '
'Coordinates will be lost if you exit without having saved first.'
*enditem
          call askok('Have you saved the ground topology?',' ',ok,
*item clickonbitmap
*enditem
        CALL PHELPD('bitmap opening',59,'-',0,0,IER)
        call easkab('Options for adding objects (see help):',' ',
 56     CALL EASKS(ltmp,' Ground topology/geometry file name ? ',
        CALL EASKS(t15,' Description of the ground?',
        CALL EASKS(ZN,' What do you want to call this new zone ',
 43       CALL EASKS(zd,' What does it represent ',
*item clickonbitmap x11_bitmap_options
'Please convert any bitmap file representing the buidling plan'
'to a monochrom X11 XBM format. Grey-scale or colour images will'
'be dithered in this process and thus may loose resolution.'
'  '
'Take note of the full path to the bitmap file so that you can'
'include this in the dialog when asked for the file name.'
'  '
'Before loading in the bitmap enlarge the graphic feedback area'
'(you will still need to see 4-5 lines of text feedback). A high'
'resolution monitor is helpful!'
'  '
'The bitmap size might be ~1000-3000 pixels wide to allow for accurate'
'positioning of the mouse. ESP-r might fault if you try to use an'
'overly large image file.  Sorry but this facility is only available'
'in the X11 version of the inteface. GTK is pending.'
' '
'If you just want to use a blank bitmap or a bitmap with'
'tickmarks to quickly input zones and/or obstructions'
'then these are also available: '
'  40x40.xbm  710 x 525 pixels 26 ticks hor 19 ticks vert'
'  40x40_notick.xbm  710 x 525 pixels blank'
'  50x50.xbm  886 x 656 pixels 26 ticks hor 19 ticks vert '
'  50x50_notick.xbm 886 x 656 pixels blank'
'  60x60.xbm  1063 x 787 pixels 26 ticks hor 19 ticks vert '
'  60x60_notick.xbm  1063 x 787 pixels blank'
'  '
'User defined bitmaps are probably ok up to 1600 x 1200 pixels'
*enditem
        call MENUATOL('Bitmap options: (see help)',' ',
        CALL EASKXORGTKF(fname,'X11 bitmap file name?',' ',
        CALL EASKATOG(msg,' ','done','left','right','up','down',' ',
        CALL ASKOK(' ',' Redefine origin? ',OK,dok,2)
        CALL ASKOK(' ',' Redefine north? ',OK,dok,2)
        CALL ASKOK(' ',' Redefine scale? ',OK,dok,2)
        CALL EASKR(disn,' ','Distance (metres) between points?',
        CALL ASKOK(' ',' Redefine grid? ',OK,dok,2)
        CALL EASKATOG('Gridding options:',' ',
        CALL EASKR(ZDI,' ',' Distance between grid points?',
*item clickonbitmap click_on_input_modes
'Input modes:'
'  Adding vertices (with same Z value) is useful if you want to'
'  gather information from the bitmap and later link the verticies'
'  to form surfaces.'
'                  '
'  Adding vertices (with different Z values) is useful if you want'
'  to capture information at several levels (e.g. contours on a'
'  site plan)'
'  '
'  Adding walls via a floor plan extrusion. Remember to select the'
'  [corners] anti-clockwise. You will be asked for the Z value of'
'  the base and the top surfaces (not floor/ceiling distance).'
'  '
'  South elevation fills X & Z coords @ one Y coord value.'
'  East elevation  fills Y & Z coords @ one X coord value.'
'  '
'  Ground toplogy will ask for Z value for each point as well as a'
'  file name to hold the information in for later use by Radiance'
'  and later viewing in ESP-r.'
'  '
'  Obstructions asks for 2 points defining front and one point'
'  perpendicular as well as base and top.'
'  '
'If gridding is on and snap-to is on then the selected coordinate'
'may be relocated to the nearest point. '
'  '
'If you switch input modes and were working on floor plans then the'
'history of prior points may be lost. ESP-r sometimes gets confused'
'if you switch input modes during a session.'
*enditem
        call MENUATOL(msg,' Coordinate input options',
        CALL ASKOK(
 46     CALL EASKS(ltmp,' Ground topology/geometry file name ? ',
        CALL EASKS(t15,' Description of the ground?',
        CALL EASKR(Z1,' ',' Elevation of vertices to be selected?',
        CALL EASKR(Z1,' ',' Elevation of the base surface? ',
        CALL EASKR(Y1,' ','Y value for south elevation?',
        CALL EASKR(X1,' ','X value for east elevation?',
        CALL EASKR(Z1,' ',' Elevation of the base of obstruction?',
        CALL EASKR(Z2,' ',' Elevation of the top surface? ',
        CALL EASKR(Z2,' ',' Height (top-bottom) of obstruction?',
*item clickonbitmap click_option_mistake
'You might have selected this option by mistake. ESP-r is expecting'
'to have found a name for a zone at this point. Probably you'
'ment to select the [add another] option first. '
*enditem
          call askok(
          CALL EASKATOG(msg,' ','done','left','right','up','down',
          CALL EASKR(Z3,' ',' Elevation (Z metres)? ',
          CALL EASKR(Z3,' ',' Elevation (Z metres)? ',
*item clickonbitmap user_typed_e
'Having stopped adding points, if you made a mistakes you can clear'
'and start again or you can clear data and return to the menu or'
'save the coordinates into the zone geometry files.'
*enditem
          call easkabc('Options:',' ','clear points & redefine zone',
*item clickonbitmap click_pan_options
'The view within a truncated bitmap can be panned left and right'
'and up and down (by 50 pixel increments)'
*enditem
          CALL EASKATOG(msg,' ','done','left','right','up','down',
          CALL EASKATOG(msg,' ','done','left','right','up','down',
*item clickonbitmap clickon_obstructions
'In order to account for external shading devices, window reveals,'
'trees, outside walls, etc. used in a detailed shading analysis'
'the user should approximate such objects as one or more prisms'
'which are described in a site obstruction file (older versions'
'of ESP-r) or held with the zone geometric information.'
'  '
'You can use the click on facility to define solar obstructions.'
'You will be asked for the blocks attributes:'
'  A descriptive name (up to 12 char) is recommended.'
'  The base elevation of obstruction is in metres.'
'  The height of obstruction (m) (dimension from base to top).'
'  The opaticy of the obstruction 0.0 transparent to'
'    1.0 opaque (for future shading facility). '
'
'And you will be asked to pick a zone to associate the obstructions'
'with. If you want to make obstructions for a different zone then'
'end the points clicking to save work and then ask for another'
'set of obstructions to be created.'
*enditem
          CALL ASKOK(' ','Block position ok? ',OK,dok,1)
          CALL EPICKS(INPIC,IVALS,' ',
          CALL EASKS(S12,' ',' Name of obstruction? ',
          CALL EASKR(Z1,' ',' Elevation of the base of obstruction?',
          CALL EASKR(Z2,' ',' Height of the obstruction?',
          CALL EASKR(blkopaq,' ',
          CALL EASKS(LTMP,' Zone obstructions file? ',
*subroutine EDSITE
*item EDSITE context_overview_menu
'This menu allows site and miscellaneous data to be defined.'
'In most cases the default entries will be acceptable. An'
'explanation of the less obvious entries follows.'
'  '
' options a/b: the location of the model in latitude +north'
'   and -south and longitude difference in degrees from the'
'   local time meridian (+-15 degrees) where east is positive.'
'   (example Glasgow is -4.1 west of Greenwich Meridian)'
'   If you alter either of these values you will be asked'
'   if you want to recalculate shading and/or insolation'
'   patterns for zones that have existing shading data.'
'  '
' option c: solar timing relates to how data is collected and'
'   held within the climate file. Toggle between hour centred'
'   and half-hour centred data.'
'  '
' option e: Some locations reserve days other than Saturday and'
'   Sunday as [weekends]. You can define these days or set a'
'   one day weekend by defining the second day equal to the first.'
'  '
' option h: to document the building and project client address.'
'  '
' option i: to document the simulation team contact information.'
'  '
' option k: ground topology is a description of the ground form'
'   which can be passed to Radiance for enhanced site views. If'
'   there is an existing ground toplogy you may browse or edit'
'   its defining data. To create a new toplogy you may input the'
'   defining data manually or elect to click on points on a bitmap.'
'  '
' option l: Ground temperature profiles define the monthly soil'
'   temperatures at some arbitrary depth (typically 1.5m) for'
'   use as a boundary condition within a simulation. Up to 12'
'   user defined profiles may be defined, each comprising 12'
'   monthly temperature values.'
'  '
'Primary energy conversions convert from predicted demands (for'
'lights, small power heating etc.) to equivalent primary energy units'
'and also equivalent emission values.'
' '
'Dispersed demands are schedules of demands for items such as pumps,'
'lifts etc, that are not simulation (although they could be). These'
'items may then be displayed on an IPV alongside data relating to'
'simulated items.'
' '
'An integrated performance view (IPV) definition specifies the'
'assessments to be included in an IPV, what portion(s) of the model'
'to cover, time periods to consider and any scaling factors to apply.'
' '
'Situation specific wind pressure coefficent sets may be calculated'
'using CPCALC for later use in network air flow modelling.'
' '
'Images are normally in GIF format although other formats may be'
'used where an appropriate display tool'
' '
'Where the time averaging method applied to climate data is known'
'this should be set via the toggle.'
*enditem
        CALL EASKABC(
        CALL ASKOK(outs,' ',OK,DOK,2)
        CALL PHELPD('Model context',30,'-',0,0,IER)
        CALL EASKR(SLAT,' ','Site latitude?',
        CALL EASKR(SLON,' ','Longitude difference from meridian?',
*item EDSITE site_exposure_options
'The site exposure defines the relative view factors between a'
'vertical surface and the sky (S), ground (G) and surrounding'
'buildings (B). These data are used in the calculation of'
'external longwave radiation exchange.'
' '
'The following options are available.'
' '
'                          View factor to:  '
'Context                   S     G     B    '
'=========================================  '
'urban (normal):          0.36  0.36  0.28  '
'urban (low density):     0.41  0.41  0.18  '
'rural:                   0.45  0.45  0.10  '
'urban (equal weighting): 0.33  0.33  0.34  '
'urban (B emphasised):    0.15  0.33  0.52  '
'isolated rural:          0.50  0.50  0.00  '
'totally enclosed:        0.00  0.00  1.00  '
'user defined:             -     -     -    '
'=========================================  '
'  '
'If you select user defined:'
'  0 <= Sky view factor <= .99'
'  0 <= Ground view factor <= .99'
'  0 <= Surroundings view factor <= .99'
*enditem
        CALL EPICKS(IX,IVALS,' ','Site Exposure',
  290   CALL EASKR(skyview,' ','Sky view factor?',
        CALL EASKR(groundview,' ','Ground view factor?',
        CALL EASKR(buildingview,' ','Surroundings view factor?',
        CALL EASKABCD(' ','Ground reflectance method?',
*item EDSITE context_ground_refl
' option d: reflectivity of the ground via different methods:'
'   Constant = time invariant value;'
'   Simple   = 12 monthly values, with user defined snow cover;'
'              you are asked for the number of days with snow'
'              greater than 5cm.'
'   Advanced = hourly snow depth data in an ASCII file with a'
'              single column of data with cm of snow depth at'
'              each of the 8760 hours of the year. Please ensure'
'              that the file exists and check what the path to the'
'              file is.'
'  '
'   Suggested ground reflectance (no snow):'
'     bituminous/gravel roof 0.13'
'     dry, bare ground       0.20'
'     weathered concrete     0.22'
'     grass                  0.26'
'     sand                   0.40'
'     light building surface 0.60'
'  '
'   Suggested ground reflectance (with snow):'
'     city centre    0.20'
'     urban          0.40'
'     rural          0.50'
'     isolated rural 0.70'
*enditem
          CALL EASKR(groundrefl,' ',' Ground reflectance?',
          CALL EASKS(HOLD,' ',
          CALL EASKS(HOLD,' ',
          CALL EASKR(snowgroundrefl,' ',
          CALL EASKS(HOLD,' ',
          CALL EASKS(HOLD,' ',
          CALL EASKR(snowgroundrefl,' ',
          CALL EASKS(SNFNAM,'Enter name of snow depth file',
          CALL ASKOK('File not found: continue?',' ',OK,DOK,2)
        CALL EASKI(idwe1T,'Day index (Mon=1,Tue=2, ...) for',
        CALL EASKI(idwe2T,'Day index (Mon=1,Tue=2, ...) for',
*item EDSITE context_model_year
'Control and scheduling actions based on the day of the week'
'are sensitive to the year associated with the model.'
'  '
'You may accept the one specified with the climate file or'
'provide an alternative.'
' '
'The choice is year impacts the day of the week for'
'1 January. It also will alter the day type associated'
'of days in the calendar which are the standard default'
'weekday/saturday/sunday (but not user defined day types.'
'  '
'You can view a calandar to check that a specific day or days'
'fall on a required date (e.g. to test a heating system-s'
'response under a cold, Monday start).'
*enditem
        CALL EASKI(iyeart,' ','Simulation year?',
        call askok(' ','View calendar?',ok,dok,3)
        call easkabcd(' ','Ground topology defining options:',
        CALL EASKABC(' ','Ground temperature profile options:',
        CALL EASKI(IFOC,' ','Profile to edit?',
        CALL EASKS(HOLD,' ','Temperatures, January- thro June?',
        CALL EASKS(HOLD,' ','Temperatures, July thro December?',
        CALL EASKABC(' ','Energy demand conversion options:',
 142    CALL EASKS(ltmp,' ','IPV description file?',
*subroutine ROAMING
*item ROAMING roaming_choices
'This facility is reserved for specialist use. It is not a'
'user accessible feature.'
*enditem
      CALL PHELPD('Roaming Introduction',19,'-',0,0,IER)
      CALL EASKAB(' ','Roaming file actions:',
      CALL EASKS2CMD(LROAM,' Roaming file? (see help)',
      CALL ASKOK('View location information?',' ',OK,dok,19)
      CALL ASKOK('View cruise schedule?',' ',OK,dok,19)
*subroutine manageimages
*item manageimages model_image_management
'Images may be associated with a model for various purposes -'
'for example to record site conditions or parts of design drawings.'
'The purpose of the image is defined as you add it to the list.'
 from either the model images folder or by entering an'
'absolute path and file name.'
'  '
'Up to 10 images may be associated with a model.'
'  '
'The following image types are supported: gif, tiff, jpeg and'
'X11 bitmap. To edit an image name, select it from the list.'
'  '
'Newer model configuration files can also include a text block'
'(<248 char) explaining each image. '
*enditem
        CALL PHELPD('Model images',11,'-',0,0,IER)
        CALL EASKABCD(' ','Project image options:',
        CALL EASKS248(tcname,' ','Image notes:',
        call easks(limg,'Image file name',' ',72,'xxx.gif',
        CALL EASKS248(tcname,' ','Image notes:',
        CALL EASKS248(tcname,' ','Image notes:',
*subroutine setuptemporal
*item setuptemporal temporal_setup_menu
'Temporal definitions are used to impose short-timestep boundary'
'conditions (e.g. climate data) on a simulation or to modify design'
'parameters (e.g. causal gains or setpoints) as a simulation proceeds.'
' '
'A temporal file holds one or more entries (of one or more types)'
'over a specified number of days and time frequency which can be'
'longer or shorter than the simulation timestep.'
' '
'associations - entries in the temporal file can be associated with'
'  entities in your model (e.g. zones or surfaces) depending on'
'  the type of information. For example climate data is associated'
'  with the whole model and infiltration is associated with a zone.'
' '
'Currently the following item types are offered: '
' ALLCLMT - all climate data (includes next 6 items)'
' BDTEXTT - ambient temperature'
' WINDVLT - wind velocity'
' WINDDRT - wind direction'
' RELHUMT - ambient relative humidity'
' DIFHSLT - diffuse horizonal radiation'
' GLOHSLT - global horizonal radiation'
' DIRSOLT - direct normal solar radiation'
' SETPTTT - control setpoint temperature (single)'
' CASUALT - zone casual gains (combined gains)'
' CASUAL3T -zone casual gains (Occup/Lights/SM Pwr)'
' ACTIVITY -global database: gains,setpoints, etc.'
' BIDIRSET -Bidirectional datasets (e.g. slat angles)'
' VERTSOL -Vertical solar radiation data for a facade'
' HTCLSETP -Specify columns to read H/C setpoints.'
' DBTZNM  - measured zone db temperature'
' SURTM   - measured surface temperature'
' '
'manage associations - you can add and delete existing associations.'
'  Note this does not alter the contents of the temporal file only'
'  the associations included in the model configuration file). '
'  For new associations or when editing associations you are asked to'
'  define associations with zones (e.g. casual gains or ventilation'
'  or with control loops to get a control state or setpoint.'
' '
'dereference temporal file - this removes current links between the'
'  model and the temporal file. It does not remove the temporal file.'
' '
'create file - you supply a file name, if it exists it is scanned'
'  otherwise a minimal file is created.'
' '
'edit/list - contents of the current file are presented and if'
'  you have permission you can alter its contents.'
' '
'General instructions for setting up a temporal file:'
'a) Decide the period of the data (start and end dates) as well'
'   as frequency (1 tsph to 60 tsph).'
'b) If data is to be imported from a file with columns of data'
'   take a note of which columns are required.'
'c) Plan the names of the temporal entities you will be creating'
'   as well as which zones or controls in the model are going to'
'   be associates with the entities in the temporal file.'
' '
*enditem
        CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
        CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
        CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
        CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
        CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
        CALL PHELPD('temporal help',nbhelp,'-',0,0,IER)
        CALL EASKS(ltmp,' ','Temporal definitions file?',
        CALL EASKS(ltmp,' ','Temporal definitions file?',
        CALL EASKS(ltmp,' Temporal definitions file name?',
        call easkabc('Temporal association options:',' ',
        call easkabcd('Temporal association options:',' ',
        CALL EASKI(it,'Temporal item which you do not want to use',
        CALL EASKI(ite,'Which temporal association to modify?',
        CALL EASKI(it,' ','Associate temporal item?',
        CALL EASKI(it,'Temporal item index to associate with',
        call askzone(ic,izdef,' Related zone for casual gains?',
        call askzone(ic,izdef,' Related zone for ventilation?',
        call askzone(ic,izdef,' Related zone for air velocity?',
        call askzone(ic,izdef,' Related zone for control state?',
        call askzone(ic,izdef,' Related zone for activity db?',
        CALL EASKABC(' Control linkage options:',' ',
        CALL EASKI(ispl,'Control loop to use set point data?',
        CALL EASKABC(' Control linkage options:',' ',
*item setuptemporal temporal_ctl_linkage
'If you are linking to an existing control we assume that the'
'existing heating and cooling capacities are adequate for reaching'
'the setpoints in the temporal definition file. You task is to'
'define the columns in the tdf where the setpoints should be read'
'from. Defaults are column 4mfor heating setpoint and column 5 for'
'cooling.'
*enditem
              CALL EASKS(HOLD,
              CALL EASKS(HOLD,
*item setuptemporal temporal_ctl_setpoints
'A temporal item of type SETPPT can be associated with a zone control'
'in order to force the zone temperature to match that recorded'
'in the temporal file. It makes use a control law 11 to do this. '
' '
'If you want to use an existing control it will be updated to'
'impliment the necessary links. If you want to create a new zone'
'control then all of the necessary control period will be generated.'
' '
'If you want to use temporal-based setpoints for several zones you'
'will need a separate temporal item and a separate zone control law'
'for each zone (sorry about that).'
' '
'You will be asked about: '
' a) control loop index (existing or new)'
' b) maximum and minimum heating & cooling capacity which should'
'    have sufficient capacity to maintain the setpoint.'
' c) the zone where the set point will be used '
' '
'It is not necessary to further modify the zone control once it has'
'been created (unless you did not guess the correct capacity. '
' '
'Heat delivery is normally set high so that the target temperature'
'is attained. The heating minimum is normally 0 but if > 0 then '
'heating will continue at the minimum even when the temperature is'
'reached. '
'  '
'In the unlikely event that you want to control to another temperature'
'but allow no cooling capacity the control may not work properly.'
'  '
'A cancel request leaves the model unchanged. '
*enditem
            CALL PHELPD('temporal-control popup',26,'-',0,0,IER)
            CALL EASKABC(' Control linkage options:',' ',
            CALL EASKI(ispl,'Control loop to use set point data?',
            CALL EASKABC(' Control linkage options:',' ',
 255        call askzone(ic,izdef,'Related zone for temporal setpoint?',
            CALL EASKS(HOLD,
            call askzone(ic,izdef,
            call easksur(IC,ISUR,'-',
            call askzone(ic,izdef,
            call easksur(IC,ISUR,'-',
            call askzone(ic,izdef,' Related zone for measured db T?',
            call askzone(ic,izdef,'Related zone for measured surf T?',
            call easksur(IC,ISUR,'-',
            CALL ASKOK(' ',' Use another temporal item?',OK,DOK,2)
*subroutine peconv
*item peconv primary_energy_conv
'Use these emission patterns as an approximation of '
'patterns in several regions. '
' '
'Emissions [grams per kWh primary energy]. '
'Typical UK       CO2    NOx   SOx   '
'Gas              190.   0.3    0.2    '
'Oil              260.   2.5    0.1    '
'Coal             320.   1.3   2.63  '
'Electricity      612.   2.06  7.57   '
'Where heating and DHW are gas, and lights/fans/pumps'
'are electricity. '
' '
'Typical Europe   CO2    NOx   SOx   '
'Gas              190.   0.3   0.2    '
'Oil              260.   2.5   5.0    '
'Coal             320.   1.3   2.63  '
'Electricity      360.   1.2   4.5   '
' '
'Conversion demand units > primary energy units includes'
'both the typical seasonal efficiency of the equipment '
'and transport losses. Transmission losses assumed'
'are 4% for gas, none for fuel oil, none for solid fuel.'
' '
'Heating system efficiencies and conversions are: '
'  gas boiler (fan assisted flue)     68%  1.53'
'  gas boiler (open/balanced flue)    65%  1.60'
'  gas condensing boiler              85%  1.22'
'  gas combi boiler                   72%  1.44'
'  solid fuel (auto feed)             60%  1.73'
'  oil fired (standard)               70%  1.48'
'  oil fired (condensing)             85%  1.22'
'  gas fired warm air (fan asst flue) 80%  1.30'
'  gas fired warm air (open/bal flue) 70%  1.48'
' '
'Cooling system efficiencies and conversions are: '
'  packaged A/C unit assuming 2.5 CoP      1.44'
'  split A/C unit assuming 2.5 CoP         1.44'
' '
'Conversion factors: '
'  small power & lighting: 3.2-3.6 (typical UK) '
'  small power & lighting: ? (typical Europe) '
*enditem
        call easkabc('Typical patterns',' ','UK','Europe','zeros',IW,41)
        CALL PHELPD('prim convers',41,'-',0,0,IER)
        CALL EASKR(pcnvht,' ','Heating primary energy multiplier:',
        CALL EASKR(pcnvcl,' ','Cooling primary energy multiplier:',
        CALL EASKR(pcnvlt,' ','Lighting primary energy multiplier:',
        CALL EASKR(pcnvfn,' ','Fans & pumps primary energy multiplier:',
        CALL EASKR(pcnvsp,' ','Small power primary energy multiplier:',
        CALL EASKR(pcnvhw,' ','Hot water primary energy multiplier:',
        CALL EASKS(HOLD,'Heating related emissions [gr/kWh primary]:',
        CALL EASKS(HOLD,'Cooling related emissions [gr/kWh primary]:',
        CALL EASKS(HOLD,'Lighting related emissions [gr/kWh primary]:',
        CALL EASKS(HOLD,'Fan & pump emissions [gr/kWh primary]:',
        CALL EASKS(HOLD,'Small power emissions [gr/kWh primary]:',
        CALL EASKS(HOLD,'Hot water emissions [gr/kWh primary]:',
*subroutine calenmanage
*item calenmanage calendar_day_types
'This facilitiy sets up and manages a calendar of day types which can'
'be associated with zone casual gains, infiltration schedues and'
'zone/plant/flow controls.'
' '
'The default is to implement weekdays, saturdays and sundays '
'throughout the year.
' '
'You can define additional day types such as holidays for a'
'specific country or company so that occupancy or controls'
'can switch to the holiday attributes which such days are part'
'of a simulation run.'
'  '
'Calendars are also a way to implement seasonal controls. You'
'can define, for example a winter day type that applies for all'
'the Julian days from 1 January to 15 March as well as all the'
'Julian days after 11 November. With seasonal day types then'
'seasonal controls can be implemented with little effort.'
'  '
'Note that day types should be defined AS SOON AS possible! Care'
'is needed when updating controls for new day types. You can'
'either have a minimal control regime for the new day type e.g.'
'one period free floating, or duplicate the data from the last'
'day type currently defined.  If you cancel this action the'
'control file will not be updated - but it will then be'
'out-of-sync with the rest of the model and may not scan corretly.'
'  '
'Care is also needed when updating existing operational schedules
'for new day types. You are asked whether you want to overwrite'
'the current file or save to a new file name. The latter is a good'
'way to preserve the past.' 
' '
'When you create a new day type you are asked for a short phrase'
'identifying the day type. Next you can select one day at a time'
'of define a pattern to follow when assigning days to the calendar.'
'For the pattern option you will first be asked for dates during'
'which the new day type is to be added (called relevant dates).'
'The selected day type will then be added to every Nth day in the'
'relevant dates starting from the first relevant date e.g.'
'N=7 for weekly, N=1 for all days'
'  '
'You can create a day type but not link any days of the year to'
'it. There is currently no facility to remove a day type from the'
'list. You have to select the days that point to it and assign'
'them to another day type.
'  '
'Take care when editing an existing day type - other entities'
'may use the data.'
'  '
'There are several options for displaying calendars. One draws'
'monthly calendars on the graphic feedback area for selected'
'months or for the whole year.'
*enditem
        CALL EASKS(tcalename,' Description of calendar: ',
        CALL PHELPD('calendar day section',3,'-',0,0,IER)
        CALL EASKABC(' Options:',' ',
        CALL EASKS(tcalentag,' Calendar day type tag: ',
        CALL EASKS(tcalendayn,' Calendar day type descripton: ',
        CALL EASKS(tcalentag,' Calendar day type tag: ',
        CALL EASKS(tcalendayn,' Calendar day type descripton: ',
        CALL PHELPD('calendar section',11,'-',0,0,IER)
        call MENUATOL(outs,'Display options:',
        CALL EPICKS(IX,IDVALS,' ',' Available day types:',
        CALL EASKABC('How to add day types (see help)?',' ',
        CALL EPICKS(ixd,ixdvals,' ',' Days in the year:',
        CALL EASKI(IFRQ,
*item calenmanage
'Select one of the existing day types. '
'Note: this applies only to the current day of the year.'
*enditem
        CALL EPICKS(IX,IDVALS,' ',' Available day types:',
*subroutine EDDGTP
*item EDDGTP ground_temp_profile
'Ground temperature profiles define the monthly soil temperatures'
'at arbitrary depths for use as a boundary condition within a'
'simulation.  Up to 12 user defined profiles, each comprising'
'12 monthly temperatures are supported.'
'  '
'The depth that the data is representative for is up to you.'
'If the monthly profile is to be used as the boundary condition'
'for a construction which is 1m thick then the temperature will'
'need to be consistant with that depth.'
'  '
'You will be asked to specify the index of the profile you'
'want to use.'
'  '
'A cancel request leaves the model unchanged.'
*enditem
      CALL EASKABC(' ','Options:',
      CALL EASKI(IFOC,' ',' Index of profile to edit?',
      CALL EASKS(HOLD,' Temperatures January-June:',' ',72,' ',
      CALL EASKS(HOLD,' Temperatures July-December:',' ',72,' ',
*subroutine EDDSHD
*item EDDSHD reflect_site_change
'Shading should be recalculated when the model site latitude or'
'longitude difference from the local time meridian changes. Each'
'affected zone will be done in turn. Do all zones'
'if you start the process.'
*enditem
      CALL EASKABC(' Reflect site change in shading options:',' ',
      CALL ASKOK(outs,' ',OK,DOK,2)
*subroutine CTLWRT
*subroutine e2eplus
*item e2eplus eplus_needs_to_know
'Exporting ESP-r models to EnergyPlus V3 is mostly an automatic'
'process however there are a few things that are needed from you'
'in order to do the conversion. Mostly this includes data that'
'has no direct equivalent or for which a conversion has not yet'
'been written. Energyplus needs to know:'

'  * the offset in hours from GTM West is negative East is positive'
'  '
'  * the site elevation in metres above sea level'
'  '
'  * how many people are represented by the peak occupant gain'
'    in each room. The numbers presented are the sensible and'
'    latent gains and the total of the sensible and latent. '
'  '
'During the scan it will attempt to find a parent surface for'
'doors and windows. If the information is not clear then it will'
'ask for clarification.'
'  '
'The cancel option will skip the creation of the IDF file.'
*enditem
      CALL EASKI(IIC2T,' Time zone (hours +- GTM) ',
      CALL EASKR(SLM,' Site elevation above sea level (m) ',
      CALL EASKR(vpeople,' Number of people in room (see report): ',
      call askok(outs,
      call easksur(izz,iss,'-',outs,' ',ier)
*subroutine EDCASCTL
*item EDCASCTL casual_gain_control
'           Casual Gains Control Menu'
'  '
'The zone casual gain control file supports control of'
'zone casual gains (lighting) based on the internal or external'
'photocell illuminance. Different levels of calculation'
'of photocell illuminance and control algorithms are supported.'
'a Descriptive phrase  '
'b Which casual gain type in the operations scehdule to control.'
'    Plus you are asked about the day types for the control.'
'  '
'c Control periods  : Star and end hours of the casual gain'
'                     control - for each calendar day type.'
'd Lighting zone    : Toggle focus lighting zones'
'e Control type     : Selection of control algorithm:'
'  * Alway On  - casual gain will be alway on'
'  * Alway Off - casual gain will be alway off'
'  * On-Off    - on-off control algorithm'
'  * Step      - step control algorithm 100% - 50% - 0%'
'  * Dimming   - three dimming control algorithms are upported'
'  '
'  * Probab    - user probability switching algorithm'
'  '
'f Calculation type : Selection of sensor illuminance calculation'
'                     method - internal analytical, user supplied'
'                     daylight factors, direct Radiance coupling'
'                     and daylight coefficients via Radiance.'
'g Control data     : Control algorithm input data'
'h Photocell data   : Casual gain distribution between lighting'
'                     zones and number of photocells'
' '
'  Posn: x y z ux ..: Photocell location & orientation'
'                     (opt. daylight coefficient link)'
'  '
' option > save writes the current information to the file'
'   (you are asked to confirm the name). The file extension'
'   is usually .cgc. REMEMBER to save otherwise the data you'
'   supplied will be lost.'
'  '
' option * provides management facilities for adding or deleting'
'   casual gain control lighting zones. Although a zone operation'
'   schedule typically only has one lighting gain type, you can'
'   control a portion of that gain via lighting zones.'
'  '
'Some control options make use of Radiance to calculate so-called'
'daylight coefficients for a room which are then used at'
'simulation time. If this has been selected then when you exit'
'the menu prj will attempt to start the module e2r to calculate'
'these coefficients. This can take some time!  If you have not'
'used a control which relies on Radiance they select the continue'
'option when exiting this menu.'
'  '
'For the Daylight coupling with Radiance option the e2r module is'
'started to create the initial descriptive files prior to simulation.'
*enditem
  246   CALL EASKS(LTMP,' Zone casual gain control file ?',
 8888   call EASKABC('Radiance model for daylight coefficients:',' ',
        CALL PHELPD('cgc editing',22,'-',0,0,IER)
  247   CALL EASKS(LTMP,' Zone casual gain control file ?',
        CALL EASKAB(' ','Modify nmber of lighting zones:',
 52     CALL EASKS(DTMP,
        CALL EASKAB(' ','Control casual gains for ','one day type',
          CALL EPICKS(IX,KSTR,' ',
        CALL EASKABC(' ','Control casual gain type ','occupants',
        CALL EASKS(HOLD,' Control is active from hour to hour:',
        call EASKATOG(' Control type:',' ',
*item EDCASCTL cas_ctl_dimming
'Select dimming control algorithm by mouse clicking:'
'* Ideal: ideal dimming control algorithm by matching the photocell'
'  illuminance value. Usually photocell is located at the horizontal'
'  workplane.'
'  '
'* Integral reset: more realistic dimming control algorithm requiring'
'  night-time calibration of photocell. Usually the photocell is'
'  located at the ceiling and one input parameter is expected:'
'  '
'  * Night-time photocell calibration value, this value can be'
'    measured or calculated and represents illuminance at the'
'    photocell point from an artificial lighting only.'
'  '
'* Closed loop: more realistic dimming control algorithm requiring'
'  night-time and day-time calibration of photocell. Usually'
'  the photocell is located at ceiling and 2 parameters are needed:'
'  '
'  * Night-time photocell calibration value, this value can be'
'    measured or calculated and represents illuminance at the'
'    photocell point from an artificial lighting only.'
'  '
'  * Linear control slope value, this value helps to set dimming'
'    levels as a linear function of the difference between '
'    photocel signal and night-time calibration value. This value'
'    could be measured or calculated under variety of the'
'    sky luminance distribution conditions.'
*enditem
          call EASKATOG(' Dimming control type:',' ',
          CALL EASKS(HOLD,' Night-time calibration lux value:',
          CALL EASKS(HOLD,' Night-time calibration lux value &',
*item EDCASCTL cas_ctl_photocell
'Photocell illuminance calculation types supported are:'
'  '
'* Analyt DF: horizontal workplane daylight factors calculated'
'  by combination of analytical formula for sky component and'
'  split flux method for interreflected component. Direct solar'
'  photocell illuminance is being traced. THE METHOD WORKS ONLY'
'  FOR VERTICAL 4 VERTEX TMC POLYGONS!'
'  '
'* User DF: horizontal workplane daylight factors provided by'
'  the user which could be either measured or calculated values.'
'  Direct solar sensor illuminance is not being traced i.e.'
'  sensor shaded from direct sunlight.'
'  '
'* Extern: external unobstructed horizonal or vertical global'
'  illuminance. In the case of vertical global illuminanace'
'  sensor location on the zone external surface has to be specified.'
'  '
'* Coupling: direct running time coupling between thermal and'
'  lighting simulations at the time step level using third party'
'  global illumination solvers. In the current version coupling'
'  with Radiance is implemented. THIS IS AN EXPERT LEVEL AND CAN BE'
'  COMPUTATIONALY INTENSIVE!'
'  '
'* DayCoeff: set of precalculated daylight coefficients is being'
'  used to calculate sensor illuminance at the time step level.'
'  Once daylight coefficients have been calculated or measured'
'  simulation progress fast. Note: third party global illumination'
'  solvers are being used to calculate set of daylight coefficients.'
'  In the current version Radiance is used to get daylight coeff.'
'  THIS IS AN EXPERT LEVEL AND CAN BE COMPUTATIONALY INTENSIVE!'
*enditem
        CALL PHELPD('cgs calct type',32,'photocell   ',0,0,IER)
        call EASKATOG(' Calculation type:',' ',
*item EDCASCTL ctl_photocell_data
'Specify number of control algorithm parameters. Five numerical'
'inputs are expected:'
' '
'* Photocell lux set point (lux) i.e. anything from 300 lux to'
'  2000 lux or more for external sensors.'
' '
'* Switch-off light level i.e. level at which the light is being'
'  switched-off, usually from 150% to 250% expressed here as a'
'  ratio i.e 1.5 to 2.5.'
' '
'* Minimum dimming light output i.e. the level to which artificial'
'  lights can be dimmed i.e. usually 10% expressed here as a'
'  ratio i.e. 0.1.'
' '
'* Minimum electric/gain dimming output i.e. the level to which'
'  electric power/ heat gain can be dimmed. Expressed here as'
'  a ratio. Does not have to equal to the minimum dimming light'
'  output.'
' '
'* Switch-off delay time i.e. the time for which the control'
'  algorithm will wait before switching off lights. Expressed'
'  here in number of building side simulation time steps. Usually'
'  anything from 5 min to 30 min. Off course this effect can be'
'  traced only with short simulation time step.'
*enditem
        CALL PHELPD('cgc control data',25,'-',0,0,IER)
        CALL EASKS(HOLD,
*item EDCASCTL cas_ctl_zone_data
'Two input parameters are expected for the lighting zone:'
' '
'* Part of the casual heat gains associated with this lighting'
'  zone. Casual gains are specified at the thermal zone level and'
'  have to be split into the lighting zones. Ratio is expected'
'  i.e 50% -> 0.5.'
' '
'* Number of the photocells in this lighting zone. If more than'
'  one photocell is specified (max. 9) then a simple average of'
'  all photocell illuminances will be used for control. An integer'
'  number is expected from 1 to 9.'
*enditem
        CALL EASKS(HOLD,' Casual gain portion & No of photocells',
*item EDCASCTL cas_ctl_cell_location
'Six input parameters are needed for photocell location:'
' '
'* X, Y, Z coordinates of the photocell location (m)'
'  relative to the site origin.'
' '
'* Photocell orientation expressed as the X, Y, Z of'
'  direction vector i.e. horizontal photocell facing'
'  up 0  0  1 or facing down 0  0  -1.'
' '
'  Note that photocell orientation will not effect'
'  Analyt DF calculation type as here only horizon-'
'  tal facing up sensors are allowed.'
*enditem
          CALL EASKS(HOLD,' Sensor x y z & ux uy uz',
*item EDCASCTL ctl_external_location
'Two input parameters are expected for an external sensor:'
' '
'* Zone external surface number at which the'
'  photocell is to be located.'
' '
'* Indication of the photocell orientation:'
'  0.0 - measure global horizontal illuminance'
'  1.0 - measure global vertical illuminance'
*enditem
          CALL EASKS(HOLD,' Sensor surface number position &',
*item EDCASCTL daylight_coef_method
'Seven input parameters are expected for the daylight coef method:'
' '
'* X, Y, Z coordinates of the photocell location (m)'
'  relative to the site origin.'
' '
'* Photocell orientation expressed as the X, Y, Z of'
'  direction vector i.e. horizontal photocell facing'
'  up 0  0  1 or facing down 0  0  -1.'
' '
'* Daylight coefficient number to be linked to the'
'  given photocell location. This has to match no.'
'  of daylight coefficients in the DC file.'
*enditem
          CALL EASKS(HOLD,' Sensor x y z & ux uy uz',
*item EDCASCTL photocell_orientation
'Six input parameters are expected for cell orientation:'
' '
'* X, Y, Z coordinates of the photocell location (m)'
'  relative to the site origin.'
' '
'* Photocell orientation expressed as the X, Y, Z of'
'  direction vector i.e. horizontal photocell facing'
'  up 0  0  1 or facing down 0  0  -1.'
' '
'  Note that photocell orientation will not effect'
'  Analyt DF calculation type as here only horizontal'
'  facing up sensors are allowed.'
*enditem
          CALL EASKS(HOLD,' Sensor x y z & ux uy uz',
*item EDCASCTL user_supplied_dfactors
'User specified DF are inputed here. You will be prompted to'
'input Daylight Factors for each TMC polygon and all photocells'
'in this lighting zone'
' '
'Note that daylight factors (DF) are inputed as ratios and not'
'as percentage i.e 2% -> 0.02.'
*enditem
          CALL EASKS(HOLD2,outs,' ',72,' 1 0.05',' df for each ',IER,6)
*subroutine CFDCOMP
*item CFDCOMP cfd_opening_menu
'ESP-r includes a 2D and 3D computational fluid dynamics solver'
'which is integrated with the building and mass flow solvers so'
'there are opportunities for carrying out CFD assessments which'
'can benefit from the evolving boundary condtions provided by the'
'other solution domans.'
'  '
'Data on conflation, geometry, gridding, solution variables,'
'boundary conditions, solver parameters, output files, etc. are'
'required for the CFD model. The majority of these data can be'
'input through the menues provided in this facility; however, '
'you will have to do some manual editing of the CFD input file'
'(use the menu item provided in this facility to invoke the'
'editor).'
'  '
'A CFD input file holds the definition of the geometry and '
'gridding of the CFD domain, information on how to conflate'
'the CFD zone model into the whole-building model, as well as'
'the data required by the CFD solver.'
' '
'Each of the menu items in this list should be selected'
'in turn to build-up the CFD input file.'
' '
'Some hints on working with CFD domains: '
' '
' a) this portion of ESP-r is full of jargon because those'
'    who work in CFD have evolved expressions that seems like'
'    english but have a particular meaning. For example, the'
'    south face of the domain might not actually be facing south.'
'  '
' b) there are lots of parameter options, some of which influence'
'    computation time and some of which are not as well documented'
'    as some users would expect.'
' '
' c) ESP-r is normally compiled for domains of limited grid'
'    resolution, it can be recompiled to increase the grid'
'    density and those who do this should carefully check their'
'    models and predictions.'
' '
' d) it is recommended that you plan your cfd domains first and'
'    there are some places where efficiency is improved if you'
'    record critical dimensions as you work - e.g. so that boundary'
'    surface and cell groups can be more reliably associated.'
' '
'You should refer to ESRU Report TR96/2, which forms part'
'of the ESP-r distribution (/usr/esru/esp-r/manual/DATA_MODEL).'
' '
'Note that CFD domains are currently restricted to cuboidal zones.'
'Remember to save your work on a regular basis!'
*enditem
      CALL EASKS(ltmp,' CFD input file?','  ',72,DFCFD,'dfd file',IER,5)
*item CFDCOMP
*enditem
        call EASKS(ltmp,'Description of CFD model:',' ',72,dtmp,
*item CFDCOMP cfd_conflation_options 
'The CFD can be coupled to other simulation domains in the model,'
'currently zone geometry and/or a mass flow network. When coupled,'
'the CFD will exchange information with these simulation domains'
'every time step.'
' '
'If coupling is enabled, boundary conditions of the CFD domain'
'should be explicitly linked with specific elements of other domains.'
'For solid boundaries, this is accomplished by choosing boundary'
'condition type [building surface] and then selecting the'
'appropriate building surface. For air flow openings this is'
'accomplished by choosing boundary condition type [from flow network],'
'and then selecting the node that is represented by the CFD domain'
'and the connections that each air flow opening represents.'
' '
'If coupling is disabled, the CFD domain will not participate'
'in integrated building simulation. However the CFD domain may be'
'simulated in isolation using the DFS module.'
' '
'Advanced options for controlling the behaviour of the CFD'
'coupling can be found in the simulation toggles menu of the'
'BPS module.'
' '
'For further details, refer to:'
'Clarke J A and Beausoleil-Morrison I, The Integration'
'of Computational Fluid Dynamics into Building'
'Simulation, IBPSA News, V9, N2, Dec. 1997.'
*enditem
        call ASKOK(
     &      'Do you want to couple CFD with other simulation domains?',
        CALL PHELPD('CFD inputs',42,'-',0,0,IER)
        CALL ASKOK(' Data not yet saved to CFD input file.',
*item CFDCOMP cfd_conflation_active
'WARNING!'
' '
'You have enabled CFD coupling. This will greatly increase the time'
'taken to run simulations (particularly if coupled with a mass flow'
'network).'
*enditem
*subroutine CFDGGRD
*item CFDGGRD cfd_gridding_setup
'One of the major imput tasks in CFD is to define the gridding'
'of the domain. This tends to be a compromise between a course'
'grid for faster solution and fine gridding to resolve detailed'
'flow patterns. Experts will have evolved techiques for defining'
'thermal zone geometry so that it works well with the needs of'
'CFD gridding.'
'  '
'There are several steps required. First, define the geometry'
'of the CFD domain by establishing its origin and X,Y, and Z axes.'
'This is done by specifying vertex points for the origin and'
'the ends of each axis. CFD domains are currently restricted to'
'cuboidal zones. Axes must be cartesian.'
'  '
'Second, subdivide the domain into cells by gridding each axis.'
'Each axis may be divided into regions, enabling a fine mesh in'
'some areas while a coarse mesh in others. For 2-dimensional'
'problems, specify only a single grid in the redundant direction.'
'  '
'It is useful to visualize the grid to confirm your work.'
'  '
'One of your first steps is to identify the origin of the zone'
'(look at the wire-frame to identify the vertex. Next choose points'
'at the end of the X and Y and Z axis.  Your selections will be'
'echoed in the menu.'
'  '
' option a: this allows you to re-define the origin and the axis.
'  '
' option b: scans the current zone geometry and makes suggestions'
'   about the regions along each axis.  You are asked to state the'
'   total number of cells in each of the axis. This is reflected'
'   in the menu in options c d and e. The suggested grid can be'
'   fine-tuned via menu options c/d/e. Remember to save the domain'
'   regularly to commit changes held in memory.'
'  '
' options c/d: supports editing of the X and Y grid spacing via'
'   altering the number of cells in a region or the power law.'
'  '
' option e: the Z axis grid spacing - note that the curvilinear'
'   option is not yet working so choose orthogonal. Check the'
'   wireframe view for the East face of the domain for the vertex'
'   that represents the start and end of the EZ axis.'
'  '
'A cancel request will return you to the main menu without altering'
'the model. But check your model carefully for inconsistencies.'
*enditem
        CALL EASKI(iorgt,' Specify vertex at origin of CFD domain. ',
        CALL EASKI(ixendt,' Specify vertex at end of X axis. ',
        CALL EASKI(iyendt,' Specify vertex at end of Y axis. ',
        CALL EASKI(izendt,' Specify vertex at end of Z axis. ',
        CALL EASKI(iorgt,' Specify vertex at origin of CFD domain. ',
        CALL EASKI(ixendt,' Specify vertex at end of X axis. ',
        CALL EASKI(iyendt,' Specify vertex at end of Y axis. ',
        CALL EASKI(izendt,' Specify vertex at end of Z axis. ',
        CALL EASKI(icellx,outs,' ',1,'F',NTCELX,'F',10,
        CALL EASKI(icelly,outs,' ',1,'F',NTCELY,'F',10,
        CALL EASKI(icellz,outs,' ',1,'F',NTCELZ,'F',10,
        CALL EASKABC('Options for Z gridding:',' ','orthogonal',
        CALL EASKI(ieorg,'Specify vertex at start of east Z axis.',
        CALL EASKI(izendet,'Specify vertex at end of east Z axis.',
        CALL PHELPD('gridding',14,'-',0,0,IER)
*item CFDGGRD cfd_gridding_auto
'The interface has been updated to reflect the regions and cells'
'in each axis generated after scanning the zone geometry. Your next'
'steps are: '
' a) Select each axis in turn and confirm the grid spacing. Adjust'
'    as required in the axis menu or try another auto-generation'
'    with different overall cells in each axis. Note that each auto-'
'    generation will clear the current memory of cells.'
' b) When you are happy with the gridding save the domain (dfd) file.'
' c) Use the operating system save the current domain (dfd) file'
'    so you can recover if you make a mistake.'
' d) Either define the solution variables or the volumes of the'
'    domain that form solids, contaminate sources, air flow inlets'
'    or outlets or blockages.'
' e) PLAN (on paper) the start and end cells for each volume as well'
'    as its name prior to creating volumes.'
*enditem
*subroutine CFDSVAR
*item CFDSVAR cfd_equations_to_solve
'This menu allows the user to set up the equations to be solved by the'
'CFD, i.e. specify what is modelled and the information required from'
'the results. Most of the settings in this menu will only be used if'
'the adaptive conflation controller (ACC) is disabled, otherwise the'
'ACC will control the equation setup for best results. See below for'
'details.'
'  '
'Velocity must always be solved and is determined from the grid'
'definition. '
'  '
'Temperature. Choice of on or off. '
'Note: This flag will only be used if the adaptive conflation'
'      controller (ACC) is disabled in the BPS simulation toggles,'
'      otherwise the ACC will always solve temperature.' 
'  '
'Turbulence. Five models available: '
'   no turbulence (ie laminar flow conditions)'
'   k-e model (for recirculating flows)'
'   fixed eddy viscosity (for approximating turbulence)'
'   MIT zero-equation (a simpler alternative to k-e)'
'   fixed eddy -> k-e model (uses fixed eddy approx for N'
'      iterations then k-e as an aide to convegence)'
'See Ian Beausoleil-Morrisons PhD thesis THE ADAPTIVE COUPLING OF'
'HEAT AND AIR FLOW MODELLING WITHIN DYNAMIC WHOLE-BUILDING SIMULATION'
'available online at:
'https://www.strath.ac.uk/media/departments/mechanicalengineering/esru
'/research/phdmphilprojects/beausoleil-morrison_thesis.pdf'
'Note: This flag will only be used if the adaptive conflation'
'      controller (ACC) is disabled in the BPS simulation toggles,'
'      otherwise the ACC will always use the MIT zero-equation model'
'      for preliminary simulations and the k-e model for the adapted'
'      simulations.'
'  '
'Buoyancy. Three choices (temperature should be solved if 
'          buoyancy is active):'
'   none - buoyancy effects are ignored.'
'   ideal gas - density calculated by ideal gas equation.'
'   Boussinesq - Calculates buoyancy relative to buoyancy'
'      at reference temperature. Best for small temperature'
'      variations in domain. '
'Note: This flag will only be used if the adaptive conflation'
'      controller (ACC) is disabled in the BPS simulation toggles,'
'      otherwise the ACC will use either no buoyancy or the Boussinesq'
'      approximation for the adapted simulations, depending on the'
'      results of the preliminary simulations.'
'  '
'Contaminants. Choice of on or off.
'   One of these options will be present for each contaminant'
'   defined in the boundary conditions.'
'  '
'Mean age of air. Choice of on or off.'
'  '
'Edit solution parameters allows the user to specify initial values,'
'relaxation factors and convergence criteria for the CFD solver.
'  '
'If you have messed up the solution parameters you might want to'
'reset them to default values. Note that default solution'
'parameters might not be appropriate. '
'  '
*enditem
        call askok('Resetting solution parameters to default values.',
        CALL PHELPD('solution variables',25,'-',0,0,IER)
*subroutine CFDEDAT
*item CFDEDAT cfd_equations_to_edit
'This menu allows the user to specify initial values, relaxation'
'factors and convergence criteria for the CFD solver. Initial'
'conditions and relaxation factors can have a significant impact on'
'convergence rates and potential. Optimal values depend upon'
'the nature of the flow, gridding,and other factors. '
' '
'Underrelaxation (values between 0 and 1) is typically employed'
'to slow the solution to avoid divergence. Overrelaxation (values'
'greater than 1), although not common, is permissible. Reducing'
'relaxation factors can often coax a troublesome CFD simulation to'
'convergence.'
' '
'For each variable, relaxation factor 1 is the nominal value and will'
'always be used if the ACC is disabled. If the ACC is active,'
'relaxation factor 1 will be used if buoyancy is not simulated, and'
'relaxation factor 2 will be used if buoyancy is simulated. In'
'general relaxation factor 2 should be lower than relaxation factor 1.'                
'  '
'Options a,b,c: Set initial conditions (which will apply to all grid'
'  cells) and relaxation factors for velocity in the X direction.'
'Options d,e,f: Set initial conditions (which will apply to all grid'
'  cells) and relaxation factors for velocity in the Y direction.'
'Options g,h,i: Set initial conditions (which will apply to all grid'
'  cells) and relaxation factors for velocity in the Z direction.'
' '
'Option j: Toggles whether temperature is solved (see help on previous'
'  menu).'
'Options k,l,m: Set initial conditions (which will apply to all grid'
'  cells) and relaxation factors for temperature.'
' '
'Option n: Toggles through turbulence models (see help on previous'
'  menu). Five are available:'
'   no turbulence (ie laminar flow conditions)'
'   k-e model (for recirculating flows)'
'   fixed eddy viscosity (for approximating turbulence)'
'   MIT zero-equation (a simpler alternative to k-e)'
'   fixed eddy -> k-e model (uses fixed eddy approx for N'
'      iterations then k-e as an aide to convegence)'
'Options o,p,q: Set turbulence parameters depending on which model is'
'  selected.'
'  '
'Option r: Toggles between 3 buoyancy choices (see help on previous'
'menu):'
'   none - buoyancy effects are ignored.'
'   ideal gas - density calculated by ideal gas equation.'
'   Boussinesq - Calculates buoyancy relative to buoyancy at a given'
'     reference T (~ average in the domain). Best for small'
'     temperature variations in domain. '
'Option s: Set reference temperature for the Boussinesq approximation.'
' '
'Option t: Set the maximum number of iterations that the solver will'
'  perform. By default unconverged solutions are accepted, though this'
'  behaviour can be controlled if the ACC is disabled.'
'Option u: Set convergence criterion, which is used by the solver'
'  to judge when a converged solution has been obtained.'
'Option v: Location of the monitoring cell. Key values at this cell'
'  are displayed during the simulation.'
'  '
'Option +: If contaminants are included in the CFD domain, this menu'
'  allows the user to set relaxation factors for the solution.'
*enditem
        call EASKS(ltmp,'Initial value and relaxation factor',
        call EASKS(ltmp,'Initial value and relaxation factor',
        call EASKS(ltmp,'Initial value and relaxation factor',
        call EASKS(ltmp,'Initial value and relaxation factor',
        call EASKS(ltmp,'Initial value and relaxation factor',
        call EASKS(ltmp,'Fixed value for eddy viscosity?',
        call EASKS(ltmp,'Fixed value for eddy viscosity and number ',
        call EASKS(ltmp,'Initial value and relaxation factor',
        call EASKS(ltmp,'Reference temperature? ','  ',16,
*item CFDEDAT cfd_convergence_crit
'Convergence criteria are used by the solver to judge when a'
'converged solution has been obtained. The solution will either'
'terminate when the maximum number of iterations is reached, or'
'if the sum of the residuals is less than the specified value.'
'Only the latter case represents a successful solution.'
'  '
'An iterative solution procedure is employed.'
'Iterations continue until either:'
'  1) the solution converges to a user-specified tolerance, or'
'   '
'  2) a user-specified number of iterations has been'
'     performed.'
' '
'In the case of a maximum equation residual, when the sum of'
'the equation residuals (for the mass and momentum equations)'
'over all cells in the domain drops below this value, the'
'solution is considered converged. The residual is normalized'
'by the flow into the domain.'
'  '
'A value of 0.001 is considered well converged. A reasonable'
'prediction of the flow pattern can often be achieved with'
'a value of 0.02.'
'  '
'A cancel results in no change to the model. '
*enditem
        CALL EASKI(ival,' ',' Maximum iterations to perform?',
        CALL EASKR(VAL,' ',' Maximum equation residual?',
        CALL PHELPD('solution variables',53,'-',0,0,IER)
*item CFDEDAT cfd_no_contam_defined
'No contaminants defined. Please define in the boundary conditions'
'menu before attempting to edit solution parameters.'
*enditem
*subroutine CFDEDATC
*item CFDEDATCON cfd_contam_equ_to_edit
'This menu allows the user to specify relaxation factors for the'
'contaminant transport equations solver. Optimal values depend upon'
'the nature of the flow, gridding,and other factors. '
' '
'Underrelaxation (values between 0 and 1) is typically employed'
'to slow the solution to avoid divergence. Overrelaxation (values'
'greater than 1), although not common, is permissible. Reducing'
'relaxation factors can often coax a troublesome CFD simulation to'
'convergence.'
' '
'For each contaminant, relaxation factor 1 is the nominal value and'
'will always be used if the ACC is disabled. If the ACC is active,'
'relaxation factor 1 will be used if buoyancy is not simulated, and'
'relaxation factor 2 will be used if buoyancy is simulated. In'
'general relaxation factor 2 should be lower than relaxation factor 1.'
*enditem
*subroutine CFDBVAR
*item CFDBVAR cfd_boundary_variables
'A summary of each boundary condition is presented. By selecting'
'one you can see all the data associated with this boundary and'
'edit it if necessary. If source type bc are to be defined do'
'not start the name by SRC_'
'  '
'If new source type boundary condition types have been '
'defined to accomodate contaminant entering and leaving'
'the CFD domain via airflow connections these are named'
'in the pattern SRC_[contaminant #][airflow node #]'
'  '
' option + allows you to manage the boundary conditions list.'
'   if you add a new boundary condition it can be:'
'   * air flow opening (to mass flow)'
'   * a solid surface (one of the zone surfaces)'
'   * a source ?'
'   * a blockage '
'   if you ask to delete a boundary condition you are asked'
'   to select form a list of volume names.'
'  '
'Boundary conditions facilities help messages are terse - we'
'need volunteers to improve them...'
*enditem
        CALL PHELPD('boundary conditions',9,'-',0,0,IER)
        CALL PHELPD('boundary conditions',5,'-',0,0,IER)
        call easkabc('Add/ delete a boundary condition?','  ','Add',
        call EASKATOG('Which type of boundary?','  ',
        call EPICKS(INDEL,IDEL,' ',' ',12,INVOL,NAMES,
*subroutine EDAIRO
*item EDAIRO cfd_air_boundary
'One boundary condition option for a CFD domain involves links'
'to a mass flow network. This is a potentially powerful approach'
'because it allows the efficiency of the mass flow solution to'
'provide a transient boundary condition of air flow to the CFD'
'domain solution - for example wind pressures against a facade'
'or from an adjacent room.'
'  '
'Boundary coundition if defined to be [from flow network] will'
'make ALL air flow opening conditions to be defined from the'
'airflow network and individual specification of boundary'
'conditions will be overridden.'
'  '
'If, however, CFD is run in standalone mode, boundary conditions,'
'if previosuly defined, will be maintained.  Only choose'
'[from flow network] if an airflow network has been defined and'
'you wish to take up boundary conditions from it i.e. conflate'
'CFD and the flow network.'
'  '
'If you choose to conflate then ALL air flow openings will be'
'taken from the flow network automatically.  If you wish not'
'to conflate CFD and flow network then choose some other boundary'
'condition and ALL openings will be restored.'
'  '
' option a: supply a name for the opening - this short phrase'
'    <12 char is essential for understanding the cfd domain.'
'  '
' option b: opening types are Pressure Velocity Zero gradiant'
'   and Mass flow and from-flow-network.  Depending on the type'
'   the attributes shown in the menu will change. The data'
'   requested includes:'
'   * pressure Pa at the cell'
'   * mass flow rate entering or leaving the cell/domain'
'   * temperature of air entering the cell/domain'
'   * opening area - the real opening area may be less than'
'     the area covered by the cells.  If this is the case then'
'     enter the true area of the opening and the mass flow rate'
'     and momentum of the incoming air will be preserved.'
'  '
'Boundary conditions facilities help messages are terse - we'
'need volunteers to improve them...'
*enditem
        call EASKS(t12,'Opening name? ','  ',12,d12,'open name',IER,1)
        CALL EASKATOG('Opening types: (see help)',' ','pressure',
        call EASKR(VAL,' ',' Pressure (Pa) of cells?',
        call EASKR(VAL,' ',
        call EASKR(VAL,' ','Mass flow rate (kg/s) entering cells?',
        call EASKR(VAL,' ','Temperature (degC) of air entering domian?',
        call EASKR(VAL,' ','Real area (m^2) of opening?',
        CALL PHELPD('boundary conditions',1,'-',0,0,IER)
*subroutine MFCONF
*item MFCONF cfd_mass_flow_node
'The linkage between the CFD domain and the mass flow domain'
'requires that you identify which node in the mass flow network'
'is considered to be representative of the CFD domain. This allows'
'the solvers to coordinate their computations e.g. for the flow'
'network to talk to the CFD domain to get relevant predictions.'
'  '
'After identifying the representative flow node for the domain you'
'are asked to identify the connection in the flow network for each'
'of the air flow boundaries.'
*enditem
      call ASKMFNOD(INOPT,NNPK,INPK,PROMPT1,PROMPT2,NH)
      CALL ASKMFCON(INODE,NNPK,ICPK,PROMPT1,PROMPT2)
*subroutine EDSLDB
*item EDSLDB cfd_solid_boundary_edit
'One of the allowed boundary conditions for the CFD domain is'
'a solid boundary - to be located at the West, East, South, North'
'Low or High edges of the domain (identified in menu a Face just'
'under the option c cells) or to be applied to the Whole'
'domain or one of the blocks or a source region.'
'  '
' option a: name of the boundary - useful to help others'
'   understand the CFD domain!'
'  '
' option b: each of the volumes will be identified with its'
'   current boundary type: Temperature, Heat flux, Symmetrical,'
'   or Conflated.  Depending on the boundary type option e will'
'   display one of the following:'
'   * temperature (degC)'
'   * heat flux (W)'
'   * surface name it is conflated with and the type of handshaking'
'  '
'If the cells for the volume have not been defined you will be'
'asked for this information as a first step.'
'  '
'Handshaking defines the flow of information between the zone solver'
'and the CFD at this boundary. Note that the user choice of handshaking'
'is only used if the ACC is turned off (currently found in the'
'simulation toggles in bps); if the ACC is active it will choose'
'optimum handshaking for each solid boundary condition at each time'
'step.'
'  '
'The terms used for handshaking are as follows:'
'  Direction     - Indicates how information is shared between the zone'
'                  solver and CFD domain.'
'                  one-way: BPS --> CFD         two-way: BPS <-> CFD'
'  Wall function - Indicates whether log-law or Yuan wall functions'
'                  are applied, and whether these are evaluated locally'
'                  or not.'
'  HTC / Qsurf   - Indicates whether heat transfer coefficients are'
'                  calculated by the CFD, or Qsurf is evaluated'
'                  directly, and the formula for this calculation.'
'  Tref          - If Qsurf is evaluated directly, this indicates the'
'                  source of the reference temperature Tref.'
*enditem
        call EASKS(t12,'Boundary name? ','  ',12,d12,'bnd name',IER,1)
        CALL EASKATOG('Boundary types:',' ','temperature','heat flux',
        call EASKR(VAL,'temperature (degC) at chosen face of cells?',
        call EASKR(VAL,'Heat flux (W) at chosen face of cells?',
        CALL EASKSUR(IZONE,IS,'-','Select a surface.',' ',IER)
        CALL PHELPD('boundary conditions',1,'-',0,0,IER)
*subroutine EDSRC
*item EDSRC cfd_source_boundary_edit
'This menu allows you to define contaminant source and sink for this'
'CFD boundary type.  It is also possible to allow heat injections/'
'extractions at these sources, to do this you may sepcify a heat'
'flux manually or as a casual gain from the operations file, in
'which case you have to give the index of that casual gain and'
'fraction injected.'
'  '
'It is also possible to define contaminants automatically from the'
'contaminants definition file if you have created one. It is'
'essential that you have an airflow network defined and/or coupled'
'with CFD before contaminants can be auto defined. You may couple'
'flow network with CFD by exiting from here are defining boundary'
'condition of opening type boundaries to be taken from the flow'
'network'
'  '
'In standalone mode CFD will take static boundary conditions are'
'defined here.'
'  '
'If the cells for the volume have not been defined you will be asked'
'for this information as a first step.'
'  '
' option a: name of the source - useful to help others understand'
'   the CFD domain!'
'  '
' option b: each of the volumes will be identified with its current'
'   boundary type which might be the name of the face of the domain'
'   or static-source or from-ctm-network. Choose from contaminants
'   network only if:'
'   1. This is not standalone CFD'
'  '
'   2. You have a mass flow network which is conflated with the'
'      CFD domain or you intend to conflate it before simulation.'
'      Once this is done source type boundary conditions will'
'      take their strengths (kg/s) from source/sink models that'
'      you have defined in the contaminant network.'
'      If you have conflated a mass flow network with CFD then'
'      new source type boundary conditions which will acommodate'
'      any addition or deletion of contaminant from CFD domain'
'      due to air flow as computed from conflated CFD and mass'
'      flow network.'
'  '
'      If you have not conflated the mass flow network with '
'      CFD you are advised to do so before linking CFD with'
'      contaminant network'
'  '
'   3. You have a contaminants flow network defined'
'  '
'Look for volume names beginning in SRC_ in this case the source' 
'  type boundary condition has been set up to allow contaminant'
'  mass injections / extractions due to air flow as described'
'  from conflated mass flow and CFD. Do not modify any paramter'
'  definition in the menu to follow this message and exit from there!'
'  '
' option c: defines cells for this volume'
'  '
' option e: defines heat flux (W) at the boundary'
'  '
' option f/g: defines which casual gain is associated with'
'   this boundary and the fraction of the gain'
'  '
'Boundary conditions facilities help messages are terse - we'
'need volunteers to improve them...'
*enditem
        CALL PHELPD('Warning',5,'-',0,0,IER)
        call EASKS(t12,'Source name? ','  ',12,d12,'src name',IER,1)
        CALL EASKABC('How to specify coundary condition',' ','static',
        CALL ASKOK('Link CFD with contaminant network (see help) ?',
        CALL PHELPD(' ',3,'-',0,0,IER)
*item EDSRC cfd_contam_distribution
'In order to calculate contaminant distribution the turbulent'
'Schmidt Number needs to be calculated. To do this the following'
'information is required: molar mass, volume at critical point,'
'boiling point and critical temperature.'
'  '
'If this information is available press parameters. If not'
'press manual to specify a value for the turbulent Schmidt'
'Number.  Click default to use a default value of unity or'
'0.59 for moisture'
*enditem
            CALL EASKABC('How to specify turbulent Schmidt #(see help)?'
            CALL EASKS(HOLD,'enter mol mass(g/mol),crit vol(cm^3/mol)'
            call EASKR(VAL,'What is Turbulent Schmidt Number for',
*item EDSRC cfd_contam_sinks
'If sources and sinks are defined in the contaminant network then'
'these can be linked with this CFD source boundary condition.'
'  '
'For any one contaminant only one source/sink can be linked'
'to one source b.c. but two or more source/sinks for as many'
'contamiants can be linked with the same CFD source b.c.'
'  '
' option a: name of the source - useful to help others understand'
'   the CFD domain!'
'  '
' option c: defines the cells for the volume have'
'  '
'You are given the option to add or delete contaminate sources.'
'Be careful when you do this (make a backup first just in case).'
'  '
'If you add a contaminate source you are asked for:'
'  * the name of the contaminate name'
'  * the source strength (kg/s)'
'  * whether the contaminate is water'
'  '
*enditem
        CALL ASKOK('Link contaminant network source/sink with this',
        CALL PHELPD('Choose source/sink',3,'-',0,0,IER)
        call EASKS(SRCNAM,'Contaminant name? ','  ',12,d12,
        call EASKR(VAL,'What is source strength (kg/s) ',
        CALL ASKOK(' ','Is this contaminant water',OK,dok,0)
        CALL EASKABC('Add/Delete contaminant source',' ','add',
*item EDSRC cfd_contam_delete_warn
'You cannot add / delete contaminants from contaminants network'
'here, go to contaminants in Model Definition Menu'
'  '
'To dereference contaminants network and invoke static definition'
'(which you can edit here) change source type to [static] from'
[From ctm network]'
*enditem
            CALL PHELPD('Not allowed',6,'-',0,0,IER)
*item EDSRC cfd_contam_schmidt_no
'In order to calculate contaminant distribution the turbulent'
'Schmidt Number needs to be calulated. To do this the following'
'information is required: molar mass, volume at critical point,'
'boiling point and critical temperature.'
'  '
'If this information is available press parameters. If not press'
'manual to specify a value for the turbulent Schmidt Number.'
'Click default to use a default value of unity or 0.59 for moisture'
*enditem
       CALL EASKABC('How to specify turbulent Schmidt #(see help)?'
       CALL EASKS(HOLD,'enter mol mass(g/mol),crit vol(cm^3/mol)'
       call EASKR(VAL,'What is Turbulent Schmidt Number ',
*item EDSRC cfd_link_contam_sink
'You can link contaminant(ctm) source/sink models from'
'contaminants network here. '
'  '
'If you add a contaminate source you are asked for:'
'  * the name of the contaminate name'
'  * the source strength (kg/s)'
'  * whether the contaminate is water'
*enditem
       CALL PHELPD('Contaminants Edit',10,'-',0,0,IER)
       call EASKS(SRCNAM,'Contaminant name? ','  ',12,d12,
       call EASKR(VAL,'What is source strength (kg/s) ',
       CALL ASKOK(' ','Is this contaminant water(humidity)',OK,dok,0)
*subroutine EDBLK
*item EDBLK cfd_blockage_menu
'The CFD facility supports the concept of blockages within the'
'domain. These are defined as a specific volume of cells.'
'  '
'If the cells for the blockage have not been defined you will be'
'asked for this information as a first step.'
'  '
' option a: name of the blockage - useful to help others'
'   understand the CFD domain!'
'  '
' option c: defines the cells for the blockage'
'  '
' option e: defines heat flux (W) within the blockage'
'  '
'The blockage facility help messages are terse - we'
'need volunteers to improve them...'
*enditem
        call EASKS(t12,'Blockage name? ','  ',12,d12,'blk name',IER,1)
        call EASKR(VAL,'Heat flux (W/m^2) on blockage surfaces?',
        CALL PHELPD('blocakage edit',1,'-',0,0,IER)
*subroutine PIKCELS
*item PIKCELS cfd_cell_selection
'A volume or face within the CFD is composed of a number of cells'
'in the X and Y and Z axis.'
'  '
'If this is a new volume or face you will have to pick a face at'
'which the boundary condition will apply.'
'  '
'Based on the face you select, information about the face X/Y or Z'
'cell coordinates will be reported in the text feedback area. '
'  '
'The boundary condition will apply to a volume (or face) defined by'
'the start and end control volume in the three orthogonal'
'directions i,j,k.'
' '
'If in doubt, review the cell coordinates which are listed in the'
'text feedback area.'
*enditem
      CALL EASKATOG('Boundary face is on which side?',t30,'West',
      call EASKS(s30,'Boundary cells?',t30,30,dflt,'bndry cells',IER,6)
*subroutine PIKFACE
*item PIKFACE cfd_face_selection
'Boundary conditions in the CFD domain are often defined in relation'
'to a face within the domain.'
'  '
'You may be asked to pick a face or a range of cells at which
'the boundary condition will apply.'
*enditem
        CALL EASKATOG('Boundary face is on which side?',' ','West',
*subroutine TOPBOT
*item TOPBOT cfd_curvilinear_grid
'The curvilinear gridding routine requires the shape of the high'
'and low boundaries of the domain to be defined as follows:  '
'  '
'For the high boundary start with the vertex at the intersection'
'of the west and high boundaries.  Select the next vetex to the'
'east in the same east-west, high-low plane.'
'  '
'     4____ 5'
'     /     \\'
'  3/       | 6'
'   |       |'
'   |       |'
' 1 -------- 9 '
' view from south'
'In the example above HIGH is defined by the vertices 3 4 5 6 '
'and the LOW by 1 and 9. Note: order is from the WEST to the'
'EAST (i.e. left to right). '
'  '
'The definition of the vertices requires that you either type'
'the list of vertices (west to east) OR in the X11 interface'
'you can click mouse on existing vertices, ending with an '
'[e]. A match is assumed if within 5 pixels.'
'You will be given an oportunity to confirm the list. '
'  '
'Repeat for the bottom boundary. '
*enditem
      CALL PHELPD('gen start popup',18,'-',0,0,IER)
      CALL EASKS(HOLD,' Give high vertices (west to east)','  ',
      CALL EASKSCMD(HOLD,' Give high vertices (west to east)',
      CALL EASKS(HOLD,' Associated high vertices (confirm):',
      CALL EASKS(HOLD,' Give low vertices (west to east)','  ',
      CALL EASKSCMD(HOLD,' Give low vertices (west to east)',
      CALL EASKS(HOLD,' Associated low vertices (confirm):',
*subroutine GRIDDEF
*item GRIDDEF cfd_cells_in_region
'Number of cells - specifies how many computational cells (control'
'volumes, grid points) the current region contains. There is a limit'
'for each axis due to array dimensions (if you would like to'
'change it please read file esrudfs/Info/help1.txt.'
' '
'The length of the region is in meters.'
' '
'The power law coefficient guides the distribution of cells. A'
'value of 1.0 will distribute cells evenly, for a value bigger'
'or less than 1 - each next cell will increase/decrease in size.'
' '
'To have a grid of a good quality - the size/distance of two'
'neighbor cells should not differ more than 20%. This can be'
'controlled using --> vizualize gridding --> list x,y,z plane'
'points (aspect ratio) from the upper menu.'
' '
'Symmetrical gridding will set an axis of symmetry in the'
'middle of the region.'
'  '
' option + allows you to manage regions by adding and deleting'
'   them. Each region is gridded independently.'
'   When adding a region you can specify the length (m) or'
'   by selecting verticies.'
'   You may be asked how many cells to include in the a new'
'   region. If more than one cell you are asked for further info'
'   according to a power-law relation:'
'            Xi = L*(i/n)**c'
'   where [i] is cell number, [Xi] is position of '
'   face of ith cell, [L] is length of region, '
'   [n] is number of cells in region, and [c] is '
'   power-law coeff. '
'  '
'   c > 1:      grid spacing grows along axis'
'   0 < c < 1:  grid spacing decreases along axis'
'   c = 1:      uniform grid'
'   -1 < c < 0: grid spacing grows along axis'
'   c < -1:     grid spacing decreases along axis'
'  '
'   If symmetrical gridding will set an axis of symmetry in the'
'   middle of the region. If this is what you want say ok.'
'  '
'   If you ask to delete a region you are asked for its index'
'   e.g. the 2nd region along an axis would be index 2.'
*enditem
        call EASKS(HOLD,outs,' ',32,' 1 1.0 1.0 ','cell data',IER,21)
        CALL ASKOK(' ',' Symmetrical gridding?',OK,dok,3)
        call EASKABC('Region operations:','  ','add one','delete one',
        CALL EASKABC('Specify region length:',' ','by vertices',
        call EASKS(HOLD,'Specify vertex at start & end of region',
        CALL EASKR(VAL,' ','Length of current region (m) ? ',
        CALL EASKI(icellt,' Specify number of cells in region',
        CALL EASKR(VAL,'  ','Power-law coefficient?',
        CALL ASKOK('  ','Symmetrical gridding?',OK,dok,3)
        CALL EASKI(IDEL,' ','Which region to delete ? ',
        CALL PHELPD('CFD inputs',21,'-',0,0,IER)
*subroutine edcfg
*item edcfg model_comprises_br_sim
'A model, as defined within the system configuration file, comprises'
'several entities such as simulation domain definition, site location'
'geometry, construction, usage and control. The system configuration'
'file references other files where the actual defining data is held.'
' '
'The structure of this menu reflects the entities of a model config-'
'uration file. The interface allows you to evolve it. For example, it'
'is possible to initially define a single building zone and then add'
'further zones, plant and control later. Or increase the resolution'
'of a model by, adding in a CFD domain to represent zone air movement'
'or plant component working fluid flow.'
'  '
' option a:  domains included in a model are updated automatically'
'   as new information is added. Changing the domain can have a'
'   significant impact: for example, if [building & plant] and you'
'   change to [plant only], all references to the building zones'
'   will be removed (zone files still exist). [registration level]'
'   domain holds only site information documentation and images.'
'  '
' option b: the context of the model includes site details, images'
'   primary energy conversions and the Integrated Performance View'
'  '
' option c: the zone composition includes facilities for defining'
'   geometry, constructions, operational schedules and optional'
'   facilities to increase thermophysical resolution.'
'  '
'The [networks] section gives access to details of plant (component'
'based or idealized) and air flow, electrical & contaminant networks.'
'  '
'The [controls] section gives access to the detail of the ideal'
'zone controls as well as plant, flow and global controls.'
'Co-simulation links can also be specified using the Functional Mockup'
'Interface (FMI) standard.'
'  '
'The [actions] section includes tasks that are applicable to models'
'which are complete:'
'  * visualisation supports hidden line views or colour images'
'  * simulation defines the parameters of simulations as well as'
'     comissioning assessments of the model'
'  * results recovers performance indicators, reports, graphs etc.
'  * QA reports on the composition of the model. '
'  '
' option ! saves the model cfg and cnn (boundary conditions) file'
'   with the information currently in memory
*enditem
        CALL PHELPD('configuration images',19,'-',0,0,IER)
   89   CALL EASKS(ltmp,' ','Update system configuration file?',
        CALL EASKS(ltmp,' ','Surface connections file name?',
        call MENUATOL(outs,'Domain options:',
        call askok('Are you sure you want to change the domains',
*item edcfg disk_might_be_full
'Check to see that the disk is not full and that you'
'have permission to write to the folder.'
*enditem
          CALL ASKOK('Problem creating new file!',
*item edcfg submenu_plant_options
'There are several options for defining environmental controls in'
'ESP-r. One approach is based on ideal zone controls which are'
'accessed via the [controls] section.'
'  '
'In the current menu there are additional options which you may'
'wish to consider which can provide additional performance infor-'
'mation within the components or in relation to parasitic power use.'
'  '
'Idealized model creates an .hvac file with descriptions of main and'
'backup systems for a number of residential scale scenarios. It is'
'used in combination with the ideal zone control laws to provide the'
'attributes needed for post-processing tasks.'
'  '
'Explicit creates a plant network file which defines plant components'
'and their connection topology and thus the greatest level of detail'
'in terms of the response of individual components. If you do not'
'have access to a suitable components database or a good working'
'knowledge of how systems are assembled from components then you'
'should avoid the explicit approach.'
'  '
'If an existing plant network file is located it will be used (if'
'you say OK), otherwise a new plant network file will be created'
'(if you say OK).'
'  '
'For existing plant network files there is a dereference option'
'which removes the name of the plant network file from the model'
'configuration file but does not delete it. The plant network can'
'later be re-established.'
'  '
'If you select the explicit mode and there is no plant component'
'database you will be warned not to continue.'
*enditem
            CALL PHELPD('Idealized or Explicit Plant Model?'
            CALL ASKOK(
            CALL EASKS(ltmp,' ','Plant network definition file?',72,
            CALL EASKSCMD(ltmp,'Plant network definition file?',' ',
            CALL EASKS2CMD(ltmp,'Plant network definition file?',' ',
            CALL ASKOK('This is a new plant network file.',
            CALL ASKOK('Found existing plant network file.',
*item edcfg submenu_flow_options
'Air flow can be modelled using an empirical air infiltration'
'model, sheduling flow by prescribing flowrates and imposing'
'controls or by defining an air flow network.'
'  '
'The Alberta Air Infiltration Model (AIM-2) is used to describe'
'the empirical air infilration model.'
'  '
'It is possible to schedule air flowing from the outside'
'(infiltration) and from specified zones or plant components'
'(ventilation). This is sometimes appropriate at an early design'
'stage and for simple air flow regimes.'
' '
'The flow network approach employs flow components (doors, cracks'
'ducts, fans etc.) to explicitly represent the distributed flow'
'paths in the model. This approach requires additional attributes'
'to be supplied. (A related facility, described elsewhere allows'
'a CFD domain to be linked to this flow network so that intra-'
'zone flows can be evaluated by a combination of solvers.'
' '
'Flow networks may be defined by selecting components from a menu'
'or by graphical manipulation of icons in a grid. New networks are'
'defined via icons, however existing networks are not converted.'
' '
'If you have created nodes that are not yet linked to a thermal'
'zone you will be asked to confirm the link manually for each'
'of the zones in the model.'
*enditem
        call EASKATOG('Define air flow via:',' ',
        CALL EASKS(LFIL,' ','Network graphics file?',72,
        CALL EASKABC(outs,' ','ok',
        call ASKRNOD('available nodes','-',IC,IER)
        CALL EASKAB(outs,' ','ok','select a node',iacc,3)
        call ASKRNOD('available nodes','-',IC,IER)
        CALL ASKOK('Save graphic flow network links to zones',
*item edcfg password_is_needed
'This option is password protected because it is under development'
'and so must be used with care. The password is available from ESRU'
'on request. If you are in a hurry try 101.'
*enditem
        call easki(IPASS,' ','Password?',
*item edcfg model_visual_options
'In addition to the in-built perspective view you can request a'
'hidden line view of the model - this starts a separate [viewer] tool.'
'  '
'For high resolution interior or external images of the model you'
'can request that the ESP-r model be exported in a syntax which'
'is understood by the visual simulation tool Radiance and managed'
'by the [e2r] module in the ESP-r suite.'
'  '
'Radiance is available for Linux, OSX and the Cygwin environment'
'under Windows.'
*enditem
          CALL EASKABC(' ','Visualisation options:','hidden line',
*subroutine EDZCOMP
*item EDZCOMP zone_composition_menu
'This menu provides facilities to create, browse and edit zone-level'
'data such as geometry and construction, schedules and miscellaneous'
'technical data relating to CFD, casual gain control etc.'
' '
'The [Zones] section (geometry, construction, operations) are the'
'essential attributes of zones which must be completed prior to'
'simulation. If you fully attribute the zone surfaces in the geometric'
'facility the [construction materials] section tasks require little'
'user intervention. In the zone selection menu you have options to'
'nanage zones (add delete copy).'
' '
'The [Topology] section automates the specification of'
'what-is-on-the-other-side of surfaces in the model (which'
'can also be done on a surface by surface basis within the geometry'
'facility). Anchors can be thought of as named lists of surfaces'
'e.g. a list called [finistration] might point to all windows in'
'a facade to allow you to change them all to a new type of glazing.'
' '
'The [Options] section allows you to add additional descriptions'
'and or detail to your model as and when such concepts become'
'important to your performance assessments. If you do not specify'
'these additional model attributes default assumptions are made.'
' '
'The [Special components] section also allows you to add detail to'
'your model to support specialists tasks (e.g. assigning electrical'
'characteristics to PV cells embedded within surfaces).'
' '
'The [Global tasks] option allows you to transform and rotate the'
'model on the site and do search & replace actions on surface'
'attributes. XYZ transforms (of zone and obstruction coordinates)'
'and rotations (+ is anticlockwise around site origin or a user'
'specified point) may be applied to one or more zones.'
'  '
'Search-and-replace of surface construction attributes asks for'
'the construction name to look for and the construction to replace'
'it with and then searchs the model for these and updates as'
'required (and with your concent).'
'  '
'Global attribution allows all surface matching specific'
'criteria (e.g. vertical and opaque) to be assigned a'
'particular attribute.'
*enditem
        CALL PHELPD('zones definition',32,'-',0,0,IER)
        call EASKATOG(' Global action?',' ',
        call EASKATOG(' Global action?',' ',
        CALL EASKS(HOLD,'X, Y and Z transform (m)?',' ',
        CALL EASKSCMD(HOLD,'X, Y and Z transform (m)?',' ',
        CALL EPICKS(INPIC,IVALS,' ','Zones to transform?',
        CALL EASKR(VAL,' ','Rotation (degrees, +ve anticlockwise)?',
        CALL EASKABC(' ','Rotation choice?',
        CALL EASKR(x1,' ','X point (m)?',
        CALL EASKR(y1,' ','Y point (m)?',
        CALL EPICKS(INPIC,IVALS,' ','Zones to rotate?',
        CALL EASKGEOF('Select a zone to focus on:',CFGOK,IC,'M',IER)
*item EDZCOMP zone_copy_and_ctl
'When copying a zone and obstructions the copy can be transformed'
'and rotated. This is useful for replicating zones. You can skip'
'such transforms.'
'  '
'XYZ transforms shifts the zone by a given amount in each axis.'
'If you want to rotate the zone from its initial position the'
'rotation option can be done around the first vertex of the zone'
'or a user specified XYZ point.'
'  '
'When you copy a zone there are a number of dependencies that need'
'to be resolved.'
'  '
'One dependency relates to links between the zone ideal controls'
'held in the model control file - it needs to be'
'updated to reflect the additional zone or a zone deletion.'
'  '
'If a zone control exists in your model you will want to update'
'it. If no control exist you can skip this step.'
'  '
'There is a separate facility (in the control interface) where you'
'can indicate which control loop to use with the copied zone. The'
'INITIAL assumption is that the new zone free-floats. '
*enditem
            CALL ASKOK(
            CALL EASKS(lctmp,' Control file ? ',
*item EDZCOMP problem_scanning_file
'While scanning the file a problem was noted. If you think this'
'might be because the wrong file name was given you can try it again.'
*enditem
            CALL ASKOK('Problem reading geometry file.','Try again?',
*item EDZCOMP zone_name_description
'There are two forms of documentation to help idenfity zones (for'
'use in the interface and in reports).
'  '
'The name of the zone (up to 12 char) is used both for descriptive'
'and bookkeeping purposes.  Each name should be unique and should'
'not contain blanks. Files associated with the zone use this as'
'a root name and reports and graphs will use this for identification'
'so a good name can provide clarity in selection tasks.'
'  '
'The zone description (up to 64 char) allows information about'
'zone form, composition and use to be recorded. This is included'
'in the model QA report and can help to clarify the intent of'
'the zone within the model.'
*enditem
          CALL EASKS(ZN,' What do you want to call this copied zone ',
  40      CALL EASKS(zd,'What does it represent?',
*item EDZCOMP options_for_copy_obs
'The original zone had associated solar obstructions'
'and you have two options:'
'  '
' a) copy the obstructions so that modifications relevant to the'
'    copied zones obstructions can be made.'
'    '
' b) do not copy the obstructions. Optionally you can reference'
'    the original obstructions (via the project files menu).'
*enditem
          CALL ASKOK(' ','Also copy obstructions of source zone?',
          CALL EASKSCMD(HOLD,'Transform (X Y Z metres):',' ',
          CALL EASKS2CMD(HOLD,'Transform (X Y Z metres):',' ',
          CALL ASKOK(' ',' Rotate the copied zone',OKZR,dok,3)
          CALL EASKR(VAL,' ',' Rotation (deg., +ve anticlockwise)?',
          CALL EASKABCD(' ','Rotation choices:',
          CALL EASKR(x1,' ',' X point (metres) ? ',
          CALL EASKR(y1,' ',' Y point (metres) ? ',
*item EDZCOMP problem_writing_file
'When writing the geometry file a problem was found.'
'  '
'Check that you have permission to update the file and'
'that there is sufficient disk space. '
*enditem
            CALL ASKOK(' ','Problem creating geometry...try again?',
*item EDZCOMP copy_constr_options
'A zone construction file contains thermophysical data for the zone'
'surfaces. If the original zone had a construction file the infor-'
'mation may be able to be reused.'
'  '
'You can have the new zone constructions based on the source zone'
'(by copying the file) or by pointing to the source zone file name'
'(exercise care because the two zones must continue to be identical'
'in terms of their construction and optical attributes) or you can'
'browse available files in the model [zones] folder or continue'
'without defining constructions at this time.'
'  '
'A similar pattern exists for any zone tmc (zone optical properties'
'file) you can copy or point to source file or browse to locate a'
'file.'
*enditem
            CALL EASKATOG(' ','Source zone has a constructions file:',
            CALL EASKATOG(' ','Source zone has no constructions file:',
            CALL EASKS(CFILE,' New construction file name:',
            CALL EASKS(DFILE,' ','New zone tmc file name:',
*item EDZCOMP copy_operation_options
'A zone operation file contains scheduled air flows and casual gains'
'for the zone. The original zone had an operations file the infor-'
'mation may be able to be reused.'
'  '
'You can have the new zone operations based on the source zone'
'(by copying the file) or by pointing to the source zone file name'
'(exercise care because the two zones must continue to be identical'
'in terms of their schedules) or you can browse available'
'files in the model [zones] folder or continue without defining'
'schedules at this time.'
'  '
*enditem
            CALL EASKATOG(
            CALL EASKATOG(
            CALL EASKS(DFILE,' New zone operations file name:',
*item EDZCOMP
'A zone view factor file contains calculations of how much each'
'surface can see other surfaces. The original zone had this file'
'so the information may be able to be reused (if the two zones'
'will remain geometrically identical.'
'  '
'You can have the new zone view-factors based on the source zone'
'(by copying the file) or by pointing to the source zone file name'
'(exercise care because the two zones must continue to be identical'
'in terms of their geometry) or you can browse available'
'files in the model [zones] folder or continue without defining'
'view-factors at this time.'
*enditem
            CALL EASKATOG(
            CALL EASKS(DFILE,' ','New view factor file name?',
*item EDZCOMP copy_cgc_options
'A zone casual gain control file contains logic for light switching'
'in a zone. The original zone had this file so the information'
'may be able to be reused (if the two zones will remain geometrically'
'and operationally identical.'
'  '
'You can have the new zone casual gain ctl based on the source zone'
'(by copying the file) or by pointing to the source zone file name'
'(exercise care because the two zones must continue to be identical'
'in terms of their geometry and schedules) or you can browse available'
'files in the model [zones] folder or continue without defining'
'casual gain controls at this time.'
*enditem
            CALL EASKATOG(
              CALL EASKS(DFILE,' ','Zone CG file name?',
*item EDZCOMP copy_hc_options
'A zone convection coefficients file contains data used to impose'
'surface convection regimes within a zone. The original zone had'
'this file so the information may be able to be reused (if the two'
'zones will remain geometrically identical.'
'  '
'You can have the new zone convection regime based on the source zone'
'(by copying the file) or by pointing to the source zone file name'
'(exercise care because the two zones must continue to be identical'
'in terms of their geometry) or you can browse available files'
'in the model [zones] folder or continue without defining a'
'convective regime at this time.'
*enditem
            CALL EASKATOG('Source zone has a CC file.',
            CALL EASKS(DFILE,' ','Zone CC file name?',
*item EDZCOMP
*enditem
 249    CALL EASKGEOF('Select a zone to focus on:',CFGOK,IC,'t',IER)
*item EDZCOMP update_all_constructions
'If you suspect that your zone constructions file has been corrupted'
'or is out of date then this command will refresh it.'
'  '
'This requires that the model has existing zone construction files'
'because the process of refreshing constructions requires the file'
'names to have already been determined.'
*enditem
          CALL ASKOK(' ','Update zone constructions files?',
*item EDZCOMP update_all_operations
'You can upgrade older unsorted zone operations files if they'
'exist in the current model.'
' '
'You can also check current operations files to see if the casual'
'gains periods are sorted (so that periods do not overlap).'
*enditem
          CALL EASKABC(
*item EDZCOMP global_shading_tasks
'You can establish detailed shading and/or insolation patterns in'
'nominated zones as follows.'
' '
'  Recalculate shading in all zones where a shading file exists.'
' '
'  Nominate zones for which you want to include an insolation'
'  analysis (i.e. track the distribution of the directly'
'  transmitted solar component).'
' '
'  Nominate zones for which you want to create solar obstructions'
'  so that shading and insolation can be calculated.'
' '
'  Nominate zones for which you want to dereference the shading/'
'  insolation file (the file is not actually removed).'
' '
'If you review the result of a shading analysis and find unexpected'
'patterns, this may be because of incorrectly ordered surface edges.'
' '
'  a) Check that a surface that appears to face a particular'
'     direction in the wireframe view actually does! (turn on'
'     the surface normals to get a clear view).
' '
'  b) Check the ordering of the edges of all problematic surfaces'
'     by adhering to the following advice:'
' '
'     It is suggested that the first surface edge be'
'     close to horizontal if possible.'
'  '
'The shading and insolation patterns for a zone is held in a'
'zone shading/insolation file. The name of the file is typically'
'based on the root name of the zone.'
'  '
'If there is an existing shading and insolation file you can '
'dereference it (the file will not be deleted) so that it can be'
're-referenced later.'
*enditem
          CALL EASKABCD(' ','Options for multiple zones:',
          call askmultizone(inpic,ivals,
          call askmultizone(inpic,ivals,
          CALL EASKS(SFIL,' ','Zone shading/insulation file?',
          CALL EASKSCMD(SFIL,' ','Zone shading/insulation file?',
          CALL ASKOK(' ',
*item EDZCOMP area_weighted_or_calc
'Inter-surface view factors may be determined as simple area'
'weightings or exactly using ray tracing. Area weighting is the'
'default treament.'
' '
'You can nominate the zones to which you want to apply either '
'calculation type or, alternatively, you may dereference an'
'exiting zone view factor file.analysis.'
*enditem
          CALL EASKABCD(' ','View factor options:',
*item EDZCOMP zone_cgc_options
'This menu allows a zone casual control file to be created or'
'edited. The data within this file controls zone casual gains'
'based on the internal or external illuminance.'
'Different control algorithms are offered.'
'  '
'The facility also allows you to dereference an existing file'
'or edit an existing zone casual gain control file.'
*enditem
          CALL EASKABC(' ','Casual gain control options:','edit',
          CALL EASKABC(' ','Casual gain ctl options:',
*item EDZCOMP zone_cfd_options
'This facility allows you to compose a file defining the zone'
'parameters required for a CFD simulation.'
'  '
'You may reference and dereference the CFD domain within the current'
'model at any time. If the CFD domain is complete you will probably'
'want to associate it with the model. If you do not do this now,'
'you can do it later (but you will need to supply the name of the'
'file to complete the association). '
*enditem
        CALL PHELPD('CFD domain + parameters',4,'-',0,0,IER)
        CALL ASKOK(outs,'(see help)',OK,dok,6)
*item EDZCOMP zone_adaptive_grid_opt
'There are four adaptive gridding files which must be specified'
'for each zone to which such gridding is to be applied.'
'  '
'  The moisture file holds moisture transport data for nodes.'
'  '
'  The 3D control volumes file defines...<< ? >>'
'  '
'  The 3D control volumes connections file defines...<< ? >>'
'  '
'  The 3D nodes coordinates file defines...<< ? >>'
'  '
'  The 3D nodes temperatures file defines...<< ? >>'
'  '
'To proceed with adaptive gridding you first have to...'
'   << instructions to be added >> '
'  '
'Check documentation for more information.'
*enditem
        CALL EASKGEOF('Select zone for adaptive gridding:',CFGOK,IC,
        CALL EASKSCMD(SFIL,outs,' ','ignore',clkok,72,DSFIL,
        CALL EASKSCMD(SFIL,outs,' ','dereference',clkok,72,DSFIL,
        CALL EASKAB(' Addaptive gridding options:',
        CALL EASKABC(' Addaptive gridding options:',
        CALL EASKS(SFIL,' 3D control volumes file',
        CALL EASKS(SFIL,' 3D control volumes connections file',
        CALL EASKS(SFIL,' 3D nodes coordinates file',
        CALL EASKS(SFIL,' 3D nodes temperatures file',
        CALL ASKOK(' ',' Proceed with adaptive gridding?',OK,dok,2)
*subroutine NEWPRB
*item NEWPRB new_model_cfg_overview
'The system configuration file holds the definition of the'
'building/plant/flow regime to be simulated, including references'
'to the various files comprising a model.'
'  '
'If the name given matches an existing file then that model is loaded'
'by the Project Manager and becomes available for browsing and'
'editing (if you are the owner).'
'  '
'If the file does not exist then a new one is created and loaded with'
'a set of default (database names and site information) that can'
'subsequently be modified.'
' '
'Note that before a default model can be edited, it should be copied'
'to your user area to give you write permissions.'
'  '
'Other example models are available via the [exemplars] option.'
'  '
'If you are using the GTK iterface there is a browsing function'
'in the dialog. If you used the browse facility the selected'
'file will be loaded and used if it is a valid file.'
*enditem
        CALL EASKXORGTKF(LCMDFL,
        CALL EPICKS(IX,ivlist,outs,' ',
*item NEWPRB
*enditem
          CALL EASKABC('When reading the model description,',
*item NEWPRB unspecified_prob_found
'There was an unspecified problem, review any warnings to see if'
'the problem is one you can fix. Also check that the file was of the'
'correct type.'
' '
'If you say [no] then it may be possible to work with the model, but'
'it may be incomplete or inconsistent and should be treated as at risk.'
*enditem
          CALL ASKOK('While reading the model configuration file',
*item NEWPRB control_problem_found
'There was a problem while scanning the control file. Review any'
'messages to see if you can correct the problem. Also check to see'
'that the file is of the correct type. A useful approach is to look'
'at the model contents report section relating to control.'
' '
'If you say [no], the model description may be incomplete so be'
'careful. Consider dereferencing the control file and recreating'
'it from scratch if it is seriously corrupted.'
*enditem
            CALL ASKOK('While reading the control file a',
*item NEWPRB cfg_not_found
'If the name supplied is not found you can: '
'  a) edit the file name,'
'  b) create a new configuration file using that name,'
'  c) delay the decision by selecting [cancel].'
' '
'If you are running the GTK version of Project Manager, and the'
'name of the model appears correct (including the correct folder'
'path), then select the respecify option and use the file'
'browser to locate the model.'
*enditem
        CALL EASKABC(OUTSTR,' Options: (see help)',
*subroutine visualz
*item visualz visualization_options
'In addition to the in-built perspective view you can request a'
'hidden line view of the model - this starts a separate [viewer]'
'tool based on a special geometric data file that is created by'
'prj (you are asked to confirm the file name and then whether'
'to start up the [viewer] tool.'
'  '
'For high resolution interior or external images of the model'
'you can request that the ESP-r model be exported in a syntax'
'which is understood by the visual simulation tool Radiance and'
'managed by the [e2r] module in the ESP-r suite.'
'  '
'A Radiance scene file specifies the composition of the model'
'for Radiance as well as the purpose of various scenes (for'
'general viewing, daylight appraisal etc.).'
'  '
'The other files and data that are used by Radiance and the [e2r]'
'module needs to be placed in a separate folder. Typically this'
'will be in a ../rad folder within the model folder. If there is'
'an existing folder by that name you are asked whether you want'
'to use it.'
'  '
'Note that the Radiance process works best if you are working'
'IN THE MODEL CFG folder rather than accessing a remote'
'folder.  If possible close prj and go to the model cfg folder'
'and re-start prj before working with Radiance.'
'  '
'Radiance is available for Linux, OSX and the Cygwin environment'
'under Windows.'
*enditem
        CALL EASKS(LFIL,' ','File name for image data?',
        CALL ASKOK(' ',' Display hidden line views?',OK,dok,3)
        CALL PHELPD('visu-rad-warning',7,'-',0,0,IER)
        CALL EASKS(ltmp,' Radiance scene file for this model?',
*item visualz click_when_done
'CLICK here when you have finished with the colour rendering module.'
*enditem
        CALL PHELPD('e2r finished menu',2,'-',0,0,IER)
*subroutine globaltransform
*item globaltransform global_transform_options
'There are a number of global transformations to geometric data'
'in the simulation model (zone geometry, solar obstructions'
'and even block sensors for MRT).'
'  '
'If information for any of these geometric objects is referenced'
'multiple times (e.g. old zone obstruction files could be used by'
'several zones) you probably do not want to transform these more'
'than once. The software does not always detect this so please'
'be observant during global actions. Even better, make a backup'
'copy of your model before you do any global transforms.'
'  '
'If you transform a zone you will probably also want to rotate any'
'MRT sensors and obstructions to match.'
*enditem
              call askok('Transform MRT sensors of',outs,OK,dok,2)
              call askok(outs,' ?',OK,dok,2)
              call askok(outs,' ?',OK,dok,2)
*subroutine globalrotate
*item globalrotate global_rotate_options
'There are a number of global rotations to geometric'
'data in the simulation model (zone geometry, solar obstructions'
'and even block sensors for MRT).'
'  '
'If information for any of these geometric objects is referenced'
'multiple times (e.g. old zone obstruction files could be used by'
'several zones) you probably do not want to transform these more'
'than once. The software does not always detect this so please'
'be observant during global actions. Even better, make a backup'
'copy of your model before you do any global transforms.'
'  '
'If you rotate a zone you will probably also want to rotate any'
'MRT sensors and obstructions to match.'
*enditem
              call askok('Rotate MRT sensors of',outs,OK,DOK,3)
              call askok(outs,' ?',OK,dok,3)
              call askok(outs,' ?',OK,dok,3)
*subroutine EDCON
*item EDCON many_not_attributed
'The zone construction file defines the thermophysical'
'properties of the zone and is required in order to run a'
'simulation.'
'  '
'In preparation for the creation of this file attributes from'
'the databases and zone construction file are scanned.'
'When scanning the geometry it was found that many of '
'the surfaces have not been attributed as to their '
'construction type.  It is recommended that you: '
'  '
'  a) go to the  [geometry browse & edit] facility and'
'     attribute the surface construction types - after'
'     which you can return to this facility,'
'  '
'  b) in the case of an existing [old or unattributed]'
'     zone construction file select the [Save] '
'     option in the following menu. '
*enditem
        CALL PHELPD('unknowns atrib in constr',11,'-',0,0,IER)
*item EDCON pre_zone_constructions
'The zone construction file defines the thermophysical'
'properties of the zone and is required in order to run a'
'simulation. The idea is that the thermophysical properties'
'are held within the model so that there is less need for'
'scanning databases durin the simulation.'
'  '
'In preparation for the creation of this file attributes from'
'the databases and zone construction file are scanned. Please'
'agree with the suggested file names or edit as required.'
'  '
'If an existing construction file is found you can use it or'
're-build the data from the available attributes in the'
'geometry file.'
'  '
'If a file was not found then you must supply a name if prj'
'is being run interactively. If prj is in silent model the'
'processing will fail because there is no way to supply the'
'needed information.'
'  '
'A TMC file holds optical properties for transparent surfaces'
'within a zone as well as the definition of and control of'
'blinds associated with such surfaces. If any surfaces are'
'transparent you will be asked to confirm this file name.'
'  '
*enditem
        CALL EASKS(LTMP,' Zone construction file? ',' ',
        CALL EASKABC(outs,'Options:',
        CALL PHELPD('file error',2,'-',0,0,IER)
        CALL EASKAB(outs,'Options:','respecify',
*item EDCON confirm_surf_opaque
'The opaque/transparent attribute of the surface is not'
'OPAQUE. If it is opaque then select [ok].'
*enditem
          CALL ASKOK(outs,'Confirm surface is opaque?',OK,DOK,2)
*item EDCON complex_fen_options
'Complex Fenestration Construction (CFC)'
'A CFC allows for a more accurate treatment of glazing systems'
'with or without shading devices. A CFC surface has the following'
'attributes:'
' '
'  -Exterior, vertical surface (IE=0)'
'  -Each glazing/shading layer is separated by gas gap'
'  -Currently limited to one shading layer per CFC'
' '
'The CFC is composed of glazing and shading layers whose'
'properties can be defined either by:
' '
'  - [new] using the CFClayers db in ESP-r to assemble a '
'    multilayer construction in the usual way.'
'  - [legacy] importing layer inputs from the Glazing Shading'
'    Layer editor (GSLedit), which can be downloaded'
'    from the ESRU website, downloads section'

'For an example of usage of CFCs see the publication'
'[Appendix F: CFC User Reference from'
'http://uwspace.uwaterloo.ca'
'/bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
'  '
'If any surfaces have CFC attributes you will be asked to'
'supply the name of the *.cfc file which will store the CFC'
'input data for this zone.'
*enditem
        CALL EASKS(ltmp,'CFC file name?',
        CALL PHELPD('CFC instructions',19,'-',0,0,IER)
*item EDCON zone_constructions_menu
'The surface attributes within the zone geometry file,'
'in conjunction with the Constructions db, allow the'
'specific thermo-physical properties to be saved within'
'the model definition.'
' '
'The recommended procedure is to attribute surfaces within'
'the geometry editing facility before creating the zone'
'contructions file.'
' '
'Surfaces which are composed of transparent materials will have'
'optical properties defined from either the optical database'
'(the safe prefered approach) or by manual input. If there'
'is a mismatch between information in a zone TMC file and'
'existing surface attributes then you will be asked to confirm'
'the correct choice.'
' '
'Optical properties can have scheduled controls which allow'
'an alternative optical property to be used based on the'
'following sensd parameters:'
' a) time - alternative optics are used during a specific'
'    period of the day'
' b) total radiation on the outside face of a zone surface -'
'    you specify a radiation level (W/m^2) above which'
'    the alternate optical propertiess are used.'
' c) ambient temperature - you specify a temperature above'
'    which the alternative optical properties are used'
' d) zone air temperature - you specify the temperature above'
'    which the alternative optical properties are used.'
' e) lux level - you specify the lux level above which the'
'    alternative optical properties are used.'
'    '
'Note that there can be up to 8 control periods during a day'
'and that all days within the simulation are treated the same).'
' '
'The alternative optical propetry set must relate to the same'
'number of material layers as the original set. It is a good idea'
'to prepare the alternative set using the Optical Preoperties db'
'tmanagement facility prior to using the transparent properties'
'facility in this menu.'
' '
'Control of optical properties can be used to approximate the'
'closing of window blinds and shutters.'
' '
'If the model has an air flow network you might also with to'
'control any flow components associated with transpartent'
'surfaces that have optical property control.'
'  '
'Note however that the air flow control logic is different from'
'optical property control logic so care is required to ensure'
'that they operate together.'
*enditem
       CALL PHELPD('zone geom file section',54,'-',0,0,IER)
*item EDCON attribute_recent_change
'The Project Manager thinks that there have been recent changes'
'to either surface attributes or constructions that have not'
'been saved. To be safe agree to saving these changes.'
*enditem
          CALL ASKOK('Save changes in surface attributes or',
*item EDCON zone_linear_cond
'The linear conductivity facility currently requires that you'
'use an external text editor to add information to the zone'
'constructions file to define linear dependencies.'
'  '
'Please contact your administrator for information on how'
'to do this.'
' '
'The linear facility identifies which layers in the model'
'will have such dependencies applied.'
' '
'A non-linear property facility is also available from the'
'above menu.'
*enditem
        CALL PHELPD('linear properties',11,'-',0,0,IER)
*item EDCON constr_write_error
'Check that you have permission to update the zone files and'
'that you have sufficient disk space. If you are running on OSX'
'or Linux or Cygwin there may be messages written to the command'
'window.'
*enditem
          CALL ASKOK(
*subroutine EDSCON
*item EDSCON surface_constr_atrib
'This is a display of the surface attributes which may be edited.'
'Most are selections from existing database entries.'
'  '
'WARNING: You are allowed to modify the thermophysical properties'
'of the layers BUT BE CAREFUL.  Manual editing will be over-'
'written by subsequent file re-attrubution. Manual editing messes'
'up QA tasks!'
' '
'RATHER create additional multilayer constructions for each unique'
'case, give them unique names and use them as attributes for the'
'surfaces.'
'  '
'DO NOT CHANGE the TOPOLOGY (ie. move air gaps around) within'
'a construction - do it in the constructions database.'
'  '
'The choice of using an opaque or transparent construction is'
'dependent on the optical properties. Where there is a mix of'
'opaque and transparent layers the construction should be marked'
'transparent.'
' '
'For a more exact treatment of windows that may include slat type'
'operable blinds, choose Complex Fenestration'
' '
'After selecting TRAN you will be asked for further information.'
'  '
'Other construction attributes that you can edit:'
'  * long-wave/infrared emissivity is normally 0.1 < x < 0.9'
'    this is an attribute of the face adjacent to the zone and the'
'    other-face of the surface.'
'  * short wave absorptivity is normally 0.1 < x < 0.9 this ia'
'    an attribute of the face adjacent to the zone and the other-'
'    face of the surface.'
'  * layer conductivity can vary from about 0.03 W/(mK) for'
'    insulation to about 200 W/(mK) for copper'
'  * layer density can vary from about 30 kg/m^3 for insulation'
'    to about 8900 kg/m^3 for copper'
'  * specific heat (J/(kgK))
'  * layer thickness is typically from 0.1mm to 300mm
'  '
'If a layer is identified as an air gap all you can do is to'
'alter its resistance -.e.g. 0.18 m^2K/W for a cavity wall'
*enditem
        CALL PHELPD('surface details',12,'-',0,0,IER)
        CALL EASKABCD('Select a type for the surface.',' Surface type',
        CALL EASKR(EMISI(ISUR),' ','Inside emissivity  ?',
        CALL EASKR(EMISE(ISUR),' ','Outside emissivity ?',
        CALL EASKR(ABSI(ISUR),' ',' Inside absorptivity ? ',
        CALL EASKR(ABSE(ISUR),' ',' Outside absorptivity? ',
        CALL EASKS(HOLD,
        CALL EASKR(VAL,' ',' Air gap resistance ? ',
*subroutine MKTWIN
*item MKTWIN tmc_file_not_found
'The zone TMC (tramsparent multilayer construction data file does not'
'exist, or was not found! '
'  '
'Please create / rereference this file individually.'
*enditem
        CALL PHELPD('file error',2,'-',0,0,IER)
*subroutine EDTWIN
*item EDTWIN constr_attribute_checks
'Surfaces have several attributes which are ment to work together'
'and if these are not consistent you are asked to clarify what'
'approach to take. For example, if the geometry file surface'
'attribute is OPAQUE but the MLC construction database indicates'
'that the construction is not opaque then you will be asked to'
'decide which one is correct.
'  '
'If the optical properties name does not point to a valid entry'
'in the optics database then you will be asked to either select'
'a different construction or supply the optical properties'
'manually. Do not start on the maual editing unless you already'
'know the set of optical property data that you will be typing'
'into the dialogs.' 
'  '
'If you interupt the process of defining an optical control you'
'will be given the option to try it again or to clear the'
'control definition.'
*enditem
        CALL EASKAB(outs,' do you want to:','switch to opaque',
        CALL EASKABC(outs,' Do you want to: ',
        CALL ASKOK('Try again to define the optical control?',
*item EDTWIN detect_existing_opt_ctl'
'If there is a surface attribute that indicates that an existing'
'optical control. You have the following options:'
'  '
' a) remove this optical control '
' b) edit the current optical control'
' c) continue with out changing this control'
' '
'Hint - scroll the text feedback backwards to see the current'
'optical control details. '
'  '
'Or if there are no controls say yes to the offer to create a new'
'control. Up to eight optical controls can be defined in the zone.'
'  '
'When working with optical controls you have several options'
'for sensors:'
'  '
' * each transparent surface has its own sensor (default);'
'  '
' * one user defined external surface will contain the sensor'
'   for all surfaces which use this particular TMC type;'
'  '
' * one user defined internal Daylight Coefficient sensor is used.'
*enditem
        CALL EASKABC(outs,' ','remove this optical control',
        CALL ASKOK(OUTS,'optical control?',OK,dok,2)
        CALL EASKI(N1,' ','Number of control periods?',
        CALL EASKAB(' ','Transparent surfaces controlled by:',
        CALL EASKI(N2,' ','Surface for common sensor location?',
*item EDTWIN optical_control_summary
'Surfaces composed of transparent constructions will have optical'
'properties defined from either the Optical Properties db or'
'by manual input. If there is a mismatch between information'
'in a zone TMC file and existing surface attributes then you'
'will be asked to confirm the correct choice.'
' '
'Optical properties can have scheduled controls which allow'
'an alternative optical property to be use based on the'
'following sensed parameter:'
' a) time - alternative optics are used during a specific'
'    period of the day;'
' b) total radiation on the outside face of a surface in the'
'    zone - you specify a radiation level (W/m^2) above which'
'    the alternate optical properties will be used;'
' c) ambient temperature - you specify a temperature above which'
'    the alternative optical properties will be used;'
' d) zone air temperature - you specify the temperature above'
'    which the alternative optical properties will be used;'
' e) lux level - you specify the lux level above which the'
'    alternative optical properties will be used. Two alternative'
'    lux calculation approaches are offered.'
' '
'Note: there can be up to 8 control periods in a day (all'
'days within the simulation will be treated the same).'
' '
'The alternative optics must correspond to the same number of'
'layers as the initial set. It is a good idea to prepare the'
'alternative properties via the Optical Properties db management'
'facility prior to using the transparent properties facility.'
' '
'Control of optical properties can be used to approximate'
'closing blinds/shutters and shading devices.'
' '
'If the model has an air flow network you might also think about'
'controlling any air flow components associated with any'
'transparent surfaces that have been assigned optical property'
'control. Note however that the air flow control logic is different'
'from the optical property control logic so some care and testing'
'is required to ensure that optical and flow control works together.'
'  '
'If you interupt the process of defining an optical control you'
'will be given the option to try it again or to clear the'
'control definition.'
*enditem
          CALL EASKR(VAL,outs,' Begin at hour: ',
          CALL EASKR(VAL,outs,' End at hour  : ',
          call EASKATOG('Controlled on:','(currently time)',
          call EASKATOG('Controlled on:','(currently radiation)',
          call EASKATOG('Controlled on:','(currently ambient temp.)',
          call EASKATOG('Controlled on:','(currently zone temp.)',
          call EASKATOG('Controlled on:','(currently daylight coef)',
          call EASKATOG('Controlled on:','(currently Lightswitch)',
          call EASKATOG('Controlled on:','(currently undefined)',
          CALL EASKR(VAL,' ','Radiation set point?',
          CALL EASKR(VAL,' ','Ambient temp. set point?',
          CALL EASKR(VAL,' ','Zone temp. set point',
          CALL EASKR(VAL,' ','Lux set point',
          CALL EASKR(VAL,' ','Lightswitch lux set point?',
*subroutine EOPTKS
*item EOPTKS manual_optical_editing
'The simulation of radiation transmission through glazing is angular'
'dependent.  Five angles are used:'
' 0 (normal to the glass), 40, 55, 70 & 80 degrees.'
'  '
'The visible transmittance at normal incidence is used for daylighting'
'calculations.'
'  '
'The simulation of radiation transmission through transparent'
'constructions also requires that the short-wave absorptance'
'at each layer (including air gaps) is defined for five angles'
'of incidence: '
'  0 (normal to the glass), 40, 55, 70 & 80 degrees '
'The values for an air gap are usually: '
'  0.001, 0.002, 0.003, 0.004, 0.005 '
'  '
'The number of layers should be equal to that of the'
'associated multilayer construction. Layers index (outside=1).'
'  '
'There are two typcial sources for angular optical properties:'
' * data which is held in the optical properties database'
'   which has typically been imported from Window 6.2 or from'
'   the EU WIS application.'
' * data which you supply and type in manually'
'  '
'Manual data input will ask for the direct transmission at each'
'angle as well as absorption characteristics for layer. Using'
'data from an optical database simplifies the process. '
'  '
'If you cancel you will be taken back to the start of the editing'
'sequence. '
*enditem
      CALL EASKAB(' Get optical properties from: ',' ',
      CALL EASKS(HOLD,' Direct trans @ 0 40 55 70 80 degrees: ',
      CALL EASKR(VTRN,' ',' Visible transmittance: ',
      CALL EASKI(NTLT,' ',
      CALL EASKS(HOLD,outs,'  ',
*subroutine ELISTMAT
*item ELISTMAT cat_list_materials
'The classifications shown in the display include up to'
'~30 materials. To get a listing of the items included'
'select one of the classifications.'
'  '
'You can manage categories - e.g. add a new category and'
'give a name (<32 char) to the classification and also'
'supply notes (<248 char) about the category.'
'  ' 
'Summary reporting can be shown in the text feedback'
'or exported to a text file.'
'  '
*enditem
        CALL PHELPD('materials menu',3,'-',0,0,IER)
        CALL EPICKS(INPIC,ICLSSEL,' ',' Which classes to list:',
        CALL EASKABC(' Reporting to:',' ',
        CALL EASKS(t32,' Classification name (<32 char)?',' ',
*item ELISTMAT materials_db_overview
'The information in this display is based on data from a'
'materials database. Databases of this this type are referenced'
'by the ESP-r construction database.'
'  '
'Data in this db rarely changes. However, users may wish to add'
'additional materials or classifications to conform to products'
'and materials in their region.'
'  '
'You can manage categories - e.g. add a new category and give a'
'name (<32 char) to the classification and also supply notes'
'(<248 char) about the category.'
'  '
'Adding or Deleting a material is supported. The former creates'
'a material at the end of the current classification which'
'may then be edited. '
'  '
'You have the choice of supplying the data for a material or'
'to approximate the performance of non-homogeneous constructions'
'in ISO 6946 (repeating thermal bridges) by selecting two existing'
'materials and give each a weighting (1-99%) (please document '
'non-homogeneous constructions carefully).'
' '
'Note: currently the derivation only works with two solid'
'materials. If air is in the layer then its air gap resistance'
'needs to be converted into an aeuivalent thermal conductivity.'
'The 6946 spec applies to pairs of materials which do not'
'differ greatly in conductivity and thus is not applicable for'
'metal & insulation combinations.'
' '
'The conductivity, density, spedific heat and vapour'
'properties will be weighted from the two sources for 6946.'
' '
'You may copy an existing material into a new item at'
'the end of the list. BE SURE TO ALTER ITS NAME! '
'  '
'Recent changes to the materials database are held'
'in memory and might be lost if not saved to file.'
*enditem
          CALL ASKOK('Changes have been made in database. ',
          CALL EASKS(t32,' ',' Classification name (<32 char)?',
          CALL EASKS248(t248,'Category notes:',' ',
          CALL PHELPD('materials database',17,'-',0,0,IER)
          CALL EASKABCD(' ','Options: ','Delete existing material',
          CALL EASKR(PER1,' ','First material % in the layer: ',
          CALL EASKR(PER2,' ','Second material % in the layer: ',
          CALL ASKOK(outs,'as your selection ?',OK,dok,1)
*subroutine EDONEMAT
*item EDONEMAT material_db_edit_one
'This display shows the attributes of this material. The attributes'
'vary depending on the source of the material (legacy materials'
'have fewer attributes). '
' '
'Some attributes (e.g. single layer optics) will be used in a future'
'ESP-r version but are required for expport to other assessment tools.'
' '
'Edit by selecting an item. The following information can be changed:'
'  '
' name - (up to 32 char) is required and will appear in selection'
'   lists (but might be be shown in a truncated form in some menus).'
'  '
' documentation - (up to 248 char) is a really good idea and might'
'   include the source and test regime etc.'
'  '
' conductivity - units are W/(m deg.C) '
'  '
' density - -units are  kg/m**3 '
'  '
' specific Heat units are J/(kg deg.C) '
'  ;
' surface emissivity - is based on infrared band. It is a'
'   fraction 0.01 < x < 0.99  You may specify different values'
'   for each face (but ESP-r does not yet use this).'
'  '
' surface absorptance - is based on solar band. It is a'
'   fraction 0.01 < x < 0.99. 'You may specify different'
'   values for each face (but ESP-r does not yet use this).'
'  '
'Legacy materials will have the same value for the inside and'
'outside faces. '
'  '
'Legacy materials will have the same value for the inside and'
'outside face. '
'  '
'Vapour resistvity for vapour transfer has units of'
'MNs g^-1m^-1. Used to support assessments of condensation'
'within constructions. '
'  '
'Thickness (mm) is the typical/default thickness of this mateiral.'
'  '
'Recent changes to materials are held in memory and if you exit'
'without saving the edited data will be discarded. '
*enditem
        CALL ASKOK(' ','Accept changes in material (see help)?',
        CALL EASKS(tnam,' ',' Description of material? ',
        CALL EASKS248(tdoc,' ',' Documentation for material? ',
        CALL EASKR(DBCON,' ',' Conductivity (W/(m deg.C): ',
        CALL EASKR(DBDEN,' ',' Density (kg/m**3): ',
        CALL EASKR(DBSHT,' ',' Specific heat (J/(kg deg.C): ',
        CALL EASKR(EOUT,' ',' Surface emissivity : ',
        CALL EASKR(EOUT,' ',' Outside face emissivity : ',
        CALL EASKR(EIN,' ',' Surface emissivity : ',
        CALL EASKR(EIN,' ',' Inside face emissivity : ',
        CALL EASKR(AOUT,' ',' Surface absorptance: ',
        CALL EASKR(AOUT,' ',' Outside face absorptance: ',
        CALL EASKR(AIN,' ',' Surface absorptance : ',
        CALL EASKR(AIN,' ',' Inside face absorptance: ',
        CALL EASKR(dbdrv,' ','Vapour resistvity (MNs g^-1m^-1): ',
        CALL EASKR(THICK,' ',' Default thickness (mm) : ',
*item EDONEMAT material_db_edit_type
'Legacy opaque was imported from an older materials database'
'and only contains essential data. Future materials database'
'will have additional attributes to introduce temperature '
'corrections based on either gas data plus a temperature'
'correction factor or gas data at 4 temperature points. '
' '
'Transparent materias will include single layer optics such as'
'used by WIS and Window6 etc. These are:'
'  Longwave transmittance units (-) between 0.0 & 1.0'
'  '
'  Solar transmittance units(-) between 0.0 & 1.0'
'  '
'  Solar reflectance units are (-) between 0.0 and 1.0'
'    (the outside face is farthest from zone air)'
'    (the inside face is nearest the zone air)'
'  '
'  Visible transmittance units are (-) between 0.0 & 1.0'
'  Visible reflectance units are (-) between 0.0 and 1.0'
'    (the outside face is farthest from zone air)'
'    (the inside face is nearest the zone air)'
'  '
'  Colour rendering units are (?) between 0.0 & 100.0'
'    <<more text to be added...>>'
'  '
*enditem
        CALL EASKATOG('Material options:',message,
        CALL EASKR(IRTRAN,' ','Longwave transmittance (-): ',
        CALL EASKR(SOLDRTRN,' ','Solar direct transmittance (-): ',
        CALL EASKR(soldrotrfl,' ',
        CALL EASKR(soldrinrfl,' ',
        CALL EASKR(vistran,' ','Visible trans (-): ',
        CALL EASKR(visotrfl,' ',
        CALL EASKR(visinrfl,' ',
        CALL EASKR(visinrfl,' ',
        CALL PHELPD('material attributes',9,'-',0,0,IER)
*subroutine EDMLDB
*item EDMLDB constr_db_overview
'The information in this display is based on data from'
'both a materials database and a construction database.'
'It is used to build zone construction files according to'
'the construction name associated with each surface.'
'  '
'Note that the reporting level influences the detail in'
'this display and you may wish to reset the reporting level'
'to see additional information.'
'  '
'The list of MLC database entries can be sent to a text file'
'or displayed.  Optical properties are included in detailed'
'files or if the reporting level has been set to verbose. And'
'the combined information is also available in the modeo QA'
'report if you toggle that report to verbose.'
'  '
'Adding or Deleting constructions is supported. The'
'former creates a single layer construction at the end'
'of the list which may then be edited. Plese be sure '
'that new construction names are unique.'
' '
'You may copy an existing construction into a new item at'
'the end of the list. Be sure its name is unique! '
' '
'The copy and invert function is useful where nonsymmetric'
'constructions are used in partitions. For example, in'
'the case of a raised floor system from the point of view'
'of the room the carpet is on the inside face and from the'
'point of view of the floor void the carpet should be on '
'the outside face. The original and interted constructions'
'should have similar names with one indicating its'
'inverted state.'
'  '
'Although you only have 12 characters to work with (no spaces'
'or unprintable characters try and create a useful name for the'
'construction that is not a duplicate of an existing name.'
'  '
'Remeber, recent changes to constructions are held in memory'
'and might be lost if not save to file. '
'  '
'In order to reflect changes you have made in this db you'
'you will have to rebuild the zone construction and tmc files.'
'This option will be presented to you when you exit'
'the database management session. '
*enditem
        CALL ASKOK(' ','Save recent changes to constructions db?',
        CALL PHELPD('construction db',19,'-',0,0,IER)
        CALL PHELPD('construction db save',6,'-',0,0,IER)
        CALL EASKABCD(' Reporting to:',' ',
        call easkatog('Constructions options:',' ',
        CALL EASKS(T14,' ',' Name of construction? ',
        CALL ASKOK(' ',' Are you sure? ',OK,dok,1)
        CALL EASKS(T14,' ',' Name of new construction (<12 char)?',
        CALL EASKS(T14,'Name of inverted construction (<12 char)?',
*item EDMLDB construction_db_g-value
'Although g-values for transparent glazings are not used'
'in ESP-r is is possible to report these in accordance with'
'Test G5 TM33:2006 CIBSE. '
'You will be required to provide for each pane its transmittance'
'and reflectance (both in the direction of incident radiation and'
'against it). Single/double and triple glazings are supported.'
'  '
'G-value calculations are currently restricted to air or'
'gas filled triple glazings which are symmetric in construction.'
'  '
'In order to calculate G-value ESP-r needs values for'
'  trnt   = transmittance of the pane,'
'  ref    = reflectance of this pane in direction of'
'           incident radiation'
'  o-ref  = reflectance of this pane in direction '
'           opposite incident radiation'
'  ems    = emissivity of this pane in direction of'
'           incident radiation'
'  o-ems  = emissivity of this pane in direction '
'           opposite incident radiation'
' '
'Choose CIBSE TM33:2006 prescribed values or define your own.'
' '
'Note that low emissivity glass has been inverted because it'
'is always the 2nd pane for TM33 tests in the UK.'
*enditem
       CALL PHELPD('G-value for tran construction',10,'-',0,0,IER)
       CALL EPICKS(INPICK,IVALS,PROMP1,PROMP2,
       CALL EASKS(T72,
*subroutine EDWALL
*item EDWALL edit_wall_details
'A construction is composed of between one and ten layers'
'(three of which may be air gaps). Each layer has a thickness'
'and is composed of one material. The thermophysical properties'
'of each layer are based on data in the current materials database.'
'  '
'Instances of the data for this construction will be inserted'
'in the zone construction file. To ensure model quality, avoid'
'further editing of the zone construction files. Create more'
'constructions if you need variant thermophysical properties.'
'  '
'You can delete an existing layer, append a new layer at the'
'[inside face] of the surface (remember the order is other-side'
'to zone-side), or insert a layer (you will be asked to select'
'a point of insertion and existing inner layers will be shifted).'
'Note: layer 1 is considered the [outside].'
'  '
'When editing you are given the option to select a material from'
'the materials database. To keep the existing material say no to'
'browsing the materials database.'
'There is a special case for an air gap - historically the'
'material zero indicated air. Currently there is a category'
'named GAPS in the materials database and the first entry'
'in that category should be used for air gaps (to get properties'
'for other gasses you should edit the air gap resistance). In'
'the future the other entries in the GAPS category can be used.'
'  '
'A set of default assumptions on the R value of an air gap will be'
'requested so the the construction can be used in different'
'orientations (horizontal, vertical sloped).'
'  '
'The thickness of the layer is nominally between 1mm and 300mm.'
'It is stored in the file as m. You can also alter the name'
'of the construction (try for clarity an uniqueness).'
'  '
'If you alter a construction you will be asked (later) if you want'
'to update the zone construction files.'
'  '
'The terms SYMMETRIC and NONSYMMETRIC have the following meaning:'
'SYMMETRIC constructions can be referenced from either zone'
'associated with a partition; a NONSYMMETRIC construction should'
'have an [inverted] version in the database. If a construction is'
'linked to a reversed version the software to keep these in sync!'
'  '
'In ESP-r air gaps in constructions are represented as a fixed'
'resistance to heat flow (depending on the orientation of the'
'surface using the construction). The R-value supplied should'
'account for the resistance across the cavity (including the'
'impact of low emissivity at the adjacent solid layers).'
' '
'Air gaps are assumed not to have air movement. If the cavity is'
'ventilated make it a zone and include it in an air flow network.'
'  '
'There is an option to try different layer thicknesses or air gap'
'resistances in order to reach a desired U value.'
*enditem
       CALL ASKOK(outs,'Update the linked construction as well?',
       CALL PHELPD('construction editing',36,'-',0,0,IER)
       CALL EASKABCD(' Layer options: ',' ',' Delete',
       CALL EPICKS(IX,imlay,' ',' Layer to delete: ',
       CALL EPICKS(IX,imlay,' ',' Point of insertion: ',
       CALL ASKOK('Browse the materials db for a new material',
       CALL EASKABC('Your selection is `0` i.e. air. Options:',
       CALL EASKR(VAL,outs,
       CALL EASKR(VAL,outs,
       CALL EASKR(VAL,outs,
       CALL EASKR(VAL,' ',' Layer thickness (mm): ',
       CALL EASKS(T14,' ','Name of the construction?',
*item EDWALL construction_opaque_trn
'In order to make cross checking easier the user is asked'
'to define the construction as either OPAQUE or TRANSPARENT.'
'  '
'A Complex Fenestration Construction (CFC) allows for a more'
'accurate treatment of modeling windows with or without shading'
'devices. A CFC surface has the following attributes:'
' '
'  -Exterior, vertical surface (IE=0)'
'  -Each glazing/shading layer is separated by gas gap'
'  -Currently limited to one shading layer per CFC'
' '
'For an example of usage of CFCs see Appendix F: CFC User'
'Reference from http://uwspace.uwaterloo.ca'
'/bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
'  '
'The Glazing Shading Layer editor (GSLedit) used for importing'
'CFC input properties can be downloaded from here.'
*enditem
        CALL EASKABC(' ','Please choose one type :',
        CALL PHELPD('CFC instructions',20,'-',0,0,IER)
*item EDWALL construction_optics
'In order to allow for the optical properties to be'
'used in the model description and to be acted on'
'by control laws the relevant optical property id  '
'(from the optical properties db) is required.'
'  '
'If a particular optical property set cannot be recovered'
'you are asked to select a different one.'
*enditem
        CALL PHELPD('optical selection',4,'-',0,0,IER)
        CALL ASKOK(' ',' Not found... try again? ',OK,dok,2)
        CALL ASKOK('Would you like to link this construction to',
        CALL ASKOK('Change the materials db reference via browsing',
        CALL EASKABC('Your selection is `0` i.e. air. Options:',
        CALL EASKR(VAL,outs,
        CALL EASKR(VAL,outs,
        CALL EASKR(VAL,outs,
        CALL EASKR(VAL,' ',' Layer thickness (mm): ',
*subroutine allmat
*item allmat select_from_materials
'This menu allows existing materials to be viewed and'
'one of them selected.'
*enditem
        CALL PHELPD('materials section',2,'-',0,0,IER)
*subroutine EDDB
*item EDDB database_mgt_overview
'ESP-r is provided with standard databases located in'
'a databases folder adjacent to the ESP-r executables bin'
'folder.'
'  '
'For some simulation models a user may require a bespoke'
'version of a database.  In this case the user may either'
'copy a standard database into a local directory for'
'modification or simply begin from scratch.'
' '
'In most cases a bespoke database may be created by copying'
'a standard database into the project directory (hint:'
'accept the suggested name which is based on the root name'
'of the model or give it a name identifiable with the project)'
'and then modifying it to fit the needs of the project.'
' '
'Initially the database names will correspond to the defaults'
'supplied with ESP-r. If these defaults are not found, the'
'most likely reason is that they have not been correctly'
'installed in the file path given at the top of this message.'
'  '
'If you alter database file names these need to be recorded'
'in the model if the correct databases are to be accessed in'
'the future. If you do not update the model configuration'
'other dependencies might be left unresolved. '
' '
'If you are have not quite finished work on your databases'
'(e.g. you are creating an alternative) you might wish to delay'
'updating the model zone files. If you have finished and zone'
'construction and tmc files already exist then the option to'
'update the zone files will save time.'
'  '
'The help option in this menu allows you to select which db'
'you want more information for.'
*enditem
        CALL ASKOK(
        CALL ASKOK(
        call phelpd('databases overview',19,'-',0,0,IER)
        call easkatog(' ','Help options:','overview','climate',
        CALL PHELPD('databases overview',7,'-',0,0,IER)
*item EDDB database_clm_overview
'Climate databases contain hourly parameters over the period'
'1h00 on 1 Jan to 24h00 on 31 December (i.e. no leap years).'
'Where data is supplied for only one or more part of this period,'
'the remaining data will be set to zero. The parameters required'
'for each hour are as follows.'
' '
' 1. Diffuse horizontal solar intensity (W/m^2).'
' 2. Dry bulb temperature (tenths degC, i.e. 102 ='
'   10.2degC).'
' 3. Direct normal solar intensity (W/m^2). As an'
'    alternative, global horizontal intensity may be'
'    used in which case a corresponding db flag must'
'    be set.'
' 4. Wind speed (tenths m/s, i.e. 15 = 1.5 m/s).'
' 5. Wind direction (clockwise degrees from North.'
' 6. Relative humidity (%).'
' '
'When using these climate parameters ESP-r will assume that'
'the data represents the one hour period centered on the hour'
'in question. Where sub hour simulation time steps are used,'
'interpolation is used.'
'  '
'The database is held in binary format to allow random access.'
'Conversion to an ASCII format is supported to allow transfer'
'between different operating systems.'
*enditem
          CALL PHELPD('climate overview',26,'clm_dbitems ',0,0,IER)
*item EDDB database_mat_overview
'The Materials database holds the density, specific heat,'
'conductivity, diffusion resistance and surface absorptivity'
'and emissivity (plus some future attributes) of products such'
'as brick, concrete, metal, wood and so on.'
'  '
'Materials are arranged into a number of categories such as'
'concrete, glass etc. to allow for quicker access.'
' '
'Older versions of the database were held in binary format'
'but most recent versions of ESP-r use an ASCII file format'
'which is scanned into memory. The ASCII version is assumed'
'however it is possible to use the older binary version as'
'well as supporting its conversion to the ASCII format.'
'  '
'Materials are known by a short name <12 char as well'
'as by a longer <248 character description. The initial'
'portion of the description is used for checking and is included'
'in the constructions database to clarify the contets'
'  '
'Older database made use of a numerical index rather than'
'the name for identification and thus the short names in'
'older files may not be unique and cause some confusion when'
'they are scanned. The usual recorse is to open the materials'
'database in a text editor and locate the duplicate names and'
'alter them slightly.'
*enditem
          CALL PHELPD('materials db overview',8,'materials_db',0,0,IER)
*item EDDB database_mlc_overview
'The Constructions database defines the composition of walls, floors,'
'roofs etc in terms of layer ordering, thickness and material.'
'  '
'Where the construction is transparent a named set of optical'
'properties, as held in the Optical Properties database, is'
'part of the construction description.'
'  '
'Unlike materials, constructions are held in a single list'
'and so it may take some time to identify a specific construction.'
'  '
'Also unlike materials there is no documentation string associated'
'with a construction and you are advised to keep separate notes'
'on the construction and the assumptions and sources.'
*enditem
          CALL PHELPD('constr db overview',5,'mlc_database',0,0,IER)
*item EDDB database_optic_overview
'The Optical Properties database holds the visable and solar'
'transmissivity and absorptivity for each layer within a'
'transparent construction and for 5 angles of incidence:'
'   0 (normal), 40, 55, 70 and 80 degrees.'
'  '
'Optical data must be sourced from 3rd party software. ESP-r'
'is able to import optical data calculated via the applications'
'WIS (in Europe) and Window 6 (from LBL). It is up to you to'
'ensure that there is a matching construction for the optical'
'property.'
*enditem
          CALL PHELPD('optics overview',4,'optical_db',0,0,IER)
*item EDDB database_plant_overview
'The Plant components template database holds data defining'
'individual plant components for assembly into networks'
'defining particular systems of arbitrary complexity.'
' '
'The database is held in binary format to allow random access.'
'Conversion to an ASCII format is supported to allow transfer'
'between different operating systems.'
'  '
'The database format is strict and it takes extreme care and'
'attention to detail in order to edit the database or add in'
'new component templates.'
*enditem
          CALL PHELPD('plant db overview',7,'plant_db_fld',0,0,IER)
*subroutine opendb
*item opendb many_mat_not_found
'The Materials database holds the density, specific heat,'
'conductivity, diffusion resistance and surface absorptivity/'
'emissivity for materials such as brick, concrete, wood,'
'metal etc.'
'  '
'Older versions of this database were held in binary format'
'and newer models use an ASCII version of the file and support'
'additional attributes. Conversion options between ascii and binary'
'versions are available.'
'  '
'When ESP-r attempts to scan the databases it will look at how'
'many of the materials are correctly read. If there are many that'
'seem to be corrupted it will conclude that the Materials db'
'associated with this model is a binary file from a different'
'operating system.'
'  '
'ESP-r will attempt to locate an ASCII version of the materials'
'database and, if successful use it.'
'  '
'The Materials db holds the thermo-physical properties of a range'
'of materials. The ascii version of this database can also be'
'used to transfer the contents between operating systems that have'
'incompatible binary representations (e.g. Unix and Windows).'
*enditem
            CALL EASKS(LASCI,' ','Materials database (ASCII)?',
*subroutine EDDBMATERIAL
*item EDDBMATERIAL mat_db_edit_menu
'The Materials database holds the density, specific heat,'
'conductivity, diffusion resistance and surface absorptivity/'
'emissivity for materials such as brick concrete, wood, metal'
'etc. Older versions of thie db were held in binary format and'
'newer models use an ASCII version of the file and support'
'additional attributes. Conversion options between ascii and'
'binary versions are available.'
' '
'The ESP-r distribution includes alternatives to the'
'default which might be useful.'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database and if'
'   you have permission to update the file you can edit the'
'   entities in the database.'
' '
'b) select from list: you confirm a common file name and it will'
'   be associated with the model. Take care if you browse or edit!'
' '
'c) select from files in model ../dbs folder : you confirm name and'
'   it will be associated with the model.'
' '
'd) copy default database: a project copy of the default'
'   database will be made and you will be offered a chance to'
'   rename it.  The suggested name will be based on the model'
'   root name.'
' '
'e) copy a file from common: a project copy of a common file'
'   will be made and you will be offered a chance to rename'
'   it (based on the model root name.'
' '
'f) Convert a legacy binary representation of the db (which is'
'   platform dependant) to an ASCII representation which is'
'   the current standard format.'
' '
'g) Convert an ascii representation of the db to a binary'
'   representation (NOTE THIS IS ONLY for LEGACY models'
'   with old ASCII format files and is depreciated).'
' '
'h) make a new database: a new database will be created and'
'   the suggested file name will be based on the model root'
'   name which you can alter.  A new materials will have'
'   one item in each of the standard categories. It will be'
'   useless until you populate the database with relevant infor.'
' '
*enditem
        call MENUATOL('  ','Materials db',
        call MENUATOL('  ','Materials db',
        call MENUATOL('  ','Materials db',
        call MENUATOL('  ','Materials db',
        CALL EASKSCNCL(ltmp,' ','New materials db?',
        CALL ASKOK(' ','Browse or edit new database?',OK,dok,4)
        CALL EASKXORGTKF(lguess,
   66   CALL EASKS(LTMP,
        CALL EASKSCNCL(LTMP,'Materials db (binary)?',' ',
        CALL EASKSCNCL(LTMP,'Materials db (ascii)?',' ',
        CALL EASKSCNCL(LTMP,'Materials db (legacy ascii)?',' ',
 143    CALL EASKSCNCL(ltmp,'Materials db (legacy binary)?',' ',
        CALL EASKXORGTKF(LCOPY,'Materials db?',' ',
        CALL ASKOK('Is this file in the model ../dbs folder?',
        CALL EASKF(LCOPY,' ','Materials db?',
        CALL EASKSCNCL(LTMP,
*subroutine EDDBPCDB
*item EDDBPCDB plant_template_manage
'The plant components database is a binary, random access file'
'holding plant component descriptions to enable the establishment of'
'component state-space representations used by ESP-r.'
' '
'If there is no such file then a new one will be created to hold'
'data for new components.'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database and if'
'   you have permission to update the file you can edit the'
'   entities in the database.'
' '
'b) select from list: you confirm a common file name and it will'
'   be associated with the model. Take care if you browse or edit!'
' '
'c) select from files in model ../dbs folder : you confirm name and'
'   it will be associated with the model.'
' '
'd) copy default database: a project copy of the default'
'   database will be made and you will be offered a chance to'
'   rename it.  The suggested name will be based on the model'
'   root name.'
' '
'e) copy a file from common: a project copy of a common file'
'   will be made and you will be offered a chance to rename'
'   it (based on the model root name.'
' '
'f) Convert a binary representation of the db (which is'
'   platform dependant) to an ASCII representation which is'
'   the current standard format.'
' '
'g) Convert an ascii representation of the db to a binary'
'   representation.'
' '
'h) make a new database: a new database will be created and'
'   the suggested file name will be based on the model root'
'   name which you can alter. Take care if you use this option'
'   as the file format is pedantic.'
'   An empty plant component database is useless until it has'
'   been populated with data. If you have the information required'
'   you can proceed with that task.'
' '
*enditem
        call MENUATOL('  ','Plant Components db',
        call MENUATOL('  ','Plant Components db',
        call MENUATOL('  ','Plant components db',
        call MENUATOL('  ','Plant Components db',
        CALL EASKSCNCL(ltmp,' ','Plant Components db?',
        CALL ASKOK(outs,' Browse or edit new database?',OK,dok,4)
        CALL EASKXORGTKF(lguess,
   66   CALL EASKS(LTMP,
        CALL EASKXORGTKF(LCOPY,'Plant templates db?',' ',
        CALL ASKOK('Is this file in the model ../dbs folder?',
        CALL EASKF(LCOPY,' ','Plant templates db?',
*subroutine EDDBPREDEF
*item EDDBPREDEF pre_db_edit_menu
'The predefined objects database is an ASCII file which holds'
'descriptions of furniture, fittings, zonal based environmental'
'system components and facade elements which can be inserted into'
'ESP-r models.'
' '
'Predefined objects for furniture can hold visual attributes'
'(to be passed of Radiance) as well as back-to-back surfaces'
'which represent the thermal mass. These are intended to be'
'inserted into existing thermal zones after which they take a'
'full part in the thermal and/or visual assessment.'
' '
'An environmental component, such as a thermostat, becomes'
'a zonal representation including the mass of the circuit'
'board, explicit sensor and casing. This zone-in-a-zone interacts'
'with the occupied space zone.'
' '
'A predefined facade element would be inserted into a zone as'
'a collection of surfaces, optionally with visual blocks to'
'represent the depth of the framing.'
' '
'Currently predefined objects are created as ESP-r zones and'
'then converted into a block of text to be manually inserted'
'into the predefined.db1 file. Examples can be found in the'
'models/validation/DSM/predef folder.'
' '
'In this menu you can list the contents of existing predefined'
'objects, scan and convert existing ESP-r geometry files into'
'the blocks of text to be inserted (further editing is required).' 
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database. '
'   (Editing is not yet available you have manually edit)'
' '
'b) select from list: you confirm a common file name and it will'
'   be associated with the model.'
' '
'c) select from files in model ../dbs folder : you confirm name and'
'   it will be associated with the model.'
' '
'd) copy default database: a project copy of the default'
'   database will be made and you will be offered a chance to'
'   rename it.  The suggested name will be based on the model'
'   root name.'
' '
'e) copy a file from common: a project copy of a common file'
'   will be made and you will be offered a chance to rename'
'   it (based on the model root name).'
' '
'f) Convert a ESP-r geometry file into an block of text which'
'   you can further edit and insert into the predefined database.'
' '
'g) Preview the contents of a predefined object allows you to view'
'   an object along with its primary attributes.'
*enditem
*subroutine EDDBPROFILE
*item EDDBPROFILE events_db_manage
'   Events Database '
' '
'Profiles in this database are currently used to assist in the'
'defintion of zone operations.  The standard db are found in the'
'databases folder adjacent to the ESP-r executables bin folder.'
'There are ASCII versions (file name ends with an .a) or binary'
'versions (depreciated).'
' '
'The ESP-r distribution includes alternatives to the default'
'which might be useful.'
'  '
' The data requirements are summarised below :- '
' '
' for each profile - number of events.'
' '
' for each event - start and finish hours'
'                  percentage of first magnitude '
'                  percentage of second magnitude '
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database and if'
'   you have permission to update the file you can edit the'
'   entities in the database.'
' '
'b) select from list: you confirm a common file name and it will'
'   be associated with the model. Take care if you browse or edit!'
' '
'c) select from files in model ../dbs folder : you confirm name and'
'   it will be associated with the model.'
' '
'd) copy default database: a project copy of the default'
'   database will be made and you will be offered a chance to'
'   rename it.  The suggested name will be based on the model'
'   root name.'
' '
'e) copy a file from common: a project copy of a common file'
'   will be made and you will be offered a chance to rename'
'   it (based on the model root name).'
' '
'f) browse common folder for a file to copy into model (similar'
'   to option e).'
' '
'g) Make a new database: a new (ASCII) database will be created'
'   based on the file name you supply.  The suggested file name'
'   will be based on the model root name. It will contain a minimal'
'   number of items and you can then modify this as required'
'   (indeed the database is useless until you add data to it.'
'   Exercise care if you use a text editor to copy sets of data'
'   from another event profile database into the current database.'
' '
*enditem
        call MENUATOL('  ','Event Profiles db',
        call MENUATOL('  ','Event Profiles db',
        call MENUATOL('  ','Event Profiles db',
        call MENUATOL('  ','Event Profiles db',
        CALL EASKSCNCL(ltmp,' ','Event Profiles db? (ASCII)',
        CALL ASKOK(outs,' Browse or edit database?',OK,dok,4)
        CALL EASKXORGTKF(lguess,'Event Profiles db (source)?',' ',
  66    CALL EASKS(LTMP,
        CALL EASKXORGTKF(LPRFDB,'Event Profiles db (source)?',' ',
        CALL EASKXORGTKF(LLASCI,
        CALL EASKXORGTKF(lbin,'Event Profiles db (binary)?',' ',
        CALL EASKXORGTKF(LCOPY,'Event Profiles db?',' ',
        CALL ASKOK('Is this file in the model ../dbs folder?',
        CALL EASKF(LCOPY,' ','Event Profiles db?',
*subroutine EDDBMLCON
*item EDDBMLCON mlc_db_manage
'A (multilayer) construction database defines the composition'
'of constructions such as walls and glazing systems in terms'
'of layers of materials of particular thickness in a particular'
'order and, where appropriate, with a named set of optical '
'properties. '
'  '
'More than other database types the MLC databse tends to be'
'project specifice. Some groups maintain a number of bespoke'
'MLC databases for specific building types and then use those'
'as the starting point for new models.'
' '
'The ESP-r distribution includes alternatives to the default'
'which might be useful.'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database and if'
'   you have permission to update the file you can edit the'
'   entities in the database.'
' '
'b) select from list: you confirm a common file name and it will'
'   be associated with the model. Take care if you browse or edit!'
' '
'c) select from files in model ../dbs folder : you confirm name and'
'   it will be associated with the model.'
' '
'd) copy default database: a project copy of the default'
'   database will be made and you will be offered a chance to'
'   rename it.  The suggested name will be based on the model'
'   root name.'
' '
'e) copy a file from common: a project copy of a common file'
'   will be made and you will be offered a chance to rename'
'   it (based on the model root name).'
' '
'f) browse common folder for a file to copy into model (similar'
'   to option e).'
' '
'g) Make a new database: a new database will be created based'
'   based on the root name of the model (which you can alter'
'   if necessary. It will contain a minimal number of items'
'   and you can then modify this as required. Indeed a new'
'   database is useless until you add data to it. Exercise
'   care if you use a text editor to copy sets from another'
'   MLC database into this new database.'
' '
*enditem
        call MENUATOL('  ','Constructions db',
        call MENUATOL('  ','Constructions db',
        call MENUATOL('  ','Constructions db',
        call MENUATOL('  ','Constructions db',
        CALL EASKSCNCL(ltmp,'Constructions database?',
        CALL ASKOK('  ',' Browse or edit new database?',OK,dok,3)
        CALL EASKXORGTKF(lguess,'Constructions db (source)?',
  66    CALL EASKS(LTMP,
        CALL EASKXORGTKF(LCOPY,'Constructions db?',' ',
        CALL ASKOK('Is this file in the model ../dbs folder?',
        CALL EASKF(LCOPY,' ','Constructions db?',
*subroutine EDDBOPT
*item EDDBOPT optic_db_manage
'The optical properties of multilayer constructions are defined'
'in an optical database.  The data include'
'  angular (0, 40, 55, 70, 80 degrees from normal) solar'
'  transmission and absorption at each layer.'
'  '
'There are two typcial sources for angular optical properties:'
' * data which is held in the optical properties database'
'   which has typically been imported from Window 6.2 or from'
'   the EU WIS application.'
' * data which you supply and type in manually'
' '
'The ESP-r distribution includes alternatives to the default'
'which might be useful.'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database and if'
'   you have permission to update the file you can edit the'
'   entities in the database.'
' '
'b) select from list: you confirm a common file name and it will'
'   be associated with the model. Take care if you browse or edit!'
' '
'c) select from files in model ../dbs folder : you confirm name and'
'   it will be associated with the model.'
' '
'd) copy default database: a project copy of the default'
'   database will be made and you will be offered a chance to'
'   rename it.  The suggested name will be based on the model'
'   root name.'
' '
'e) copy a file from common: a project copy of a common file'
'   will be made and you will be offered a chance to rename'
'   it (based on the model root name).'
' '
'f) browse common folder for a file to copy into model (similar'
'   to option e).'
' '
'g) Make a new database: a new database will be created based on'
'   the file name you supply. It will contain a minimal number of'
'   items and you can then modify this as required (indeed the'
'   database will be useless until you you add in some data.'
'   Exercise care if you use a text editor to copy sets of data'
'   from another optical database.'
' '
*enditem
        call MENUATOL('  ','Optical Properties db',
        call MENUATOL('  ','Optical Properties db',
        call MENUATOL('  ','Optical Properties db',
        call MENUATOL('  ','Optical Properties db',
        CALL EASKSCNCL(ltmp,' Optics database?',
        CALL ASKOK('  ',' Browse or edit new database?',OK,dok,3)
        CALL EASKXORGTKF(lguess,'Optical Properties db (source)?',
  66    CALL EASKS(LTMP,
        CALL EASKXORGTKF(LCOPY,'Optical Properties db?',' ',
        CALL ASKOK('Is this file in the model ../dbs folder?',
        CALL EASKF(LCOPY,' ','Optical Properties db?',
*subroutine EDDBPRES
*item EDDBPRES pressure_db_manage
'To enable the calculation of wind-induced surface pressures'
'(as required the simulator), this database of angle dependent'
'pressure coefficients is provided.'
'  '
'Wind pressure coefficients are pressure coefficients for surfaces'
'in typical positions and within several different exposure categories.'
'  '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database and if'
'   you have permission to update the file you can edit the'
'   entities in the database.'
' '
'b) select from list: you confirm a common file name and it will'
'   be associated with the model. Take care if you browse or edit!'
' '
'c) select from files in model ../dbs folder : you confirm name and'
'   it will be associated with the model.'
' '
'd) copy default database: a project copy of the default'
'   database will be made and you will be offered a chance to'
'   rename it.  The suggested name will be based on the model'
'   root name.'
' '
'e) copy a file from common: a project copy of a common file'
'   will be made and you will be offered a chance to rename'
'   it (based on the model root name).'
' '
'f) browse common folder for a file to copy into model (similar'
'   to option e).'
' '
'g) Make a new database: a new database will be created baed on the'
'   root name of the model and you will be given a change to alter'
'   this file name. It will contain a minimal number of items and'
'   you can then modify this to make it useful.'
'   Exercise care if you use a text editor to copy sets of data'
'   from another pressure database.'
'  '
*enditem
        call MENUATOL('  ','Pressure Distributions db',
        call MENUATOL('  ','Pressure Distributions db',
        call MENUATOL('  ','Pressure Distributions db',
        call MENUATOL('  ','Pressure Distributions db',
  62    CALL EASKSCNCL(ltmp,' New pressure coefficients database?',
        CALL ASKOK('  ',' Browse or edit new database?',OK,dok,3)
        CALL EASKXORGTKF(lguess,
  66    CALL EASKS(LTMP,
        CALL EASKXORGTKF(LCOPY,'Pressure coefficients db?',' ',
        CALL ASKOK('Is this file in the model ../dbs folder?',
        CALL EASKF(LCOPY,' ','Pressure coefficients db?',
*subroutine EDDBCLM
*item EDDBCLM clm_db_manage
'Climate databases are hourly sets of values from '
'1h00 on 1 Jan to 24h00 on 31 December.  For each hour'
' the following data is held:'
' '
'  Diffuse horizontal solar intensity (W/m^2)'
'  Dry bulb temp. (tenths of degree C ie. 102 = 10.2C)'
'  Direct normal or global horiz. solar intensity (W/m^2)'
'  Wind speed (tenths m/s ie. 15 = 1.5 m/s)'
'  Wind direction (degrees from north, clockwise)'
'  Relative humidity (percent)'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database and if you'
'   have permission to update the file you can edit the contents.'
' '
'b) select another file: you will presented with a list of'
'   available climate files. One of the options is user-defined'
'   where you can supply a file name and if it is found you'
'   can browse or edit it.'
' '
'c) make a new database: will create a file full of zeros which you'
'   can then optn in the clm module for editing.'
'   Alternatively in the list of available climate files choose'
'   user-defined a new database will be created based on the name'
'   you supply. This starts up the clm module where you can enter'
'   data or import data from EPW of Korea Met office files.'
' '
'd) copy default database: a project copy of the default database'
'   will be made and you will be offered a chance to rename it.'
' '
'e) convert binary file to an (esp-r) ascii file (typically for'
'   transport between machine types).'
' '
'f) convert ascii (esp-r) climate file to a binary suitable to '
'   the current computer.'
' '
'g) convert an EPW file (which has been check as per the'
'   EPW_readme instructions) to an esp-r binary weather file.'
'  '
'After conversion you are asked to confirm the weather file latitude'
'and longitude (this is often stated as the difference in degrees'
'from the local time meridian but some weather file sources are in'
'actual longitude) as well as the climate year. The weather file'
'documentation should make the longitude value clear. Typically one'
'would use a weather file which is close to the site of your building.'
'  '
'The year associated with a model primarily tells the simulator'
'what day of the week is 1 January. '
' '
'IF YOU CHANGE the model year remember to save your model'
'before you exit the project manager. '
' '
'The choice is year impacts the day of the week for 1 January.'
'It also will alter the day type associated with days in the'
'model calendar which are of the standard default'
'weekday/saturday/sunday (but not user defined day types).'
*enditem
        call MENUATOL('  ','Climate db',
        call MENUATOL('  ','Climate db',
        call MENUATOL('  ','Climate db',
        CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
        CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
        CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
        CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
        CALL EASKF(llclmdb,' Climate file (esp-r binary)?',
        CALL EASKF(longtmp,' ',' Climate file name ? ',
        CALL EASKF(longtmp,' ',' Climate file name ? ',
        CALL EASKF(longtmp,' ',' Climate file name ? ',
        CALL ASKOK(' ','Browse/edit new climate data?',OK,dok,3)
        CALL ASKOK(' ','Browse/edit new climate data?',OK,dok,3)
        CALL EASKF(longtmp,' ',' Climate file name ? ',
        CALL EASKF(longtmp,' ',' Climate file name ? ',
        CALL EASKF(longtmp,' ',' Climate file name ? ',
        CALL ASKOK(' ','Browse/edit copied climate data?',OK,dok,3)
        CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
        CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
        CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
        CALL ASKOK(' ','Browse/edit exported climate data?',OK,dok,3)
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
          CALL EASKF(longtmp,' ',' Climate file name ? ',
          CALL EASKF(longtmp,' ',' Climate file name ? ',
          CALL EASKF(longtmp,' ',' Climate file name ? ',
        CALL ASKOK(' ','Browse/edit exported climate data?',OK,dok,3)
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
          CALL EASKF(LLASCI,' ',' Climate file name (ASCII)?',
          CALL EASKF(longtmp,' ',' Climate file name (binary)? ',
          CALL EASKF(longtmp,' ',' Climate file name (binary)? ',
          CALL EASKF(longtmp,' ',' Climate file name (binary)? ',
        CALL ASKOK(' ','Browse/edit imported climate data?',OK,dok,3)
      CALL ASKOK(outs,
      CALL ASKOK(OUTS,
*subroutine EDDBMSC
*item EDDBMSC misc_db_manage
'The miscellaneous components database can bed edited using the'
'current defined text editor (as defined in the default file).'
'BE CAREFUL!'
' '
'The following options can be selected:'
' '
'a) If the file exists than you can browse the database and if'
'   you have permission to update the file you can edit the'
'   entities in the database.'
' '
'b) select from list: you confirm a common file name and it will'
'   be associated with the model. Take care if you browse or edit!'
' '
'c) select from files in model ../dbs folder : you confirm name and'
'   it will be associated with the model.'
' '
'd) copy default database: a project copy of the default'
'   database will be made and you will be offered a chance to'
'   rename it.  The suggested name will be based on the model'
'   root name.'
' '
'e) copy a file from common: a project copy of a common file'
'   will be made and you will be offered a chance to rename'
'   it (based on the model root name).'
' '
'f) browse common folder for a file to copy into model (similar'
'   to option e).'
' '
'g) Make a new database: not yet available '
'  '
'The miscellaneous components database can be edited with'
'the current defined text editor (as defined in the default file).'
'BE CAREFUL!  The format may be sensitive to user edits! '
'  '
'If you alter the file name when saving the text'
'in the editor then you will have to browse to'
'find the new file.'
*enditem
        call MENUATOL('  ','Miscellaneous components db',
        call MENUATOL('  ','Miscellaneous components db',
        call MENUATOL('  ','Miscellaneous components db',
        call MENUATOL('  ','Miscellaneous components db',
          CALL EASKXORGTKF(lguess,'Miscellaneous comp db (source)?',
  66    CALL EASKS(LTMP,
        CALL EASKXORGTKF(LCOPY,'Miscellaneous comp db?',' ',
            CALL ASKOK('Is this file in the model ../dbs folder?',
          CALL EASKF(LCOPY,' ','Miscellaneous components db?',
      CALL ASKOK('  ','Use this edited database (see help)?',OK,dok,5)
*subroutine EDZONE
*item EDZONE geometry_main_menu
'This menu allows the attributes of a thermal zone to be specified'
'as follows.'
' '
'* Zone name: label <12 char used in lists and reports. It should'
'    be descriptive and unique'
'  '
'* Zone description: <64 char which records the intent of the zone'
'    and assumptions made
'  '
'* Base area: list of surfaces associate with the base. Logic looks'
'    for FLOR orientation but you can manually select ~6 surfaces'
'    and the base area will be calculated or type in a specific'
'    floor area (for example if the base of the zone is sloped).
' '
'* Vertex list & coordinates: X, Y, Z coordinates of vertices'
'    in the zone and related functions (add/delete/copy and'
'    transforms). You are asked to confirm the data shoould be'
'    saved when you exit.
' '
'* Surface list: topology (edge ordering) of each surface with'
'  related functions (add/delete/copy as well as transforms).'
'  New surfaces can be composed via point and click, imported'
'  from other zones or defined via keyboard input.'
' '
'* Surface attributes: name, composition, opacity and boundary'
'  conditions and use. This is the preferred place to define the'
'  full range of surface attributes. You will have the option'
'  to attribute-many surfaces as well as editing individual'
'  surfaces one at a time. This includes a new USES attribute'
'  which is used to automate code compliance checking.'
'  '
'* Solar insolation: as a alternative to running a time-series'
'  insolation analysis, you may specify the surface or surfaces'
'  that will receive any solar radiation entering a zone.'
' '
'* Obstructions: Shading patterns are generated via the'
'  use of obstruction blocks, and the definition of these'
'  blocks is via this menu pick. You will be able to supply'
'  an origin plus dimensions or click-on-bitmap.'
' '
'* Browse: displays a table of information about each surface'
'  there is an option to see detailed attributes such as thermo-'
'  physical properties.'
'  '
'* Visual entities are simple solid bodies with names and composition'
'  which are seen in wireframe views and passed to Radiance. Also'
'  compound entities which might represent furniture are collections'
'  of visual entities.'
'  '
'* Predefined entities are a mix of visual entities with embedded'
'  thermal mass for multi-criteria assessments. Definitions are'
'  currently in predefined.db1 and are work-in-progress.'
'If you exit without saving changes then some inputs may be lost.'
'You will be asked to confirm the file name.'
*enditem
        CALL ASKOK('Save changes to zone composition and surface',
        CALL EASKS(T14,'Descriptive name for zone?','(<12 characters)',
  64    CALL EASKS(T64,'Zone description?','(<64 characters)',
        CALL EPICKS(INPICK,IVALS,outs,
        CALL EASKR(ZBASEA(ICOMP),' ',
        CALL ASKOK(' ','Save vertex changes?',OK,DOK,2)
        CALL EASKSUR(ICOMP,IS,'M','Select surface(s) to attribute.',
          CALL EASKATOG('Surface attribution: ',' ',
*item EDZONE geometry_boundary_menu
'The boundary conditions at the other face of this'
'surface is specified  here. The default is [exterior].'
' '
' Exterior - exposed to external weather.'
' '
' Similar to current - exposed to the same conditions as the'
'   inside face except for the treatment of solar insolation:'
'   only the diffuse component assumed the same.'
'   A temperature (C) and radiation (W/m^2) offset may be imposed'
'   to approximate a room which is always a bit warmer or cooler.'
' '
' Prescribed static - exposed to a user specifiec and constant'
'   temperature (C) and radiation condition (W/m^2)'
'   e.g. to approximate a cold storage room.'
' '
' Surface in other zone - exposed to the temperature and radiation'
'   conditions of a specified surface in another zone but'
'   one time step in arrears.'
' '
' Ground (monthly profile) - exposed to a temperature defined by'
'   a standard monthly temperature profile embedded in ESP-r.'
'   There are ~50 profiles to choose from.'
' '
' Ground (user defined profile) - exposed to a temperature defined'
'   by a monthly temperature profile supplied by the user (via the'
'   Model Context menu). For example a profile at 1m and another'
'   at a 3m depth.'
' '
' Ground (3D conduction model) - exposed to a temperature'
'   calculated from a 3D representation of the ground.'
'  '
'The 1st index for a ground connection is either:'
' > 0 connection to a standard profile'
' = 0 connection to a user defined profile (2nd index)
' =-3 connection to a 3D ground model.'
' '
' Adiabatic - heat flux set to zero at the boundary'
' '
' BASESIMP foundation configuration -  used to represent'
'  a basement configuration and precalculate basement'
'  heat transfer. Requires the existence of a [basesimp]'
'  file giving dimensions and required computational'
'  parameters.'
' '
' CEN 13791 partition - CEN 13791 test: like'
'  [similar to current] above but the temperature and'
'  radiation offsets are not available. Details given'
'  in Section 4.4.2 of the CEN 13791 standard.'
' '
'Note that the Project Manager is able to automatically'
'link adjacent surfaces based on the infomation'
'available in zone geometry files.'
*enditem
            CALL EPICKS(IX,IVALSS,' ','Surface boundary condition:',
            CALL EASKR(VALT,' ','Temperature offset?',
            CALL EASKR(VALW,' ','Radiation offset?',
            CALL EASKR(VALT,' ','Constant temperature?',
            CALL EASKR(VALW,' ','Constant radiation?',
            CALL EASKI(IIC2,' ','Standard ground profile number?',
            CALL EASKI(IIE2,' ',
            CALL EPICKS(INPICK,IVALS,' ',' ',15,NSUR,ITEMSS,
            CALL EPICKS(INPICK,IVALS,' ',' ',32,NSUR,ITEMSS,
            CALL EPICKS(INPICK,IVALS,' ',' ',32,NSUR,ITEMSS,
            CALL EPICKS(INPICK,IVALS,' ',' ',32,NSUR,ITEMSS,
 52         CALL EASKS(T14,outs,'(<=12 chars, no spaces)',
          call easkab(' ','Shading obstruction definition via:',
          call easkabc(' ','Shading obstruction definition via:',
*item EDZONE geometry_rotation_menu
'The current zone geometry can be modified via rotation,'
'translation and mirroring options that apply to all zone'
'surfaces and, optionally, to obstructions and Mean Radiant'
'Temperature sensors in the zone. You will be asked if you'
'want to apply the rotation to obstructions and sensors.'
' '
'Rotation: + = anticlockwise.'
' '
'Translation: use to change all X Y or Z by the same amount.'
'To translate a portion of the zone use surface translation'
'or edit vertices.'
' '
'Mirror: flips one axis - you specify the axis and this point'
'along that axis where the mirror is to occur. A positive Y'
'mirror is shown below; a negative mirror is top to bottom.'
' '
'             +Y'
'            |  .......'
'            |  :     :.......'
'            |  :     /\\     :'
'            |  :.....||.....:'
'           -|- - - - || - - - - - -mirror line'
'            |  ......||......'
'            |  :     ||     :'
'            |  :     .......:'
'            |  :.....:'
' -X_________|______________________ +X '
'            |'
'            | -Y    Positive Y mirror'
'  '
'  '
'A positive X mirror is shown below; a negative mirror'
'is from right to left.'
' '
'             +Y'
'            |            mirror line'
'            |           |'
'            | ......... | ..........'
'            | :     ==========>    :'
'            | :     ..: | :..      :'
'            | :.....:   |   :......:'
'   -X_______|___________|__________ +X '
'            |'
'            | -Y    Positive X mirror'
'                  '
'Please ensure that the mirror point is at the edge of or outside'
'the zone since a mirror point within a zone can cause problems.'
'Take care: there is no undo facility.'
*enditem
          CALL PHELPD('rotation section',50,'-',0,0,IER)
          CALL EASKR(VAL,' ','Rotation (+ = anticlockwise)?',
          CALL EASKR(x1,' ','X-coord?',
          CALL EASKR(y1,' ',' Y-coord?',
          call askok('Apply this rotation to MRT sensors',
          call askok('Apply this rotation to obstructions',
          call askok('Apply this rotation to obstructions',
  43      CALL EASKS(HOLD,'Transform (X Y Z metres):',' ',36,
          call askok('Apply this transform to zone surfaces?',' ',
          call askok(msgv,' Is this ok?',ok,dok,58)
          CALL EASKGEOF(
          call askok(msgv,' Is this ok?',ok,dok,58)
          call askok('Apply this transform to MRT sensors',
          call askok('Apply this transform to obstructions',
          call askok('Apply this transform to obstructions',
*item EDZONE geometry_mirror_menu
'The mirror facility flips one axis.  You specify which axis'
'and the point along that axis where the mirror is to occur.'
'A positive Y mirror is shown. A negative mirror is top to bottom.'
'             +Y'
'            |  .......'
'            |  :     :.......'
'            |  :     /\\     :'
'            |  :.....||.....:'
'           -|- - - - || - - - - - -mirror line'
'            |  ......||......'
'            |  :     ||     :'
'            |  :     .......:'
'            |  :.....:'
' -X_________|______________________ +X '
'            |'
'            | -Y    Positive Y mirror'
'  '
'  '
'A positive X mirror is shown. The negative goes from'
'right to left. '
' '
'             +Y'
'          |            mirror line'
'          |           |'
'          | ......... | ..........'
'          | :     ==========>    :'
'          | :     ..: | :..      :'
'          | :.....:   |   :......:'
' -X_______|___________|__________ +X '
'          |'
'          | -Y    Positive X mirror'
'                  '
'                  '
'Please ensure the mirror point is at or outside '
'of the zone. '
'  For +Y mirror the point is above the object.'
'  For -Y mirror the point is below it. '
'  For +X mirror the point is to the right of the zone'
'  For -X mirror the point is on the left.'
*enditem
          CALL PHELPD('axis mirror',35,'-',0,0,IER)
          CALL EASKR(VALM,' ','Mirror point on Y-axis?',
          call askok(' ','Apply mirror transform?',ok,dok,3)
          CALL EASKR(VALM,' ','Mirror point on X-axis?',
          call askok(' ','Apply mirror transform?',ok,dok,3)
           call askok(' ','Also view thermo-physical details?',
        CALL EASKS(LTMP,' ','Zone geometry file?',
        CALL PHELPD('geometry section',35,'zone_geo_ed ',0,0,IER)
*subroutine EDINSUL
*item EDINSUL insolation_choices
'There are a number of options for treating shading and insolation'
'distibution in a zone:'
' '
'* The user specifies a static insolation distribution i.e. which'
'  surface or pair of surfaces to which all insolation entering'
'  the room is to be directed.'
'  '
'* Insolation is distributed diffusely (by surface area and'
'  absorptance) (this is the default).'
'  '
'* A dynamic analysis of shading and insolation distribution via'
'  [ish] which is stored in a shading/insolation file (you are'
'  asked to confirm the name) based on user directives.'
'  Typical directives are to calculate shading on all applicable'
'  surfaces (those that face the outside) as well as to'
'  include all outside facing transparent surfaces as insolation'
'  sources and to do calculations for all months of the year.'
'  '
'Note: Shading is assessed based on any shading obstructions'
'associated with the current zone. Insolation can be assessed'
'if there is at least one outside facing transparent surface.'
' '
'Note that you can define directives for the shading and'
'insolation analysis in another sub-menu of the geometry facility. '
'These directives allow automated recalculation if the zone'
'geometry is revised or if there is no zone shading file at'
'simulation time. '
*enditem
        CALL PHELPD('shad:insol',28,'-',0,0,IER)
        CALL EASKABC('Shading & insolation analysis options: ',' ',
        CALL EASKS(SFIL,' New zone shading/ insulation database?',
        CALL EPICKS(IX,IVAL,' static insolation options:','  ',
        CALL EASKSUR(ICOMP,IS,'A','Select surface for insolation.',
        CALL EASKSUR(ICOMP,IS,'A','Select first insolated surface.',
        CALL EASKSUR(ICOMP,IS,'A','Select 2nd insolated surface.',
*subroutine PICKSSUR
*item PICKSSUR picksurface_choices
'For shading and insolation analysis you will be asked to'
'specify surfaces to participate in the analysis. A limit'
'to the number of surfaces will be indicated in the interface.'
'  '
'A shading analysis calculates the time varying patterns'
'of shading on external zone surfaces. You must select'
'the surfaces to include in this calculation. Selecting'
'[all applicable surfaces] corresponds to all outside'
'facing opaque and tansparent surfaces.'
'  '
'An insolation analysis calculates the time varying'
'insolation of internal zone surfaces. You must select'
'the external surfaces (with windows) to include in'
'this calculation. Selecting [all applicable surfaces]'
'corresponds to all outside facing tansparent surfaces.'
*enditem
        CALL EASKABCD(' ','Shading calculation options:',
        CALL EASKABCD(' ','Insolation calculationoptions:',
        CALL EPICKS(INPIC,IVALS,'Which surfaces?',msg1,
        CALL EPICKS(INPIC,IVALS,' ','Surfaces to Include',
*subroutine EDSURA
*item EDSURA surface_attrib_menu
'This menu displays the surface attributes that may be edited.'
'  '
' option a: surface name (up to 12 char) should be descriptive'
'   if possible and unique within this zone. A key step in'
'   QA involves replacing the default name.'
'  '
' option b: surface type identifies whether the surface is opaque'
'   or transparet or a complex fenistration. This attribute is'
'   based on the properties of the construction it uses so make'
'   sure it matches! If a surface has at least one transparent'
'   layer is considered a TRAN and it is expected that the MLC'
'   will include a reference to an optical property set.'
'  '
' option c: surface location is derived from the orientation of'
'   the polygon to characterize the heat transfer at the surface'
'   as well as an aide in model checking and determining the area'
'   of the base of the model. A value of UNKN signals that it is'
'   sloped.'
'  '
' surface area, azim & elevation, perimeter are derived values'
'  '
' option d: thickness is derived from the construction attribute'
'   and is reported here to clarify the nature of the surface. In'
'   older files the display relates to indentation used for thermal'
'   bridge estimation if 3D conduction is active.'
'  '
' option e: construction gives access to the current list of'
'   constructions in the database and a change in construction'
'   may cause other attributes and derived values to be updated.'
'   You are given the option to view the current thermophysical'
'   properties if a zone construction file exists.'
'  '
' option f: environement (at the other face) presents a standard'
'   list of available options. More help is found in that dialog'
'   and if this surface is thermophysically linked to a surface'
'   in another zone then its details are presented.'
'  '
' option g: parent child relationships are indicated based on an'
'   analysis of the edges and orientations of adjacent surfaces.'
'   Other simulation tools rely on this and it also is used when'
'   undertaking code complience tasks.'
'  '
' option h: surface use attributes help clarify the intent of a'
'   surface (primarily for code complience) and as an aide for'
'   model checking. In the future it will be used to automate the'
'   creation of air flow networks.'
'  '
' option + You can add a rectangular opening (e.g. a window or'
'   door) to a surface by specifing its position within'
'   the parent surface. This position is an X Y offset from'
'   the lower left hand corner (when looking from outside'
'   the model). An opening will then be created within'
'   the parent surface with the specified width and height.'
' '
'To add a non-rectangular opening, use the surface list & edges'
'menu. Or you might begin with a rectangle and then add more'
'vertices (be careful with openings in sloped surfaces).'
*enditem
        CALL PHELPD('surface attributes menu',11,'-',0,0,IER)
 52     CALL EASKS(T14,' Surface name?','(<=12 characters, no spaces)',
    9   CALL EPICKS(IX,IVAL,' ','Surface Type',
        call MENUATOL(' ','Surface Orientation',
*item EDSURA surface_indentation
'To enable 3D geometry definition (as required for 3D gridding),'
'3the distance between the current surface and an imaginary'
'external surface (line) is required. One imaginary surface'
'may be assumed for all surfaces with similar direction angles.'
*enditem
        CALL EASKR(SINDT,' ','Surface indentation?',
        call askok('View thermo-physical properties of ',
        call askok('View thermo-physical properties of ',outs,
*item EDSURA surface_non_symetric
'If this surface is a partition and the construction is'
'non-symetrical and linked to a reversed construction,'
'you should check that the surface in the other room'
'has also been properly updated.'
*enditem
          call askok('Modify thermo-physical data of',outs,ok,dok,7)
*item EDSURA surface_boundary_opt
'The boundary conditions at the other face of this surface'
'is specified  here. The default is [exterior].'
' '
' Exterior - exposed to external weather.'
' '
' Similar to current - exposed to the same conditions as the'
'   inside face except for the treatment of solar insolation:'
'   only the diffuse component assumed the same. A temperature'
'   (C) and radiation (W/m^2) offset may be imposed to approximate'
'   a situation where the adjacent space (not included in the model)'
'   tends to be warmer or cooler than the real zone.'
' '
' Prescribed static - exposed to a user specified constant'
'   temperature(C) and radiation condition(W/m2) such as would be'
'   found in a cold store room.'
' '
' Surface in other zone - exposed to the temperature and radiation'
'   condition of a specified surface in another zone (but one time'
'   step in arrears). You are given the option to update the other'
'   zone to match this.'
' '
' A ground connection is either:'
'  > 0 connection to one of several standard profiles'
'  = 0 connection to a user defined profile'
'  =-3 connection to a 3D ground model.'
'  '
' Ground (monthly profile) - exposed to a temperature defined by'
'  one of the standard monthly temperature profiles embedded in'
'  ESP-r. Some of these were found in the literature, others are'
'  based on data held in DoE EPW climate files.'
' '
' Ground (user defined profile) - exposed to a monthly temperature'
'  supplied by the user (via the Model Context menu prior to its'
'  use as a surface atrributre). Note that calculated ground'
'  temperatures are included in the model QA report based on'
'  standard simplified methods. If you have measured ground'
'  temperatures these should be used.'
' '
' Ground (3D conduction model) - exposed to a temperature calculated'
'  from a 3D representation of the ground (via the grd module).'
' '
' Adiabatic - heat flux set to zero at the boundary.'
' '
' BASESIMP foundation configuration -  used to represent a basement'
'  configuration and precalculate basement heat transfer. Requires'
'  the existence of a [basesimp] file giving dimensions and required'
'  computational parameters. Look for the BASESIMP option in the zone'
'  geometry menu. You are asked for which of the BASESIMP'
'  configurations to use and the the percentage of the overall heat'
'  transfer with the ground which is associated with this surface.'
'  More information is available in the source bscoeff.F.'
' '
' CEN 13791 partition - CEN 13791 test: like [similar to current]'
'  above but the temperature and radiation offsets are not available.'
'  Details given in Section 4.4.2 of the CEN 13791 standard.'
' '
'Note that the Project Manager is able to automatically link adjacent'
'surfaces based on the infomation available in zone geometry files.'
*enditem
        CALL EPICKS(IX,IVAL,' ','Other Side Boundary Condition',
          CALL EASKR(VALT,' ','Temperature offset?',
          CALL EASKR(VALW,' ','Radiation offset?',
          CALL EASKR(VALT,' ','Constant temperature?',
          CALL EASKR(VALW,' ','Constant radiation?',
          CALL EASKGEOF('If other zone known select it, else exit.',
          CALL EASKSUR(IZ,ISO,'A','Select surface in',
          CALL ASKOK(' ','Update other surface side?',
  777     CALL EASKI(IIC2,' ','Standard ground profile number?',
 778      CALL EASKI(IIE2,' ','User defined ground profile number?',
          CALL EASKI(Ifrac,' ','% BASESIMP loss to this surface?',
*subroutine edituse
*item edituse surface_use_menu
'For QA and code compliance purposes as well as to help auto-'
'generate air flow networks ESP-r allows you to attach SEMANTIC'
'tags to surfaces in a zone.'
' '
'There are a number of types of tags e.g. DOOR,FICT '
'(fictitious construction), FLOOR, FRAME (around a window or'
'door), FURNIture (surfaces representing internal mass),'
'GRILL/SMOKEVNT (surfaces representing a specific location'
'of forced air flow), ROOF, STRUC (column or beam), WALL/FLOOR'
'(part of the facade), and either PARTN or [-] to represent'
'other surfaces.'
' '
'There are, of course, more than one kind of DOOR and WINDOW'
'so a second specifier is included. For some objects you will'
'also be asked for indicators of air flow e.g.'
'CLOSED/UNDERCUT/OPEN/BIDIR as qualifiers which specify where'
'air might flow. '
'NOTE: the flow inference is not yet implemented. When implemented'
'a zone operation file might detect a mismatch in infiltration'
'if there were cracks or openings noted for surfaces.'
'When implmented such key words could help to auto-generate'
'mass flow networks. '
' '
'For building code complience you will want to set appropriate'
'qualifiers e.g. a WINDOW DISPLAY surface will not be resized'
'to meet code requirements but other surfaces marked'
'WINDOW ORDINARY will. '
' '
'Models which are intended for UK code compliance checking'
'are restricted to a limited set of surface use tags: '
'DOOR PERSONEL, DOOR ENTRANCE, DOOR VEHICLE, WALL, '
'WINDOW NORMAL, WINDOW DISPLAY, WINDOW SKYLIGHT,'
'WINDOW FRAME, ROOF PITCHED (>20deg slope),'
'ROOF FLAT (0deg-20deg slope).'
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item edituse door_use_open_closed
'Closed signals to other parts of ESP-r that air is not likely'
'to pass and neither the scheduled air flow or air the air'
'flow network definitions should pay further attention to this door.'
' '
'Undercut signals that air might pass via a crack component'
'(if network) or that there might be a small scheduled flow. '
' '
'Open - other facilities should confirm the flow with whatever is on'
'the other side. Control might be applied (to vary the opening area)'
' '
'Bidirectional - other facilities should confirm the details of two'
'way flow. Control might be applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','DOOR air leakage:',
*item edituse fict_use_open_closed
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this fictitious opening. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Open - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Bidirectional - other facilities should confirm'
'the details of two way flow. Control might be'
'applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','FICT surface air leakage:',
*item edituse frame_use_open_closed
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this frame. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Vent - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','FRAME surface air leakage:',
*item edituse window_use_open_closed
'Closed signals to other parts of ESP-r that air '
'is not likely to pass and neither the scheduled '
'air flow or the flow network definitions should '
'pay further attention to this window. '
' '
'Crack signals that air might pass via a crack '
'component (if network) or that there might be a'
'small scheduled flow. '
' '
'Open - other facilities should confirm the'
'flow with whatever is on the other side. Control'
'might be applied (to vary the opening area) '
' '
'Sash - implies an upper and lower opening. '
' '
'Bidirectional - other facilities should confirm'
'the details of two way flow. Control might be'
'applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','WINDOW surface air leakage:',
*subroutine selectuse
*item selectuse surface_use_menu
'For QA and code compliance purposes as well as to'
'help auto-generate air flow networks ESP-r allows'
'you to attach SEMANTIC tags to surfaces in a zone.'
' '
'There are a number of types of tags e.g. DOOR, '
'FICT (fictitious construction), FLOOR, FRAME (around'
'a window or door), FURNIture (surfaces representing'
'internal mass), GRILL/SMOKEVNT (surfaces representing'
'specific location of forced air flow), ROOF, STRUC'
'(column or beam), WALL/FLOOR (part of the facade), '
'and either PARTN or [-] to represent other surfaces.'
' '
'There are, of course, more than one kind of DOOR and '
'WINDOW so a second specifier is included. For some '
'objects you will also be asked for indicators of air'
'flow e.g. CLOSED/UNDERCUT/OPEN/BIDIR as qualifiers'
'which specify where air might flow. NOTE: flow'
'inference is not yet implemented. When implemented'
'a zone operation file might detect a mismatch in '
'infiltration if there were cracks or openings noted'
'for surfaces. When implmented such key words could'
'help to auto-generate mass flow networks. '
' '
'For building code complience you will want to set '
'appropriate qualifiers e.g. a WINDOW DISPLAY surface'
'will not be resized to meet code requirements but '
'other surfaces marked WINDOW ORDINARY will. '
' '
'Models which are intended for UK code compliance checking'
'are restricted to a limited set of surface use tags: '
'DOOR PERSONEL, DOOR ENTRANCE, DOOR VEHICLE, WALL, '
'WINDOW NORMAL, WINDOW DISPLAY, WINDOW SKYLIGHT,'
'WINDOW FRAME, ROOF PITCHED (>20deg slope),'
'ROOF FLAT (0deg-20deg slope).'
*enditem
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
        CALL EPICKS(IX,iuseopt,' ','Surface USAGE attributes:',
*item selectuse door_use_open_closed
'Closed signals to other parts of ESP-r that air is not likely'
'to pass and neither the scheduled air flow or the flow'
'network definitions should pay further attention to this door. '
' '
'Undercut signals that air might pass via a crack component'
'(if network) or that there might be a small scheduled flow. '
' '
'Open - other facilities should confirm the flow with whatever'
'is on the other side. Control might be applied (to vary the'
'opening area) '
' '
'Bidirectional - other facilities should confirm the details of'
'two way flow. Control might be applied to the width of the opening.'
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','DOOR air leakage:',
*item selectuse fict_use_open_closed
'Closed signals to other parts of ESP-r that air is not likely to'
'pass and neither the scheduled air flow or the flow network'
'definitions should pay further attention to this fictitious opening.'
' '
'Crack signals that air might pass via a crack component (if network)'
'or that there might be a small scheduled flow. '
' '
'Open - other facilities should confirm the flow with whatever is on'
'the other side. Control might be applied (to vary the opening area) '
' '
'Bidirectional - other facilities should confirm the details of two'
'way flow. Control might be applied to the width of the opening.'
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','FICT surface air leakage:',
*item selectuse frame_use_open_closed
'Closed signals to other parts of ESP-r that air is not likely to'
'pass and neither the scheduled air flow or the flow network'
'definitions should pay further attention to this frame. '
' '
'Crack signals that air might pass via a crack component (if'
'network) or that there might be a small scheduled flow. '
' '
'Vent - other facilities should confirm the flow with whatever is on'
'the other side. Control might be applied (to vary the opening area)'
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','FRAME surface air leakage:',
*item selectuse window_use_open_closed
'Closed signals to other parts of ESP-r that air is not likely to'
'pass and neither the scheduled air flow or the flow network'
'definitions should pay further attention to this window. '
' '
'Crack signals that air might pass via a crack component (if'
'network) or that there might be a small scheduled flow. '
' '
'Open - other facilities should confirm the flow with whatever is on'
'the other side. Control might be applied (to vary the opening area)'
' '
'Sash - implies an upper and lower opening. '
' '
'Bidirectional - other facilities should confirm the details of two'
'way flow. Control might be applied to the width of the opening. '
' '
'Cancel does what it says. '
*enditem
        CALL EASKATOG(' ','WINDOW surface air leakage:',
*subroutine EDVERT
*item EDVERT surface_vertex_menu
'This menu allows existing vertices to be viewed and edited.'
'  '
' edit vertex - select one and you can then alter the values of the'
'   X Y or Z value and if you are in graphic mode you can see the '
'   change in the zone. You can jump to previous or next vertex'
'   but the zone may not fully re-draw until you say ok.'
'  '
' + manage vertices - add a new vertex, delete an existing vertex'
'   if it is not being referenced by a surface, copy a vertex (you'
'   will be given the option to edit the X Y Z values after the'
'   copy), replicate a vertex allows a number of copies to be made'
'   (useful if only one coordinate needs to be altered), delete ALL'
'   UNREFERENCED vertices in the zone or copy vertices (up to 10)'
'   from another zone. If you are in X11 graphics mode click select.'
'  '
'Transforms - provides options to reduce the need for calculator:'
'  '
'  *--x-* Vertex on a line: creates one (or more) points along a'
'  line (i.e. two vertices and then a distance (m) along the line).'
' '
'  *<-?->* Distance between vertices: gives distance (m) based on'
'  two user selected vertices.'
' '
'  Vertex at angle: finds a (new) vertex relative to a given vertex'
'  at a specified distance (m), angle (degrees north is 0 + clockwise)'
'  and elevation (degrees) where 90 is vertical.'
' '
'  Angle between lines: finds angle A between two lines given'
'  3 vertex as in:'
'                            * 1 '
'                           /    '
'                       a  /     '
'                3 *------* 2    '
' '
'  The intersection of a line & plane asks you for two points'
'  defining a line as well as a polygon to test.'
' '
'  The intersection of LINES and plan ask for a plane to test and'
'  then checks ALL lines that intersect that plane and adds vertices'
'  where they cross. This can be used to help subdivide surfaces'
'  within a zone or work with a sloped ceiling.'
'  '
'  Distance between vertex and a line - you are asked to identify'
'  the line as well as the vertex.'
'  '
'  Find close vertices - sometimes the wire-frame is not clear so'
'  this searches for close vertices within the room.'
'  '
'  Move vertices within a line - you are told the existing length'
'  of the line and the distance from the first vertex. Positive is'
'  a move towards the 2nd vertex and negative is away from the'
'  2nd vertex.'
'  '
'Where a new vertex is created you will be asked to confirm that'
'you want it to be included in the zone.'
'  '
'If a new vertex is within 3mm of an existing edge confirmation'
'about including the vertex in a polygon is provided.'
*enditem
        CALL PHELPD('configuration section',2,'-',0,0,IER)
        call MENUATOL(' ',
        CALL EASKR(vdis,' ','Distance along line?',0.001,
 342    CALL EASKS(HOLD,
        CALL EASKSUR(ICOMP,IS,'-','Select surface to intersect.',
        CALL EASKSUR(ICOMP,IS,'-','Select surface to intersect.',
        CALL EASKABC(' ',outs,'new vertex',
  136   CALL EASKS(HOLD,outs,' ',36,' 0. 0. 0. ','vtx co',
        call askok(' ','Insert this vertex?',ok,dok,5)
        call askok('Is this aligned vertex ok?',' ',ok,dok,1)
        call askok(' ','Insert this vertex?',
        CALL EASKABC(' ','Options:','find close vertices',
        CALL EASKR(vdis,' ','Movement distance?',
        call askok('Apply this move?',' ',OK,dok,1)
        CALL EASKABC(' ',outs,'new vertex',
  43    CALL EASKS(HOLD,outs,' ',36,' 0. 0. 0. ','vtx co',IER,2)
        call askok(' ','Insert this vertex?',ok,dok,5)
        call askok('Another vertex along the line? ',' ',
        call askok('Another vertex from this origin? ',
        call askok('Another intersection of line and plane? ',
        CALL EASKATOG(' ','Vertex operations:','add','delete','copy',
        CALL EASKI(IADD,' ',' How many vertices to add ? ',
        CALL EASKI(IADD,' ',' Replicate how many times ? ',
 146    CALL EASKS(HOLD,outs,' ',36,' 0. 0. 0. ','vertex coord',
  42    CALL EASKS(HOLD,outs,' ',36,' 0. 0. 0. ','vertex coord',IER,2)
*subroutine EDVLIST
*item EDVLIST surface_edge_list
'This menu allows existing surface edge lists to be viewed and'
'edited. Edit by selecting an item or -Exit to escape.'
' '
'The [@ check vertex topology] looks for unbounded edges, edges'
'with an adjacent edge ordered in the same direction (one surface'
'is probably reversed) and for missing intermediate vertices'
'(where one edge is has more than one adjacent surface). '
' '
'The [>] command to shift a surface along its normal axis updates'
'vertices associated with that surface and thus surfaces sharing'
'these vertices.  Useful for expanding/shrinking a zone. '
' '
'NOTE: it is suggested that the first surface edge be horizontal'
'(or close to horizontal) if at all possible. The shading analysis'
'application gets confused if the first edge of a surface is'
'vertical. Nothing in esp-r warns you of this so get into a'
'consistent habit of avoiding vertical first edges in surfaces.'
' '
'There are several options for adding surfaces to a zone'
' *made from existing vertices - use this if all of the'
'    vertices already exist within the zone.'
' '
' *made from existing vertices (mouse) - the same but you can'
'    select points by clicking on them in the wire-frame view
' '
' *inserted into a surface - this option would allow you to insert'
'    a window or a door or a grill into an existing surface.'
' '
' *copy surface(s) in this zone - this option allows you to'
'    replicate an existing surface and transform or rotate it'
'    into a new position. Useful if you have repeating'
'    element(s). Most attributes are preserved.'
' '
' *copy surface(s) from another zone - this option allows you to'
'    re-use surfaces defined in another zone such as a partition.'
'    Most surface attributes are preserved during the copy process.'
' '
' *vertical rectangle - allows you to place a rectangle'
'    which is vertical within or at the edge of the zone.'
' '
' *horizontal rectangle - allows you to place a rectangle in a'
'    horizontal position within or at the edge of the zone.'
'    E.g. to make a desk add a horizontal rectangle in the'
'    correct location and then copy and invert this surface to'
'    form two back-to-back surfaces (and give them either adiabetic'
'    or a partition connection to the other.'
' '
' *extrude sides and top from a base surface - can take an intial'
'    surface and extrude it to form a closed set of surfaces'
'    taking its shape. A base surface can be extruded up and a'
'    wall initial surface extrudes sideways.'
'  '
'Transforms - included actions: 
'  shift surface along surface normal (+ve is outward metres);'
'  translate vertices by X,Y,Z metres;'
'  rotate surface about one of its vertices (+ve anticlockwise);'
'  invert ordering (to swop front and back faces);'
'  apply several operations to the surface; cancel (no action).'
*enditem
        CALL PHELPD('vertex section',59,'-',0,0,IER)
        CALL EASKSUR(ICOMP,IS,'-','Select surface to act on.',
        CALL PHELPD('transform section',7,'-',0,0,IER)
        CALL EASKR(vdis,' ','Distance along normal?',
 152    CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
        CALL EASKI(IRV,'Rotate about which vertex index: ',
        CALL EASKR(ANGR,' ','Rotation (+ = anticlockwise)?',
        CALL ASKOK(outs,'Update the vertex?',OK,DOK,1)
        CALL ASKOK('Apply the transformed points to the',
        CALL EASKSUR(ICOMP,IS,'-','Select surface to delete.',
*item EDVLIST surface_insertion
'Insertion into an existing surface is a common way to create'
'a door or window opening. '
' '
'You may copy (and then transform) a surface within this zone'
'to make a new surface. An example an identical shape which is'
'repeated in several locations. '
' '
'You may copy (and then transform) a surface from another zone'
'for use in this zone. For example, a partition between zones.'
' '
'You may create a rectangular surface by specifying its origin'
'XYZ (typically the lower left corner) and either an azimuth'
'(for vertical) or a rotation between the X axis and its'
'[length edge] for a horizontal rectangle + anticlockwise.  A'
'polygon which is parallel to the Y axis should face North or'
'South. Azimuth 0.0 is north, 180 is south, 270 is west.'
'Azimuth 90.0 is east '
' '
'Creating a new surface with existing vertices can be done by'
'either entering the indices of each vertex in turn (anti-'
'clockwise looking from the outside or clock-wise looking from'
'the inside). '
' '
'NOTE: it is suggested that the first surface edge be horizontal'
'(or close to horizontal) if at all possible. The shading'
'analysis application gets confused if the first edge of a'
'surface is vertical. Nothing in esp-r warns you of this - so'
'get into a habit of avoiding vertical first edges in surfaces!'
' '
'You may take a surface and extrude an enclosure (like the'
'process of creating a zone from a floor plan). With a surface'
'extrusion the shape of the initial surface is repeated as a'
'top to the extrusion Xm along the normal vector and the sides'
'are filled in and given default names. '
' '
'Hint: the extrusion value (if positive) will extrude in the'
'direction of the outward surface normal and if negative it'
'will extrude in inwards. If the original surface is a floor'
'position use a negative extrusion. If the original surface is'
'an exterior wall a negative extrusion value will extude inwards.'
' '
'If you are working in a graphics display you can use'
'mouse clicks on the existing vertices.'
' '
'Options to insert a vertical or horizontal rectangle into the'
'zone have two variants. One creates a single surface with a'
'name and construction and the MASS option creates a pair of'
'surfaces which are thermally connected as partitions to each'
'other. For the MASS option the construction should represent'
'the full thickness (as opposed to the use of an ADIABETIC'
'connection where the construction represents half of the thickness.'
*enditem
          call MENUATOL(' ','new surface options',
          call MENUATOL(' ','new surface options',
          CALL EASKSUR(ICOMP,IS,'-','Select surface to insert into.',
          CALL EASKS(HOLDS,' Vertical surface origin X Y & Z: ',' ',
          CALL EASKS(HOLDS,' Surface azimuth (deg) length & height:',
          CALL EASKS(HOLDS,' Horizontal surface origin X Y & Z: ',' ',
          CALL EASKS(HOLDS,' Surface rotation (deg) length & height: ',
          CALL EASKSUR(ICOMP,IS,'-','Select surface .',
          CALL EASKR(vdis,' ','Extrusion distance along normal?',
          CALL EASKS(T14,'Revised surface name',
          CALL EASKS(T14,'Inserted surface name (12 char max):','  ',
*item EDVLIST surface_edge_order
'The list of associated vertices should be given in anti-clockwise'
'order as one faces the outside of the surface.'
'  '
'If one is looking at the inside face then think of the list in'
'clockwise order.  It is a convention that the first vertex is'
'located at the bottom-left corner of the surface (looking from the'
'outside) with the next vertex moving horizontally.'
'It helps to follow a consistent pattern!'
*enditem
        CALL EASKS248(t248,' Associated vertices (type the indices)?',
*subroutine LINTHBRDG
*item LINTHBRDG linear_thermal_bridge
'Linear thermal bridges are composed of a length (m) and a'
'psi value (W/mK) and are used to represent the difference in'
'heat flow due to a corner, junction or edge. Psi values are'
'typically derived via 3rd party software such as LBNL THERM.'
'  '
'When entering the facility you are asked if the zone has'
'construtions with metal cladding or no metal cladding or if'
'you wish to define thermal bridges as a percentage of the'
'heat flows through the facade.  If you select metal or non-metal'
'cladding then the geometry of the room, the boundary condition'
'attribute and USE attribute of each surface is checked to determine'
'the cagetory of thermal bridge to apply to each edge.'
'  '
'The total length of the category bridge as'
'well as initial default values (based on the BRE Information'
'publication 1/06) are set.'
'  '
'Only use this facility IF ALL the surfaces in the zone have been'
'fully attributed and the geometry is stable.  If you alter the'
'geometry or the boundary attributes then the Project Manager may'
're-evaluate the lengths and psi values and overwrite manually'
'computed values.'
'  '
'If you agree with the initial geometric and brounday scan then'
'you have very little work to do.  If you want to alter the'
'lengths or the psi values then the interface allows you to edit'
'these as required. If you have an additional type of thermal'
'bridge then you can either use the [user defined] bridge type'
'or a zero length bridge of another type.'
'  '
'At simulation time the lengths and psi values are added up'
'and then multiplied by the temperature difference between the'
'zone and the outside.  The labels and types of thermal bridges'
'are for documentation purposes and to help in checking the'
'model.'
'  '
'The underlying assumptions for the default values of heat flows'
'via thermal bridges depend on whether the facade uses metal'
'cladding. If the zone is mixed then you will have to manually'
'edit the lengths and psi values.'
' '
'The fixed % option sets thermal bridges equivalent to a percentage'
'of the overall UA value of the zone. NOTE: if you enter the'
'facility selecting metal or non-metal facade and then switch to'
'the % facility then the software does not clear the lengths or'
'psi values.  If you wish to switch from % to one of the other'
'methods the interface gets confused.'
*enditem
        CALL EASKABCD('This zone:','(see help)',
        CALL EASKABCD('This zone:','(see help)',
        CALL PHELPD('thermal bridge menu',4,'-',0,0,IER)
        CALL EASKR(thbrpercent,' ',
        CALL EASKR(psiv,phrasepsi(lookfor),msg,
        CALL EASKR(lenv,phraselen(lookfor),msg,
        CALL EASKR(psiv,phrasepsi(lookfor),msg,
        CALL EASKR(lenv,phraselen(lookfor),msg,
        CALL EASKR(psiv,phrasepsi(lookfor),msg,
        CALL EASKR(lenv,phraselen(lookfor),
*subroutine updatesvfc
*subroutine CPVERT
*item CPVERT surface_vertex_copy
'When working on the coordinates of one zone you might want to copy'
'vertices from another zone to ensure proper alignment.'
'This menu allows you to select up to 10 vertices from another zone'
'and have them copied into the current zone. If any of the vertices'
'are close to an existing vertex the copy is not completed. If a'
'copied vertext is very need an existing edge it will be incorporated'
'into the edge and the surface edge list updated.'
'  '
'Current you are only presented with a list of vertices. There is no'
'wireframe view of the other zone.  Thus you should plan ahead and'
'review the vertices of the other zone prior to requesting vertex'
'copies.'
*enditem
*subroutine IPVCMD
*subroutine ipvdat
*item ipvdat ipv_menu_overview
'An Integrated Performance View (IPV) is a facility which allows'
'users to define (hopefully at the plannning stage) performance'
'issues that are of interest in the project (e.g. comfort, solar'
'entering rooms), their location in the model (e.g. a set of offices)'
'and the assessment periods (e.g. one typical week in each season'
'or all days in the summer).'
' '
'It includes descriptive information: title, version and synopsis'
'as well as one or more images. These can be edited directly.'
' '
'Performance metrics (comfort, zone dry bulb temp, etc.) are linked'
'with sets of thermal zones'
' '
'Demand sets are sets of zones for which heating, cooling, lighting,'
'small power and DHW are reported. Each set has a scaling factor so'
'has a scaling factor so that, for example 2 office zones can be'
'scaled to represent 15 offices.'
' '
'One useful facility of an IPV is to allow annual performance to be'
'derived from an actual annual assessment or scaled from three'
'seasonal runs: winter/transition/summer, or five runs: 1st winter/'
'spring/summer/autumn/2nd winter. Each run has a start/stop date'
'time frequency and heating and cooling degree day ratios. Periods'
'can be setup based on a best-fit scan of climate data (see option 5).'
' '
'Display days: are specific days (up to 10) for which timestep data'
'is recorded. There is an option to turn off timestep reporting.'
' '
'Seasons are based on information in the [climatelist] file. This'
'information is included to clarify the relationship between each'
'climate season and the 1/3/5 simulations being run. '
' '
'Ratios: are typically ratios between the number of days (for'
'lighting (or heating/cooling degree days for heating and cooling)'
'of the assessment period and the season. For an annual simulation'
'the ratios are 1.00. A typical winter week performance might be'
'multiplied by 8.9 to represent the whole 1st winter season. This'
'can save lots of computation time and if properly calibrated for'
'the building type and location can also be quite accurate.'
' '
'Option 5 [re-scan climate] is a two step process; the first step'
'is to scan the [climatelist] file for the days in each season'
'e.g. 1st winter might be defined from 1 Jan to 10 March; the'
'second being scanning the climate data to find the best fit week'
'based on heating and cooling degree days and solar radiation.'
' '
'Setting up an integrated performance view: '
'a) edit the title (up to 40 char), version (up to 40 char) and'
'   synopsis (up to 248 char), '
'd) images (up to 5 GIF file names),'
'e) format of report (normal spaces, tab, Java I2PV)'
'1) select/edit/manage performance metrics,'
'2) select/edit/manage demand (heating/cooling) sets'
'3) select the number and type of simulations,'
'4) select display days (up to 10 within the simulations),'
'5) re-scan the climate file for seasons and day ratios'
' '
'For older models a file holds a description of an IPV, in newer'
'models the information is held in the model configuration file.'
*enditem
        CALL EASKS(ltmp,'IPV description file ?',
        CALL PHELPD('IPV setup',10,'-',0,0,IER)
        CALL EASKS(t40,'IPV tile?',' ',40,'TITLE','IPV Tile',IER,1)
        CALL EASKS(t40,'version ?',' ',40,'base','version',IER,2)
        CALL EASKS248(t248,'Synopsis',' ',72,
        CALL EASKABCD(outs,'Choices: ','list',
        CALL EASKI(IFOC,'Which image (give index) ? ',' ',
        CALL EASKS(t72,'Image file name:',' ',72,'xxx','image file',
        CALL EASKS(t72,'Image file name:',' ',72,'xx','image file',
        CALL EASKS(HOLD,'Simulation period: start (day & month) and',
        CALL EASKS(HOLD,'Winter period: start (day & month) and',
        CALL EASKS(HOLD,'1st winter period: start (day & month) and',
        CALL EASKS(HOLD,'Transition period: start (day & month) and',
        CALL EASKS(HOLD,'Spring period: start (day & month) and',
        CALL EASKS(HOLD,'Summer period: start (day & month) and',
        CALL EASKS(HOLD,'Autumn period: start (day & month) and',
        CALL EASKS(HOLD,'2nd winter period: start (day & month) and',
        CALL EASKS(HOLD,'Display day & month: (should be',
        CALL EASKAB('Options: ',' ','add another day','continue',IW,1)
        CALL EASKS(HOLD,'Display day & month: (should be',
*item ipvdat ipv_season_multip
'These multipliers allow for scaling of predictions from a simulation'
'period to a season.  If the simulation period equals the season'
'then use 1.0 or use either a heating degree day ratio or a day ratio'
'for the heating or cooling degree day ratio for cooling.'
' '
'For items (such as lighting) that are not sensitive to HDD and'
'CDD ratios use a ratio of the days in the assessment to the days'
'in the season.'
' '
'If single simulation only edit first number. '
'If three simulations only edit first three numbers.'
'If five simulations edit all numbers.'
' '
'Note: the [rescan climate] function can be used to'
'find these ratios if the simulation period is a '
*enditem
        CALL EASKS(HOLD5,'Seasonal multiplier for heating:',
        CALL EASKS(HOLD5,'Seasonal multiplier for cooling:',
        CALL EASKS(HOLD5,'Seasonal multiplier for lighting:',
        CALL EASKS(HOLD5,'Seasonal multiplier for small power:',
        CALL EASKS(HOLD5,'Seasonal multiplier for fans & pumps:',
        CALL EASKS(HOLD5,'Seasonal multipliers for domestic hot water:',
*item ipvdat ipv_season_scan
'Each climate data set may have different seasons and'
'different typical assessment periods. This is often based'
'on local knowledge of the region and preferences of people'
'in the region. For example, the first flowering of specific'
'trees in the spring may generally signal a switch in clothing'
'and heating preferences which can impact building controls.'
'  '
'Choosing this option will rescan the [climatelist] file and'
'update display with the standard assumptions for the location.'
' '
'Both the climate tool and the project manager can scan'
'the current climate file to locate the best fit week '
'in each season and return the ratios of days or degree'
'days (for heating and cooling) for use in scaling short'
'simulations to whole seasons.'
*enditem
        CALL EASKABC('Options: ',' ',
        CALL EASKABC('Metric set options:',' ','add','delete',
        CALL EASKI(IFOC,'Which metric set (give index) ? ',
        CALL PHELPD('IPV metrics',8,'-',0,0,IER)
*item ipvdat ipv_metric_overview
'This is a sub-set of the metrics that can be selected in the'
'results analysis module. '
'  '
'For each metric the IPV will include statistics,'
'frequency reporting and timestep data for display days.'
'  '
'Each metric has a short name  (12 char or less) unique'
'identifier for the group of zones associated with this metric.'
'Each metric has a floor area for the associated zones so that'
'reports can also include W/m2 data.'
'  '
'  zone resultant temperature is a useful proxy for comfort in'
'    rooms (it does not require all of the descriptive data'
'    needed for a Fanger comfort assessment)'
'  '
'  zone dry bulb temperature is equivalent to a shielded'
'    temperature sensors in each of the associated zones'
'  '
'  zone relative humidity % might be of interest to check if'
'    humidity controls are working or are needed
'  '
'  zone infiltration load is the energy impact of air entering'
'    the zone(s) by natural or forced means
'  '
'  zone ventilation load is the energy impact of air entering'
'    from other rooms in the model
'  '
'  zone casual gains (all) is the sum of all of the types of'
'    casual gains and includes both the radiant and convective'
'    portion of the gains'
'  '
'  zone solar (from outside) is solar radiation which has passed'
'    the outside facing glazing in the zone'
'  '
'  zone solar (absorbed in) is solar radiation which has been'
'    absorbed in the surfaces of the zone'
'  '
'  Visual comfort (Guth and glare) are not operational'
'  '
'If the metric only makes sense if filtered for occupancy then'
'you are asked which casual gain index is to be used as a filter'
'criteria. For no filter (full time) then select zero.'
'  '
'If you need to cancel select the NO CHOICE option. '
*enditem
        CALL PHELPD('metric options',7,'-',0,0,IER)
      CALL EPICKS(INPIC,IVALS,' ',
      CALL EASKS(t12,
      CALL EASKR(TFLA,' ',' Associated floor area (m^2)? ',
      CALL EASKI(icgv,'Casual gain type associated with occupancy',
*item ipvdat ipv_demand_overview
'An IPV can include one or more ehergy demand sets. These are'
'groupsnof zones which can be combined and/or scaled for reporting'
'and/or analysis purposes.  For example, a number of offices might'
'associated with a demand set so that the aggregate heating and '
'cooling can be reported on and core zones treated with a separate'
'demand set.'
'  '
'There is an option to scale the performance of the demand set so'
'that a subset of the building model can be made to represent a'
'larger area. For example, all the offices on the 4th level can'
'be in a demand set and multiplied by 8 to represent the performance'
'of the middle 8 levels of an office building.'
'  '
'Each demand set has a short unique idenfier (12 char or less)'
'to help identify the purpose of the set. Useful if there are'
'a number of demand sets in the model.'
'  '
'As with performance metrics, demand sets have a floor area'
'associated with the set so that W/m2 values can be reported.'
'  '
'You can add another demand set or delete an existing set.'
*enditem
      CALL EASKABC('Demand set options:',' ','add','delete',
      CALL EASKI(IFOC,'Which demand set (give index) ? ',
      CALL PHELPD('IPV demand sets',4,'-',0,0,IER)
      CALL EASKS(t12,'Identifier for this demand set ?',
      CALL EPICKS(INPIC,IVALS,' ',
      CALL EASKR(edgflr(iset),' ','Energy set floor area (m^2)? ',
      CALL EASKR(edgsca(iset),' ','Multiplier for energy set? ',
*subroutine ipvseasons
*item ipvseasons ipv_assessment_regime
'Select an assessment regime from the list provided.'
'The [winter/spring/summer/autumn] options are based on'
'information in the [climatelist] file for the current'
'climate file. For example if you ask for the summer season'
'the period from the [climatelist] file will be used. '
' '
'The annual assessment will do one simulation for the whole'
'year (this may generate a large results file). '
' '
'The three season option does winter transition and summer'
'runs for a typcial week each season (as determined by'
'an analysis of heating and cooling degree days and solar'
'radiation) a fortnight in each season or all days in the'
'season. '
' '
'The five season option does winter (jan..) spring summer'
'autumn and winter (dec..) for a typical week or fortnight'
'or every day in each season. '
'  '
'You have the option to run simultions for a typcial week'
'or for all the days of the season. This choice depends on'
'whether the project is well represented by a typical week'
'and whether the computational time needed for all the days'
'matches project resources.'
*enditem
        CALL PHELPD('IPV seasons',18,'-',0,0,IER)
*subroutine getmultip
*item getmultip seasonal_climate_scan
'Seasonal multipliers are based on the following values:'
'  heating degree days (HDD) and a base temperature (C)'
'  '
'  cooling degree days (CDD) and a base temperature (C)'
'  '
'  solar radiation 
'  '
'Depending on the number of assessments to be undertaken the'
'ratios have slightly different meanings:'
'  '
'If there is one winter assessment to represent the first and'
'second winter seasons. The ratios is of the winter'
'assessment period to all winter days and/or degree days.'
'  '
'If there is one transition assessment to represent spring'
'and autumn seasons. The ratios is of the transition'
'assessment period to all transition days and/or DD.'
*enditem
      CALL EASKR(HBT,' ',' Heating base temperature ? ',
      CALL EASKR(CBT,' ',' Cooling base temperature ? ',
      call easkab(
      call easkab(
*subroutine makeCFCfile
*item makeCFCfile CFC_creation_overview
'Complex fenistrations are based on information collected in'
'a separate application (which creates so-called GSL files.'
'  '
'Each CFC type requires a corresponding *.GSL file except'
'when the only difference between two CFCs is the shade layer'
'slat angle. The slat angle is set during the import process.'
'  '
' For instructions on importing *.GSL files'
' see [Appendix F: CFC User Reference] from'
' http://uwspace.uwaterloo.ca'
' /bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
'  '
' If GSL files have already been imported, select continue'
'  '
' The initial scan of the GSL file will establish how many'
' CFC are available and the zone attributes are also scanned'
' to determine the miniminum number of CFC types required. This'
' minimum value is the default in the dialog requesting the CFC'
' type index for the surface.'
'  '
' For each surface in the zone which is attributed as a CFC the'
' interface will ask you to assign a CFC type.'
'  '
' You are asked to confirm the name of the GSL file. (again'
' check Appendix F in the CC User Refernce). If the file does'
' not exist then you are asked to use GSLedit to create the'
' GSL file and then copy it into the model [zones] folder.
'  '
'To download the Glazing Shading Layer Editor go to'
'the ESRU website downloads section.'
*enditem
      CALL EASKAB(outs,'Options:',
      CALL EASKI(ncfctypes,' ','Number of CFC types?',
      CALL EASKI(itype,'CFC type for: ',outs,1,'F',
      CALL EASKS(ltmp,outs,' ',72,ltmp,'GSLedit file name',IER,7)
      CALL EASKAB('File not found! ','Options:',
*subroutine importGSLedit
*item importGSLedit slat_angle_convention
'You are asked whether the slats are Vertical or Horizontal. Use'
'the slat angle convention shown in Figure F.12 in:'
' [Appendix F: CFC User Reference] from'
' http://uwspace.uwaterloo.ca'
' /bitstream/10012/4164/1/Lomanowski_Bartosz.pdf'
'  '
'You are then asked to set the initial slat angle. This is constant'
'if there is no control applied to the slat. The slat angle'
'convention is also shows in Figure F.12 For Appendix F.'
*enditem
          CALL EASKAB(outs(1:ln_outs),' ',
          CALL EASKR(rphi,' ',outs(1:ln_outs),-89.999,'F',
*subroutine read_in_cfc_file
*subroutine askCFCtype
*item askCFCtype CFC_type_select
'Select CFC type to apply shading schedule/control.'
'  '
'The CFC data file must exist before you can select a CFC'
'type. Please sort this out first.'
*enditem
        CALL PHELPD('Choose CFC type',1,'-',0,0,IER)
        CALL PHELPD('CFC file not found',4,'-',0,0,IER)
*subroutine EDMRT
*item EDMRT mrt_menu_overview
'This menu allows zone viewfactors or MRT sensors to be viewed'
'and edited.  These are then passed to the program [espvwf] for'
'further processing if a robust evaluation of view factors or'
'position dependent mean radiant temperatures is required. '
' '
'MRT sensors are rectangular bodies similar to those used for'
'zone obstructions. The default size is a 100x100x100mm cube.'
'They are placed within a zone (you are asked for an origin'
'and a rotation angle) and are used to find position-specific'
'view-factor weighted mean radiant temperatures. You may alter'
'the initial shape of the cube to approximate an occupant or'
'other object. It is possible to define several MRT sensors'
'in a zone for projects which require detailed information in'
'several locations.'
' '
'View factors may also be created from scratch in the current'
'facility.  Note that the default treatment in ESP-r is to use'
'area weighted viewfactors which do not require the creation of'
'a zone view factor file.'
'  '
'Your initial choice of whether to use area-weighted or ray-'
'traced calculations can be altered later on.'
'  '
'If you choose ray-traced calculations an initial viewfactor'
'file is created with zeros in it and then this is passed to'
'the calculation module. When the computations are complete'
'yu will be asked whether you want to use the data.'
'  '
'If you choose to edit viewfactors it is suggested that you'
'pay particular attention to the summation of values so that'
'the total view from a surface does not exceed 1.0. If the'
'total is less than 1.0 then you will be asked if you want to'
're-edit the values.'
'  '
'You are asked to confirm the name of the zone viewfactor file.'
'The intial name will be based on the name of the zone. If you' 
'want to ignore the existing viewfactors for this zone click on'
'the dereference option. '
*enditem
   46   CALL EASKSCMD(LTMP,'Zone viewfactor file? ',' ',
   47   CALL EASKSCMD(LTMP,'Zone viewfactor file? ',' ',
        CALL PHELPD('mrt sensor',18,'-',0,0,IER)
   48   CALL EASKS(LTMP,' Zone viewfactor file? ',
        CALL EASKSUR(ICOMP,IS,'-',
        CALL EASKR(V,outs,' view factor: ',
        call easkab(outs,' ','re-edit','continue',IW,2)
        call easkabc(' Zone viewfactor calculations can be either',
*item EDMRT pause_for_calcs
'When the computation is completed you will be asked whether you'
'want to make use of this data.'
'The computation may take some time... do not attempt to use the'
'data until the computation is finished. '
*enditem
          CALL PHELPD('espvwf running',4,'-',0,0,IER)
          CALL EASKABC(' Post calculation choices :',' ',
*subroutine EDMRTS
*item EDMRTS mrt_sensor_dimensions
'The specification of MRT sensors is currently based on a sensor'
'being a prism.  Assuming there is no rotation the width of the'
'sensor is its distance along the X axis, the depth is along the'
'Y axis, and the height is along the Z axis.'
'  '
'The sensor may be rotated with the angle being measured anticlockwise'
'in degrees between the lenth side of the sensor an the X axis.'
'  '
'The origin of the sensor is in site coords X Y Z (as are other'
'zone geometric entities).'
'  '
'Each sensor should have a unique name (up to 6 char) for'
'identification in wire-frame images and in reporting.'
*enditem
        CALL EASKR(XOC(ICUB),MSG,'Origin X coordinate?',
        CALL EASKR(YOC(ICUB),MSG,' Origin Y coordinate?',
        CALL EASKR(ZOC(ICUB),MSG,'Origin Z coordinate?',
        CALL EASKR(DXC(ICUB),MSG,' Sensor width? ',
        CALL EASKR(DYC(ICUB),MSG,' Sensor depth? ',
        CALL EASKR(DZC(ICUB),MSG,' Sensor height? ',
        CALL EASKR(CANG(ICUB),MSG,' Sensor rotation? ',
        CALL EASKS(S6,' ',' Name of MRT sensor ? ',
        CALL PHELPD('sensor menu',7,'-',0,0,IER)
*subroutine EDOBS
*item EDOBS solar_obs_overview
'The default treatment of shading of outside surfaces is to assume'
'that a surface is un-obstructed. The default treatment of'
'insolation is that solar radiation entering rooms is diffusely'
'distributed.'
'  '
'In order to account for external shading devices, window reveals,'
'trees, outside walls, etc. in a detailed shading analysis the'
'user should approximate such objects as one or more prisms.'
' '
'The obstruction composition defaults to NONE, but can be set to'
'a multi-layer construction for use in visualisation studies. The'
'construction attribute is NOT used in thermal analysis.'
'  '
'Obstructions are typically prism shaped and you will be asked to'
'define an origin X Y and Z (m) as well as a length width and'
'height (m) and one or two rotations. A 2nd obstruction form is'
'a six sided body derived from an initial prism shape after which'
'the coordinates can be edited.'
'  '
'Existing obstructions can be rotated as required. When editing'
'an obstruction rotations are applied to the block origin with'
'anticlockwise direction positive in the edit menu. Multiple.'
'obstructions can be rotated about the site origin or another user'
'defined point.'
'  '
'Transforms (X Y Z) can be applied to one or more obstructions.'
'  '
'You can manage the list of obstructions by adding new obstructions'
'or deleting existing obstructions or copying (with option to'
'rotate and transform) existing obstructions. New obstructions must'
'be given a unique name (up to 12 characters).'
'  '
'Where facade elements, such as window reveals, are thick and thus'
'reduce the solar radiation entering the zone it is useful to'
'represent window reveals as obstruction blocks.  This is automated'
'by adding 4 blocks 5mm away from the surface with a thickness of'
'the adjacent wall (m) check the construction database or the'
'geometry menu for the thickness.'
'  '
'Each of the reveal blocks will share a root name with the block'
'name ending in s being the sill, ending in h the head, ending'
'in l the left reveal and r the right reveal.'
'  '
'Prior to undertaking shading calculations you should set the'
'gridding density to be used. This varies between 4 and 80 points'
'in each direction. The higher the density the more time it takes'
'to calculate - but a high density is required if there are small'
'dimensions e.g. a thin frame around a window.'
'  '
'After defining obstructions select the shading and insolation'
'directives menu option from where you can also ask for a'
'shading & insolation calculation to be run.'
*enditem
        CALL PHELPD('obstr menu',13,'-',0,0,IER)
        CALL PHELPD('obstr reveal',7,'-',0,0,IER)
        CALL EASKSUR(ICOMP,IRS,'-','Which surface should the reveal',
        CALL EASKS(blkroot,' Root name for related obstructions?',
        CALL EASKR(RTK,' ',' Thickness of the wall (m)?',
        CALL EASKABC(' Choices:',' ','rotate','transform',
        CALL EPICKS(INPIC,IVALB,' ',' Which obstructions to rotate:',
        CALL EASKR(ANGR,' ','Rotation (degrees, anticlockwise +ve)?',
        CALL EASKAB(' Rotate about the:',' ',
        CALL EASKR(x1,' ',' X coordinate (m)?',
        CALL EASKR(y1,' ',' Y coordinate (m)?',
        CALL EPICKS(INPIC,IVALB,' ','Transform which obstructions:',
 152    CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
        CALL EASKATOG('Modify obstruction list:',' ',
        CALL EPICKS(INPIC,IVALB,' ','Delete which obstruction(s):',
        CALL EPICKS(INPIC,IVALB,' ','Copy which obstruction:',
        CALL EASKS(tbn,' Re-name the obstruction copy:',
 243    CALL EASKS(HOLDS,'Transform obstruction (X Y Z metres):',
        CALL EASKS(HOLD,' Surface X & Z grid density:',' ',
*subroutine ECROBS
*item ECROBS obstruction_creation
'In order to account for external shading devices, window reveals,'
'trees, outside walls, etc. in a detailed shading analysis the user'
'should approximate such objects as one or more prisms'
'which are described in a site obstruction file.'
' '
'For new models the browse option presents a file list in the project'
'[zones] folder to allow import of legacy obstructions (overwriting'
'any obstructions already held in the zone geometry file.'
' '
'For older models the browse option presents a file list in the'
'project [zones] folder to associate with obstructions in an'
'exising zone obstruction file. '
' '
'The dereference option removes the reference to any currently'
'associated obstruction file. '
*enditem
          CALL EASKSCMD(LTMP,'Legacy obstructions import (see help):',
          CALL EASKSCMD(LTMP,'Zone obstructions file (see help):',
          CALL EASKS2CMD(LTMP,'Legacy obstructions import (see help):',
          CALL EASKS2CMD(LTMP,'Zone obstructions file (see help):',
          CALL EASKS2CMD(LTMP,
          CALL EASKS2CMD(LTMP,'Obstructions file (see help):',
          CALL EASKS(LTMP,
          CALL EASKS(LTMP,
*subroutine EDOBSB
*item EDOBSB obstruction_prism
'The specification of obstructions is currently based on obstructions'
'being a prism.  Assuming there is no rotation the width of the block'
'is its distance along the X axis, the depth is along the Y axis, and'
'the height is along the Z axis.'
'  '
'Obstructions must have a unique name (up to 12 char). This will be'
'seen in the wire-frame view as well as in reports.'
'  '
'Rotations: '
' First rotation: Assuming the block length dimension is along the'
' X axis the 1st rotation is around the Z axis with a positive angle'
' being measured anticlockwise from the line of the X axis. Note: this'
' is a different syntax from the rotation of zones.'
' '
' Second rotation: Assuming the block has no first rotation, the'
' 2nd axis of rotation is around the X axis with the angle being'
' measured between the base face and the horizon +ve is tilted,'
' upwards; -ve is tilted downwards.'
' '
' Third rotation: Tilt is not yet implemented but will be around the'
' Y axis (assuming no other rotations).'
'  '
' The combination of two rotations can be use to make a sloped roof'
' eve or an external shading slat that is horizonal along its'
' length but slanted in a short dimension.'
'  '
'To assist in determining the placement of obstruction blocks '
'the site coordinates of the 4 corners:'
' Front Left  = Block origin, '
' Front Right = Right side (along initial X axis), '
' Back Right  = Side diagonal from block origin '
' '
'The associated zone bounds are also shown in the menu as well as '
'the construction gives surfaces properties for use in visualisation.'
' '
'A block type obstruction can be converted into a general polygon'
'enclosure with six sides (as long as each face is flat). Such'
'general obstructions could represent non-rectangular objects. '
' '
'The base of a general polygon obstruction is made up of'
'vertices 1 4 3 2. The upper surface is 5 6 7 8. The front'
'surface is 1 2 6 5. The left surface is 4 1 5 8. The '
'right surface is 2 3 7 6. The back surface is 3 4 8 7.'
'Thus the 1st coordinate is the lower front left. The 2nd coordinate'
'is the lower front right. The 3rd coordinate is the lower back right.'
'The 4th coordinate is the lower back left. The 5th coordinate is'
'the upper front left. The 6th coordiante is the upper front right.'
'The 7th coordinate is the upper back right and the 8th is the'
'upper back left.'
' '
'Obstructions also have an attribute of opacity where 0.0 is'
'transparent and 1.0 is opaque. Perforated devices can thus be'
'represented without altering their size.'
'  '
'You can edit the origin of the block, make it the same as a vertex'
'in the zone, or the same as a vertex in the zone after editing.'
*enditem
          CALL EASKABCD('Choices:',' ','edit origin','use zone vertex',
 342      CALL EASKS(HOLD,
          CALL EASKS(HOLD,MSG,
          CALL EASKS(HOLD,MSG,' width (X), depth (Y), height (Z) ',
          CALL EASKR(VX,MSG,' Block Z rotation? ',
          CALL EASKR(VX,MSG,' Block Y rotation (see help)? ',
          CALL EASKS(S12,' ',' Name of obstruction? ',
          CALL EASKR(VX,MSG,' Block opacity (see help)? ',
          CALL PHELPD('obstr menu',48,'-',0,0,IER)
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
          CALL EASKS(HOLD,MSG,' X(m) Y(m) Z(m) (see help)',
          CALL EASKS(S12,' ',' Name of obstruction? ',
          CALL EASKR(VX,MSG,' Block opacity (see help)? ',
          CALL PHELPD('obstr menu',48,'-',0,0,IER)
*subroutine EREVEAL
*item EREVEAL window_reveal
'Reveals only created around a rectangular opening. '
'You can specify 4 corners (i.e. 4 vertices, beginning lower'
'left corner and going anti-clockwise). '
'  '
*enditem
        CALL EASKAB('The selected surface doesn-t have 4 sides.',
153     CALL EASKS(HOLDS,' 4 vertices defining corners: ',' ',
*subroutine EDVIS
*item EDVIS visual_overview
'ESP-r includes a number of geometric entities for visual assessments'
'(e.g. Radiance models or to add visual clarity to wire-frame views of'
'models). These entities do not take part in thermal assessments or in'
'shading assessments. Use shading obstructions for shading assessments'
'and/or paired (back-to-back) surfaces for thermal inertia.
' '
'The composition of visual entities should be set to a multi-layer'
'construction for use in visualisation studies.'
'  '
'Visuals are typically prism shaped and you will be asked to'
'define an origin X Y and Z (m) as well as a length width and'
'height (m) and one or two rotations. A form is a six sided body'
'derived from an initial prism shape after which the coordinates'
'can be edited.'
'  '
'Existing visual entities can be rotated as required. When editing'
'rotations are applied to the block origin with anticlockwise '
'direction positive in the edit menu. Rotations are about the site'
'origin or another user defined point.'
'  '
'Transforms (X Y Z) can be applied to one or more visual entities.'
'  '
'You can manage the list e.g. adding new visuals, deleting existing'
'visuals or copying (with option to rotate and transform). New'
'visuals must be given a unique name (up to 12 characters).'
'  '
'As several visual entities can form an object, such as an office'
'chair or a desk, you can also link several visual entities into'
'a visual object. You can also rotate or transform an object as'
'well as copying it (and the entities it references).'
'  '
*enditem
*subroutine EDVISB
*item EDVISB visual_prism
'The specification of visual entities is currently based on prism'
'forms.  Assuming there is no rotation the width of the block'
'is its distance along the X axis, the depth is along the Y axis, and'
'the height is along the Z axis.'
'  '
'Visuals must have a unique name (up to 12 char). This will be'
'seen in the wire-frame view as well as in reports.'
'  '
'Rotations: '
' First rotation: Assuming the block length dimension is along the'
' X axis the 1st rotation is around the Z axis with a positive angle'
' being measured anticlockwise from the X axis. Note this is'
' the same as in zone obstructions.'
' '
' Second rotation: Assuming the block has no first rotation, the'
' 2nd axis of rotation is around the X axis with the angle being'
' measured between the base face and the horizon +ve is tilted,'
' upwards; -ve is tilted downwards.'
' '
' Third rotation: Tilt is not yet implemented but will be around the'
' Y axis (assuming no other rotations).'
'  '
'To assist in determining the placement of visual entities '
'the site coordinates of the 4 corners:'
' Front Left  = Block origin, '
' Front Right = Right side (along initial X axis), '
' Back Right  = Side diagonal from block origin '
' '
'The associated zone bounds are also shown in the menu as well as '
'the construction gives surfaces properties for use in visualisation.'
' '
'A block type visuals can be converted into a general polygon'
'enclosure with six sides (as long as each face is flat). These'
'can represent non-rectangular objects. '
' '
'The base of a general polygon visual is made up of'
'vertices 1 4 3 2. The upper surface is 5 6 7 8. The front'
'surface is 1 2 6 5. The left surface is 4 1 5 8. The '
'right surface is 2 3 7 6. The back surface is 3 4 8 7.'
'Thus the 1st coordinate is the lower front left. The 2nd coordinate'
'is the lower front right. The 3rd coordinate is the lower back right.'
'The 4th coordinate is the lower back left. The 5th coordinate is'
'the upper front left. The 6th coordiante is the upper front right.'
'The 7th coordinate is the upper back right and the 8th is the'
'upper back left.'
' '
'Visuals also have an attribute of opacity where 0.0 is'
'transparent and 1.0 is opaque. This information is not yet used'
'within radiance representations.'
'  '
'You can edit the origin of the block, make it the same as a vertex'
'in the zone, or the same as a vertex in the zone after editing.'
*enditem
*subroutine EDVISOBJ
*item EDVISB visual_object
'Sometimes it is useful to associate several visual entities to form'
'a compound visual object i.e. an office chair or desk. A compound'
'visual object has a name (up to 12 char), a description (up to 32'
'char) and up to a dozen names of existing visual entities.'
' '
'Visual objects can be rotated or transformed by applying the'
'rotation or transfor to all the associated entities.'
' '
'You can copy a compound visual object. This is done by copying'
'and renaming the associated entities. One can then rotate or'
'transform the copied compound visual object without impacting'
'the original entities.'
*enditem
*subroutine EDACONN
*item EDACONN boundary_choice_menu
'The model contiguity (boundary conditions at surfaces) are set in'
'this menu.  Before a simulation can be performed it is necessary'
'that all surface have an assigned boundary condtion.'
' '
'There are several means to define the topology: '
' a) attribute surfaces via the zone geometry facility,'
'    '
' b) manually edit them via this list, '
'    '
' c) search for matching vertices within the model to fill in all'
'    partitions and then complete this list by editing or '
'    importing surface attributes.'
' '
'The automated facility is considerably faster than manual methods'
'and best used when all the zones have been created. '
'  '
'The boundary conditions at the other face of a surface is selected'
'from one of these choices.  The default is OUTSIDE.'
' '
' Exterior - the other face of the surface is exposed to ambient air'
'  temperature, wind and solar radiation.'
' '
' Dynamic/similar - the other face of the surface is exposed to the'
'  same conditions as the inside face. A dynamic/similar connection'
'  can include an offset temperature (C) and radiation (W/m^2).'
' '
' Static - requires that a constant temperature and radiation is'
'  supplied. You might use this to represent a cold storage room.'
' '
' Surface in another zone - the other face of the surface gets its'
'  boundary conditions from the last known state of the other surface.'
'  There is a thermophysical connection established between the zones.'
'  Usually you will also want to update the other zone surface.'
' '
' Ground (standard profile) - the other face of the surface is in'
'  direct contact with one of the standard monthly temperature'
'  profiles embedded in ESP-r.'
' '
' Ground (user defined profile) - the other face of the surface is'
'  in direct contact with a monthly profile previously created by'
'  the user (in the model context)'
' '
' Ground (3D conduction) - the other face connects to a 3D ground'
'  representation. This is not often used.'
' '
' Adiabatic boundary - typically used for back-to-back surfaces in'
'  a zone representing thermal mass. There is no heat flux passed'
'  beyond the other-face. '
' '
' BASESIMP is used to represent one of several basement configuration'
'  and precalculated patterns of heat transfer. For this to be useful'
'  there must be a basesimp file created for the zone giving a number'
'  of dimensions and computational parameters.'
' '
' CEN 13791 partition which is like the SIMILAR but for CEN 13791'
'  test. The offset temperauture and radiation (W/m^2) in SIMILAR'
'  is not available for the CEN 13791 partition type. For details see'
'  section 4.4.2 CEN 13791 standard. As it results in equal solar'
'  radiation on both sides of a partition it is [unrealistic] and'
'  thus not recommended for normal use.'
*enditem
        CALL PHELPD('connection section',17,'-',0,0,IER)
        call MENUATOL(outs,' Connection options ',
        CALL EASKR(VALT,' Offset temperature? [default=0.0]',
        CALL EASKR(VALW,' Offset radiation source (W/m^2)?',
        CALL EASKR(VAL,' ',' Constant temperature ? ',
        CALL EASKR(VAL,' ',
        CALL EASKGEOF('Select zone on other side:',CFGOK,IZ,'-',IER)
        CALL EASKSUR(IZ,IS,'-','Select surface in the adjacent',
        CALL ASKOK(' ','Update other side?',updoth,dok,5)
*item EDACONN boundary_ground
'A ground connection allows either:'
'> 0 a connection to one of several standard profiles in which'
'    case the profile number is required. A listing of the known'
'    profiles will be shown.'
'  '
'= 0 a connection to a user defined profile in which case a zero is'
'    followed by a user defined profile number is required.'
'  '
'-3  a connection to a 3D ground model.'
*enditem
  777     CALL EASKI(IIC2,' Monthly (standard) profile index? ',
          CALL EASKI(IIE2,' User defined ground profile index ?',
*item EDACONN boundary_basesimp
'Specify the BASESIMP configuration number (iconfig). '
'Refer to src/esp-r/esrubld/bscoeff.F for the '
'correspondence between iconfig and standard BASESIMP '
'descriptors (e.g. BCIN_1).'
'  '
'BASESIMP is a [whole-foundation model]. Therefore, when'
'a foundation is represented by numerous ESP-r surfaces'
'(e.g. four walls + floor to represent a basement), you'
'must specify the percentage of the whole-foundation'
'heat loss to attribute to each surface. Normally the'
'sum of surfaces representing a founcation is 100%.'
*enditem
          CALL EASKI(Ifrac,' Percent of BASESIMP loss to this surface?'
*subroutine EDOPT
*item EDOPT optical_properties_menu
'Optical properties are used for transparent constructions as well'
'as for daylighting calculations and the control of casual gains.'
'  '
'Optical properties in ESP-r must be derived from 3rd party apps'
'such as the LBL Window 5.2/6.2/6.3 or the EU WIS (Window Information'
'System) from TNO. Import functions are part of option * in the menu.'
'  '
'Gather your information and decide how the glazing will be treated'
'e.g. is the glazing coated, are their multiple states such as'
'blinds that need to be included. For example, a double glazed'
'unit with internal blinds might be represented via the DCF7671_06mb'
'optical property which has 5 layers (glass air blind air glass) and'
'its open state via DCF7671_6omb which also has 5 layers. This'
'needs to be associated with a relevant construction such as'
'switched_gl (which points to the open version of the optical'
'properties. Enable optical switching in the zone constructions'
'menu and nominate the internal blind as the alternative state.'
'  '
'The list of available optical properties includes the short name'
'of the optical property plus a documentation string. The short name'
'must be unique and be up to 12 characters with no blanks.'
'  '
'Take care when deleting an optical property or re-naming an'
'optical property. Other constructions may reference it. Consider'
'using the copy facility to create variants of an optical property.' 
'All data is used except for items marked as (documentation).'
' '
'Optical data in ESP-r is representative of the whole transparent'
'system and their inter-relationships. The absorption at an inner'
'layer is relative to the radiation arriving at that layer (thus'
'the need for 3rd party applications such as WIS and Window 6.2).'
'  '
'Often glass manufacturers will only publish the aggregate optical'
'data in terms of the overall transmission rather than the layer'
'by layer data needed by ESP-r.'
'  '
'Imported data includes inforation that is not directly used by ESP-r'
'but which is documentation - the U value and solar heat gain factors'
'are examples of this.'
' '
'Note that the materials database has slots for single layer optics'
'which will be used in the future (currently they are un-used.'
'  '
'To reflect changes you have made in the constuction db you will'
'have to rebuild the zone construction and tmc files.  This is in'
'option [Construction] of the [model definition] menu.'
*enditem
        CALL PHELPD('optical db update',4,'-',0,0,IER)
        CALL PHELPD('optics db',58,'-',0,0,IER)
        CALL EASKABC(' Reporting to:',' ',
        CALL EASKATOG('Optical actions: ',' ',
        CALL EASKS(lfil,'WIS file name?',
*subroutine EDOPT
*item EDOPT optical_import_win6
'Optical properties in ESP-r must be derived from 3rd party apps'
'such as the LBL Window 5.2/6.2/6.3. Here is a step by step guide:'
'  '
'Gather your information and decide how the glazing will be treated'
'e.g. is the glazing coated, are their multiple states such as'
'blinds that need to be included.'
' '
'Older Window files start with:'
'Window 5.2a  v5.2.17a Glazing System Thermal and Optical Properties'
'  '
'Newer Window files start with:'
'Window v6.3.9.0 Glazing System Thermal and Optical Properties'
'  '
'1) Take note of the full path to the LBL report file and confirm'
'   how many layers are included in the optical data. Decide on'
'   a descriptive phrase and short ID string for new optical data'
'   as well as the name of the construction which will use or be'
'   created to use this optical data.'
'  '
'2) In the Database Maintenance facility of prj make sure there'
'   is a local optical and construction database for your model.'
'  '
'3) Browse the optical properties database: optica properties ->'
'   browse/edit db and locate the * import option. Choose the'
'   [Import Window4/5/6] button. In the X11 interface you have'
'   to type in the full file path and name of the LBL report.'
'   If the import process works you will be presented with a'
'   new Optical Property Set. Ignore any EOF warnings. The'
'   contents of the LBL report are echoed in the text feedback.'
'  '
'4) Fill in the [a type] with the short optical identifier and'
'   [b descrip] with the phrase from step 1. Check the visible'
'   and solar values reported in the interface are crrect and'
'   that air gaps in the optical report have been detected.'
'  '
'5) Take a note of the U-value from the LBL report. You may need to'
'   adapt the air gap resistance in the construction.'
'  '
'6) Exit from the optical facility and browse the constructions'
'   database. Either locate an existing construction with the'
'   same number of layers or create a new construction. Check that'
'   the [General type] is Transparent and then click on the'
'   [Optical properties] option. This will open the optics db so'
'   locate and select the new optical set. If the reported ISO'
'   6946 value does not match the LBL report adjust it.'
*enditem
*item EDOPT optical_import_wis
'Optical properties in ESP-r must be derived from 3rd party apps'
'such as the TNO WIS (Windows Information System). This is free'
'download from http://www.windat.org/wis/html/index.html. It is'
'implemented as an ACCESS database interface. The download file'
'unpacks to a folder of files which includes a standard Windows'
'setup.exe application. Typically you will be asked to confirm the'
'install of a Microsoft Jet engine, but otherwise if you have'
'Office installed it should run without any other dependencies.'
'  '
'Although WIS is an older application it has facilities to work'
'with diffusing elements. Some glazing systems can result in the'
'inclusion of direct-to-diffuse attributes at each angle as well'
'as a full hemisphere of data (-90 to +90). ESP-r cannot deal with'
'that many angles and it does not yet have the ability to process'
'angular diffuse information. If that is important you might wish'
'to explore the ESP-r CFC (complex fenistration) functions.'
'  '
For the purposes of ESP-r, the use of WIS is focused on the'
'[Transparent System] option. This starts up another proforma with'
'a scrolling option at the bottom. New systems can be added.'
'  '
'The [Calculate] option starts a dialog of data choices for the'
'report. The default includes basic-oveall, angular-overall, and'
'angular-elements as well as temperatures and network. ESP-r will'
'read this default report but does now use the temperature or the'
'network data (so you can untick that).'
'  '
'After confirming the reporting options use the [create] button to'
'generate the report after with Notepad will start up with the'
'report loaded. Save this and it can be used in the import option'
'of the optical database facility. Linux users may need to convert'
'the file from DOS line endings.'
'  '
'WIS includes the concept of g-values. This is not directly used in'
'ESP-r but is a common descriptor so they are included in the ESP-r'
'optical database in place of the solar heat gain coefficients.'
'  '
*enditem
          CALL EPICKS(IX,IVALSS,' ','Typical glazing types:',
          CALL EASKI(nl,' ',' Number of layers in the new set ?',
          CALL EPICKS(IX,IGSET,' ','Optical set to delete:',
          CALL ASKOK(' ',' Are you sure?',OK,dok,1)
          CALL EPICKS(IX,IGSET,' ','Optical set to copy:',
*subroutine OPT2TMP
*subroutine EDITOPT
*item EDITOPT optical_properties_edit
'Optical properties are used for transparent constructions'
'as well as to support daylighting calculations and the'
'control of casual gains.  All data is used except for '
'that which is marked as (documentation).'
' '
'For QA purposes you may fill in the surface solar abs & refl'
'values to match the MLC surface properties.'
'The U-value and solar heat gain coef are for documentation.'
' '
'The angular reflections are derived from the overall solar'
'transmission and layer absorptions at normal to the surface, and'
'at 40 degrees, 55 degrees, 70 degrees and 80 degrees from normal.'
' '
' option a: type is an ID string up to 12 char which is used'
'   in the constructions database and zone geometry files. It'
'   should be unique (within the database).'
'  '
' option b: descrip is a phrase up to 36 char which you can use'
'   to clarify the optical system'
'  '
' option c: visible transmittance is typically taken from a'
'   WIS or Window 6 report. It is used when creating visual'
'   simulations via Radiance.'
'  '
' option d: solar absorption and reflectin is typically taken from'
'   a WIS or Window 6 report and is for documentation purposes. ESP-r'
'   pays attention to the surface properties defined in the zone'
'   construction files. Ensure that the materials database has values'
'   which are consistent with the WIS or Window 6 report.'
'  '
' option e: U-value is typically taken from a WIS or Window 6 report'
'   and is for documentation purposes. You might want to adapt the'
'   air gap resistance in the construction database to match this.'
'  '
' option f: direct solar transmission at 5 angles - typically from'
'    a WIS or Window 6 report. to importing optical data.'
'  '
' reflection data is derived and cannot be directly edited
'  '
' option g: solar heat gain is typically imported from a WIS or'
'    Window 6 report and is for documentation purposes.'
'  '
' layer data includes the refractive index of the glass (typically'
'    1.52) or air layer (typically 1.0) as well as the'
'    absorption at 5 angles. This is normally found in the WIS or'
'    Window 6 report. The absorption is relative to the radiation'
'    arriving at the layer it must be be computed for the glazing'
'    system rather than independent layers.'
'  '
' option 1: management of layers includes the usual functions where'
'   add will insert at the point you indicate and copy adds a layer'
'   at the inside face.'
*enditem
        CALL PHELPD('optics set',58,'-',0,0,IER)
        CALL EASKABCD('Layer actions: ',' ','Add (insert)',
        CALL EPICKS(IX,IGSET,' ','Point of insertion:',43,NTLED+1,
        CALL EPICKS(IX,IGSET,' ','Layer to delete:',43,NTLED,
        CALL EPICKS(IX,IGSET,' ','Layer to copy:',43,NTLED,
        CALL EASKS(T12,'Id string ?',' ',12,GTYPE,'opt id',IER,2)
        CALL EASKS(GDESCR,'Description ?',' ',36,'new','opt desc',IER,1)
        CALL EASKR(VTRNED,' ','Visable transmission? ',
        CALL EASKS(hold,'Solar absoption & reflectance?',
        CALL EASKR(UVALED,'U value','(documentation): ',
        CALL EASKS(hold,'Solar trn @ 0 40 55 70 80 deg:',
        CALL EASKS(hold,'Overall heat gain @ 0 40 55 70 80 deg:',
        CALL EASKS(hold,'Refraction index, absorb @ 0 40 55 70 80 deg:',
*subroutine IMPOPT
*item IMPOPT optical_import_win6
'Optical properties in ESP-r must be derived from 3rd party apps'
'such as the LBL Window 5.2/6.2/6.3. Here is a step by step guide:'
'  '
'Gather your information and decide how the glazing will be treated'
'e.g. is the glazing coated, are their multiple states such as'
'blinds that need to be included.'
' '
'Older Window files start with:'
'Window 5.2a  v5.2.17a Glazing System Thermal and Optical Properties'
'  '
'Newer Window files start with:'
'Window v6.3.9.0 Glazing System Thermal and Optical Properties'
'  '
'1) Take note of the full path to the LBL report file and confirm'
'   how many layers are included in the optical data. Decide on'
'   a descriptive phrase and short ID string for new optical data'
'   as well as the name of the construction which will use or be'
'   created to use this optical data.'
'  '
'2) In the Database Maintenance facility of prj make sure there'
'   is a local optical and construction database for your model.'
'  '
'3) Browse the optical properties database: optica properties ->'
'   browse/edit db and locate the * import option. Choose the'
'   [Import Window4/5/6] button. In the X11 interface you have'
'   to type in the full file path and name of the LBL report.'
'   If the import process works you will be presented with a'
'   new Optical Property Set. Ignore any EOF warnings. The'
'   contents of the LBL report are echoed in the text feedback.'
'  '
'4) Fill in the [a type] with the short optical identifier and'
'   [b descrip] with the phrase from step 1. Check the visible'
'   and solar values reported in the interface are crrect and'
'   that air gaps in the optical report have been detected.'
'  '
'5) Take a note of the U-value from the LBL report. You may need to'
'   adapt the air gap resistance in the construction.'
'  '
'6) Exit from the optical facility and browse the constructions'
'   database. Either locate an existing construction with the'
'   same number of layers or create a new construction. Check that'
'   the [General type] is Transparent and then click on the'
'   [Optical properties] option. This will open the optics db so'
'   locate and select the new optical set. If the reported ISO'
'   6946 value does not match the LBL report adjust it.'
*enditem
*subroutine IMPWIS
*item IMPWIS optical_import_wis
'Optical properties in ESP-r must be derived from 3rd party apps'
'such as the TNO WIS (Windows Information System). This is free'
'download from http://www.windat.org/wis/html/index.html. It is'
'implemented as an ACCESS database interface. The download file'
'unpacks to a folder of files which includes a standard Windows'
'setup.exe application. Typically you will be asked to confirm the'
'install of a Microsoft Jet engine, but otherwise if you have'
'Office installed it should run without any other dependencies.'
'  '
'Although WIS is an older application it has facilities to work'
'with diffusing elements. Some glazing systems can result in the'
'inclusion of direct-to-diffuse attributes at each angle as well'
'as a full hemisphere of data (-90 to +90). ESP-r cannot deal with'
'that many angles and it does not yet have the ability to process'
'angular diffuse information. If that is important you might wish'
'to explore the ESP-r CFC (complex fenistration) functions.'
'  '
For the purposes of ESP-r, the use of WIS is focused on the'
'[Transparent System] option. This starts up another proforma with'
'a scrolling option at the bottom. New systems can be added.'
'  '
'The [Calculate] option starts a dialog of data choices for the'
'report. The default includes basic-oveall, angular-overall, and'
'angular-elements as well as temperatures and network. ESP-r will'
'read this default report but does now use the temperature or the'
'network data (so you can untick that).'
'  '
'After confirming the reporting options use the [create] button to'
'generate the report after with Notepad will start up with the'
'report loaded. Save this and it can be used in the import option'
'of the optical database facility. Linux users may need to convert'
'the file from DOS line endings.'
'  '
'WIS includes the concept of g-values. This is not directly used in'
'ESP-r but is a common descriptor so they are included in the ESP-r'
'optical database in place of the solar heat gain coefficients.'
'  '
*enditem
      CALL EASKS(lwin4,' WIS report file to import? ',
*subroutine edbioptics
*item edbioptics optical_bidirectional
'ESP-r accepts measured optical properties at 5 degree intervals'
'over a hemisphere. This high resolution optical data can be'
'associated with surfaces in the model. Note that each such surface'
'is assumed to use a normal optical attribute.'
' '
'Currently this data is read in from an external file. See esrucom/'
'econstr.F or ask ESRU for details on the file format. An example'
'is given here. Lines starting with # are optional and for'
'documentation purposes: '
'*BIDIRECTIONAL '
'*types,1 '
'*item, Genius internal with heat mirror DGU '
'##(3 datatypes: Te_g_rho, Te_abs_n_diffuse, Te_g_only) '
'*datatype,Te_g_rho '
'*layers,3 '
'*sets,6 '
'## Next four lines are not used (only for documentation)'
'## Properties of DGU: '
'## WSV Iplus neutral E (4mm/16mm/4mm) '
'## g0 = 0.60; '
'## tauvis0 = 0.80; '
'## udgu := 1.1; '
'*start_set '
'*set_type 1,#slat angle = 0deg '
'*Uvalue 1.1 '
'*Rexternal 0.04 '
'*Rinternal 0.13 '
'#Next 2 lines: only used for datatype 1 (Te_abs_n_diffuse)'
'*diffuse_abs,0.260,0.521,0.002,0.000,0.007 '
'*diffuse_trn,0.345 '
'*direct_angs,37,37 '
'*data '
'#Azimuth,Height,Te,g,rho '
'-90,-90,0,0,1 '
'-90,-85,0,0,1 '
'-90,-80,0,0,1 '
'... '
'90,85,0,0,1 '
'90,90,0,0,1 '
'*end_set '
'*start_set '
'*set_type 2,#slat angle = 15deg '
'*Uvalue 1.1 '
'*Rexternal 0.04 '
'*Rinternal 0.13 '
'#Next 2 lines: only used for datatype 1 (Te_abs_n_diffuse)'
'*diffuse_abs,0.260,0.521,0.002,0.000,0.007 '
'*diffuse_trn,0.345 '
'*direct_angs,37,37 '
'*data '
'#Azimuth,Height,Te,g,rho '
'-90,-90,0,0,1 '
'-90,-85,0,0,1 '
'... '
'90,85,0,0,1 '
'90,90,0,0,1 '
'*end_set '
*enditem
        CALL PHELPD('bi-directional attributes',60,'-',0,0,IER)
        CALL EASKS(lfil,' bi-directional optical data to use?',
        call easkab(' File not found. Do you want to specify again?',
*subroutine CASFMK
*item CASFMK events_db_overview
'   Profiles Database '
' '
'Profiles in this database are currently used to assist in the '
'defintion of zone operations.  The standard database is found in'
'/usr/esru/esp-r/databases or the databases folder of your ESP-r'
'distribution.'
' '
' The data requirements are summarised below :- '
' '
' for each profile - number of events during the day'
' '
' for each event - start and finish time'
'                  percentage of first (sensible) value'
'                  percentage of second (latent) value'
' '
'  option * add a profile - add a profile to the end of the current'
'    list of profiles. You will be asked how many events in the'
'    profile.'
'  '
'  option ! list profiles - produces a compact listing of the'
'    current profiles database.'
'  '
'If you edit data in the database the ASCII file will be'
'updated. Consider using a model specific file if you'
'need custom profiles.'
*enditem
        CALL PHELPD('event profiles',18,'-',0,0,IER)
        CALL EASKI(IV,' ','Number of events in profile: ',
*subroutine EDPROF
*item EDPROF events_db_start
'You may alter the start and/or stop times of any period as well as'
'the associated values. For casual gain type profiles the first'
'value is the sensible and the second is the latent. '
' '
'When a change is made to the data a fresh copy of the ASCII '
'version will be written out. '
' '
'Models pointing to binary versions of this file will be converted'
'to ASCII versions after editing.'
'  '
'If you provide the actual start times the subsequent '
'editing tasks will be easier (there is no sort function).'
'  '
'Each profile includes a description (up to 40 char) is provided as'
'a way to select from the profile list.  Please make the'
'description unique.'
*enditem
        CALL EASKS(CSTR,' Start hour of each event',
        CALL PHELPD('pro edit',10,'-',0,0,IER)
        CALL EASKS(TMP,' Description ? ',
*subroutine EDEVENT
*item EDEVENT events_item_edit
'An event may start between hours 0 and 23. '
' '
'An event may finish  between hours 1 and 24.'
'  '
'Each event has two associated data:'
'  percentage of sensible gain'
'  percentage of latent gain'
' '
'A cancel request leaves the model unchanged.'
*enditem
      CALL EASKI(IES,outs,' start hour : ',
      CALL EASKI(IEF,outs,' finish hour: ',
      CALL EASKAB(' Finish time overlaps next event...',
      CALL EASKR(EC,' ',' First value (sensible) percentage ? ',
      CALL EASKR(EL,' ',' Second value (latent) percentage ? ',
*subroutine EDSPLIST
*item EDSPLIST special_file_and_data
'If you know of the name of an existing file click on ok. If you'
'want to create one say no. '
'  '
'If you say no (so that a new file is to be created you must'
'also confirm that you have the data needed to define a special'
'materials database.'
*enditem
        CALL ASKOK('Does a special components file exist?',' ',OK,dok,2)
        CALL ASKOK('Would you like to create a new special',
*item EDSPLIST special_file_contents
'This file contains information about special components integrated'
'into the building fabric. Examples include:'
'facade integrated photovoltaics, ducted wind turbines,'
'phase change materials, thermochromic glazing, etc.'
*enditem
        call easks(lfil,' ',' Special components filename?',72,
*item EDSPLIST special_file_menu
'This menu controls the definition of special components in the'
'model. Special component properties supports features such as'
'integrated photovoltaics or and phase change materials. '
' '
'Each entry is given a name and includes positional information to'
'link it to a surface/layer within the building model.  NOTE that'
'changes to zones such as adding/deleting surfaces or changing'
'composition is not automatically updated. '
'  '
'Management facilities:'
'  delect component - removes an existing special component'
'  add component - add a new component (be sure you have your'
'     data for the new component available)'
'  edit component - change details in an existing component you'
'     will be asked to confirm that you want to edit.'
*enditem
        CALL PHELPD('special component edit',10,'-',0,0,IER)
        CALL EASKABCD('Options:',' ','delete component',
        CALL ASKOK('Edit this component?',' ',OK,dok,1)
*subroutine EDSPM
*item EDSPM special_file_cat
'The menu options relate to different categories of special'
'components which may be selected for integration into the'
'building. Select a category'
*enditem
        call phelpd('Special component',3,'-',0,0,IER)
*item EDSPM special_file_select
'Select a special component from the list. Each material shown'
'is associated with a set of pre-defined parameters,these can be'
'altered if required. '
'  '
'Switching the [component info] toggle to ON lets the user view'
'any more information associated with the special component; this'
'appears in the text window. '
'  '
'You will be asked to supply a label for the material (no spaces).'
'  '
'You will then be asked to supply each of the data items that'
'are associated with the special materials type. You can either'
'accept the default data or enter you own values.'
'  '
'At the end of editing you will be asked if you want to save it.'
*enditem
          CALL PHELPD('Special material',8,'-',0,0,IER)
      call easks(labl,' ',' Label for material (no spaces)?',16,
      call phelpd('Special mat data',3,'-',0,0,IER)
      call easkr(datsp,outs,' ',1.,'-',99.,'-',1.0,'SPM data',
      call easkr(datsp,outs,' ',1.,'-',99.,'-',1.0,'SPM data',
*item EDSPM special_file_wind
'To enable the calculation of wind-induced surface pressures'
'(as required by the ducted wind turbine model), a database of'
'angle dependent pressure coefficients is provided.'
'  '
'The default ESP-r set contains wind pressure coefficients for'
'surfaces in typical positions and within several different'
'exposure categories. They can be used (with care) for low-rise'
'buildings.'
'See the ESP manual for additional info.'
' '
'It is also possible to calculate pressure coefficients using'
'CpCalc (see database maintenance).'
' '
'Select the pressure coefficient from this list, which is most'
'appropriate for the location of the ducted wind turbine.'
' '
'Notes about pressure coefficients: '
'The first 27 data sets in the standard pressure coefficients'
'database are from the Air Infiltration & Ventilation Centre'
'Handbook called <Air Infiltration Calculation Techniques -'
'An Applications Guide>. The 27 data sets are only appplicable'
'for buildings up to 3 storeys andcome with the usual warnings'
'about usage of the data. '
' '
'Each data set is described with the following terms:'
' a) facade or roof at different roof pitch angles'
' b) the ratio of the building length to width and for a non-square'
'    building there will be a long and a short wall to select'
' c) site shielding as follows:'
'   exposed - open countryside with no obstructions'
'   simi-exposed - rural with some obstructions'
'   sheltered - urban, surrounded on all sides by obstructions'
'     of similar size.'
'  '
'After selection of the pressure set you will be asked for'
'confirmation.'
'  '
'You will then be asked to specify the angle of the surface'
'in degrees from the north clockwise. This will be the same'
'as is reported on in the surface attributes.'
*enditem
        CALL PHELPD('databases overview',36,'-',0,0,IER)
        CALL ASKOK(t72,'as the pressure coefficient set?',OK,dok,1)
        CALL EASKR(VAL,' ',
        CALL PHELPD('databases overview',16,'-',0,0,IER)
        CALL EASKR(VAL,' ',
*item EDSPM
'Choose a layer at which to situate a special materials node.'
'  '                                     '
'Select a node within the layer in which to position the special'
'component. The value given is the node in the centre of the layer.'
'  '
'If a PV component is chosen and the ALL the construction layers'
'are opaque then the node should be placed at the outside surface'
'(node no. 1).'
' '
'A cancel request leaves the model unchanged.'
*enditem
          call easki(nodloc,' Position component at ',
          call askok(' An existing special component exists at',
          call phelpd('Special material',2,'-',0,0,IER)
*subroutine EDCONN
*item EDCONN topology_choice_menu
'The model contiguity (boundary conditions at surfaces) are set in'
'this menu.  Before a simulation can be performed it is necessary'
'that all surface have an assigned boundary condtion.'
' '
'In the automated search the coord tolerance is expressed in mm'
'and edge not-quite-straight in degrees so you can control how'
'much of a change in direction along a line constitutes a surface'
'corner. '
'  '
'You are also asked to set toggle about which kinds of connections'
'need to have user confirmation of. Typically you would want to'
're-confirm partitions and surfaces which do not match.'
'  '
'Be careful with the toggle for surfaces which do not have a match.'
'These you probably want to confirm rather than just assume that'
'they face the outside.'
' '
'NOTE: If internal mass in zone or explicit blinds have been defined'
'as a back-to-back surfaces then they will be treated as partitions'
'unless you force confirmation.'
' '
'The boundary conditions opts are:'
' Exterior - the other face of the surface is exposed to ambient air'
'  temperature, wind and solar radiation.'
' '
' Dynamic/similar - the other face of the surface is exposed to the'
'  same conditions as the inside face. A dynamic/similar connection'
'  can include an offset temperature (C) and radiation (W/m^2).'
' '
' Static - requires that a constant temperature and radiation is'
'  supplied. You might use this to represent a cold storage room.'
' '
' Surface in another zone - the other face of the surface gets its'
'  boundary conditions from the last known state of the other surface.'
' '
' Ground (standard profile) - the other face of the surface is in'
'  direct contact with one of the standard monthly temperature sets.'
' '
' Ground (user defined profile) - the other face of the surface is'
'  in direct contact with a monthly profile previously created by'
'  the user (in the model context)'
' '
' Ground (3D conduction) - the other face connects to a 3D ground'
'  representation. This is not often used.'
' '
' Adiabatic boundary - typically used for back-to-back surfaces in'
'  a zone representing thermal mass. There is no heat flux passed'
'  beyond the other-face. '
' '
' BASESIMP is used to represent one of several basement configuration'
'  and precalculated patterns of heat transfer. For this to be useful'
'  there must be a basesimp file created for the zone giving a number'
'  of dimensions and computational parameters.'
' '
' CEN 13791 partition which is like the SIMILAR but for CEN 13791'
'  test. The offset temperauture and radiation (W/m^2) in SIMILAR'
'  is not available for the CEN 13791 partition type. For details see'
'  section 4.4.2 CEN 13791 standard.'
*enditem
        CALL PHELPD('connection section',21,'surf_topo   ',0,0,IER)
        CALL EASKR(CACC,' ',' Tolerance (metres) ? ',
        CALL EASKR(DACC,' ',' Corner tolerance (degrees) ?',
        CALL EASKI(IACC,' Number of corners which are allowed outside',
        call askok('Are you sure you want to skip marked partitions?',
        CALL PHELPD('cfg import atrib',5,'-',0,0,IER)
*item EDCONN boundary_back_to_back
'Typically, back-to-back surfaces in a room represent mass and/or'
'blinds and if these surfaces are connected to each other heat'
'will flow. If you want the option to reset these to ADIABETIC say YES.'
*enditem
          call askok('Do you want to confirm back-to-back surfaces',
*item EDCONN boundary_clear_all
'In restructuring a model it is sometimes useful to redefine'
'the topology.'
' '
'The [clear subset] asks for each type of connection (partitions/'
'(identical etc.) to clear. '
' '
'The [clear all] will rebuild the whole master list and this should'
'be done if the list has been corrupted.'
'  '
'How would you know if these topology was corrupted? Well if'
'you focus on a surface and the wire-frame does not highlight'
'that surface the list is probably messed up.'
'  '
'The [clear subset] asks for each type of connection (partitions/'
'identical etc.) to clear. '
' '
'Say yes to SIMILAR and/or CONSTANT and/or GROUND and/or'
'ADIABETIC if you want to clear connections of surfaces matching'
'these boundary types. '
'  '
'After clearing contiguity you can re-establish some of the'
'connections via surface attributes (adiabetic, similar, constant'
'and ground connections). If these attributes are YES in the list'
'of boundary type toggles (choices c-h) then you will be asked for '
'confirmation. '
*enditem
        CALL EASKABC(' Topology Options:',' ','clear all topology',
        call askok('About to clear ALL contiguity.','Is this ok',
        call askok('Recover surface attribute data?',
        call askok(' ','Clear items marked SIMILAR?',M1OK,dok,6)
        call askok(' ','Clear items marked CONSTANT?',M2OK,dok,6)
        call askok(' ','Clear items marked GROUND?',M4OK,dok,6)
        call askok(' ','Clear items marked ADIABETIC?',M5OK,dok,6)
        call askok(' ','Clear items marked BASESIMP?',M6OK,dok,6)
        call askok(' ','Clear items marked IDENT_CEN?',M7OK,dok,6)
        call askok('Recover surface attribute data?',
        CALL EASKS(LCNN,' Updated surface connections file ?',' ',
        CALL EASKS(CFGFN,
        CALL EASKS(LCNN,' Updated surface connections file ?',' ',
*item EDCONN surface_corner_detect
'ESP-r provides two methods for scanning for geometric surface'
'matches - within the topology checking facility and in the surface'
'attribution [scan for nearby surfaces] option. Both check for a'
'number of tollerances vis-a-vis how close vertices are, how close'
'the angles between surface normals are, how close the COG of surfaces'
'are etc. If your model includes fine details and/or small surfaces'
'then changing to smaller tollerances helps to constrain the tests.'
*enditem
*subroutine CONFIG
*item CONFIG setting_up_topol
'The process of checking topology in a model usually involves all of'
'the zones in the model because there is a significant risk that if '
'you only do a portion of the model there may be inconsistencies'
'that are not identified.'
'  '
'You are given a few chances to halt the proces but if you do'
'it will probably leave the model in an inconsistent state.'
'  '
*enditem
      CALL EPICKS(ICPIC,ICVALS,' ',' Which zones to include: ',
      CALL ASKOK(outs,'(see help)',OK,dok,5)
*item CONFIG boundary_choices
'The boundary conditions at the other face of a surface is selected'
'from one of these choices.  The default is OUTSIDE.'
' '
' Exterior - the other face of the surface is exposed to ambient air'
'  temperature, wind and solar radiation.'
' '
' Dynamic/similar - the other face of the surface is exposed to the'
'  same conditions as the inside face. A dynamic/similar connection'
'  can include an offset temperature (C) and radiation (W/m^2).'
' '
' Static - requires that a constant temperature and radiation is'
'  supplied. You might use this to represent a cold storage room.'
' '
' Surface in another zone - the other face of the surface gets its'
'  boundary conditions from the last known state of the other surface.'
'  There is a thermophysical connection established between the zones.'
'  Usually you will also want to update the other zone surface.'
' '
' Ground (standard profile) - the other face of the surface is in'
'  direct contact with one of the standard monthly temperature'
'  profiles embedded in ESP-r.'
' '
' Ground (user defined profile) - the other face of the surface is'
'  in direct contact with a monthly profile previously created by'
'  the user (in the model context)'
' '
' Ground (3D conduction) - the other face connects to a 3D ground'
'  representation. This is not often used.'
' '
' Adiabatic boundary - typically used for back-to-back surfaces in'
'  a zone representing thermal mass. There is no heat flux passed'
'  beyond the other-face. '
' '
' BASESIMP is used to represent one of several basement configuration'
'  and precalculated patterns of heat transfer. For this to be useful'
'  there must be a basesimp file created for the zone giving a number'
'  of dimensions and computational parameters.'
' '
' CEN 13791 partition which is like the SIMILAR but for CEN 13791'
'  test. The offset temperauture and radiation (W/m^2) in SIMILAR'
'  is not available for the CEN 13791 partition type. For details see'
'  section 4.4.2 CEN 13791 standard. As it results in equal solar'
'  radiation on both sides of a partition it is [unrealistic] and'
'  thus not recommended for normal use.'
*enditem
                call MENUATOL(outs,' Connection options ',
                CALL EASKR(VAL,' ',' Constant temperature ? ',
                CALL EASKR(VAL2,' ',' Constant rad (W/m^2) ? ',
*item CONFIG boundary_ground
'A ground connection allows either:'
'> 0 a connection to one of several standard profiles in which'
'    case the profile number is required. A listing of the known'
'    profiles will be shown.'
'  '
'= 0 a connection to a user defined profile in which case a zero is'
'    followed by a user defined profile number is required.'
'  '
'-3  a connection to a 3D ground model.'
*enditem
  777             CALL EASKI(IIC2,' Monthly (standard) profile index?',
                    CALL EASKI(IIE2,
*item CONFIG boundary_basesimp
'Specify the BASESIMP configuration number (iconfig). Refer to '
'src/esp-r/esrubld/bscoeff.F for the correspondence between iconfig'
'and standard BASESIMP descriptors (e.g. BCIN_1). Also check the'
'ESRU web publications page for documents about BASESIMP.'
'  '
'BASESIMP is a [whole-foundation model]. Therefore, when a foundation'
'is represented by numerous ESP-r surfaces (e.g. four walls + floor'
'to represent a basement), you must specify the percentage of the'
'whole-foundation heat loss to attribute to each surface. Normally the'
'sum of surfaces representing a founcation is 100%.'
*enditem
                  CALL EASKI(Ifrac,
*item CONFIG multi_match_partn
'You asked to specify connection if a match was found to another'
'surface in the same room. '
'  '
'If there is more than ONE possible matching geometric connection'
'you are asked to confirm which one. Exercise care - the interface'
'does not tell you how many possible matches it will be showing you.'
*enditem
            CALL EASKABC('Matched surface within room:',' ',
            CALL ASKOK(outs,' Accept this? (see help)',OK,dok,5)
            CALL EASKABCD(' None of the suggestions taken:',' ',
*item CONFIG save_to_cnn_file
'At this point the zone geometry files will have updated surface'
'attributes. And the master connections list is still held in'
'memory and needs to be written out to filev or the model will be'
'inconsistent.'
' '
'This dialog allows you to save the master connections list to a'
'different file name (in case you do not want to overwrite the'
'existing file. '
*enditem
      CALL EASKS(LCNN,' Surface connections file name?',' ',
*subroutine ESACON
*item ESACON importing_surf_conn
'Even if some of the connections are incorrect in the master'
'list there may be some surface attributes are ok and can be'
'used so this facility allows you to selectively import the'
'existing surface attributes to help build the master connections'
'list.'
'  '
'There are a few places where a pause is inserted so that you'
'can confirm the data.'
' '
*enditem
          CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
          CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
          CALL EASKR(VAL,' ',' Constant temperature ? ',
          CALL EASKR(VAL2,' ',' Constant rad (W/m^2) ? ',
          CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON fill_out_ground
'A ground connection allows either:'
'> 0 a connection to one of several standard profiles in which'
'    case the profile number is required. A listing of the known'
'    profiles will be shown.'
'  '
'= 0 a connection to a user defined profile in which case a zero is'
'    followed by a user defined profile number is required.'
'  '
'-3  a connection to a 3D ground model.'
*enditem
          CALL EASKI(IVAL,' Monthly profile (0 = user defined) ? ',
            CALL EASKI(IVAL,' User defined profile: ',
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
*item ESACON boundary_basesimp
'Specify the BASESIMP configuration index. Refer to the source code'
'in src/esp-r/esrubld/bscoeff.F for the correspondence between'
'iconfig and standard BASESIMP descriptors (e.g. BCIN_1).'
'  '
'BASESIMP is a [whole-foundation model]. Therefore, when a foundation'
'is represented by numerous ESP-r surfaces (e.g. four walls + floor'
'to represent a basement), you must specify the percentage of the'
'whole-foundation heat loss to attribute to each surface. Normally the'
'sum of surfaces representing a founcation is 100%.'
*enditem
          CALL EASKI(Ifrac,
            CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
          CALL ASKOK(' ','Use this surface attribute?',OK,dok,1)
     CALL ASKOK(' ','Save updated topology?',OK,dok,3)
*subroutine anchor
*item anchor anchor_options
'Anchor points allow a user to line a number of items (such as'
'surfaces) to a concept so that global actions (such as attribution'
'or performance enquiries) can be undertaken. An achor point consists'
'of a name (12 char) for the concept and a list of item indices'
'and a type indicator. '
' '
'Anchor types set the context within which esp-r can manipulate items'
'associated with a named anchor. Details: '
' a general surface - supports actions such as changing'
'   attributes or graphing temperatures of a '
'   collection of surfaces).'
' '
'Tagging surfaces as possible openings or leakage paths in a flow'
'network:'
' b closed door - surface acts as or includes a closed door'
'   (or crack) between two flow nodes.'
' c open(able) door - surface acts as or includes an open door'
'   (perhaps controlled) between flow nodes.'
' d closed window - surface acts as/includes a closed window'
'   (or crack) between two flow nodes.'
' e open(able) window - surface acts as/includes a window'
'   (perhaps controlled) between flow nodes.'
' f closed grill - surface acts as/includes a closed grill'
'   (or crack) between two flow nodes.'
' g open(able) grill - surface includes an grill or vent'
'   (perhaps controlled) between two flow nodes.'
' h duct or pipe - surface inclues an duct or pipe between'
'   two flow nodes.'
' i fan or pump - surface near a fan or pump between two'
'   flow nodes.'
*enditem
        CALL PHELPD('anchor points',30,'-',0,0,IER)
        call easkconn(inpic,iconnpk,60,
        call askok('Edit anchor name or type?',' ',ok,dok,1)
        call MENUATOL('Select a type for the anchor:',
        CALL EASKS(AL,' Label for anchor: ',
        CALL EASKS(AL,'Label:',' ',12,'none','closed dr',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','open dr ',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','closd win',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','open win',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','closd grill',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','open grill',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','ductorpipe',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','fanorpump',IER,30)
        call askok('De-reference link(s) to this surface?',' ',
        call askok(outs,' ',okd,dok,1)
*subroutine anchlist
*item anchlist anchor_choices
'Anchor points allow a user to aline a number of items (such as'
'surfaces) to a concept so that global actions (such as attribution'
'or performance enquiries) can be undertaken. An anchor point'
'consists of name (12 char) for the concept plus a list of item'
'indices and a type indicator. '
' '
'Anchor types set the context within which esp-r can manipulate'
'items associated with an anchor. Details: '
' a general surface - supports actions such as changing'
'   attributes or graphing temperatures of a '
'   collection of surfaces).'
' '
'Tagging surfaces as possible openings or leakage paths in a flow'
'network:'
' b closed door - surface acts as or includes a closed door'
'   (or crack) between two flow nodes.'
' c open(able) door - surface acts as or includes an open door'
'   (perhaps controlled) between flow nodes.'
' d closed window - surface acts as/includes a closed window'
'   (or crack) between two flow nodes.'
' e open(able) window - surface acts as/includes a window'
'   (perhaps controlled) between flow nodes.'
' f closed grill - surface acts as/includes a closed grill'
'   (or crack) between two flow nodes.'
' g open(able) grill - surface includes an grill or vent'
'   (perhaps controlled) between two flow nodes.'
' h duct or pipe - surface inclues an duct or pipe between'
'   two flow nodes.'
' i fan or pump - surface near a fan or pump between two'
'   flow nodes.'
*enditem
        CALL PHELPD('anchor points',30,'-',0,0,IER)
        CALL EASKABC('Anchor point options:',' ',
        call MENUATOL('Select a type for the anchor:',
        CALL EASKS(AL,' Label for anchor: ',
        CALL EASKS(AL,'Label:',' ',12,'none','closed dr',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','open dr ',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','closd win',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','open win',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','closd grill',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','open grill',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','ductorpipe',IER,30)
        CALL EASKS(AL,'Label:',' ',12,'none','fanorpump',IER,30)
*subroutine procgdst
*item procgdst interactive_ipv
'Interactive mode uses simulation parameters as defaults. The'
'silent running mode uses the parameters to run in automatic mode.'
*enditem
        CALL EASKAB('Simulation interaction options: (see help)',
*subroutine serchrpl
*item serchrpl search_constructions
'Often it is convenient to search a model for one constructional '
'attribute and replace this by another. You can do this by searching'
'for occurances of a particular construction or by selecting an anchor'
'point (with an associated list of surfaces) to apply the new'
'attribute to.'
' '
'In the first method, choose the construction to search for and then'
'its replacement (you will be asked to confirm each replacement'
' '
'In the 2nd method, choose an anchor point and then the substitute'
'construction. '
' '
'NOTE: After using the search & replace facility one construction'
'files should be rebuilt for the new attributes to take effect. '
'  '
'A search & replace only changes the surface attribute, it does'
'not update the raw thermophysical data held in the zone construction'
'files. It is recommended that you also update the zone files. '
'  '
'Often it is convenient to supply surface constructional' attribution
'by globally applying a material to a subset of surfaces and then'
'attend to exceptions.'
'  '
'In the gloal seach and replace you can restric the updating to'
'surfaces which fit a specific type like opaque surfaces or surfaces'
'which face specific boundary conditions.'
'  '
'NOTE: After using the global attribution facility you must then'
'rebuild the zone construction files for the new attributes to take'
'effect. '
*enditem
        CALL PHELPD('global attributions',17,'-',0,0,IER)
        CALL EASKABC(' Surfaces to update:',' ',
*subroutine SCRZONE
*item SCRZONE zone_name
'The zone name is used for selection and bookkeeping purposes.'
'It should be unique, be less than 12 characters and no spaces.'
'  '
'The zone description allows further information about the zone form'
'and composition and use to be recorded (<64 characters).'
*enditem
      CALL EASKS(ZN,'New zone description?','(<12 chars, no spaces)',
 43   CALL EASKS(zd,'What does it represent?','(<64 characters)',
*item SCRZONE zone_initial_shapes
'You have the option to describe zone geometry as an extruded'
'rectangle, a floor plan extrusion or a general polyhedra. Keeping'
'the geometry as simple as possible will simplify the constructional'
'attribution and result interpretation tasks.'
' '
'Points from a bitmap:                  '
' Zone geometry can be defined by taking points from a scanned image'
' of a site plan or floor plan.         '
'                  '
' To do this you need to scan the relevant source and then convert it'
' to an XBM (X11 monochrome bitmap) file, which should be placed in the'
' project [cfg] folder.'
' '
' Please ensure that the bitmap is large enough to allow for'
' accurate positioning of the mouse. The bitmap can be larger than'
' the graphic display area (say up to 1600 x 1000 pixels, and where'
' it is you can pan left/right and up/down to see more of it.'
'                  '
' The source image should have indications on it of an origin'
' (typically X=0.0 Y=0.0), the North direction and a line of known'
' length (to get scaling from).'
*enditem
      CALL EASKABCD(' ','Base zone geometry on:',
*item SCRZONE zone_initial_rect
'The specification of a rectangular extrusion requires the user'
'enter an origin (relative to the site coordinate system, and a'
'length, depth and height.'
'  '
'Assuming there is no rotation, the length dimension is along'
'the X axis, the depth dimension is along the Y axis and the'
'height dimension is along the Z axis.'
'  '
'The rectangle may then be rotated by an angle measured'
'from the X axis and the length side of the rectangle,'
'anticlockwise positive about the Z axis.'
'  '
'Elevation is the angle between the length (DX) side of the'
'rectangle and the horizon, +ve is an upwards incline and -ve'
'is a downwards incline. Zero results in a standard horizontal base.'
*enditem
        CALL EASKS(HOLD,' ','Origin X,Y,Z?',
        CALL EASKS(HOLD,' ','Rectangle length, width and height?',
        CALL EASKR(ANGR,' ','Rectangle orientation?',
        CALL EASKR(ANGE,' ','Rectangle elevation (see help)?',
*item SCRZONE zone_initial_extrude
'A zone created from an extruded plan requires the following:'
'  '
'The base surface (probably floor) height relative to the'
'site coordinate system.'
'  '
'The top surface (probably ceiling) height relative to the site'
'coordinate system. Note that this is not necessarily the same'
'as the base-top distance!'
'  '
'The number of walls excluding the base and the top. Think about'
'this - each boundary condition requires a separate surface so'
'a long partition which connects with two other zones needs to be'
'two separate surfaces. Easier to do this in the initial planning'
'than to split the surface later.'
'  '
'The coordinates should be entered in anti-clockwise order when'
'viewed from the top. The specific starting point is not all that'
'important - if you follow a consistent pattern it make make model'
'quality checking easier.'
'  '
'If you have ANY DOUBT as to whether you entered the correct vertex'
'coordinates you can save time by respecifying them now. Usually'
'this takes less time than trying to correct problems later.'
'  '
'After accepting the vertices you are asked if you want to rotate'
'the zone around the 1st vertex of the zone (anticlockwise is'
'positive.'
*enditem
        CALL EASKR(Z1,' ','Z value of the base surface?',
        CALL EASKR(Z2,' ','Z value of the top surface?',
        CALL EASKI(NW,' ','Number of walls?',
          CALL EASKS(HOLD,OUTSTR,'  ',32,' 0.  0.  ','floor xy',IER,2)
        CALL ASKOK(' ','Accept base vertices?',OK,dok,4)
        CALL EASKR(AR,' ','Rotation angle?',
*item SCRZONE zone_initial_polyhedra
'A general polyhedra is appropriate for complex shapes.'
'A set of vertices is defined and then linked together to'
'form surfaces that bound the zone. Vertices are linked'
'anti-clockwise when viewed from outside the zone. It is'
'convention to start at the lower left vertex.'
' '
'After you supply the zone origin, a 2m x 2m initial (floor)'
'surface will be placed there. These vertices may then be'
'modified and new ones added/linked to create the enclosed zone.'
'Initial warning messages may be ignored. These will cease after'
'you have defined a bounded zone. The initial surface may be'
'deleted if no longer needed.'
'  '
'Another use of general polyhedra is where the form of the zone'
'is best described by extrusion of a wall. In this case you create'
'the initial surface and then use the [extrude-from] option in'
'the surface topology menu to extrude sides and an end from the'
'initial surface.'
*enditem
        CALL PHELPD('gen start popup',15,'-',0,0,IER)
        CALL EASKS(HOLD,' ','Origin X Y Z?',
*item SCRZONE zone_initial_write
'When attempting to write the geometry a problem was encountered.'
'Check that you have permission to write this type of file and that'
'you have sufficient disk space.'
*enditem
        CALL ASKOK('Problem creating geometry file.','Try again?',
*subroutine NEWZONE
*item NEWZONE zone_source_files
'You may read in an existing ESP-r zone geometry file (e.g. copied'
'from another ESP-r model), convert a cflow3/IES zip file into one'
'or more zones (i.e. whole model conversion) or create a zone by'
'inputing data related to one of the primitive initial shapes. '
'  '
'If you asked for an existing file and there was no existing geometry'
'file found in the ../zones folder then you must supply'
'a file name. It should be relative to the cfg folder.'
' '
'NOTE: it is assumed that the zone geometry file that you'
'specify to read is not one that is NOT already used in your'
'model! Otherwise the Project Manager may get confused because'
'two zones point to the same file and have the same name! '
'  '
'NOTE: a cflow3/IES zip file is NOT a DXF file. If you want to'
'import DXF use the Model Management -> import CAD file facility.'
' '
'Check the zone name after you have loaded the existing zone'
'geometry file to make sure it is unique. '
*enditem
      CALL EASKABCD(' ','New zone options:','input dimensions',
      CALL EASKS(LTMP,OUTSTR,' ',72,DFILE,'geom file',IER,8)
      CALL ASKOK(' ','Geometry file not found, try again?',OK,
      CALL ASKOK(OUTSTR,
*item NEWZONE zone_also_schedules
'If you are extending a model via the use of existing zone geometry'
'files you might also have existing zone schedules to reference. You'
'can do that here. '
'  '
'If there was not existing operations file found in the ../zones'
'folder then you must supply a file name which is relative to the'
'model cfg folder. '
*enditem
        CALL ASKOK(' ','Also use an existing operation file?',OK,dok,3)
 295    CALL EASKS(LTMP,OUTSTR,' ',72,DFILE,'opr file',IER,3)
        CALL ASKOK(' ','Operations file not found, try again?',
*item NEWZONE zone_also_constructions
'If you are extending a model via the use of existing zone geometry'
'files you might also have existing zone constructions to reference.'
'You can do that here. '
'  '
'If there was not existing constructions file found in the ../zones'
'folder then you must supply a file name that is relative to the'
'model cfg folder. '
*enditem
        CALL ASKOK(' ','Also use an existing constructions file? ',
 297    CALL EASKS(LTMP,OUTSTR,' ',72,DFILE,'constr file',IER,3)
        CALL ASKOK(' ','Constructions file not found, try again?',
*item NEWZONE zone_also_zip_source
'If there is no existing zip geometry file found in the ../zones'
'folder then you must supply a file name including a path relative'
'to the cfg folder.'
*enditem
 396    CALL EASKS(LTMP,' ',OUTSTR,72,DFILE,'zip file',IER,3)
        CALL ASKOK('Zip file not found!','Try again?',OK,
        CALL ASKOK('Problem scanning CAD file!',
*item NEWZONE after_predef_warning
'After importing a predefined zone object its bounding surfaces'
'will have been set to indicate not-defined-yet. Please use either'
'the surface attribute facility to set the boundary conditions or'
'request a topology check to set the boundary conditions.'
' '
'Next double check the composition of the surfaces in the new zone'
'to ensure they are appropriate.'
' '
'Check the documentation for the predefined object to see if it'
'suggests other post-processing tasks. There may be additional'
'predefined objects that should be used for multi-zone entities.' 
*enditem
*subroutine DELZONE
*item DELZONE zone_delete_warning
'                  - W A R N I N G - '
'Because of the many inter-connections within a model, the '
'removal of a zone requires a number of steps and you will'
'be asked to confirm several actions to resolve dependencies.'
'  '
'If ventilation definitions or controls in zone operation files'
'point to the zone-to-be-deleted you will be asked what to do.'
'If control loops reference the zone-to-be-deleted then you'
'will be asked if you want to delete the control loop.'
'  '
'Other zones which have surfaces which point to this zone will'
'have their attributes reset to UNKNOWN.'
'  '
'You will also be asked if you want to delete the zone files'
'associated with the zone-to-delete.'
'  '
'Upon completion, carefully review the model to ensure that'
'the new inter-connections are appropriate. '
'  '
'If in doubt ARCHIVE of the model before embarking on a'
'major restructuring - there is no [undo] command! '
*enditem
      CALL ASKOK(outs,'(see help)',OK,dok,10)
*item DELZONE zone_delete_net_node
'A linked network ventilation node will take the current zone'
'temperature during assessments. If, after deleting a zone,'
'the link points to a non-existant zone then flows may not be'
'correctly predicted. Unlinking will result in the node using'
'a fixed temperature during assessments.'
'  '
'Because a node may have several connections within the network'
'you must edit the network to remove such links before it can be'
'removed. '
*enditem
              CALL ASKOK(outs,'Remove this link? (see help)',OK,DOK,9)
*item DELZONE zone_delete_control
'The system control file holds the definition of all of the'
'building/plant controls.  This file is optional but if it exists'
'in your model it should be updated.'
'  '
'The removal of a zone may result in zone or ventilation'
'control loops which specifically sense the removed zone'
'causing incorrect assessments. Also references to subsequent'
'zones in control loops need to be adjusted.'
'  '
'If a control loop sensor references the deleted zone then'
'you should probably remove the control loop (say yes). Otherwise'
'make sure to edit the control loop to sense something that'
'exists.'
*enditem
        CALL ASKOK(' System zone-based controls should also be',
        CALL ASKOK(' System zone-based controls should also be',
        CALL EASKS(ltmp,' Control file ? ',
        CALL ASKOK(outs,' Remove this control loop?',OK,DOK,2)
*item DELZONE zone_delete_net_control
'The network flow control sensor or actuator references this'
'specific zone (as the source of air). You should remove the'
'ventilation control (say yes) or ensure that you revise the'
'control to point to an air source that exists.'
*enditem
                  CALL ASKOK(outs,' Remove this control loop?',OK,DOK,2)
*item DELZONE zone_delete_cfc_control
'The complex fenistration control sensor or actuator references'
'his specific zone. You should remove the control (say yes) or'
'ensure that you revise the control to point to a zone that exists.'
*enditem
                  CALL ASKOK(outs,' Remove this control loop?',OK,DOK,2)
*item DELZONE zone_delete_files
'You can de-reference a zone in the current model, and you have the'
'option to also remove the zone files. If you might have a use for the'
'files later keep them. '
*enditem
      CALL ASKOK(' In addition to de-referencing this zone do you',
*item DELZONE zone_net_delete_warning
'                 - W A R N I N G - '
'Ventilation network nodes linked to the deleted zone have been'
'unlinked (i.e. they are assumed to be at a static temperature).'
'If connections related to this node need to be revised use'
'the ventilation network facility.'
*enditem
        CALL PHELPD('mfs update popup',6,'-',0,0,IER)
*item DELZONE zone_ctl_delete_warning
'             - W A R N I N G - '
'Links to the deleted zone by zone and/or ventilation control loops'
'have been adjusted and are being saved.'
*enditem
        CALL PHELPD('control update popup',3,'-',0,0,IER)
*item DELZONE zone_delete_update_cfg
'The updated model description (with dependencies of the deleted'
'zone sorted out) will be placed into this model cfg file. Some'
'users prefer to rename model cfg files after such changes.'
*enditem
 49   CALL EASKS(ltmp,' Updated configuration file? ',
*subroutine WARNMOD
*subroutine SUMRCHG
*item SUMRCHG change_for_shading
'Shading should be recalculated if the changes you made affect'
'isolation distribution. When in doubt it is best to recalculate.'
*enditem
          CALL EASKABC(' Reflect zone change in shading options:',' ',
*item SUMRCHG change_for_constructions
'Zone construction files should be rebuilt after surface'
'attributes change or surfaces are added or deleted. '
*enditem
        CALL ASKOK('Update the zone construction and/ or TMC and/ or',
*subroutine ELECNET
*item ELECNET elec_net_pre_warning
'You have picked electrical network definition. This network'
'is best created after both the plant and building side have'
'been fully defined as power loads in each zone and plant'
'components can be connected to the electrical network.'
' '
'If you have not defined the building and plant yet then'
'you are advised to exit this section.'
'  '
'If you proceed you will be asked if you want to see a synopsis'
'of the current electrical network (if it exists).'
*enditem
      CALL ASKOK(' ','Proceed with electrical network definition?',
      CALL ASKOK(OUTS,
*item ELECNET elec_net_menu
'This part of the Project Manager allows you to define an electrical'
'network, which can be simulated in tandem with your building/plant/'
'flow model. The electrical network consists of several elements:'
' '
'NODES - these are the calculation points in the network and should'
'be placed where conductors join, or where loads or power sources'
'connect to the network. In multi-phase systems, multi-phase nodes'
'are grouped in phase-sets, one node of the set represents a phase.'
' '
'CONNECTING COMPONENTS - these convey electrical current between'
'the nodes in the network. They are impedance models of the '
'distribution components in an electrical system: lines, cables,'
'transformers. In addition to conveying power, the transformer'
'component also changes the voltage between two nodes.'
' '
'HVAC/PV/LIGHTS/EQUIPMENT and POWER-ONLY COMPONENTS - these link'
'into the network and either draw power from or inject power into'
'the network. HVAC components etc. are components which exist in'
'other areas of your model, i.e. lighting loads a PV array or a fan.'
'Power-only components exist only in the electrical world e.g. '
'a wind turbine or a diesel generator set.'
' '
'CONNECTIONS - these link the entire network together. A connection'
'links two or more nodes using a connecting component, connections'
'can be multi-phase, single-phase d.c. or balanced. Single phase'
'components can be used in the connection of multi-phase sets of'
'nodes but not vice versa. Phase-set nodes can be linked to single '
'nodes, but only if the phase numbers of the connected nodes'
'match. An a.c. to d.c. connection is possible, but only with'
'AC/DC conversion devices.'
' '
'The complete NETWORK consists of all the above elements connected'
'together. Other information required includes the type of network:'
'a.c., d.c., mixed or balanced plus BASE VALUES of voltage and power.'
'These are needed as network solution is done in PER UNIT notation.'
'Voltage base values for each node are generated automatically.'
'If required you can enter a short description of your electrical'
'network here.
'  '
' option a: the name of the eletrical network file'
'  '
' option b: user supplied description of the network'
'  '
' option c: type of network:                            '
'   d.c      - direct current only'
'   1,2,3    - phase a.c. only '
'   Balanced - a balanced 3-phase system '
'   Mixed    - Mix of 1,2,3-phase elements and possibly d.c.'
'                         <the default> '
'  '
' option i: phase angles in the time domain e.g. 3 phase is'
'   a 120 degree phase angle
*enditem
        CALL EASKS(ENDESC,'The electrical network description:',' ',
        CALL EASKATOG('Select network type:',' ',
*item ELECNET elec_net_phase_angle
'The phase angles for the system are the phase in the time'
'domain in which each phase in the system operates where the'
'difference in each phase angle is given by 360/No. of phases.'
'So for a three phase system the phase angles should separated'
'by 120 degrees.          '
*enditem
        CALL EASKS(STR,'Enter the phase angle for each network phase.',
*item ELECNET elec_net_base_power
'The base power value is used in the conversion of all network '
'power values to per-unit, where the per-unit power is defined by:'
'  Pp.u.=Actual Power/Base Power'
'  '
'Choose a value that reflects the size of the power system being'
'modelled, e.g:                            '
'  1000    - small offices or dwellings                   '
'  10000   - medium sized buildings, small communities    '
'  1000000 - large CHP or community energy schemes        '
'  '
'For multi-phase system enter the multi-phase base value e.g.'
'for a three-phase system the three-phase base value should be'
'entered. The system base value will be this value divided by three.'
*enditem
        CALL EASKR(ENODBASEP,'Enter the system base power value (VA)',
*item ELECNET elec_net_base_volt
'If you have the required support information you may proceed with'
'the base voltage calculation.'
*enditem
          CALL ASKOK(' ','Proceed with base voltage calculation?',
*item ELECNET elec_net_request_save
'Recent changes are held in memory and may be lost if you do not'
'save them to file. '
*enditem
        CALL ASKOK('Save any changes you have made?',' ',OK,dok,2)
*subroutine ELNODLST
*item ELNODLST elec_net_mode_e
'The list shows the currently available nodes in the electrical'
'network. Click in a node to edit it or choose to add/delete/copy'
'a node.'
*enditem
*item ELNODLST elec_net_mode
'The list shows the currently available nodes in the electrical'
'network. Please select one from the list displayed.'
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
        CALL EASKABCD('Select option or continue',' ','Add node',
*subroutine ELHYBLST
*item ELHYBLST hybrid_elec_net_mode_e
'The list shows the HVAC, PV, lights, etc,. connected to the electrical'
'network. Please select one from the list or choose to add/delete/copy'
'a component. '
*enditem
*item ELHYBLST hybrid_elec_net_mode
'The list shows the HVAC, PV, lights, etc., connected to the '
'electrical network. Please select one from the list displayed.'
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
        CALL EASKABCD('Select option or continue',' ',
*subroutine ELPOWLST
*item ELPOWLST elec_net_power_mode_e
'The list shows the available power only components in the electrical'
'network. Click on one to edit it or chose to add/delete/copy a'
'component.'
*enditem
*item ELPOWLST elec_net_power_mode
'The list shows the available power only components in the'
'electrical network. Please select one from the list displayed.'
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
        CALL EASKABCD('Select option or continue',' ',
*subroutine ELCNCLST
*item ELCNCLST elec_net_connect_e
'The list shows the current connecting components in the'
'electrical network. Click on one to edit it or chose to'
'add/delete/copy a component.'
*enditem
*item ELCNCLST elec_net_connect
'The list shows the current connecting components in the'
'electrical network. Please select one from the list displayed.'
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
        CALL EASKABCD('Select option or continue',' ',
*subroutine ELCONLST
*item ELCONLST elec_connections_e
'The list shows the currently defined connections in the'
'electrical network. Click on one to edit it or chose to'
'add/delete/copy a component.'
*enditem
*item ELCONLST elec_connections
'The list shows the currently defined connections in the'
'electrical network. Please select one from the list displayed.'
*enditem
        CALL PHELPD('Select node',3,'-',0,0,IER)
        CALL EASKABCD('Select option or continue',' ',
*subroutine EDENOD
*item EDENOD elec_net_edit_node
'The user has the option to add up to three nodes depending'
'on the nature of the point in the network being modelled:                             '
'  1 - a one phase or balanced system node             '
'  2 - a two phase point in the network                '
'  3 - a three phase point in the network              '
'  '
'Points of more than one phase in an a.c. system are described'
'by a [multi-phase set] of 2-3 nodes, each of the form:'
'   root_name_phase_extension.             '
'For example: generator_1, generator_2, generator_3 '
'or lighting_1, lighting_2 or fan_1, fan_3, etc.    '
*enditem
        CALL EASKATOG
*item EDENOD elec_net_node_type
'The voltage type specifies whether the nodal voltage is fixed'
'by the user or calculated during the simulation. Generally'
'nodal voltages should be calculated; however, those connected'
'to the grid or a large power source can be considered as fixed.'
'Three methods are available for calculating nodal voltages:'
'  - [Variable] means that the voltage is determined '
'    by the solution of the power flow matrix of eqs.'
'  - [PV] means that the voltage is calculated by    '
'     the buiding domain`s PV model.                 '
'  - [Plant] means that the voltage is calculated by '
'    a component in the plant domain.                '
*enditem
            CALL EASKABCD('What is the node type?',' ',
*item EDENOD elec_net_watsun
'Only the original esp-r PV model or a type 5 WATSUN-PV can be used.'
*enditem
                    CALL ASKOK(
*item EDENOD elec_net_invalid
'Please select a valid component. If you say no then it gets'
'you out of the question loop.'
*enditem
                  CALL ASKOK('No special material component picked.',
*item EDENOD elec_net_duplicate
'Enter a 12 char or less name for the node. Do not duplicate
'names. If the node is one of a multi-phase set then the'
'name will be the root name.'
*enditem
            CALL EASKS(SHSTR,
            CALL EASKS(SHSTR(1:10),
*item EDENOD elec_net_node_phase
'Specify which phase of the electrical network the node is'
'associated with. Note, for balanced and d.c. nodes simply'
'specify 1.'
'  '
'NOTE: two nodes in a multi-phase set cannot have the'
'same phase! '
*enditem
            CALL EASKI(ENODPH(IENOD),OUTS,' ',1,'F',5,'F',
            CALL EASKI(ENODPH(IENOD),OUTS,' ',1,'F',5,'F',
*item EDENOD elec_net_node_delete
'When deleting a node any connections assoctated with that node'
'must also be deleted. Also if the node is part of a multi-phase'
'set then the other members of that set must also be deleted.'
'  '
'These deletions are done automatically. Any linkages to power'
'only components or hybrid components are nulled.'
*enditem
        CALL ASKOK(OUTS,' ',OK,dok,6)
*item EDENOD elec_net_continue_if
'A chance to continue if wrong node selected. '
*enditem
        CALL ASKOK('Edit this node?',' ',OK,dok,1)
*item EDENOD elec_net_edit_name
'Enter a 12 char or less name for the node. Do not duplicate'
'names. If the node is one of a multi-phase set then'
'this name will be the root name.           '
' '
'Editing of nodal data is restricted to altering the component'
'name and the nodal type. If the phase type or phase number'
'needs to be changed then please delete the node and create'
'a new one with the desired properties.    '
*enditem
        CALL EASKS(SHSTR(1:ISTRL),
*item EDENOD elec_net_new_node_type
'The voltage type specifies whether the nodal voltageis fixed'
'by the user or calculated during the simulation. Generally'
'nodal voltages should be calculated; however, those connected'
'to the grid or a large power source can be considered as fixed.'
'  '
'Three methods are available for calculating nodal voltages: '
'  '
'  - [Variable] means that the voltage is determined  '
'    by the solution of the power flow matrix of eqs. '
'  - [PV] means that the voltage is calculated by     '
'     the buiding domain`s PV model.                  '
'  - [Plant] means that the voltage is calculated by  '
'    a component in the plant domain.                 '
*enditem
        CALL EASKABCD('What is the node type?',' ',
*item EDENOD elec_net_root_name
'Give the copied node a unique name or root name.'
*enditem
        CALL EASKS(SHSTR,
*subroutine EDEHYB
*item EDEHYB elec_net_beam_me_up
'A chance to continue without editing component. '
*enditem
          CALL ASKOK('Edit this component?',' ',OK,dok,1)
*item EDEHYB elec_net_attach_loads
'You can attach electrical loads and power sources to the'
'electrical network. Please select the type of component '
'you wish to attach: '
'- a zone-side electrical load i.e. lighting;'
'- a plant-side electrical load i.e. pump;   '
'- a pv material in the building facade.     '
'  '
'Note if none of these elements exist in the model '
'already, you will not be able to attach anything.'
*enditem
        CALL EASKABCD('Add which type of component ?',' ',
*item EDEHYB elec_net_opr_no_data
'The zone operation file selected did not contain any eletrical'
'data. You can select another zone.'
*enditem
             CALL ASKOK('Zone has no electrical loads',
*item EDEHYB elec_net_opr_type
'Each user specified gain type in each zone can be associated'
'with a node in the electrical network. '
'  '
'The cumulative power consumption of all the gains of that type'
'(both absolute and per m2) is then attributed to the node;'
'provided load electrical data has been specified.'
*enditem
 16       CALL EASKABCD('What is the type of load do',
*item EDEHYB elec_net_select_again
'ESP-r expected you to have selected a component and so here'
'is your chance to try again. '
*enditem
            CALL ASKOK(outs,'to the network. Try again?',OK,dok,2)
*item EDEHYB elec_net_select_phase
'Please select the phase type of this component from the list.'
*enditem
          CALL EPICKS(IX,IVALS,'Which phase type',
*item EDEHYB elec_net_no_overwrite
'Here is your chance to continue without over-writing the node'
'already referencing this phase.'
*enditem
              CALL ASKOK(OUTS,'Overwrite it?', OK,dok,2)
*item EDEHYB elec_net_select_ac_dc
'Please select a different nodes for AC and DC. Say no to get'
'you out of the question loop.'
*enditem
              call askok(
*item EDEHYB elec_component_name
'Supply a name for the component (12 char no blanks).'
*enditem
        CALL EASKS(SHSTR,
*item EDEHYB elec_component_descr
'A description (up to 72 char) can be given to clarify the nature'
'of the component within the network or its attributes.'
*enditem
        CALL EASKS(LNGSTR,
*subroutine EDEPOW
*item EDEPOW elec_net_beam_me_up
'Chance to continue without editing the component.'
*enditem
          CALL ASKOK('Edit this component?',' ',OK,dok,1)
*item EDEPOW elec_power_comp_menu
'The menu options relate to different categories of power-'
'only components which may be selected for connection to'
'the electrical network       '
'Select a category'
*enditem
          CALL PHELPD('Power-only comp.',4,'-',0,0,IER)
*item EDEPOW elec_power_comp_add
'Select a power-only component from the list. Each one'
'shown is associated with a set of pre-defined [arameters,'
'these can be altered if required. '
'  '
'Switching the [additional info] toggle to ON lets the'
'user view any more information associted with the component;  '
'this appears in the text window. '
*enditem
            CALL PHELPD('Special material',8,'-',0,0,IER)
*item EDEPOW elec_net_component_name
'Each power component has a short name (12 char no blanks)'
'for use in selection and bookkeepping.'
*enditem
 99     CALL EASKS(SHSTR,' ',' name for component ?',12,
*item EDEPOW elec_net_component_desc
'Each power component has a descriptive string (< 72 char)'
'which can be used to document its attributes or purpose.'
*enditem
        CALL EASKS(LNGSTR,'You can take this oportunity to ',
*item EDEPOW elec_net_component_data
'Enter the required data for the power only component. '
'Either accept the default values or enter your own'
'data.                                             '
*enditem
        CALL PHELPD('Power comp data',3,'-',0,0,IER)
        CALL EASKI(NPOWCDAT(IEPOW),' ',' Number of data items ?',1,'-',
        CALL EASKR(DATSP,OUTS,' ',1.,'-',99.,'-',1.0,'SPM data',
        CALL EASKI(NPOWCDATS(IEPOW),' ','Number of string data items ?',
        CALL PHELPD('Power comp data',3,'-',0,0,IER)
        CALL EASKS(DATSTR,OUTS,' ',72,'UNKNOWN',' pow str',IER,0)
*item EDEPOW elec_net_select_phase
'Please select the phase type of this component from the list.'
*enditem
          CALL EPICKS(IX,IVALS,'Which phase type',
*item EDEPOW elec_net_no_overwrite
'Here is your chance to continue without over-writing the node;
'already referencing this phase.'
*enditem
              CALL ASKOK(
*item EDEPOW elec_net_send_receive
'Please select different nodes for sending and receiving. Say no'
'to get out of the question loop.'
*enditem
              CALL ASKOK(
*subroutine EDECNC
*item EDECNC elec_net_beam_me_up
'Chance to continue without editing the component.'
*enditem
          CALL ASKOK('Edit this component?',' ',OK,dok,1)
*item EDECNC elec_connecting_menu
'The menu options relate to different categories of connecting'
'components which may be selected for connection to the'
'electrical network. Select a category:'
*enditem
          CALL PHELPD('Power-only comp.',4,'-',0,0,IER)
*item EDECNC elec_connecting_add
'Select a connecting component from the list. Each one shown'
'is associated with a set of pre-defined parameters, these can'
'be altered if required. '
'  '
'Switching the [additional info] toggle to ON lets the user'
'view any more information associted with the component,'
'this appears in the text window. '
*enditem
            CALL PHELPD('Connecting component',8,'-',0,0,IER)
*item EDECNC elec_connecting_name
'Components used for connecting have a short name of up to'
'12 characters (no blanks) for use in selection lists and'
'reports.'
*enditem
  99    CALL EASKS(SHSTR,' ',' name for component ?',12,
*item EDECNC elec_connecting_desc
'Components used for connecting have a descriptive string'
'of up to 72 char for use in clarifying their use or their'
'context in the network.'
*enditem
        CALL EASKS(LNGSTR,'You can take this oportunity to',
*item EDECNC elec_connecting_data
'Enter the required data for the power only component. '
'Either accept the default values or enter your own'
'data.                                             '
*enditem
        CALL PHELPD('Power comp data',3,'-',0,0,IER)
        CALL EASKI(NCONECOMDAT(IECNC),' ',' Number of data items ?',1,
            CALL EASKR(DATSP,OUTS,' ',1.,'-',99.,'-',1.0,'cnc data',
*item EDECNC elec_connecting_phase
'Please select the phase type of this component from the list.'
*enditem
        CALL EPICKS(IX,IVALS,'Which phase type',
*item EDECNC elec_connecting_delete
'If a conecting component is deleted, the connections containing this'
'component must also be deleted.      '
*enditem
        CALL ASKOK('Delete connections containing this component?',
*subroutine EDECON
*item EDECON elec_net_beam_me_up
'Chance to continue without editing the connection.'
*enditem
          CALL ASKOK('Do you want to edit this connection?',' ',
*item EDECON elec_net_2nd_chance
'This is a chance to correct this error.'
*enditem
          CALL ASKOK('You cannot connect a node to itself.',
          CALL ASKOK('You cannot connect nodes of different',
          CALL ASKOK('You can only connect a BALANCED connector to',
          CALL ASKOK('You can only connect a DC connector to',
          CALL ASKOK(
          CALL ASKOK(
*item EDECON elec_net_2_to_3
'As you are connecting a two phase component to a three phase'
'set, the program needs to know which phase combination the'
'component connects. For example 1 and 2, 2 and 3 or 1 and 3.            '
'please pick the other phase.                    '
*enditem
 50       CALL EASKABCD('Which other phase of the three-phases does',
*subroutine ENETBASEV
*item ENETBASEV elec_net_one_voltage
'In order to set the network base voltage values of the network'
'you must define at least one voltage in the network, usually one'
'which attaches to the grid and/or has a fixed voltage. The other'
'base voltage values will then be automatically calculated .                             '
*enditem
      CALL PHELPD('Set base value',5,'-',0,0,IER)
*item ENETBASEV elec_net_2nd_chance
'This is your chance to correct this error. '
*enditem
        CALL ASKOK('Warning: this is NOT a node with a fixed ',
      CALL EASKR(ENODBASEV(IENODPK),'Base voltage (V) for ',
*subroutine EDTITEM
*item EDTITEM temporal_static_menu
'This display includes static and temporal information about'
'this temporal item.  The menu entries proceeded by a key'
'character may be edited. To edit an item, select it and'
'follow the prompts supplied.  Fields are filled with '
'default values for a new instance. '
' '
'Use the ! option to focus the graph on a shorter period.'
' '
'You can also use the ! option to import raw data from a file'
'of column data previously setup in the [preferences] menu.'
'Once the data is imported the display will updated.
' '
'Use the page option to jump to other periods.'
' '
*enditem
        CALL PHELPD('static fields',10+NHELP,'-',0,0,IER)
*item EDTITEM temporal_graph_menu
'You can graph the current day or a sequence of days or the'
'whole period. '
' '
'You can insert column data (from a text file of column data'
'beginning at the startor at some timestep. '
' '
'You can insert static values (from a text file of data listed'
'sequentially. '
'  '
'You can also automatically insert UK National Calculation'
'Methodology Activity (operations) data '
*enditem
          CALL PHELPD('data options',10,'-',0,0,IER)
          CALL EASKPER('Display period:',igbdoy,igedoy,IFDAY,IER)
*item EDTITEM temporal_timestep_import
'These options allow you to set the timestep within the'
'temporal file where the data you are importing is to be inserted.'
' '
' start @ timestep one - this is the initial timestep of the'
'    temporal file. If the temporal file begins on the first'
'    day of February the data will be inserted from this point.'
' '
' start @ other timestep - use this if you want to begin inserting'
'   the data at a different point in the temporal file.'
'   For example if you want the imported data to write on the third'
'   day of the temporal file you would use the timestep '
'   X = 24 * frequency * 3 '
' '
'Later you will be asked to specify what line of the data inport'
'file to begin reading from (e.g. if there are labels or not-relevant'
'data then you can skip such lines at the beginning of the import'
'file. '
' '
'These timing relationships might take a few trys to get sorted.'
'It works best if you work out what you want to do on paper first'
'and try importing data several times until the process is
'established.'
*enditem
          CALL EASKABC('Import data options: ','(see help)',
*item EDTITEM temporal_import_source
'One import source file will be assumed throughout this sesion.'
'If this needs to be altered then the user should return to'
'this menu to give the new name.'
*enditem
          CALL EASKS(tfile,' Import file name? ',
*item EDTITEM temporal_unique_id
'In order to find items in the TDF db a unique id must be assigned'
'to each item. This id is a character string up to 12 characters'
'long with no blanks.'
*enditem
        CALL EASKS(TTAG,' ',' Unique id string? ',
*item EDTITEM temporal_unique_menu
'This is your chance to verbosely identify this item of the'
'temporal db (up to 36 char). Word of advice: giving a good'
'description may save your sanity at a future date.'
*enditem
        CALL EASKS(TTAIDE,' ',' Item description ',
*subroutine STRTIM
*subroutine EDIMPT
*item EDIMPT temporal_import_param
'This display allows the user to specify parameters which controls'
'the importation of data into this temporal file.'
' '
'One import source file will be assumed throughout this session.'
'If this needs to be altered then the user should return to this'
'menu to give the new name.'
'  '
'The import file is assumed to be an ASCII file and to contain'
'column data (there can be a header or other text at the start'
'of the file which you can skip over).'
' '
'After supplying the name of the file of column data that you want'
'to import (space or comma or tab separated) you can view the initial'
'lines of the file to confirm which columns the relevant data is in'
'as well as how many lines (if any) to ignore at the start of the file.'
'If the file name is not local, specify the whole path. '
' '
'If the column data file includes information prior to the point in'
'time that you are interested in you can use the [bein reading @]'
'instruction to skip past the unwanted information (take care when'
'deciding how many lines to skip as there is no way to shift time'
'once the data is imported). '
' '
'You must specify the column within the import file which corresponds'
'to each of the fields which contain timestep data (a zero means no'
'import for a particular field).'
'NOTE: blank characters, tabs, and commas are all treated as'
'separators. In the following db temp is actually in column 5. '
' '
'# place year month day time direct_solar dbT '
'Berlin 2001-10-12 09.00 100.0  19.2 '
'Berlin 2001-10-12 09.50 112.0  19.3 '
'Berlin 2001-10-12 10.00 142.0  19.6 '
' '
'Note: the data that you are reading in is not transformed'
'as it is read (e.g. taking an integer value in tenths'
'of a m/s 105 to the value 10.5 m/s is not supported.'
' '
'Interpolation of data during the import is not supported'
'(i.e. you cannot import hourly data into a temporal file'
'with a frequency of ten minutes. '
*enditem
        CALL EASKS(tfile,' Import file name? ',
        CALL EASKI(IV,' ','Begin reading @ import file line no:',
        CALL PHELPD('period fields',36,'-',0,0,IER)
*item EDIMPT temporal_warn_casgains
'The file you are importing appears to be a timestep'
'casual gain file.  NOTE that such files required '
'that the data included the startup period except for'
'the first hour of the first day (which was omitted)'
' '
'A temporal file includes the entire period of the startup'
'period so you may need to edit the import file to take'
'this into account. '
*enditem
        CALL PHELPD('timestep import warning',8,'-',0,0,IER)
        CALL EASKI(IV,' ','Associated column in import file:',
*subroutine EDSTATICIMPT
*item EDSTATICIMPT temporal_import_param
'This display allows the user to specify parameters which control'
'the importation of column data into this temporal file.  '
'  '
'One import source file is assumed thoughout this session unless'
'you alter the name of the file via the [preferences] option.'
' '
'After supplying the name of the file of column data that you want'
'to import you can view the initial lines of the file to confirm'
'which items the relevant data is in as well as how many lines'
'(if any) to ignore at the start of the file. If the file name is'
'not local, specify the whole path. '
' '
'If the data file includes information prior to the point in'
'time that you are interested in you can use the '
'[begin reading @] instruction to skip past the unwanted'
'information (take care when deciding how many lines to skip'
'as there is no way to shift time once the data is imported).'
'Note that lines which begin with a # are considered as comments'
'and should NOT BE COUNTED.'
' '
'You must specify the column number within the import file which'
'corresponds to each of the fields which contain data ( a zero'
'means no import for a field).  To be sure, first check the types'
'of information needed for the temporal item of interest, then'
'determine which columns of the file will be needed.  If you have'
'several temporal items to populate you will have to return to the'
'[preferences] menu and define new columns for importing.'
'  '
'NOTE: blank characters, tabs, and commas are all data separators.'
'  '
'One import source file will be assumed throughout this session.'
'If a different file is required, return to this [preferences]'
'menu to give the new name (also remember to reset the column'
'directives).'
'  '
'Once the import directives have been set you need to select a'
'temporal item and look for the [import raw data] option at the'
'bottom of the menu. Once the data is imported then the graphic'
'display will update to show the newly imported data.'
*enditem
        CALL EASKS(tfile,' Import file name? ',
        CALL EASKI(IV,' ','Begin reading @ import file line no:',
        CALL EASKI(IV,' ','Associated item number in import file:',
*subroutine pregist
*item pregist cfg_overview
'The model configuration file holds the definition of the building,'
'plant, flow and control systems to be simulated, including'
'references to associated files.'
'  '
'The name you supply will be used as the root name for the various'
'files corresponding to the model you will later establish.'
'Up to 24 characters allowed.'
'  '
'The root name of the model is generally the same as the name'
'of the model folder structure. In it will be the following'
'folders:'
'  '
' cfg (system files)'
' ctl (control files)'
' aim2 (aim2 files)'
' zones (zone files)'
' hvac (ideal hvac files)'
' nets (networks for flow and power and systems)
' doc (reports and notes)'
' tmp (odds+ends)'
' dbs (model specific databases)'
' bsm (BASESIMP files)'
*enditem
        CALL EASKSCMD(LCFTMP,' ','Model root name?',
*item pregist cfg_overwrite_warning
'If you overwrite the existing configuration file its contents'
'will be lost unless you have backed up your data.'
' '
'If you want to create a new model variant say no and enter'
'a different file name.'
*enditem
          call askok('There is an existing configuration with',
*item pregist cfg_model_descriptor
'A model has an associated descriptor (<72 characters, which is'
'used later as an identifier, e.g. Low energy building with'
'optimum start/stop plant control.'
*enditem
      CALL EASKS(ltmp,' ','Model description?',
*item pregist cfg_model_log_file
'The project log file holds a description of the project and the'
'analysis intentions. It is located in the [cgf] folder. Keep it'
'up to date via a text editor.'
' '
'Assuming you have an editor associated with ESP-r (defined'
'via your .esprc file), you can edit the log file.'
'  '
'Note: if the log file was found but could not be scanned and'
'opened it might be that it has unprintable characters in it.'
*enditem
      CALL EASKS(ltmp,' ','Project log file?',
      CALL ASKOK('Problem detected with log file!',
      CALL ASKOK(' ','Edit log file?',OK,dok,8)
*item pregist cfg_model_images
'A model can usefully include references to images depicting'
'different model aspects such as geometry, flow networks,'
'simulation results, site conditions and the like.'
'Such images are usually located in the [images] folder.'
'  '
'Notes (<248 char) for images can help with communicating'
'the intent of the image. This is particularly true for.'
'images which are used for training purposes.
' '
'You can either identify such images now or add them later via'
'the [model context->images] menu item.'
*enditem
      CALL ASKOK(' ','Associate images now?',OKI,dok,7)
      CALL EASKS248(tcname,' ','Image notes:',
      CALL ASKOK(' ',' Another image?',OK,dok,1)
*item pregist cfg_latitude_longitude
'Site latitude in degrees, where North is +ve, e.g. 55.9'
'for Glasgow.  In the southern hemisphere use negative'
'numbers. In both cases the positive Y axis of the model'
'faces North.'
'  '
'Site longitude difference is the difference in degrees'
'from the local time reference meridian, East is +ve, e.g.'
'-4.1 for Glasgow (relative to the Greenwich Meridian).'
*enditem
        CALL EASKR(SLAT,' ','Site latitude?',
        CALL EASKR(SLON,' ','Longitude difference from meridian?',
*item pregist cfg_model_year
'The assessment year is required for event scheduling.(e.g.'
'to determine which day of the week is 1 January. You can'
'either use the value offered or provide an alternative.'
' '
'The cancel option will accept the year associated with'
'the climate file used in a simultion.'
*enditem
        CALL EASKI(IYEART,' ','Assessment year?',
*item pregist cfg_model_other
'Other site information, such as ground reflectivity and'
'wind exposure, have been automatically set to default'
'values and these may be changed via the [model context]'
'menu option accessed via the [browse/edit/simulate]'
'option of the present menu.'
' '
'If you have ADDITIONAL day types (e.g. summer holiday or for'
'seasonal controls or operational regimes) that you want to'
'define, do this BEFORE working with any controls or schedules.'
*enditem
        CALL PHELPD('new site',9,'-',0,0,IER)
*subroutine pfolders
*item pfolders cfg_path_overview
'This menu allows you to edit the information related'
'to a project-s folders and files.'
' '
'The path options allow new files to be positioned in standard'
'folders. The paths are relative to the location of the model'
'configuration file.'
'  '
'If you select each of the standard paths to model details'
'you can alter the relative path from the location of the model'
'cfg file to the relevant folder.  Be careful, if you revise'
'an existing path you may isolate several model files!'
'  '
'The path for:
'  zone files is typically ../zones'
'  control files is typically ../ctl'
'  Alberta Infiltration Method files is ../aim2'
'  network (air/power/system) files is ../nets'
'  image files is ../images'
'  documents and notes are in ../docs'
'  temporary files are in ../tmp'
'  Radiance files are in ../rad'
'  local databases are always in ../dbs'
'  idalized HVAC descriptions are in ../hvac'
'  BASESIMP descriptions are in ../bsm'
' '
'The option to examine a specified ASCII file is useful if'
'you have need to directly view the contents of a file such'
'as the model configuration file or a zone geometry file or'
'the model log file.  The contents of the file will be sent'
'to the text feedback window of the application.'
' '
'Editing an ASCII file - such as the project log file - requires'
'a text editor. This can be re-defined in your .esprc file.'
'  '
'If ESP-r thinks that recent model changes have been'
'made such changes may only be held in memory and will'
'be lost if not saved to file. Agree to updating the file
'if you want to save what is memory and say no if you do'
'not want to record recent changes.
*enditem
        CALL ASKOK(' ','Update system configuration file?',
        CALL PHELPD('folders and files',19,'-',0,0,IER)
        CALL EASKS(t24,'Relative path from cfg',
    6   CALL EASKS(LFIL,' ','ASCII file name?',
        CALL ASKOK(' Problem detected while trying to open',
        CALL EASKS(LFIL,' ','ASCII file to edit?',
*subroutine edimage
*item edimage image_overview
'Images will be displayed when the project is loaded.'
'The default image type is GIF but JPEG can also be viewed.'
'  '
'Standard image types that can be tagged in the model'
'cfg file are:'
'  GIF   TIFF  XBM (X11 bitmap) and other'
'  '
'If you select the [other] type of image you will be asked to'
'supply a 4 charcter tag which then needs to be linked to'
'the display tool specification in the .esprc file.'
'  '
'Images are displayed via an external image tool (in the X11'
'interface or via a pop-up image if running the GTK version'
'of ESP-r.'
'  '
'If you make a mistake you are given a 2nd chance.'
*enditem
      CALL EASKS(limg,' ','Name of image file?',
      CALL ASKOK('Could not locate image file.','Try again?',
      call EASKATOG(' ','Image format?',
      CALL EASKS(t5,' ','Image type character code?',
*item edimage image_topic
'Each image can be tagged for a specific or general topic'
'so that ESP-r can better choose when the image is displayed'
'to the user.'
'  '
'If an image is tagged [general] then it will be displayed'
'when the model is loaded, otherwise it will only be'
'displayed when requested via a graphic display button.'
'  '
'If you selected the [other] topic then you are asked to'
'supply a 4 character focus tag.'
*enditem
      call EASKATOG(' ','Image focus?',
      CALL EASKS(t5,' ','Image type character code?',
*subroutine edbuild
*item edbuild cfg_zone_files
'The files defining the composition of a zone are listed in'
'this menu. In the case of a blank entry, the file is'
'optional and is not currently defined.'
' '
'If the menu says [not yet defined] then the file is required'
'before simulations can proceed.  Such files will be created'
'when the related facilities have been accessed (ie. geometry'
'files are created as you define each zone).  '
' '
'The default names of files is the zone name with an extension'
'indicating the file type (geo con tmc vwf).'
' '
'The primary use of this facility is to confirm the current'
'state of the model and to assist in the sharing of files'
'(i.e. when several zones share the same constructions).  The'
'model definition will be updated after each change you make.'
*enditem
        CALL PHELPD('utility file contents',18,'-',0,0,IER)
*item edbuild cfg_zone_name
'The zone name is used as an identifier during results analysis'
'Names should be unique.'
*enditem
        CALL EASKS(T15,' ','Zone name?',12,D15,'zone name',IER,2)
*item edbuild cfg_geo_file_name
'The zone geometry file is mandatory and defines the composition'
'of a closed poluygon body of a thermal zone.'
*enditem
   41   CALL EASKS(L,outs,' ',72,D,'Z geom',IER,2)
*item edbuild cfg_con_file_name
'The zone construction file is mandatory and defines the thermo-'
'physical properties of the thermal zone.'
*enditem
        CALL EASKABC(' For zone construction file',
   42   CALL EASKS(L,outs,' ',72,D,'Z constr',IER,2)
*item edbuild cfg_opr_file_name
'The zone operation file is mandatory and defines  infiltration,'
'ventilation and casual gains.'
*enditem
        CALL EASKABC(' For zone operation file',
   40   CALL EASKS(L,outs,' ',72,D,'Z operations',IER,2)
*item edbuild cfg_obs_file_name
'The zone obstructions file contains the geometry of'
'obstruction blocks for use in shading/ insolation'
'calculations. You may browse for existing files.'
*enditem
          CALL EASKABCD(' For zone obstruction file',' :',
          CALL EASKABC(' For zone obstruction file',
   47     CALL EASKS(L,outs,' ',72,D,'Z obstr',IER,3)
*item edbuild cfg_tmc_file_name
'The zone optics (TMC) file contains the optical'
'properties of transparent surfaces and offering'
'a more exact treatment of, for example, windows.'
*enditem
          CALL EASKABCD(' For the zone TMC file',' :',
          CALL EASKABC(' For the zone TMC file',' :',
   51   CALL EASKS(L,outs,' ',72,D,'tmc file',IER,6)
*item edbuild cfg_vwf_file_name
'The zone view factor file supports a more exact'
'treatment of longwave radiation exchange.'
'You may also browse for existing files.'
*enditem
        CALL EASKABCD(' For zone view factor file',' :',
        CALL EASKABC(' For zone view factor file',' :',
   46   CALL EASKS(L,outs,' ',72,D,'view factor',IER,4)
*item edbuild cfg_cgc_file_name
'The zone casual gain control file allows a casual'
'gain type to be controlled on the basis of daylight'
'levels as sensed by one or more sensors located within'
'or outwith a zone and against a selected control law.'
*enditem
          CALL EASKABCD(' For zone casual gain control file',' :',
          CALL EASKABC(' For zone casual gain control file',' :',
   52   CALL EASKS(L,outs,' ',72,D,'casual gain control file',IER,6)
*item edbuild cfg_shd_file_name
'The shading/ insolation file contains the results of'
'a separate shading and insolation analysis for use'
'throughout a simulation to dictate solar injection'
*enditem
          CALL EASKABCD(' For zone shading/ insolation file',' :',
          CALL EASKABC(' For zone shading /insolation file',' :',
   48   CALL EASKS(L,outs,' ',72,D,'shd db',IER,6)
*item edbuild cfg_htc_file_name
'The convection regime file contains data for'
'controlling the calculation of internal and/or external'
'surface convection heat transfer for selected surfaces.'
'It is possible to override the default convection'
'coefficient correlations for specified surfaces and for'
'specified time intervals. You can specify fixed'
'coefficients, select from amongst a suite of specialised'
'correlations, or impose [adaptive] control over the'
'convection calculations.'
*enditem
          CALL EASKABCD(' For the convection regime file',' :',
          CALL EASKABC(' For zone convection regime file',' :',
   49   CALL EASKS(L,outs,' ',72,D,'Z hc',IER,6)
*item edbuild cfg_cfd_file_name
'The domain flow file allows the association of a'
'computational fluid dynamics (CFD) domain with a'
'zone.  This allows intra-zone air movement to be'
*enditem
          CALL EASKABC(' For the zone domain flow file',
   53   CALL EASKS(L,outs,' ',72,D,'Domain flow model file',IER,6)
*item edbuild cfg_grd_file_name
'There are four adaptive gridding files which must be'
'specified for each zone to which such gridding is to'
'be applied. Check documentation for more information.'
'  '
' 3D control volumes file'
' 3D connections file'
' 3D coordinates file'
' 3D nodes temperatures file defines the location of additional'
'    construction nodes corresponding to the finer discretisation'
'    of a multi-layered construction.'
'
*enditem
          CALL EASKABC(' For addaptive gridding files',
        CALL EASKS(L,outs,' ',72,D,'control volumes',IER,2)
        CALL EASKS(L,' 3D volumes connections file?',
        CALL EASKS(L,' 3D coordinates file?',
        CALL EASKS(L,' 3D node temperatures file?',
*item edbuild moist_transp_file_name
'Moisture transport data is required for adaptive '
'gridding use in the current zone.'
'Check documentation for more information.'
*enditem
          CALL EASKABC(' For moisture transport file',
        CALL EASKS(L,outs,' ',72,D,'moisture file',IER,2)
*item edbuild struc_mesh_file_name
'structure mesh configuration file is required for '
'structured gridding of the current zone.'
'Check documentation for more information.'
*enditem
          CALL EASKABC(' For structured mesh file',
        CALL EASKS(L,outs,' ',72,D,'structured file',IER,2)
*item edbuild cfg_cfc_file_name
'The zone complex fenestration constructions (CFC)'
'provides a more exact treatment for windows which'
'can include operable slat-type shading layers.'
*enditem
          CALL EASKABCD(' For the zone CFC file',' :',
          CALL EASKABC(' For the zone CFC file',' :',
  511   CALL EASKS(L,outs,' ',72,D,'cfc file',IER,6)
*subroutine GTOPOL
*item GTOPOL ground_form_overview
'This file contains a description of a ground form '
'for use by Radiance and viewing (later by esp). '
'  '
'The ground form has a short (15 char) description'
*enditem
 46   CALL EASKS(ltmp,' Ground topology/geometry file name ? ',
      CALL EASKS(t15,' Description of the ground?',
*item GTOPOL ground_form_menu
'As an option the default assumption of a flat uniform ground'
'attributed only by a reflectance you can define a ground topology'
'and geometry.  Currently this information is passed to imaging'
'software such as Radiance for wire-frame viewing packages.'
'  '
'In the FUTURE it will be included in shading calculations. '
' '
'Geometry is similar to that of zone enclosures but is primarily'
'a collection of triangles which need not form a [closed]'
'body - rather a mesh which approximates the contours of the site.'
' '
' option d - Each surface has an composition attribute (construction'
'   database name) so that surface properties are known. This is'
'   for use by Radiance only.'
'  '
' option * -  auto triangulation method is most robust when'
'   applied to a ground topography with no existing surface.'
'   If you say yes, existing surfaces are cleared before'
'   beginning triangulation. '
'  '
' option # - rotation and translation options are the same as '
'   for thermal zones. Rotation is applied around vertex 1 or'
'   the site origin or a user defined point. The rotation angle'
'   is positive anticlockwise. Transform options shifts the'
'   ground form by a given amount in each axis.'
' '
'If you are creating the initial vertices via a click-'
'on-bitmap the ESP-r cookbook has a useful guide. '
' '
*enditem
        CALL PHELPD('grnd topo section',22,'-',0,0,IER)
        CALL EASKS(t15,' Description of the ground?',
        CALL EPICKS(INPICK,IVALS,' ',' ',32,NGT,VERTS,
        call askok('Existing surfaces will be removed prior to',
        CALL EASKAB(' Adjust location of ground:',' ',
        CALL EASKR(VAL,' ',' Rotation (deg + = anticlockwise) ? ',
        CALL EASKABC(' Rotation choices :',' ','Site origin',
        CALL EASKR(x1,' ',' X point (metres) ? ',
        CALL EASKR(y1,' ',' Y point (metres) ? ',
        CALL EASKR(VALX,' ',' X shift (metres) ? ',
        CALL EASKR(VALY,' ',' Y shift (metres) ? ',
        CALL EASKR(VALZ,' ',' Z shift (metres) ? ',
*subroutine EDGVERT
*item EDGVERT ground_form_verticies
'This menu allows existing vertices to be viewed and'
'edited. Edit by selecting an item or -Exit to escape.'
'  '
' option + to manage ground verticies you can add new vertices,'
'   delete existing vertices, copy (and then edit) existing'
'   verticies, replicate existing verticies and edit vertex'
'   coordinates.'
'  '
' option ^ vertex transforms includes a number of useful'
'   facilities to modify vertices:'
'   *--x-* Vertex on a line: finds one or more points along a'
'   line (defined by specifying two vertices). You can add more'
'   vertices along the same line.'
' '
'   *<-?->* Distance between vertices: gives distance in '
'   metres given two vertices. '
' '
'   Vertex at angle: finds a (new) vertex relative to a given'
'   vertex at a specified distance, azimuth angle north=0'
'   +degrees clockwise and elevation (90 is vertical). '
' '
'   Angel between lines: finds angle A between two lines'
'   given 3 vertex as in:      * 1 '
'                       a  /    '
'                3 *------* 2   '
'  '
'   Find close vertices - looks for and lists vertices that'
'   are close to each other
'  '
' option ! triangulation routines which require you to '
'   identify which vertices are at an edge. '
*enditem
        CALL PHELPD('configuration section',8,'-',0,0,IER)
        call MENUATOL('available vertex transforms (see help):',
        CALL EASKR(vdis,' Distance along the line (metres): ',
        CALL EASKABC(outs,' ','new vertex',
 443    CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vtx co',IER,2)
        call askok('Insert this vertex?','(see help)',
        call askok('Another vertex along the line? ',' ',ok,dok,2)
 342    CALL EASKS(HOLD,
        CALL EASKABC(outs,' ','new vertex',
 543    CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vtx co',IER,2)
        call askok('Another vertex from this origin?',' ',ok,dok,2)
        call askok('Is this aligned vertex ok?',' ',ok,dok,1)
        CALL EASKR(vdis,' Move along the line (metres): ',
        call askok('Apply this move?',' ',OK,dok,1)
        CALL EASKABC(outs,' ','new vertex',
  43    CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vtx co',IER,2)
*item EDGVERT ground_form_vert_manage
'If a new vertex is a minor variation of an existing '
'point then it may be easier to copy and then edit. '
' '
'You may delete one or more vertices (but only those'
'which are unlinked to surfaces may be deleted). '
'In graphic mode click on the vertices (end with and [e])'
' '
'Replication can be used make several varitants of a'
'single vertex (useful where only one coordinate needs'
'to be altered). '
' '
'In graphic mode you can edit a number of vertices by '
'clicking on the wire-frame image. '
' '
'A cancel request leaves the model unchanged. '
*enditem
        CALL EASKATOG('Vertex operations:',' ','add','delete','copy',
        CALL EASKI(IADD,' ',' How many vertices to add ? ',
        CALL EASKI(IADD,' ',' Replicate how many times ? ',
 146    CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vertex coord',
  42    CALL EASKS(HOLD,outs,' ',32,' 0. 0. 0. ','vertex coord',IER,2)
*subroutine ADDGVERT
*item ADDGVERT ground_add_vertex
'The vertex coordinates for the ground form should be in metres.'
'It is not advisable for Z to be negative (tends to confuse).'
'  '
'If you add a new vertex within 3mm of an existing edge the logic'
'may ask you whether it should be included in the other edge. Also'
'it can be very confusing if there are identical vertices in the'
'ground form.'
'  '
'Currently a ground form can contain up to 400 surfaces and'
'up to 500 vertices. Each surface can have up to 8 edges.'
*enditem
        CALL EASKS(HOLD,' Vertex  X  Y  Z (in metres): ',
        call askok('Insert this vertex?','(see help)',
        CALL EASKS(HOLD,outs,' X  Y  Z (in metres): ',
        call askok('Insert this vertex?','(see help)',
*subroutine EASKGSUR
*item EASKGSUR ground_surf_selection
'A ground surface will be selected via its name'
'in the list. (This may be edited elsewhere.)'
*enditem
        CALL PHELPD('ground surface file section',2,'-',0,0,IER)
*item ADDGSUR
*enditem
          CALL EASKS(SNAME1,'Revised surface name','Please edit.',
*item ADDGSUR ground_surf_transforms
'Actions:'
' Shift surface along (+ = outwards) surface normal.'
' Transform all surface associated vertices by X,Y,Z (m).'
' Rotate surface about one of its vertices (you are asked which'
'   vertex to rotate around). Note a positive rotation is'
'   anticlockwise.' 
' Invert ordering (to swop front & back faces) if the surface was'
'   originally specified with an incorrect order. If you look at'
'   a surface from the outside you would order the edges anti-'
'   clockwise.'
'  '
' Do several (of the above) operations to the surface.'
' Continue with no action.'
'  '
'If in one of these actions a vertex is transformed into a position'
'within 3mm of an existing edge of an surface you may be asked if'
'you want to include it in the adjacent surface.'
*enditem
          CALL EASKATOG(' ','Surface action options:',
          CALL EASKR(vdis,' ','Distance along normal?',
 152      CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
          CALL EASKI(IRV,' ','Rotate about which vertex?',
          CALL EASKR(ANGR,' ','Rotation degrees?',
          call askok(' ','Insert this vertex?',
          CALL EASKAB('Reverse the edge ordering of',
*item ADDGSUR ground_surf_create
'A surface is composed of an ordered list of vertices.'
'The order is anticlockwise when viewed from outside'
'the model. The total number of vertices defining a'
'surface must be less than 8. Note that the last line'
'of the surface is from the last to the first vertex. '
' '
'You may mouse click on existing vertices, ending with'
'an [e]. A match is assumed if the location is within'
'5 pixels.'
'  '
'Currently a ground form can contain up to 400 surfaces and'
'up to 500 vertices. Each surface can have up to 8 edges.'
'  '
'Each ground form surface has a name which must be less than'
'6 characters with no blanks.'
*enditem
        CALL EASKS(HOLD,' ','Vertex list?',
        CALL EASKSCMD(HOLD,' ','Vertex list?','via mouse',
        CALL EASKS(HOLD,' Associated vertices (confirm):',
        CALL EASKS(SN,'Surface name','(unique word <=6char):',
*subroutine EDGVLIST
*item EDGVLIST ground_vertex_edits
'This menu allows existing vertices to be viewed and'
'edited. Edit by selecting an item or -Exit to escape.'
' '
'The transforms for ground surface vertices are similar to'
'those provided for zone surfaces and vertices. Actions: '
' Shift surface along (+=outwards) surface normal.'
' Transform vertices by X,Y,Z metres.'
' Rotate surface about one of its vertices (you are asked which'
'   vertex in the surface to rotate about). A positive rotation is'
'   anticlockwise.
' Invert ordering (to swop front & back faces).'
' Do several operations to the surface.'
' Continue with no action.'
' '
'The add/copy/delete functions are similar to those'
'offered for zone surfaces (but ground surfaces are'
'can only have 8 vertices so some functions are omitted.'
' '
*enditem
        CALL PHELPD('ground vertex section',10,'-',0,0,IER)
        CALL EASKGSUR(IS,'-','Select surface to transform.',' ',IER)
        CALL EASKATOG(outs,' :','shift along normal','transform xyz',
        CALL EASKR(vdis,' Distance along the normal (metres): ',
 152    CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
        CALL EASKI(IRV,'Rotate about which vertex index: ',
        CALL EASKR(ANGR,' ',' Rotation (deg + = anticlockwise) ?',
        CALL ASKOK('Is it ok to apply the transformed points  ',
        CALL EASKGSUR(IS,'-','Select surface to delete.',' ',IER)
*item EDGVLIST ground_insert_surf
'Insertion into an existing surface is a common way '
'to create a rectuangular body within the surface (such as'
'a rectangular foundation.'
' '
'You may copy (and then transform) a surface within this '
'zone to make a new surface. An example an identical shape'
'which is repeated in several locations. '
' '
'You may copy (and then transform) a surface from another '
'zone for use in this zone. For example, a partition which'
'shared between two zones. '
' '
'You may create a rectangular surface by specifying its'
'origin and either an azimuth (for vertical) or a '
'rotation between the X axis and its [length edge] for.'
'a horizontal rectangle.
'The origin of the new surface tends to be the lower left'
'hand corner when viewed from the outside. Note: Azimuth 0.0'
'is north, 180 is south, 270 is west. Length and height of the'
'new rectangle are in metres. Rotation is in relation to the'
'first edge along the [length] edge and the X axis (positive'
'is anticlockwise and negative is clockwise.'
'  '
'If you accept the rectangle it will be converted into '
'a surface within the ground form. If you elect to revise it'
'you will be presented with several options. '
'  '
'And after you define the form of the surface you must give the'
'new surface a name (< 6 characters with no blanks).
*enditem
        call MENUATOL(' ','new surface options',
        CALL EASKS(HOLDS,' Surface origin X Y & Z: ',' ',
        CALL EASKS(HOLDS,' Surface azimuth (deg) length & height: ',
        CALL EASKS(HOLDS,' Surface origin X Y & Z: ',' ',
        CALL EASKS(HOLDS,' Surface rotation (deg) length & height: ',
        CALL EASKABC('Options for this rectangle:',' ',
        CALL EASKS(SN,' ',' Inserted surface name: ',
*item EDGVLIST ground_surf_edge_list
'The list of associated vertices should be given in'
'anticlockwise order as one faces the outside of the'
'surface.  If one is looking at the inside face then'
'think of the list in clockwise order.  It is a con-'
'vention that the first vertex is located at the'
'bottom-left corner of the surface (looking from the'
'outside) with the next vertex moving horizontally.'
'It helps to follow a consistent pattern!'
*enditem
  43    CALL EASKS(HOLD,outs,'  ',72,' ','associated vertices',IIER,8)
*subroutine pointtogline
*subroutine UGRNDR
*subroutine TRIANG
*item TRIANG ground_include_indices
'When displaying the ground form you have the option to include'
'vertex indices in drawing. '
'  '
*enditem
        CALL ASKOK(' ','Draw vertices?',OK,dok,1)
*item TRIANG ground_alt_logic_triang
'Alternative logic will be used to check for surfaces'
'which might use this vertex. '
*enditem
          call askok('Try again to find this vertex?',' ',ok,dok,2)
*subroutine HCFMK
*item HCFMK zone_htc_overview
'A zone heat transfer coefficient file holds directives'
'instructing esp-r to either use a specific set of heat'
'transfer coefficients (e.g. related to ceiling diffusers'
'or user supplied data for surfaces in a zone. '
' '
'If you do not want to ignore the information in this '
'file click on dereference. '
*enditem
  245   CALL EASKSCMD(LTMP,'Zone conv regime file ?',
*item HCFMK zone_htc_expected
'The file was not of the expected (heat transfer'
'regime) and you should double check before you'
'agree to overwrite it with hc regime data. '
' '
'If you say no you will be returned to the zone '
'composition menu. '
*enditem
                CALL ASKOK(outs,
*item HCFMK
'Answering yes will create a new file to hold the'
'convective regime data. '
' '
'A no answer will return without changing the model.'
*enditem
            CALL ASKOK(
*item HCFMK zone_htc_menu
'The choice of algorithm for calculating internal surface'
'convection coefficients (int-hc) can significantly affect'
'simulation results and can even impact design decisions.'
'It is important to recognize that by default int-hc values'
'are calculated using a buoyancy-flow relation. The facility'
'implemented here allows you to drop this assumption and to'
'calculate int-hc values in a more rigorous fashion.'
' '
'The adaptive convection algorithm (ACA) implemented under'
'options [a] through [n] controls the calculation of int-hc'
'in a dynamic fashion. Based upon minimal data input, the'
'ACA appraises a configuration to assign an appropriate set'
'of int-hc correlation equations to each internal surface.'
'Then as the simulation evolves, the ACA toggles between the'
'int-hc equations in response to the prevailing convective regime.'
' '
'Choose the option that best describes the principle convection'
'regime within the zone. You will be prompted for supplementary'
'data in subsequent menus.'
' '
'Simulation time-steps of 15 minutes or less are recommended'
'when this facility is used.'
' '
'Options a-c are appropriate when convection in the zone'
'is driven primarily by buoyancy resulting from surface-to-air'
'temperature differences caused by in-floor heating, a heated'
'wall panel, sun-patch or cold window.'
' '
'Options d-e are appropriate when convection is driven'
'primarily by buoyancy resulting from a heating device'
'(e.g. radiator, stove) located either undeer a window'
'or at some other location in the zone.'
' '
'Options f-g are specific for treating convection inside open'
'vertical channels with bouyancy driven flow. The correlations'
'apply to the vertical surfaces and operate all the time'
' '
'Options h-j are appropriate when convection is driven primarily'
'by an air-handling system that supplies heated or cooled air to'
'the zone through ceiling floor or wall-mounted diffusers. It'
'should not be used when buoyancy is also a significant factor.'
' '
'Option k is appropriate when convection in the zone is driven'
'primarily by a heating or cooling device that circulates air'
'within the zone. There is no intentional supply or extract'
'of air from the zone.'
' '
'Options l-m are appropriate when convection in the zone is driven'
'by both mechanical and buoyant forces. The mechanical forces are'
'caused by an air handling system (AHU) that supplies heated or'
'cooled air to the zone through ceiling, floor, or wall-mounted'
'diffusers. The buoyant forces are caused by surface-to-air'
'temperature differences. This option is preferred over the'
'[air-based HVAC system] convective regime as it captures'
'the combined influence of buoyant and forced effects.'
*enditem
        CALL PHELPD('convective calculations',59,'-',0,0,IER)
*subroutine EconvA
*item EconvA zone_htc_buoyancy_ok
'The buoyancy choice is appropriate when convection in the zone'
'is driven primarily by buoyancy resulting from'
'surface-to-air temperature differences.'
'  '
'There are lots of options. You probably want to review the'
'synopsis before selecting anything! '
*enditem
      call askok('View a synopsis of Bouyancy-driven flow',
*item EconvA htc_buoyancy_floor
'This choice is appropriate when convection in the zone'
'is driven primarily by buoyancy resulting from'
'surface-to-air temperature differences.'
' '
'Use option [in-floor heating] when you have defined a'
'zone with floor surface(s) heated by flux injection'
'into the floor construction or by flux injection into'
'a plenum under the floor surface. It is assumed that'
'such a zone control is or will be defined.'
' '
'You will be prompted for the surface(s) which are '
'heated. '
' '
'ESP-r models convection as follows: '
'  walls:   Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows: Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  floor:   Awbi-Hatton heated floor eq when heat on;'
'           Alamdari-Hammond stably stratified/buoyant'
'           horizontal eq (or sim toggle) when heat off.'
'  ceiling: Khalifa eq 4 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
         CALL PHELPD('Cause of dT',28,'-',0,0,IER)
*item EconvA htc_buoyancy_wall_panel
'This choice is appropriate when convection in the zone'
'is driven primarily by buoyancy resulting from'
'surface-to-air temperature differences.'
' '
'Use option [heated wall panel] when you have defined a'
'zone with surface(s) heated by flux injection into the'
'panel construction or by flux injection into a zone'
'which represents a panel heater. It is assumed that'
'such a zone control is or will be defined.'
' '
'You will be prompted for the surface(s) which are heated.'
'The treatment for each wall depends on whether it is a'
'heated surface.'
'
' '
'ESP-r models convection as follows: '
'  heated walls: Awbi-Hatton heated wall eq when heat'
'                on; Alamdari-Hammond vert eq (or sim'
'                toggle) when heat off.'
'  non-heated:   Khalifa eq 6 when heat on; Alamdari-'
'  walls:        Hammond vert eq (or toggle) when off.'
'  windows: Khalifa eq 6 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  floor:   Alamdari-Hammond stably stratified eq when'
'           heat on; Alamdari-Hammond stably stratified'
'           or buoyant horizontal eq (or sim toggle)'
'           when heat is off.'
'  ceiling: Khalifa eq 7 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
         CALL PHELPD('Cause of dT',32,'-',0,0,IER)
*item EconvA htc_buoyancy_temp_diff
'This choice is appropriate when convection in the zone'
'is driven primarily by buoyancy resulting from'
'surface-to-air temperature differences.'
' '
'The option [other temp diff] is the appropriate choice'
'when the temperature diff is caused by a sun patch or'
'by heat transfer through the fabric (e.g. a cold window '
'surface). '
' '
'ESP-r models convection as follows: '
' walls:   Alamdari-Hammond vertical eq (or sim toggle)'
'          when heat on or off.'
' windows: Alamdari-Hammond vertical eq (or sim toggle)'
'          when heat on or off.'
' floor:   Alamdari-Hammond stably stratified or buoyant'
'          horizontal eq (or sim toggle) when heat on'
'          or off.'
' ceiling: Alamdari-Hammond stably stratified or buoyant'
'          horizontal eq (or sim toggle) when heat on'
'          or off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
         CALL PHELPD('Cause of dT',25,'-',0,0,IER)
*subroutine EconvB
*item EconvB zone_htc_device_ok
'The heating device choice is appropriate when convection in the'
'zone is driven primarily by buoyancy resulting from a heating'
'device (e.g. radiator, stove) located within the zone.'
' '
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok('View a synopsis of Bouyancy-driven flow',
*item EconvB zone_htc_device_options
'The heating device choice is appropriate when convection in the'
'zone is driven primarily by buoyancy resulting from a heating'
'device (e.g. radiator, stove) located within the zone.'
' '
'Indicate whether the heating device is located beneath a window or'
'not as this will influence the convective regime within the zone.'
' '
'You will be prompted to indicate whether you want to apply'
'Khalifa-s window correlations or alternate equations. As discussed'
'in Section 5.2 of Beausoleil-Morrison (2000), it is suspected'
'that Khalifa-s window correlations overpredict int-hc.'
' '
'For option [a] the ACA models convection as follows:'
'  walls:   Khalifa eq 6 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows: Khalifa eq 6 or 9 (user choice) when heat on;'
'           Alamdari-Hammond  vertical eq (or sim toggle)'
'           when heat off.'
'  floor:   Alamdari-Hammond stably stratified eq when'
'           heat on; Alamdari-Hammond stably stratified'
'           or buoyant horizontal eq (or sim toggle) when'
'           heat off.'
'  ceiling: Khalifa eq 7 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
' '
'For option [b] the ACA models convection as follows:'
'(you will be prompted to indicate which wall surfaces'
'are adjacent to the heating device as well as whether'
'the surface is a window or wall):'
'  walls close to heater:'
'           Khalifa eq 5 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  walls not close to heater:'
'           Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows: Khalifa eq 3 or 10 (user choice) when heat'
'           on; Alamdari-Hammond  vertical eq (or sim'
'           toggle) when heat off.'
'  floor:   Alamdari-Hammond stably stratified eq when'
'           heat on; Alamdari-Hammond stably stratified'
'           or buoyant horizontal eq (or sim toggle) when'
'           heat off.'
'  ceiling: Khalifa eq 4 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
        CALL PHELPD('Location of heater',52,'-',0,0,IER)
*subroutine EconvC
*item EconvC zone_htc_mechanical_ok
'The mechaical dominated choice is appropriate when convection in'
'the zone is driven primarily by an air-handling system that'
'supplies heated or cooled air to the zone through ceiling'
'floor or wall-mounted diffusers.'
'  '
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok('View a synopsis of Mechanically-driven flow',
*item EconvC zone_htc_mechanical_opt
'The mechaical dominated choice is appropriate when convection in'
'the zone is driven primarily by an air-handling system that'
'supplies heated or cooled air to the zone through ceiling'
'floor or wall-mounted diffusers.'
'  '
'It should not be used when buoyancy is also a significant factor.'
'Buoyancy is often negligible for cooling situations, but usually'
'important for heating situations. The [mixed flow] convective'
'regime is recommended as an alternative to this choice as it'
'can capture the combined influence of buoyant and forced effects.'
' '
'You are asked to indicate the air-handling system type. This'
'determines the temperature and flowrate of air introduced to the'
'zone and thus the convective regime.'
' '
'NOTES: variable air volume system with constant volume heating.'
'When the zone requires cooling, the supply air is chilled'
'to a constant temp while the system adjusts the air flow'
'to meet the cooling load. When the zone requires heat,'
'the system supplies air at a fixed flow rate, equal to the'
'minimum damper position of the VAV box. Reheat coils warm the'
'air upstream of the diffuser to meet the zone-s heating load.'
' '
'NOTE: variable air volume system with variable volume'
'heating. It operates the same as VAV with CV in'
'cooling mode. But when the zone requires heating, the'
'dampers and reheat coils work in conjunction to satisfy'
'the heating load. At low heat loads the system delivers'
'air at the min flowrate and the reheat coil heats the'
'air to meet the load. When the heating load is'
'sufficiently high that the reheat coil cannot meet the'
'load, the damper opens to increase the flowrate.'
' '
'NOTE: constant-volume variable-temperature system'
'delivers a constant flow of air, varying the temperature'
'of the supply air in response to the zone load.'
' '
'It is important to note that the description given here'
'is used to simulate the convective regime induced in the'
'zone by the HVAC air handling system. It does not model'
'the performance and energy draws of the system-s'
'components. Therefore, you should ensure that the data'
'given here is consistent with the zone control data or'
'the explicit plant data that describes the HVAC system.'
*enditem
        CALL PHELPD('HVAC system type',46,'-',0,0,IER)
*item EconvC zone_htc_mech_sys_4
'Enter the air flow rate supplied by the system to the zone.'
'This is expressed in terms of zone air changes per hour.'
'  '
'You are asked for the following:'
'  The minimum air temperature that can be supplied by the'
'  system to the zone. This is the design temperature'
'  for cooling and is measured at the diffuser.'
'  '
'  The maximum air temperature that can be supplied by the'
'  system to the zone. This is the design temperature'
'  for heating and is measured at the diffuser.'
'  '
*enditem
        CALL EASKR(airflow,outs,' ',
        CALL EASKR(Tmin,outs,' ',
        CALL EASKR(Tmax,outs,' ',
*item EconvC zone_htc_mech_VAV_VT
'You are asked for the following:'
'  '
'  The temperature at which air is supplied to the'
'  zone when the system is cooling.'
'  '
'  The minimum air flow rate that the system can supply'
'  to the zone. This is flow rate that occurs when the dampers'
'  in the VAV box are at their minimum position. Thi is'
'  expressed in terms of zone air changes per hour.'
'  '
'  The maximum air flow rate that the system can supply'
'  to the zone. This is design flow rate and occurs when the'
'  dampers in the VAV box are at their max position. This'
'  is expressed in terms of zone air changes per hour.'
'  '
'  The maximum air temperature that can be supplied by the'
'  system to the zone. This is the design temperature for'
'  heating and is measured at the diffuser. Note that if the'
'  zone-s heating load cannot be satisfied by this supply'
'  air temp, it is assumed that any remaining heat is'
'  supplied from another source (e.g. baseboard heaters)'
'  which does not affect the flow regime.'
*enditem
        CALL EASKR(Tmin,outs,' ',
        CALL EASKR(airflow,outs,' ',
        CALL EASKR(airflow,outs,' ',
        CALL EASKR(Tmax,outs,' ',
*item EconvC zone_htc_mech_menu
'Typically the air handling unit (AHU) conditions outdoor'
'air. In this case, the conditioning of the outdoor air'
'is performed by the AHUs heating or cooling coil.'
' '
'You can choose to represent the outdoor air in your model'
'as infiltration to the zone. This would give the correct'
'total heating or cooling load for the zone. However, in'
'this case it is necessary to subtract the outdoor air'
'load from the zone-s total load. In this way, the correct'
'temperature and flow rate at the diffuser can be'
'calculated. This is handled automatically when you'
'select option [b].'
' '
'Alternatively, you can represent the AHU as another'
'zone. You would have infiltration of outdoor air to the'
'AHU zone then ventilation from the AHU zone to the'
'occupied zone. The energy inj/extracted to condition'
'this ventilation to the zone air-point temp must be'
'subtracted from the zone-s total load to correctly'
'calculate the temperature and flow rate at the diffuser.'
'This is handled automatically with option [c].'
' '
'Use option [a] if you have no outdoor air in your model.'
*enditem
        CALL PHELPD('Outdoor air treated as',23,'-',0,0,IER)
*item EconvC zone_htc_mech_diffuers
'The location of the supply diffusers affects the'
'convective regime in the zone. Select the option'
'that most closely describes the location of the'
'diffusers in the zone.'
' '
'If the diffusers are located within the ceiling, you'
'will be given the choice of using the Fisher'
'ceiling-jet or the Fisher & Pedersen correlations.'
'The Fisher horizontal-jet correlations will be used'
'if the diffusers are located in the wall.'
' '
'The Fisher or Fisher & Pedersen correlations will be'
'used when the AHU is on, while the Alamdari-Hammond'
'correlations will be used when it is off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
'  '
'Two alternate correlations are available to calculate'
'int-hc values for AHUs that supply air through ceiling'
'diffusers. Both were generated from the same'
'experimental data set but use different functional'
'forms. Refer to Appendix C of Beausoleil-Morrison'
'(2000) for a discussion of this topic.'
*enditem
        CALL PHELPD('Which correlations',6,'-',0,0,IER)
        CALL PHELPD('Diffuser location',18,'-',0,0,IER)
*subroutine EconvD
*item EconvD zone_htc_circ_fan_ok
'The circulation fan choice is appropriate when convection in'
'the zone is driven primarily by a heating or cooling device'
'that circulates air within the zone and there is NO intentional'
'supply or extract of air from the zone.'
'  '
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok(
*item EconvD zone_htc_circ_fan_synop
'The circulation fan choice is appropriate when convection in'
'the zone is driven primarily by a heating or cooling device'
'that circulates air within the zone and there is NO intentional'
'supply or extract of air from the zone.'
'  '
'You will be prompted to indicate which surfaces are'
'struck by the fan as this augments heat transfer.'
' '
'The ACA models convection as follows:'
'  walls, fan blowing on:'
'           Khalifa eq 8 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  walls, fan not blowing on:'
'           Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows, fan blowing on:'
'           Khalifa eq 8 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  windows, fan not blowing on:'
'           Khalifa eq 3 when heat on; Alamdari-Hammond'
'           vertical eq (or sim toggle) when heat off.'
'  floor:   Alamdari-Hammond stably stratified or buoyant'
'           horizontal eq (or sim toggle) when heat on'
'           or off.'
'  ceiling: Khalifa eq 4 when heat on; Alamdari-Hammond'
'           stably stratified or buoyant horizontal eq'
'           (or sim toggle) when heat off.'
*enditem
        CALL PHELPD('Outdoor air treated as',27,'-',0,0,IER)
        CALL ASKOK(outs,'(see help)',OK,dok,2)
*subroutine EconvE
*item EconvE zone_htc_mixed_ok
'The mixed choice is appropriate when convection in the zone'
'is driven by both mechanical and buoyant forces.'
'  '
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok(
*item EconvE zone_htc_mixed_opts
'The mixed choice is appropriate when convection in the zone'
'is driven by both mechanical and buoyant forces. The mechanical'
'forces are caused by an air handling system (AHU) that supplies'
'heated or cooled air to the zone through ceiling, floor, or'
'wall-mounted diffusers. The buoyant forces are caused by'
'surface-to-air temperature differences. This option is preferred'
'over the [air-based HVAC system] convective regime as it captures'
'the combined influence of buoyant and forced effects.'
' '
'Indicate the air-handling system type. This determines the'
'temperature and flow rate of air introduced to the zone and'
'thus the convective regime.'
' '
'Option [VAV with CV heating] is a variable air volume system'
'with constant vol heating.'
'  When the zone requires cooling, the supply air'
'  is chilled to a constant temp while the system'
'  adjusts the air flow to meet the cooling load. When the'
'  zone requires heat, the system supplies air at a fixed'
'  flow rate, equal to the min damper position of the VAV'
'  box. Reheat coils warm the air upstream of the diffuser'
'  to meet the zone-s heating load.'
' '
'Option [VAV with VV heating] is a variable air volume'
'system with variable volume heating.'
'  It operates the same as [VAV with CV heating] in cooling model.'
'  In 'heating mode, the dampers and reheat coils work in'
'  in conjunction to satisfy the heating load.'
'  At low heat loads the system delivers air at the low'
'  flowrate and the reheat coil heats the air to meet the'
'  load. If the reheat coil cannot meet the load,'
'  the damper opens to increase the flowrate.'
' '
'Option [n] is a constant-volume variable-temperature system.'
'  It delivers a constant flow of air, varying the temperature'
'  of the supply air in response to the zone. You are asked for'
'  the air flow rate in ac/h and the minimum air temperature'
'  that can be supplied (at the diffuser) for cooling.
' '
'It is important to note that the description given here'
'is used to simulate the convective regime induced in the'
'zone by the HVAC air handling system. It does not model'
'the performance and energy draws of the system-s'
'components. Therefore, you should ensure that the data'
'given here is consistent with the zone control data or'
'the explicit plant data that describes the HVAC system.'
' '
'Regardless of HVAC system type, the Beausoleil-Morrison'
'mixed flow correlations will be used when the AHU is on,'
'while the Alamdari-Hammond correlations will be used'
'when it is off.'
' '
'Refer to Section 5.2 and in particular Table 5.1 of'
'Beausoleil-Morrison (2000) for further details and'
'references to the int-hc correlations.'
*enditem
        CALL PHELPD('Mixed convection',39,'-',0,0,IER)
*item EconvE zone_htc_CVVT
'The constant-volume variable-temperature system delivers'
'a constant flow of air, varying the temperature of the'
'supply air in response to the zone. You are asked for'
'  '
'  the air flow rate in ac/h'
'  '
'  the minimum air temperature that can be supplied by'
'  the system to the zone. This is the design temperature'
'  for cooling and is measured at the diffuser.'
'  '
'  the maximum air temperature that can be supplied by the'
'  system to the zone. This is the design temperature for'
'  heating and is measured at the diffuser.
*enditem
        CALL EASKR(airflow,outs,' ',
        CALL EASKR(Tmin,outs,' ',
        CALL EASKR(Tmax,outs,' ',
*item EconvE zone_htc_VAVVT
'You are asked for the following:'
'  Supply air temperature (at diffuser) when the system is'
'  cooling
'  '
'  The minimum air flow rate that the system can'
'  supply to the zone. This is flow rate that occurs when'
'  the dampers in the VAV box are at their minimum'
'  position. This is expressed in terms of zone air'
'  changes per hour.'
'  '
'  The max air flow rate that the system can supply'
'  to the zone. This is design flow rate and occurs when the'
'  dampers in the VAV box are at their max position. This'
'  is expressed in terms of zone air changes per hour.'
'  '
'  The maximum air temperature that can be supplied by'
'  the system to the zone. This is the design temperature'
'  for heating and is measured at the diffuser. Note that'
'  if the zone-s heating load cannot be satisfied by this'
'  supply air temp, it is assumed that any remaining heat is'
'  supplied from another source (e.g. baseboard heaters)'
'  which does not affect the flow regime.'
*enditem
        CALL EASKR(Tmin,outs,' ',
        CALL EASKR(airflow,outs,' ',
        CALL EASKR(airflow,outs,' ',
        CALL EASKR(Tmax,outs,' ',
*item EconvE zone_htc_ahu_outside
'Typically the air handling unit (AHU) conditions outdoor'
'air. In this case, the conditioning of the outdoor air'
'is performed by the AHUs heating or cooling coil.'
' '
'You can choose to represent the outdoor air in your model'
'as infiltration to the zone. This would give the correct'
'total heating or cooling load for the zone. However, in'
'this case it is necessary to subtract the outdoor air'
'load from the zone-s total load. In this way, the correct'
'temperature and flow rate at the diffuser can be'
'calculated. This is handled automatically when you'
'select option [b].'
' '
'Alternatively, you can represent the AHU as another'
'zone. You would have infiltration of outdoor air to the'
'AHU zone then ventilation from the AHU zone to the'
'occupied zone. The energy inj/extracted to condition'
'this ventilation to the zone air-point temp must be'
'subtracted from the zone-s total load to correctly'
'calculate the temperature and flow rate at the diffuser.'
'This is handled automatically with option [c].'
' '
'Use option [a] if you have no outdoor air in your model.'
*enditem
        CALL PHELPD('Outdoor air treated as',23,'-',0,0,IER)
*subroutine EHCMAN
*item EHCMAN zone_htc_manual_overview
'The convection calculations file contains data for'
'controlling the calculation of internal and/or external'
'surface convection heat transfer for selected surfaces.'
' '
'It is possible to override the default convection'
'coefficient correlations for specified surfaces and for'
'specified time intervals.'
' '
'Four [convection-calculation control] methods are'
'supported when you add or edit a period: '
' '
'fixed coefficients - coefficients can be specified for'
'each surface (interior and exterior to the building).'
'The initialise fixed values option creates initial '
'values for this option. '
' '
'fixed correlations - specify a correlation to use'
'for each surface (only applicable for interior '
'surfaces). This could allow, for example, the use of'
'the Alamdari & Hammond correlations for a wall, while '
'using one of the Khalifa & Marshall correlations for a '
'window. '
' '
'adaptive - allows adaptive control of the calculations '
'(only applicable for interior surfaces). '
' '
'CEN - supports CEN standard coefficient regimes or'
'regimes which are similar in approach. Applicable to'
'both inside and outside surfaces. Note this option'
'includes its own method of setting default values. CEN'
'values are almost always imposed for the whole day'
'rather than mixed with other convective regimes. '
' '
'Note that the [outside] surface of a mlc may be interior'
'to the building, ie. it may face the air-point of an '
'adjacent zone. '
'  '
' Option * to find heat transfer coefficients for an equivalent'
'   m/s  you may supply an air velocity (m/s) and an APPROXIMATE'
'   set of hc values will be returned.  The method used is as in'
'   esp-r external hc calculations. '
'   For comparison, typcial inside correlations based on '
'   Alamdari & Hammond (assuming 1 degree C delta T and a'
'   typical surface dimension of 2m.). '
' '
'Remember to save any changes before you leave this menu.'
' '
'A cancel option should leave the model unchanged (please'
'check to ensure the model).'
*enditem
        CALL EASKI(ihcftp,' ',' Number of control periods ?',
        CALL EASKI(IN,' ',' Which control period ? ',
        CALL EASKI(IN,' ',' Delete which control period ? ',
        CALL EASKR(V1,' ','Air velocity (m/s) [see help message] : ',
*item EHCMAN
*enditem
        CALL PHELPD('conv coef data',37,'-',0,0,IER)
*subroutine EconvF
*item EconvF zone_htc_vert_chan_ok
'This choice is appropriate for open vertical channels'
'with flow driven primarily by buoyancy resulting from'
'surface-to-air temperature differences.'
' '
'There are lots of options. You probably want to '
'review the synopsis before selecting anything! '
*enditem
      call askok('View a synopsis of Bouyancy-driven flow in open ',
*item EconvF zone_htc_vert_chan_data
'This choice is appropriate for open vertical channels'
'with flow driven primarily by buoyancy resulting from'
'surface-to-air temperature differences.'
' '
'Molina & Maestre correlation was developed specifically'
'for the SOLVENT ventilated window with a gap of 4.5 cm.'
'For more details refer to proceedings of the '
'EPIC AIVC 2002 conference. '
'  '
'Bar-Cohen and Rosenhow is a generic correlation for    '
'open vertical channels. See Fundamentals of Heat and '
'Mass Transfer, Incroppera and DeWitt for more details. '
'  '
'For Molina or Bar-Cohen you are asked if the air enters from'
'the outside or another zone. If the latter you will be asked'
'to select which zone.'
'  '
'For Bar-Cohen you are asked for the channel width (inside'
'bane-to-pane distance) as well as the channel height.'
*enditem
        CALL PHELPD('Channel correlations',12,'-',0,0,IER)
        CALL EASKAB(' ','Air enters channel from','Outdoor',
        CALL EASKR(CWIDTH,'Channel width ?',
        CALL EASKR(CHEIGHT,'Channel height ?',
        CALL << edited to this point >>
*subroutine EPHCF
*item EPHCF zone_htc_control_edit
'A number of user inputs are required to define a control period'
'for control of heat transfer coefficients:
'  '
'  The start and end of the control period where time is a real'
'  number between 0. and 24. '
'  '
'Four [convection-calculation control] methods are'
'supported: '
' '
'fixed coefficients - allows coefficients to be specified '
'  for each surface (interior and exterior to the building).'
'  This data is usually taken from measurements. If you enter'
'  a -1 then the default calculated values will be used for the'
'  surface.
' '
'fixed correlations - allows you to specify a correlation '
'  to use for each surface (only applicable for interior '
'  surfaces). This could allow, for example, the use of'
'  the Alamdari & Hammond correlations for a wall, while '
'  using one of the Khalifa & Marshall correlations for a '
'  window. '
' '
'adaptive - allows adaptive control of the calculations '
'  (only applicable for interior surfaces). '
' '
'CEN - supports CEN standard coefficient regimes or'
'  regimes which are similar in approach. '
' '
'Note that the [outside] surface of a mlc may be interior'
'to the building, ie. it may face the air-point of an '
'adjacent zone. '
'  '
'If you select a specific surface to edit you have the option'
'of changing the value to -1 to signal use of the default value.'
*enditem
      CALL EASKR(V1,' ',' Start time ? ',
      CALL EASKR(V2,' ',' End time ? ',
      CALL EASKATOG('calculation control (see help):',' ',
      CALL PHELPD('conv coef data',2,'-',0,0,IER)
      CALL EASKS(SN,outs,'inside, outside?',12,' -1.0 -1.0',
*item EPHCF zone_htc_correlat_edit
'A number of empirical correlations and fixed values, '
'extracted from the following sources, are supported: '
' '
'Alamdari and Hammond (1983), Improved Data Correlations'
'for Buoyancy-Driven Convection in Rooms,BSER&T, 4(3) 106-12.'
' '
'Khalifa and Marshall (1990), Validation of Heat '
'Transfer Coefficients on Interior Building Surfaces '
'Using a Real-Sized Indoor Test Cell, Int. J. Heat '
'and Mass Transfer, 33 (10) 2219-2236. '
' '
'Halcrow (1987), Heat Transfer at Internal Building '
'Surfaces, Report to ETSU, British Department of Energy.'
' '
'CIBSE Guide (1988), 5th Edition, Table A3.4.'
' '
'CEN (1995), Thermal Performance of Buildings, Room'
'Cooling Load Calculation, General Criteria for a'
'Simplified Calculation Method, CEN/TC89/WG6 N.225 /'
'JWG-N79, Section 6.2.2. '
' '
'Each correlation is identified by an index.  Refer to'
'/usr/esru/src/esp-r/esrubld/convect2.F, subroutine'
'SELCOR1, where the index numbers held in the HTC file'
'(what you supply NOW) are then matched with ICOR'
'indicies in HTBOUY. A summary is listed below: '
'IHTC ICOR           ICOR          ICOR'
' 1   1 for vertical, 50 horiz up, 70 horiz down'
' 2   5 for vertical, 50 or 60 horiz up, 70 horiz down'
' 3   6 for vertical, 50 or 61 horiz up, 70 horiz down'
' 4   2 for vertical, 51 horiz up, 71 horiz down'
' 5   3 for vertical, 52 horiz up, 72 horiz down'
' 6   4 for vertical, 53 horiz up, 73 horiz down'
' 7   9 for vertical, 54 horiz up, 74 horiz down'
' '
'The ICOR indices are as follows: '
'1 Alamdari & Hammond for vertical surfaces '
'2 Halcrow time invariant low for vertical surfaces'
'3 Halcrow time invariant high for vertical surfaces '
'4 CIBSE for vertical surfaces '
'5 Khalifa & Marshall for non heated vertical surfaces'
'6 Khalifa & Marshall fan in room or floor heating'
'7 Khalifa & Marshall radiator in room not under window'
'8 Khalifa & Marshall fan heater in room wall oppos fan'
'9 CEN for vertical surface'
'10 Fisher & Pedersen for radial ceiling diffuser'
'11 Fisher for radial ceiling diffuser'
'12 Fisher for free horizontal jet'
'13 Fisher thesis mixed convection'
'14 Awbi and Hatton.'
'15 Molina & Maestre ventilated channels '
'16 Bar-Cohen ventilated channels '
'30 Khalifa & Marshall window over radiator'
'31+ - see source code for more options or request a list'
'of available correlations.'
'-1 indicates that a correlation will be chosen based '
'on the simulation toggle. Correlation chosen for '
'surfaces exterior to the building will be ignored. '
*enditem
          CALL EASKI(IH,outs,' (-1.= simulation toggle = default) ? ',
          CALL EASKI(IH,outs,' (-1.= simulation toggle = default) ? ',
*item EPHCF zone_htc_adaptive_edit
'It is possible for the convection calculations to '
'[adapt] as the simulation progresses.  You must assign '
'a [control law] for each interior surface face, which '
'defines how the calculations will adapt. The following '
'control laws are available: '
' '
'Law 1: two correlations specified for each surface; '
'one correlation used when plant is heating zone '
'(radiation or convection); other correlation used when '
'zone is unheated. Appropriate when plant system alters '
'convection regime within zone. '
' '
'Adaptive control is only applicable for interior '
'building surfaces. Control laws specified for other side '
'faces of surfaces will be ignored. As well, a control law '
'specified for an [outside] surface which faces the '
'air-point of an adjacent zone will be ignored: the law'
'specified in the neighbouring zone will take precedence.'
'Specify law [99] in these cases where adaptive control'
'is not applicable. '
' '
'A cancel leaves the current control law unchanged.'
*enditem
          CALL EASKI(Ilaw,outs,' (99=no control for this surface)',
*item EPHCF zone_htc_adaptive_c1
'Correlation for ON = correlation to use when plant'
'is heating zone. '
' '
'Correlation for OFF = correlation to use when zone'
'is unheated. '
' '
'Each correlation is identified by an index.  Refer'
'to /usr/esru/src/esp-r/esrubld/convect.F,'
'subroutine HTBUOY, where the index numbers are'
'assigned to ICOR. '
' '
'-1 indicates that a correlation will be chosen'
'based on the simulation toggle. '
*enditem
  102       CALL EASKS(stuff,' correlation indices',
*item EPHCF zone_htc_adaptive_sim
'It is possible for the convection calculations to '
'[adapt] as the simulation progresses.  You must assign '
'a [control law] for each interior surface, which '
'defines how the calculations will adapt. The following '
'control laws are available: '
' '
'Law 1: two correlations specified for each surface; '
'one correlation used when plant is heating zone '
'(radiation or convection); other correlation used when '
'zone is unheated. Appropriate when plant system alters '
'convection regime within zone. '
' '
'Adaptive control is only applicable for interior '
'building surfaces. Control laws specified for exterior '
'surfaces will be ignored. As well, a control law '
'specified for an [outside] surface which faces the '
'air-point of an adjacent zone will be ignored: the law'
'specified in the neighbouring zone will take precedence.'
'Specify law [99] in these cases where adaptive control'
'is not applicable. '
' '
'A cancel leaves the current control law unchanged.'
*enditem
          CALL EASKI(Ilaw,outs,' (99=no control for this surface)',
*item EPHCF zone_htc_cen_default
'CEN standards impose specific hc values for surfaces'
'facing specific directions and if the surface is a '
'floor or ceiling the direction of heat flow is taken'
'into account. The hc at surfaces facing the outside '
'tends to be a standard value. '
' '
'In this facility you can over-ride the standard values'
'in case there are country-specific values. '
' '
'If you want to take the standard published values then'
'the task is only to identify which surface in the zone'
'is considered the typical floor and which surface is '
'a typical ceiling (CEN needs to know this). '
' '
'Default values are: '
' heat flow upwards (floor/ceiling/sloped) 5.0'
' heat flow downwards (floor/ceiling/sloped) 0.7'
' heat flow at walls (inside/partition side/) 2.5'
' heat flow at otherside exterior 8.0 (4+4v) where'
'  v is assumed to be 1m/s'
' '
'Sometimes CEN tests require you to lump radiant and'
'convective values at the outside (typically in con-'
'junction with zero emissivity at the outside) and '
'in this case you would need to edit the standard '
'value of 8.0. '
*enditem
          CALL ASKOK('This is probably your initial description for',
          CALL ASKOK('The base and top surfaces of the room have',
          CALL PHELPD('CEN conv coef data',20,'-',0,0,IER)
          CALL EASKR(V1,' ','Hc for upwards heat flow at floors?',
          CALL EASKR(V1,' ','Hc for downwards heat flow at floors?',
          CALL EASKR(V1,' ','Hc at outside (exterior) floors?',
          CALL EASKR(V1,' ','Hc for upwards heat flow at ceilings?',
          CALL EASKR(V1,' ','Hc for downwards heat flow at ceilings?',
          CALL EASKR(V1,' ','Hc at outside (exterior) ceilings?',
          CALL EASKR(V1,' ','Hc for upwards heat flow at sloped?',
          CALL EASKR(V1,' ','Hc for downwards heat flow at sloped?',
          CALL EASKR(V1,' ','Hc at outside (exterior) sloped?',
          CALL EASKR(V1,' ','Hc at inside face of walls?',
          CALL EASKR(V1,' ','Hc at other (partition) face of walls?',
          CALL EASKR(V1,' ','Hc at outside (exterior) walls?',
*subroutine HVACGIN
*item HVACGIN zone_hvac_file
'A hvac file holds the definition for an idealized      '
'building hvac system, which can supply the building    '
'with heating, cooling, and/or ventilation.             '
'The file is optional.                                  '
' '
'The browse option presents a list of files in the      '
'project [hvac] folder. If you do not select one then it'
'is assumed that you do not want an hvac system.        '
'If you cancel then nothing will be changed.            '
'  '
'The dereference option dereferences the hvac file from '
'your model but does not delete it. Your may re-        '
'establish this hvac by referencing the hvac file at a  '
'later point in time.'
'  '
'If you are creating a new hvac file you will be asked to'
'specify the altitude of the site (needed to determine the'
'density of the air) in metres.'
'  '
'You will also aske to specify whether there is an air'
'conditioning unit in addition to a furnace.'
*enditem
          CALL EASKS2CMD(def_hvacfile,'HVAC file? (suggested name)',' ',
          CALL EASKS2CMD(def_hvacfile,'HVAC file? (see help)',
          call EASKAB(' File not found.','Options:',
          CALL EASKR(site_altitude,
          call EASKABC('Furnace',' ','With A/C','Without A/C',
*item HVACGIN zone_hvac_ashp
'Please select whether the ASHP is used for heating, cooling,'
'or both. You will have the option to add a furnace backup.'
'  '
'If you reach the maximum number of hvac systems you will be asked'
'to delete an existing system in order to add an additional system.'
*enditem
              call EASKABCD('Please select unit use',' ','Heating',
              CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
              call EASKABC('Select backup',' ','Furnace backup',
              CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
*item HVACGIN zone_hvac_ashp_no_heat
'If you did not choose heating & cooling when you initially'
'defined this system. Please exit this menu and choose either only'
'heating or cooling, and add in the second system afterwards,'
'otherwise another system may be overwritten.'
*enditem
                  CALL PHELPD('Possible Overwrite',2,'-',0,0,ier)
                  CALL EASKAB('', ' ','Continue (dangerous)', 'Go back',
*item HVACGIN zone_hvac_gshp
'Please select whether the GSHP is used for heating, cooling or'
'both. You will have the option to add a furnace backup.'
'  '
'If you reach the maximum number of hvac systems you will be asked'
'to delete an existing system in order to add an additional system.'
*enditem
              call EASKABCD('Please select unit use',' ','Heating',
              CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
              call EASKABC('Select backup',' ','Furnace backup',
              CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
              CALL EASKAB(' ', ' ','Continue (DANGEROUS! Eek!!!)',
*subroutine HVAC_type
*item HVAC_type zone_hvac_primary
'Select the primary HVAC component - You will have the     '
'option to add additional information in the next section. '
'                                                          '
'Furnace:                                                  '
'You can choose with or without a/c in the next menu.      '
'                                                          '
'Baseboard Heating:                                        '
'                                                          '
'Air-source heat pump:                                     '
'You can choose with or without furnace backup             '
'in the next menu.                                         '
'                                                          '
'Ground-source heat pump:                                  '
'You can choose with or without furnace backup             '
'in the next menu.                                         '
*enditem
      CALL EPICKS(hvac_selections,hvac_choice,
*subroutine FURNOPT
*item FURNOPT zone_system_priority
'If the priority has not been set you are asked to define'
'the priority of the system:'
' 1 default priority'
' 2 backup'
*enditem
        CALL EASKI(ipriority(i),'Specify the system priority',
*item FURNOPT zone_furnace_type
'Select furnace type.  Only certain fuels can be matched'
'with each furnace type.  If a furnace has only one'
'acceptable fuel type, it will be assigned automatically'
'otherwise you will be presented with a list of fuel'
'options to choose from.'
*enditem
      CALL EPICKS(ipck,chosen_sys,' ','Select a furnace type:',30,
*item FURNOPT zone_furnace_fuel_type
'Not all furnace types work with each fuel type.'
'Electric'
'Electric forced-air.'
' '
'Natural gas or propane'
'Spark-iginition with and without damper,continuous'
'pilot, condensing furnace, and induced draft.'
' '
'Oil'
'Flame retention head, flue vent damper,condensing'
'Mid efficiency, and oil furnace or boiler.'
' '
'Wood'
'Advanced air tight wood stove, catalytic'
'converter, wood furnace.'
*enditem
          CALL EPICKS(ipck, chosen_fuel, ' ','Select fuel type:',30,
*item FURNOPT zone_valid_fuel_type
'Please reenter a valid fuel type'
*enditem
            CALL PHELPD('Incorrect combination', 1, '-',0,0, ier)
            CALL PHELPD('Incorrect combination', 1, '-',0,0, ier)
*item FURNOPT
*enditem
      CALL EASKI(num_sys_zones(i),' ',
*item FURNOPT zone_furnace_zones
'Enter the number of zones that the furnace system'
'serves. Your model may be split into several zones,'
'with different HVAC systems serving different zones.'
'  '
'Note: the number of zones chosen must be equal to'
'or less than the number of zones in the model.'
'Once number of zones being supplied has been'
'picked, the fraction of supplied energy to each'
'zone must be stated.'
*enditem
      CALL EPICKS(ival, sys_zone_number, ' ',
*item FURNOPT zone_furnace_frac
'Enter the fraction of the system capacity associated'
'with this zone.  The sum of the fractions to all zones'
'must be equal to 1.'
'  '
'If fractions do not add to one you will be asked to re-enter'
'the zone index and fractions.'
*enditem
        CALL EASKR(sys_zone_cap_frac(i,k),
        CALL PHELPD('Unequated fractions',3,'-',0,0,ier)
*item FURNOPT zone_furnace_capacity
'Each system has a steady state capacity (W) up to 100000.'
'  '
'Each system also has an efficiency between 0. and 1.'
'  '
'A primary system should have the same fan mode as its backup system.'
*enditem
      CALL EASKR(ss_capacity(i),'Steady state capacity of the system',
      CALL EASKR(ss_efficiency(i), ' ',
      CALL EASKABCD(' ','circulation fan mode', 'No Fan Associated',
*item FURNOPT zone_sys_fan_cap
'Enter the fan power of the system in Watts.'
'If -1 is entered, the power is estimated internally.'
'  '
'If the fan is in continuous mode, fan power need to'
'be included as internal gain in the ESP-r operations file.'
*enditem
        CALL EASKR(fan_power(i), ' ', 'Fan power (W)', -1.,'F',1.E4,'F',
        CALL PHELPD('Continuous Mode Operation of Fan',2,'-',0,0,ier)
*item FURNOPT zone_draft_fan_cap
'Enter the draft fan power of the system in Watts.'
'If unknown, a selection of 75W is suggested.'
*enditem
        CALL EASKR(draft_fan_power(i), ' ', 'Draft fan power (W)', -1.,
*item FURNOPT zone_furnace_pilot
'Enter the pilot power. If not known, 500W is suggested.'
*enditem
        CALL EASKR(pilot_power(i),' ','Pilot power (W)',0.1,'F',1000.,
*item FURNOPT zone_ducts_included
'Specify whether there is a duct system associated'
'with the HVAC system.  This is not used now but the'
'value is needed.'
*enditem
      CALL EASKI(iduct_sys_flag(i),'Specify if there is a duct system',
*subroutine BASEBOARD_INPUTS
*item BASEBOARD_INPUTS
'Select whether the baseboard system is a primary'
'system, or whether it serves as a backup system'
'in the zones.'
*enditem
C        CALL EASKI(ipriority(i),'Specify the system priority',
*item BASEBOARD_INPUTS zone_baseboard_data
'Baseboard systems have a number of attributes. You will be'
'asked for:'
'  '
'  The number of zones that the baseboard system serves.'
'  Your model may be split into several zones, with different'
'  HVAC systems serving different zones.'
'  '
'  The number of zones chosen must be equal to or less than'
'  the number of zones in the model. Once number of zones being'
'  supplied has been picked, the fraction of supplied energy to each'
'  zone must be stated.'
'  '
'  You are asked for the fraction of the system capacity associated'
   with each zone.  The sum of the fractions to all zones must'
'  equal to 1.  If not you will be asked to re-enter the zones and'
'  their fractions.'
'  '
'  The steady state capacity of the system (W) is needed.'
'  '
'  The steady state efficiency of the system (between 0. and 1.)'
'  is needed.'
'  '
'  If the baseboard is a backup, this should be the same'
'  as that for the primary system except when the primary'
'  system has a fan and the baseboard has no fan.  In this'
'  case, select no fan for the backup baseboard here, and'
'  then choose auto or continuous mode for the primary system.'
'  '
'  The baseboard fan power of the system in Watts. If a'
'  -1 is entered, the power is estimated internally.'
'  If the fan is in continuous mode, fan power need to'
'  be included as internal gain in the ESP-r operation file.'

*enditem
      CALL EASKI(num_sys_zones(i),' ',
      CALL EPICKS(ival, sys_zone_number, ' ',
      CALL EASKR(sys_zone_cap_frac(i,k),
      CALL PHELPD('Unequated fractions',3,'-',0,0,ier)
      CALL EASKR(ss_capacity(i),'Steady state capacity of the system',
      CALL EASKR(ss_efficiency(i),
      CALL EASKABCD(' ','circulation fan mode', 'No Fan Associated',
      CALL EASKR(fan_power(i), ' ', 'Fan power (W)',-1.,'F',1.E4,'F',
      CALL PHELPD('Continuous Mode Operation of Fan',2,'-',0,0,ier)
*subroutine HPHOT
*item HPHOT zone_hvac_hp_primary
'Select whether the heat pump system is a primary'
'system, or whether it serves as a backup system'
'in the zones.'
*enditem
        CALL EASKI(ipriority(i),'Specify the system priority',
*item HPHOT zone_hvac_hp_poor
'If the heating system is an air source heat pump, select'
'whether it is typical, good, or poor.'
*enditem
        CALL EASKABC(' ', 'Enter the heat pump unit type',
*item HPHOT zone_hvac_hp_zones
'Enter the number of zones that the system'
'serves. Your model may be split into several zones,'
'with different HVAC systems serving different zones.'
'  '
'Note: the number of zones chosen must be equal to'
'or less than the number of zones in the model.'
'Once number of zones being supplied has been'
'picked, the fraction of supplied energy to each'
'zone must be stated.'
*enditem
      CALL EASKI(num_sys_zones(i),' ',
      CALL EPICKS(ival,sys_zone_number,'','Select zones being supplied',
*item HPHOT zone_hvac_hp_zfrac
'Enter the fraction of the system capacity associated'
'with this zone.  The sum of the fractions to all zones'
'must be equal to 1. If it does not you will be asked to'
'reselect the zones and their fraction.'
*enditem
        CALL EASKR(sys_zone_cap_frac(i,k),
          CALL PHELPD('Unequated fractions',3,'-',0,0,ier)
*item HPHOT zone_hvac_hp_data
'Heat pumps have a number of attributes:
' '
'  steady state capacity of the system in Watts.'
'  '
'  COP (Max = 50)
'  '
'  Flow rate - if set < 0, the value is set internally'
'  This is the flow rate that occurs during the actual'
'  operation of the heat pump system.'
'  '
'  Flow rate at rated conditions. If < 0 the value is set'
'  internally.'
'  '
'  Fan mode (no fan, automatic mode, continuous mode) which'
'  should be the same for the primary and the backup.'
'  '
'  If the fan is automatic or continuous you must specify whether'
'  the fan is positioned to 1) blow through or 2) draw through.'
'  '
'  If there is an automatic or continupus fan specify the'
'  circulation fan power of the system in Watts.'
'  If -1 is entered, the power is estimated internally.'
'  If the fan is in continuous mode, fan power also needs to'
'  be included as internal gain in the ESP-r opr file.'
'  '
'  The fan power for the outdoor evaporator of the heat pump is'
'  also required (although not used while heating).'
'  '
'  In auto mode there is an fan power which, although not used'
'  during heating is still a required value.'
'  '
'  Heat pumps fan position with repspect to the heat exchanger'
'  during a ratings test are 1) blow through or 2) draw through.'
'  '
'  Also during the ratings test the circulation fan power will be'
'  recorded. This is not used while heating but is a required value.'
'  If the power is <0 then the value is set internally.'
*enditem
      CALL EASKR(ss_capacity(i),'Steady state capacity of the system',
      CALL EASKR(ss_cop(i),' ','Heat pump COP', 0., 'F', 1000., 'F',
      CALL EASKR(flow_rate(i),' ','Flow Rate',-1., 'F', 10.0, 'F', 0.,
      CALL EASKR(flow_rate_r(i),' ',
      CALL EASKABCD(' ','circulation fan mode', 'No Fan Associated',
      CALL EASKI(ifan_position(i),
      CALL EASKR(fan_power(i), ' ', 'Circulation Fan power (W)',
      CALL PHELPD('Continuous Mode Operation of Fan',2,'-',0,0,ier)
      CALL EASKR(outdoor_fan_power(i), ' ', 'Outdoor Fan power (W)',
      CALL EASKR(fan_power_auto(i),' ',
      CALL EASKI(ifan_position_r(i),
      CALL EASKR(fan_power_r(i),' ',
*item HPHOT zone_hvac_hp_temp_ctl
'Temperature Control'
'  1 - Balanced Point'
'  2 - Restricted (term to be defined)'
'  3 - Unrestricted (term to be defined)'
'  '
'You are also aked for a cutoff temperature in degrees C.'
*enditem
      CALL EASKI(itemp_control(i), 'Temperature Control',
      CALL EASKR(cutoff_temp(i),' ','Cutoff T in C',-1., 'F', 50.,'F',
*subroutine HPCOLD
*item HPCOLD zone_hvac_hp_primary
'Select whether the heat pump system is a primary'
'system, or whether it serves as a backup system'
'in the zones.'
*enditem
        CALL EASKI(ipriority(i),'Specify the system priority',
*item HPCOLD zone_hvac_hp_poor
'If the heating system is an air source heat pump, select'
'whether it is typical, good, or poor.'
*enditem
        CALL EASKABC(' ', 'Enter the heat pump unit type',
*item HPCOLD
'Enter the number of zones that the system'
'serves. Your model may be split into several zones,'
'with different HVAC systems serving different zones.'
'  '
'Note that the number of zones chosen must be equal to'
'or less than the number of zones in the model.'
'  '
'Once number of zones being supplied has been'
'picked, the fraction of supplied energy to each'
'zone must be stated. If the total fraction is not 1'
'you will be asked to respecify the zones and fractions.'
*enditem
      CALL EASKI(num_sys_zones(i),' ',
      CALL EPICKS(ival, sys_zone_number, ' ',
      CALL EASKR(sys_zone_cap_frac(i,k),
      CALL PHELPD('Unequated fractions',3,'-',0,0,ier)
*item HPCOLD
'Heat pumps have a number of attributes:
' '
'  steady state capacity of the system in Watts.'
'  '
'  COP (Max = 50)
'  '
'  Flow rate - if set < 0, the value is set internally'
'  This is the flow rate that occurs during the actual'
'  operation of the heat pump system.'
'  '
'  Flow rate at rated conditions. If < 0 the value is set'
'  internally.'
'  '
'  Fan mode (no fan, automatic mode, continuous mode) which'
'  should be the same for the primary and the backup execpt'
'  when the primary system has a fan and the heat pump has'
'  no fan. In this case, select no fan for the backup hp and'
'  then choose auto or continuous for the primary system.'
'  '
'  If the fan is automatic or continuous you must specify whether'
'  the fan is positioned to 1) blow through or 2) draw through.'
'  '
'  If there is an automatic or continupus fan specify the'
'  circulation fan power of the system in Watts.'
'  If -1 is entered, the power is estimated internally.'
'  If the fan is in continuous mode, fan power also needs to'
'  be included as internal gain in the ESP-r opr file.'
'  '
'  The fan power for the outdoor evaporator of the heat pump is'
'  also required (although not used while heating).'
'  '
'  In auto mode there is an fan power which, although not used'
'  during heating is still a required value.'
'  '
'  Heat pumps fan position with repspect to the heat exchanger'
'  during a ratings test are 1) blow through or 2) draw through.'
'  '
'  Also during the ratings test the circulation fan power will be'
'  recorded. This is not used while heating but is a required value.'
'  If the power is <0 then the value is set internally.'
*enditem
     CALL EASKR(ss_capacity(i),'Steady state capacity of the system',
     CALL EASKR(ss_cop(i),' ','Heat pump COP', 0., 'F', 1000., 'F',
     CALL EASKR(flow_rate(i),' ','Flow Rate',-1., 'F', 10.0, 'F', 0.,
     CALL EASKR(flow_rate_r(i),' ',
     CALL EASKABCD(' ','circulation fan mode', 'No Fan Associated',
     CALL EASKI(ifan_position(i),
     CALL EASKR(fan_power(i), ' ', 'Circulation Fan power (W)',
     CALL PHELPD('Continuous Mode Operation of Fan',2,'-',0,0,ier)
     CALL EASKR(outdoor_fan_power(i), ' ', 'Outdoor Fan power (W)',
     CALL EASKR(fan_power_auto(i),' ',
     CALL EASKI(ifan_position_r(i),
     CALL EASKR(fan_power_r(i),' ',
*item HPCOLD zone_hvac_hp_sensible
'This is capacity at ARI rating conditions (26.7 oC Tdb'
'and 19.4 Twb oC).'
'  '
'You are also asked whether the cooling is a conventional system'
'or one with an economizer.'
'  '
'If you select the conventional system you can define the outdoor'
'air flow into the duct system as a function of days (multiple types'
'are supported) with periods in each of these day types.'
'The following information is required:'
'  The number of different day types used to define the outdoor air'
'  schedule (fresh air into the duct system).'
'  '
'  For each day type you are asked for:'
'    - the number of periods'
'    - the hour of the year (out of 8760) at the end of the day type'
'  '
'  For each period (in a given day type) you are asked for the'
'  hour (between 0 and 24) at the end of the period. The first'
'  period of the day is assumed to start at 0.'
'  You are also asked for the air flow rate in m^3/s.'
*enditem
      CALL EASKR(shrr(i),' ','Sensible Heat Ratio',
      CALL EASKI(icooling_type(i),'Cooling Type',
      CALL EASKI(num_out_air_day_types(i),' ',
      CALL EASKI(num_outside_air_day_periods(i,day),
      CALL EASKI(iend_hour_out_air_daytype(i,day),
      CALL EASKI(iend_hour_out_air_dayperiod(i,period_counter),
      CALL EASKR(day_period_out_air_flow(i,period_counter),
*item HPCOLD zone_hvac_hp_economizer
'1. Indoor/Outdoor Temp integrated compressor control '
'   and option of outdoor dry-bulb temp limit control. This'
'   is a temperature based control with the compressor and'
'   the economizer running together to meet the load when'
'   the economizer can not meet the load by itself.'
'   You will be asked for the outdoor temperature limit in'
'   degrees C aboe which the economizer is turned off.'
' '
'2. Indoor/Outdoor Temp non-integrated compressor control'
'   and option outdoor dry-bulb temp limit control. This is'
'   a temperature based control with the compressor and the'
'   economizer not allowed to run together to meet the load'
'   when the economizer can not meet the load by itself.'
'   You will be asked for the outdoor temperature limit in'
'   degrees C aboe which the economizer is turned off.'
' '
'3. Enthalpy integrated compressor control and enthalpy'
'   limit control. This is an enthyalpy based control with'
'   the compressor and the economizer running together to'
'   meet the load when the economizer can not meet the load'
'   by itself.'
'   You will be asked for the outdoor enthalpy limit (J/kg)'
'   above which the economizer is turned off.'
' '
'4. Enthalpy non-integrated compressor control and'
'   enthalpy limit control. This is an enthalpy based'
'   control with the compressor and the economizer not'
'   allowed to run together to meet the load when the'
'   economizer can not meet the load by itself.'
'   You will be asked for the outdoor enthalpy limit (J/kg)'
'   above which the economizer is turned off.'
'  '
'Once the control type has been defined you are asked for:'
'  - minimum outdoor air flow in m^3/s.'
'  '
'  - the indoor temperature set point below which the'
'    economizer is turned off.' 
*enditem
        CALL EASKI(ieconomizer_control(i), 'Economizer Control Type ',
        CALL EASKR(economizer_min_out_air_flow(i),
        CALL EASKR(economizer_ind_temp_setpoint(i),
        CALL EASKR(economizer_out_temp_limitcon(i),
        CALL EASKR(economizer_out_enth_limitcon(i),
*item HPCOLD zone_hvac_hp_z_ctl
'The control function type in the ESP-r ctl file that is'
'associated with the heat pump operation in cooling mode'
'must be listed here.'
'It can be found either in the ctl module of the ESP-r'
'interface, or in the .ctl file itself.'
*enditem
      CALL EASKAB(' ',
*subroutine HVAC_MAIN_SUMMARY
*item HVAC_MAIN_SUMMARY zone_hvac_sys_types
'Displays the various systems present in the hvac file '
'and options for adding a new system (maximum of 5) or '
'saving the current file. To view a summary of specific'
'system characteristics within the hvac file, click on '
'the desired system.                                   '
' '
'Further options to edit each individual system are    '
'available in the next menu once the desired system is '
'chosen.                                               '
'  '
'If you are about to exceed the maximum number of havc'
'systems you will have to delete a system manually or'
'choose to overwrite an existing system description.'
*enditem
          CALL ASKOK('You will lose new info. if file hasnt been saved',
          call PHELPD('Main HVAC Summary Menu:',9,'-',0,0,IER)
          CALL PHELPD('Too many HVAC Sys', 3, '-', 0, 0, ier)
*subroutine HVAC_SYS_SUMMARY
*item HVAC_SYS_SUMMARY zone_hvac_sys_summary
'The system summary menu shows a summary of system   '
'characteristics of the system chosen from the main  '
'HVAC menu. This menu is not interactive, as many of '
'the system characteristics are interdependent. To   '
'change a system property, choose the edit option and'
'find the property in question. All other default    '
'suggestions will be the current system properties.  '
' '
'Note: Not all system properties are shown here, to  '
'ensure that the system will operate as expected     '
'choose edit and accept the default suggestions.     '
*enditem
          call PHELPD('System Summary Menu:',11,'-',0,0,IER)
          call PHELPD('Currently not an option, but will be added',9,
*subroutine ADDSUR
*item ADDSUR remove_vert_as_well
'Vertex is used in an existing edge. It probably should be'
'removed... but you are asked to confirm this action (so that'
'the edge topology is consistent). '
*enditem
c              call askok(outs,
*item ADDSUR duplicate_surf_name
'Each surface within a zone must have a unique name. A duplicate'
'name was detected so you are being asked to revise the surface'
'name.'
*enditem
          CALL EASKS(T14,'Revised surface name','(duplicate found)',
*item ADDSUR copied_surf_actions
'Actions possible for the newly copied surface: '
'  '
' Shift surface along (+=outwards) the surface normal (in'
' metres). All vertices attached to the surface will be'
' transformed. E.g. raise or lower a ceiling by Xm.j A zero'
' value does nothing.
'  '
' Transform vertices of the surface by X,Y,Z metres. Other'
' surfaces which share vertices will be impacted by this'
' transform.'
'  '
' Rotate surface about one of its vertices. The index of the'
' vertex is its position in the edge list of the surface. The'
' rotation is applied around this point. Positive is'
' anticlockwise. A zero results in no rotation.'
'  '
' Invert ordering (to swop front & back faces). The order of'
' the surface edges determines the direction of the surface'
' normal e.g. which side faces away from the zone). If you are'
' copying a surface (such as a partion) from one zone to '
' another you will usually want to invert the copied surface.'
' If you are creating back-to-back surfaces within the room'
' the copied surface is usually inverted to form the matching'
' orientation.
'  '
' Do several operations to the surface.  You are asked to provide'
' values for several options. A zero entry in the relevant entry'
' will skip that specific transform.'
'  '
' Continue with no action.'
'  '
'Often the transforms that are required for one surface'
'should also be applied to the other surfaces that you copied.'
' '
'Hint: Double check the zone after you have finished copying'
'the surfaces to ensure they are located correctly and face the'
'correct direction.'
*enditem
          CALL EASKATOG(' Actions to take on the new surface :',' ',
 552      CALL EASKS(hold64,
          CALL EASKR(vdis,' Distance along the normal (metres): ',
 152      CALL EASKS(HOLDS,' X Y & Z offsets: ',' ',
          CALL EASKI(IRV,'Rotate about which vertex index: ',' ',
          CALL EASKR(ANGR,' ',' Rotation (deg + = anticlockwise) ?',
          call askok(
          CALL EASKAB(' Reverse the edge ordering of',
          CALL ASKOK(outs,'(see help)',DDOK,dok,7)
*item ADDSUR create_new_surface
'A surface is composed of a list of vertices which form the'
'edges of the polygon. Type this list in order (anticlockwise'
'viewed from the outside). If in the wireframe view what you'
'see is the inside face of the polygon then the order will be'
'clockwise.'
'  '
'The indices in the list are integer positions of the'
'zone vertex e.g. the 3rd vertex is the 3rd in the'
'vertices associated with the zone.'
'  '
'Note: the last edge of the polygon is from the last vertex'
'to the start vertex.  Note that a polygon can have up to 32 edges.'
' '
'Or click mouse on existing vertices, ending with an [e]/ '
'A match is assumed if within 5 pixels. You will be given an'
'oportunity to confirm the list. '
*enditem
          CALL EASKS(HOLD,
          CALL EASKS248(t248,' Associated vertices (type indices)?',
          CALL EASKS248(t248,' Associated vertices (type indices)?',
          CALL EASKS248(t248,'Associated vertices (type indices)?',
*item ADDSUR new_surface_name
'Good surface names can speed up subequent editing and selection'
'tasks as well as making reports easier to read.  The name should'
'be unique within this zone.'
*enditem
 52     CALL EASKS(T14,'Surface name','(unique word <=12char):',
*subroutine ADDMASS
*item ADDMASS addmass_overview
'ESP-r zones can include surfaces floating within the zone which'
'represent mass. The interface allows you to create simple shaped'
'pairs of rectangular surfaces to represent mass. The origin and'
'the size of the rectangle will be shown on the wire-frame view.'
'  '
'If you accept the rectangle it will be converted into '
'a surface within the zone. If you elect to revise it'
'you will be presented with several options. '
*enditem
        CALL EASKABC('Options for this rectangle:',' ',
*subroutine ADDVERT
*item ADDVERT vert_add_overview
'A zone includes associated vertices which its surfaces may'
'reference. Vertices are located within the model coordinate'
'system and are in metres with sufficient resolution to ~a'
'tenth of a mm.'
'  '
'Z coordinates can be in specified relative to the model '
'coordinates.  If a building actually starts at 56m above'
'sea level you can use 56m as the coordinate or you can'
'consider this actual point as zero in the model coordinate'
'system. Height in geometry does not imply a change in air'
'density. Many people get confused if Z values are negative.'
*enditem
          CALL EASKS(HOLD,' Vertex  X  Y  Z (in metres): ',
*item ADDVERT vertex_near_edge
'Vertex is close to an existing edge. It probably should also'
'be included in the list of the adjacent surface (so that'
'the edge topology is consistent). '
*enditem
                        call askok(
*item ADDVERT vert_copy_overview
'When you copy a vertex remember that exact duplicates should'
'be avoided.  Vertices within 4mm are considered to be the'
'same and will tend to cause problems. '
'  '
'Usually one would copy a vertex and edit one of the coordinate'
'values e.g. to get a new point in the zone.'
'  '
'The vertex coordinates should be in metres. '
*enditem
        CALL EASKS(HOLD,outs,' X  Y  Z (in metres): ',
*subroutine INSREC
*item INSREC add_rect_overview
'When adding a rectangular opening (e.g. a window or'
'door) to a surface you specify its position within'
'the parent surface. For a window, this is an X Y'
'distance from the lower left hand corner of the parent'
'surface (when looking at the outside face of the parent'
'surface) to the lower left hand corner of the opening.'
'The opening will be the specified width and height.'
' '
'More complex shaped openings might begin as a rectangle'
'and then be modified via a combination of adding more'
'vertices and using the surface list & edges menu to'
'link them into the child and parent surfaces. Or consider'
'using the [within frame] option.
' '
'For [at base] e.g. door the position is given as a single'
'distance from the left edge of the parent surface (when'
'looking at the outside face) and a width and height.'
' '
'The [percentage of facade] otpion supports the insertion of'
'an opening (window) into a surface (roughly centred) as a'
'percentage of the facade area.'
'Openings will be inserted at the centre of the'
' '
'The [within frame] option asks you for a width of frame'
'and creates a frame inset that width from the edges of'
'the parent surface. This should work for surfaces of almost'
'any complexity (the frame can have more than 4 edges).'
'  '
'Generally a parent surface might contain one or two child'
'surfaces. Beyond that most users find the edge list to be'
'overly complex to work with.'
*enditem
      CALL EASKABCD(' Insert rectangular surface:','(see help)',
*item INSREC add_rect_offsets
'The X offset is the distance from the lower left '
'corner of the parent surface (looking at the'
'outside face) to the left side of the new surface.'
'The X offset should be at least 25mm for the edge'
'generation logic to work.'
' '
'The Z offset is the distance from the bottom  '
'edge of the parent surface (looking at the '
'outside face) to the bottom of the new surface.'
'The Z offset should be at least 20mm.'
' '
'The opening width and height are in metres. The'
'opening dimensions should be at least 100mm. '
*enditem
        CALL EASKS(hold,
        CALL EASKS(hold,
*item INSREC opening_percent_overview
'Define the surface area of the opening as a percentage'
'value of the parent surface (e.g. 40%).'
'The new surface will be located in the centre of the'
'parent surface. For best results choose a percentage'
'between 5 and 95.'
' '
'The logic assumes that the parent surface is rectangular'
'and may result in strange shapes if it is not. '
*enditem
        CALL EASKR(PERC,'Percentage of parent surface.',
*item INSREC confirm_location
'If the location appears to be correct in the preview'
'you can accept it by saying yes. If you are in doubt'
'then say no for a chance to modify it. '
*enditem
        CALL ASKOK('Position OK?','(see help)',OK,dok,3)
*item INSREC surface_name_logic
'Well named surfaces (e.g. call a door a door) '
'can help you understand a model better! '
*enditem
        CALL EASKS(T14,' ',' Inserted surface name (12 char max):',
*item INSREC surface_topology
'The topology of the current surface indicates that '
'there is probably an existing [hole] in the surface'
'(typically used for glazing). '
' '
'Polygons in esp-r are defined as a continuous line,'
'so the addition of a second [hole] requires that the'
'bounding surface be revised to flow around the new'
'surface.  '
' '
'You will be asked which corner of the new surface'
'and the vertex in the bounding surface to link to.'
'If the first [hole] linked to the lower left corner'
'(as indicated by a diagonal line) the new surface '
'might link to the lower right corner of the '
'bounding surface.  This convention will hopefully '
'limit the chance of the edges crossing. '
' '
'The bounding surface must be wrapped around new one'
'so you will be asked for additional information.'
' '
'If you cancel when asked about connecting to a'
'vertex in the bounding surface, the first point'
'of the bounding surface will be assumed. Please'
'resolve this issue at a later point!'
*enditem
          CALL PHELPD('tmc insert warning',24,'-',0,0,IER)
          CALL EASKAB('There is already a `hole` in the surface - ',
 8795     CALL EASKI(IVH,
*item INSREC vertex_close_to_edge
'The vertex is close to another edge. To maintain the'
'edge topology of the adjacent surface you probably want'
'to update the edges of the adjacent surface.'
*enditem
                    call askok(
*item INSREC mods_need_checking
'The modifications to the geometry of the zone, surface'
'attributes and topology which have been made need to'
'be checked closely.  For example the original surface'
'topology must have a link between the outer boundaries'
'and the [hole] so that it is a proper polygon. '
*enditem
        CALL PHELPD('surface details',5,'-',0,0,IER)
*subroutine ITINSRT
*item ITINSRT temporal_item_name
'In order to find items in the TDF db a unique name'
'must be assigned to each entry. This name is a '
'string up to 12 characters long with no blanks.'
'The word UNKNOWN is not acceptable.'
*enditem
      CALL EASKS(TTAG,' ','Name for entry? ',
*subroutine MFPROB
*item MFPROB flow_network_file_name
'The flow network file holds the definition of network'
'flow regime for this model. The file is optional.'
'The dereference option clears the name of the network '
'file but does not alter information within the network'
'description. You can re-establish the network by '
'including the file name and then re-linking to thermal '
'zones. '
'  '
'If the file name cannot be found you will be given an'
'opportunity to respecify the name.'
'  '
'As you evolve the network be sure to save often so that'
'the information in memory is not lost!'
*enditem
      CALL EASKSCMD(LTMP,' Flow network file ?',
*item MFPROB flow_network_synopsis
'A listing of the current flow network is available.'
'It includes information about the flow nodes and flow'
'components and the connections within the network.'
*enditem
        CALL ASKOK('Display a synopsis of the flow network?',' ',
        CALL EASKABCD(' File not found.','Options:',
*item MFPROB begin_flow_network
'Before you create the network, sketch the network out and'
'determine a naming scheme for the nodes and components. The'
'sketch is an important part of the QA process!'
'  '
'Begin the network description by specifying at least a few'
'of the nodes, components and connections in the network. Once'
'this is done save the network. You can the go on to expand'
'and update the network. '
' '
'The description of a flow network begins with the description'
'of flow nodes. Internal nodes are typically associated with'
'the zones of the model. Boundary nodes represent locations on'
'the facade where leakage may occurr. A functioning network '
'must have at least three nodes. '
' '
'You can select the zones to be included in the network'
'the program will then automatically generate the '
'internal nodes associated with those zones.'
'  '
'You also automatically generate internal connections'
'between the nodes in your network, but define the '
'linking components (door, vents) first. '
' '
'  a) REMEMBER to include boundary nodes in your network.'
'     These are NOT auto generated. '
'  b) Also remember to connect boundary nodes into your '
'     network!'
'  '
'A flow network can include air, liquids or a mix of'
'air and liquids (as long as the fluids do not mix).'
'  '
'There is one flow network in the model, even if there is'
'more than one building in the model.'
*enditem
          CALL PHELPD('create net',22,'-',0,0,IER)
          CALL EASKABC(' Is the new network:',' ',
*item MFPROB flow_network_from_opr
'This option scans existing zone operations files'
'and creates (at a minimum) one node for each zone'
'with the same name as the zone.'
' '
'It creates fixed volume flow rate components'
'to represent simple infiltration patterns (it finds'
'the peak value of infiltration in each zone) and'
'names the component infil.xxxx where xxxx is the'
'flow rate in m3/s. '
' '
'It creates fixed volume flow rate components to'
'represent simple ventilation patterns (via the '
'peak ventilation rate) and names the components '
'vent.xxxx where xxxx is the flow rate in m3/s. '
' '
'It creates a source boundary wind pressure node'
'and a sink boundary wind pressure node as well'
'as a set of orifices from each zone to the sink'
'to allow exfiltration. Note that because the'
'flow into the zone via infiltration is represented'
'as a volume flow rate component the orientation '
'of the boundary node is a guess as wind pressures '
'are not taken into account in such components. '
' '
'This is only a rough network, it will need to '
'be checked. '
' '
'Many zone operation files where ventilation and/or'
'infiltration rates change during the day will'
'require flow controls to be created. This is not'
'yet done automatically. '
' '
'Zone operation control of infiltration & ventilation'
'are not yet supported.  '
*enditem
          CALL PHELPD('create oper net',35,'-',0,0,IER)
          CALL ASKOK('Do you want to auto-generate flow nodes?',
*item MFPROB flow_network_menu_synop
'Esp-r simulates one-dimensional fluid flow within the model'
'zones and/or plant network. This involves the calculation'
'of fluid flow through branches and nodes in a network which'
'represents the building and/or plant network. The nodes and '
'branches define boundary pressure points, internal node'
'characteristics and flow restrictions. '
' '
'Esp-r uses an iterative mass balance approach in which nodal'
'pressures are adjusted until the mass residual of internal'
'nodes satisfies some criterion.'
' '
'Fluid flow NODE data:'
'  Name (up to 12 characters with no blanks) '
'  Fluid (1=air, 2=water) '
'  Type  (0=internal; unknown pressure '
'         1=internal; known total pressure '
'         2=boundary; known total pressure  * '
'         3=boundary; wind induced pressure *) '
'  Reference height above datum (m)         * '
'  Fluid temperature (C)'
'     optionally equal to temperature of some node'
'     if type=2: optionally equal to outside temp.'
'        type=3: outside air dry bulb temperature'
'  Supplementary data'
'     if type=0: volume (m^3)'
'        type=1: pressure (Pa) & volume (m^3)'
'        type=2: pressure & node fluid temp flag'
'        type=3: wind pressure index & surf azimuth'
' * note that pressure of a type 3 node includes '
'   stack pressure evaluated with P=0 at height=0. '
' '
'Fluid flow COMPONENT data: '
'  Name (up to 12 characters with no blanks)'
'  Type (from list)'
'  Number of supplementary data items '
'  Supplementary data: '
'     (number of data items depends on component type;'
'      first item always fluid type) '
' '
'Fluid flow LINKAGE data: '
'  Name of 1st node (+ve side of connection) '
'  Height of linkage point relative to 1st node (m) '
'  Name of 2nd node (-ve side of connection) '
'  Height of linkage point relative to 2nd node (m) '
'  Name of linking fluid flow component '
' '
'Local WIND speed REDUCTION factor : '
'  (= ratio of local wind speed at roof height'
'     and measured wind speed) '
' '
'Converting zone infiltration and ventilation schedules'
'into a (roughly) equivalent flow network is also an'
'option. This is useful when you started a model with'
'schedules and want to increase resolution/complexity'
'or better track flow rates. '
'  '
'Note: The current network description will be lost if you '
'read in a new network file or create a new network.'
*enditem
        CALL ASKOK(' Reading or creating a new model file will',
        CALL EASKS(LTMP,' Fluid flow network file ? ',
*item MFPROB flow_auto_generate
'You now have the option of automatically generating'
'flow nodes from the building description. Select'
'the zones you wish to include in the flow network and'
'a corresponding flow node will be generated with'
'the same name and with the correct volume.'
'  '
'However, you should have up-to-date building connections'
'information and defined the linking components (doors, vents,'
'etc.) you will need before commencing the automatic connection'
'generation. If you have not done either then DO NOT select the '
'auto detection option.  '
' '
'Note: a flow network should include all of the zones in'
'your model. Any information about infiltration and'
'ventilation in zone operation files will be ignored.'
*enditem
          CALL ASKOK('Do you want to auto-generate flow nodes?',
          CALL ASKOK('Auto-generate flow connections?','(see help)',
*item MFPROB link_node_to_zone
'You can have flow nodes which are not linked to a thermal'
'zone, but if you do link nodes and zones then their temperature'
'will match the zone temperature as the simulation progresses. '
*enditem
            CALL EASKABC(outs,' ','accept',
            CALL EASKAB(outs,' ','accept','select a node',iacc,3)
*subroutine MFNDES
*item MFNDES flow_node_names
'Node names should be <= 12 characters and have no blanks.'
'Use logical names for clarity where possible. An internal node'
'might follow the name of the zone, a boundary node name can'
'reflect its orientation or position.'
'  '
'Each node name must be unique. If you specify a duplicate name'
'then you will be asked to revise it.'
*enditem
        CALL EASKS(T12,' ',' Node name (<= 12 characters): ',12,
        call askok('This a duplicate name...','Try again?',
*item MFNDES node_fluid_type
'For a node related to a building select air as the '
'fluid type. Water nodes are only required in hydronic '
'plant systems or where the zone is being used as an explicit'
'representation of a plant component.'
*enditem
            CALL EASKAB(outs,'(currently air)','air','water',IW,3)
            CALL EASKAB(outs,'(currently water)','air','water',IW,3)
            CALL EASKAB(outs,'(currently undefined)','air','water',IW,3)
*item MFNDES node_type_summary
'The node types are as follows: '
' '
'internal:unknown - a node describing a volume of air inside the'
'  building (usually a zone) the pressure and (usually) temperture'
'  of this node are unknown and is solved at each time step.'
'  This is the most commonly used fluid flow node.'
' '
'  Additional internal nodes can be used to implement controls'
'  (e.g. an extra node to allow for components in series).'
'  These additional nodes are not associated with the thermal'
'  zone, but take their temperature from another flow node which'
'  is associated with a thermal zone. If you want to create such'
'  an additional bookkeepping node then say no to questions about'
'  zone linking and later you will be asked which flow node to take'
'  its temperature from. '
' '
'internal:known - another node describing a volume of air'
'  inside the building (usually a zone) the pressure is fixed'
'  and specified by the user (e.g. the outlet of a fan could be'
'  specified as an internal:known node.)  This type of node is'
'  infrequently used because we tend not to know the pressure'
'  or the pressure varies. You will be asked for the gauge'
'  pressure in  Pa.'
' '
'boundary:known - a node describing conditions at the '
'  boundary of the flow network. The pressure of this node'
'  (and sometimes temperature) is assigned by the user. An'
'  example might be to approximate a blower door test. Again'
'  this type of node is infrequently used. You will be asked'
'  for the gauge pressure in  Pa as well as a constant'
'  temperature at the node or a choice of ambient temperature.'
' '
'boundary:wind induced - another node describing the conditions'
'  at the boundary of the network. In this case the pressure of'
'  this node is generated by wind impinging upon a surface. The'
'  pressure is a function of wind velocity, wind direction and a'
'  pressure coefficient, Cp, (assigned based on the orientation'
'  and geometry of the surface): P=f(V,D,Cp). You will be asked'
'  to identify a surface in the model which is associated with'
'  the bounday node wind pressure (to get orientation and height).'
'  '
'To aid results recovery when the user is interested in reporting'
'flow as ACH it is necessary to associate a volume with internal'
'nodes.  Ideally this should match that of any linked thermal zone.'
*enditem
        CALL EASKATOG(prt,' ',
        CALL EASKR(ZVOL,' ',' Node volume (m^3) ? ',
        CALL EASKR(VAL,' ',' Node pressure (Pa) ? ',
        CALL EASKR(ZVOL,' ',' Node volume (m^3) ? ',
   60   CALL EASKR(VAL,' ',' Node pressure (Pa) ? ',
        CALL EASKAB(' ','temperature flag indicating: ',
        CALL PHELPD('wind-pressure surface',8,'-',0,0,IER)
*item MFNDES overview_pressure_db
'To enable the calculation of wind-induced surface pressures'
'(as required by ESP-r-s fluid flow simulators), a database'
'of angle dependent pressure coefficients is associated with'
'the model.'
'  '
'The default ESP-r set contains wind pressure coeffients for'
'surfaces in typical positions and within several different'
'exposure categories. They can be used (with care) for low-rise'
'buildings. See the ESP manual for additional information.'
' '
'It is also possible to calculate pressure coefficients'
'using CpCalc (see database maintenance).'
' '
'Select the pressure coefficient from this list which is'
'most appropriate for the location of the boundary node.'
' '
'Notes about pressure coefficients: '
'The first 27 data sets in the standard pressure coef'
'database are from the Air Infiltration & Ventilation'
'Centre Handbook called <Air Infiltration Calculation'
'Techniques - An Applications Guide>. The 27 data '
'sets are only applicable for buildings up to 3 '
'storeys andcome with the usual warnings about usage'
'of the data. '
' '
'Each data set is described with the following terms:'
' a) facade or roof at different roof pitch angles'
' b) the ratio of the building length to width and for a'
'    non-square building there will be a long and a short'
'    wall to select'
' c) site shielding as follows:'
'   exposed - open countryside with no obstructions'
'   simi-exposed - rural with some obstructions'
'   sheltered - urban, surrounded on all sides by'
'     obstructions of similar size.'
'  '
'Some user actions you will be asked to confirm (in case you'
'made an error.'
*enditem
          CALL PHELPD('databases overview',36,'-',0,0,IER)
          CALL ASKOK(t72,'as the pressure coefficient set?',OK,dok,1)
*item MFNDES boundary_angle_height
'For boundary nodes an azimuth angle is used to derive the boundary'
'pressure, (which is angular dependent), from the pressure coef db'
'and the current wind speed and direction.'
'  '
'All nodes have a height attribute which is used to support buoyancy'
'calculations. It is the height above some arbitrary datum'
'usually ground level (height=0.0m).'
*enditem
        CALL EASKR(VAL,' ',
   21   CALL EASKR(VALH,' ',' Node reference height above datum (m)?',
*item MFNDES initail_node_temp
'The inital temperature is the temperature assumed for'
'the node at the beginning of the simulation. If the'
'flow network is part of a thermal model then this'
'temperature is updated with calculated values as the'
'simulation progresses. Otherwise this value is fixed'
'as the nodal temperature. '
' '
'If [Set to temperature of another node] is chosen then'
'this node will pick up the temperature of a designated'
*enditem
          CALL EASKAB('Node temperature: ','(see help)',
          CALL EASKR(VAL,' ','Node temperature (C) ? ',
*item MFNDES flow_node_volume
'The current node can either take the volume of the'
'associated node or have a nominal volume. It only'
'affects the reported air change rates. It should not'
'matter to the flow solver. '
*enditem
            call askok('Use volume of associated node?',' ',OK,dok,4)
*item MFNDES flow_node_delete
'When deleting a node any connections associated with'
'that node must also be deleted.'
*enditem
        CALL ASKOK('Delete connections associated with this node?',
*subroutine MFCDES
*item MFCDES flow_network_comp_name
'Component names should be <= 12 characters and have no blanks.'
'Use logical and/or descriptive names for clarity.'
*enditem
        CALL EASKS(T12,' ',' Component name (<= 12 characters):',
*item MFCDES flow_cmp_type_list
'Components used in a flow network must be selected from known'
'types. This list includes all available mass flow components.'
'One of the planning tasks for designing flow networks is to'
'define component types.'
*enditem
        CALL EPICKS(INPIC,IVALC,' Select a component: ',prompt,
*item MFCDES flow_component_delete
'When deleting a component, any connections with that component'
'must also be deleted.  Note: deltion of components is optional'
'because unused components are allowed in a network.  Indeed,'
'some users plan several variants of components so that they can'
'test out alternatives easily.'
*enditem
        CALL ASKOK('Delete connections associated with component?',
*subroutine MFLDES
*item MFLDES flow_connect_to_self
'You cannot connect a node to itself. To correct this you need'
'to say yes to the prompt to respecify the connection. '
*enditem
          call askok('You cannot connect a node to itself...',
*item MFLDES flow_fluid_not_match
'The fluid at the start and end of this connection does'
'not match. Check the components as well. '
*enditem
          call askok('Fluid types to not match...','try again?',
*item MFLDES flow_additional_con
'An existing connection between the two nodes has been detected.'
'If your network requires parallel flow paths (such as an orifice'
'and a crack) then answer yes.'
*enditem
                CALL ASKOK
*item MFLDES flow_not_allowed_con
'Some types of components (e.g. 220 230 240 or 250)should not be'
'used in parallel between two nodes. This is a chance to re-specify'
'this connection. '
*enditem
                  CALL ASKOK(
*item MFLDES flow_node_height_diff
'To support bouyancy calculations the relative difference between'
'the two nodes of the connection and the component need to be'
'specified.  One technique is to imagine placing your view point'
'at the component and look at the node. If you are looking up the'
'difference is positive, if you are looking down the difference is'
'negative.'
*enditem
        CALL EASKR(VAL,outs,' ? ',
        CALL EASKR(VAL,outs,' ? ',
*subroutine MFWRED
*item MFWRED flow_wind_reduction
'Edit / input local wind speed reduction factor'
' -------------------------------------------- '
'which is the ratio of local wind speed at roof'
'height (= reference level for wind pressure) '
'and coefficients the measured wind speed, as '
'read from the climate file.  '
*enditem
      CALL ASKOK(outs,' edit this (see help)?',OK,dok,6)
*item MFWRED wind_reduction_opts
' Wind calculation models: '
' 0: input wind speed reduction factor directly with'
'    values in the range 0.0 to 1.0.'
'  '
'    or calculate it, on the basis of: '
' 1: powerlaw wind profile with the following options:
'      U/Um = K.z**a   {BS5925} '
' '
'   eg.: terrain                       K    a '
'     open flat country              0.68  0.17'
'     country, scattered wind breaks 0.52  0.20'
'     urban                          0.35  0.25'
'     city                           0.21  0.33'
'
' 2: logarithmic wind profile with the following options:'
'      U    {Us ln((z-d)/z0)}loc  '
'      -- = --------------------  '
'      Um   {Us ln((z-d)/z0)}met  '
' '
'      ------------------------------------  '
'   eg.: terrain                       z0    d  '
'     open flat country               0.03  0.0'
'     country, scattered wind breaks  0.1   0.0'
'     rural                           0.5   0.7h'
'     urban                           1.0   0.8h'
'     city                           >2.0   0.8h'
'  '
' 3: LBL air infiltration model wind profile'
'      U    {a (z/10)**b}loc  '
'            -- = ----------------  '
'      Um   {a (z/10)**b}met  '
' ----------------------------------  '
'    eg.: terrain                 a     b  '
'      open flat country        1.00  0.15  '
'      rural                    0.85  0.20  '
'      urban                    0.67  0.25  '
'      city                     0.47  0.35  '
'  '
'Options 1 2 or 3 require the following:'
'  - roof height - you will be asked to select a zone and a surface'
'    which represents the roof and then you can confirm the height.'
*enditem
      CALL EASKABCD('Which calculation model: ','(see help)',
  88  CALL EASKR(WRED,' ',' Local wind speed reduction factor ? ',
      CALL PHELPD('wind model',6,'-',0,0,IER)
  89  CALL EASKR(ROOFH,' ',' Roof height ? ',
      CALL EASKR(CF1,'(see help)',' K factor: ',
      CALL EASKR(CF2,'(see help)',' a factor: ',
      CALL EASKR(CF1,'(see help)',' z0 for local site: ',
      CALL EASKR(CF2,'(see help)',' d  for local site: ',
      CALL EASKR(CF3,'(see help)',' z for meteo site [~ 10]   : ',
      CALL EASKR(CF4,'(see help)',' z0 for meteo site [~ 0.03]: ',
      CALL EASKR(CF5,'(see help)',' d for meteo site [~ 0.0]  : ',
      CALL PHELPD('Logarithmic wind profile.',11,'-',0,0,IER)
        CALL EASKR(CF1,' ',' a for local site: ',
        CALL EASKR(CF2,' ',' b  for local site: ',
        CALL EASKR(CF3,' ',' z for meteo site [~ 10]   : ',
        CALL EASKR(CF4,' ',' z0 for meteo site [~ 1.0]: ',
        CALL EASKR(CF5,' ',' d for meteo site [~ 0.15]  : ',
*subroutine MFNAUTO
*item MFNAUTO flow_auto_generate_int
'Auto generation of flow networks looks in zones nominated by the'
'user and creates equivalent flow nodes (name volume and height) are'
'taken from the zone inforation.'
'  '
'The other mode of auto generation looks for partitions between'
'zones (walls, ceilings, floors, doors) which might be locations'
'of flow connections.  You are asked to confirm each of the'
'potential linkage points.  If your model has lots of partitions'
'but few connections between zones you may not want to use the'
'auto generate facility.'
'  '
Another mode is to scan the zone operations file and to compose'
'equivalent flow components which will induce the same flow as'
'the operations infiltration and ventilation descriptions.'
'  '
*enditem
        CALL EPICKS(IZN,IVALS,' ',OUTS,12,NCOMP,zname,'zone list',IER,1)
        CALL EASKABC(OUTS,'Make this a fluid flow link?',
        CALL EPICKS(IZN,IVALS,' ',OUTS,12,NCOMP,zname,'zone list',IER,1)
*subroutine MF010I
*item MF010I flow_cmp_010
'Type 10 is a power law volume flow resistance.'
'Power law relationships are correlations rather than'
'physical law.  It is a convenient characterization of'
'openings for building air infiltration calculations'
'and much data is available in this form.'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.1.'
' '
'  (m = rho . a . dP^b [m^3/s]) '
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water), '
'  (2) flow coef a, '
'  (3) flow exponent b.'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,14)
  43  CALL EASKS(hold,'Coef `a` and exponent `b` in Q=a.dP^b(m^3/s) ?',
*subroutine MF011I
*item MF011I flow_cmp_011
'Type 11 approximates self regulating devices which have'
'a rated flow rate of 15m3/h at 20 Pa. or 30m3/h.'
' '
'These devices are designed to maintain flow close to these'
'rates over a range of pressure differences. The component'
'uses a polynomial to predict flows at other pressures. '
' '
'  (Q = Nb devides*(a6*DP**6+a5*DP**5++...a1*DP) '
' '
'Supplemental data: '
 ' '
'  (2) air flow at 20 Pa, 15 or 30 m3/h'
'  (3) number of devices'
' '
'Based on work by Armando Pinto. See mfmach code MF011C'
'for details of the method.'
*enditem
      CALL PHELPD('comp 11',17,'-',0,0,IER)
  43  CALL EASKS(hold,
subroutine MF012I
*item MF012I flow_cmp_012
'Type 12 is a power law volume flow resistance (see '
'component type 10 for basic description).'
'This component additionally has a max flow rate or pressure'
'difference setpoint. In mode 0 the component returns the'
'max flow rate given, if the actual flow rate is greater. In mode'
'1, the component is closed (flow rate = zero), if max dp is'
'exceeded.'
' '
'This behaviour is for window-frame vents with storm'
'protection devices.'
'  '
'  (m = rho . a . dP^b [m^3/s]) '
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water), '
'  (2) flow coef a, '
'  (3) flow exponent b,'
'  (4) max flow rate (switch=0) or dp setpoint (switch=1),'
'  (5) switch 0 (max val) or 1 (close at dp setpoint)'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,14)
  43  CALL EASKS(hold,
*subroutine MF015I
*item MF015I flow_cmp_015
'Type 15 is a power law mass flow resistance component.'
'Power law relationships are correlations rather than'
'physical law. See discussion of type 10 as well as'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.1.'
' '
'(m = a . dP^b [kg/s]) '
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water),'
'  (2) flow coef a,'
'  (3) flow exponent b.'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,12)
  43  CALL EASKS(hold,'Coef `a` and exponent `b` in m=a.dP^b [kg/s]?',
*subroutine MF017I
*item MF017I flow_cmp_017
'Type 17 is a power law mass flow component.'
'Power law relationships are correlations rather than'
'physical law. See discussion of type 10 as well as'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.1.'
'  '
'(m = a.rho^1/2.dP^b [kg/s]) '
'  '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water),'
'  (2) flow coef a, '
'  (3) flow exponent b.'
'  '
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,13)
  43  CALL EASKS(hold,
*subroutine MF020I
*item MF020I flow_cmp_020
'Type 20 is a quadratic law volume flow component.'
'Quadratic law relationships are included because some'
'sources regard this is a superior form for building'
'fabric infiltration as it allows consideration of both'
'the laminar and turbulent flow. Type 20 is more com-'
'monly encountered in the literature than type 25.'
' '
'(dP = a.m/ro+b.(m/ro)^2) '
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water),'
'  (2) flow coef a (Pa.s/m^3),'
'  (3) flow exponent b (Pa.(s/m^3)^2).'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.2.'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,16)
  43  CALL EASKS(hold,
*subroutine MF025I
*item MF025I flow_cmp_025
'Type 25 is a quadratic law mass flow component which'
'is similar to type 20.'
' '
'dP = a.M + b.M^2 (Pa/(kg/s)^2)  '
' '
'Supplemental data: '
' (1) fluid type (1=air, 2=water),'
' (2) flow coef a (Pa.s/kg),'
' (3) flow exponent b (Pa.(s/kg)^2).'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.2.'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,12)
  43  CALL EASKS(hold,
*subroutine MF030I
*item MF030I flow_cmp_030
'Type 30 is a constant flow rate component which is included'
'as a convenient constant volume flow inducer which can be'
'combined with other components. It is often used as an'
'equivalent to a scheduled zone infiltration or ventilation'
'rate or to approximate a fan or pump (which might later be'
'switched to a performance curve fit representation).'
'  '
' (m = rho . a)'
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water), '
'  (2) flow rate in m^3/s.'
' '
'The flow rate can be derived from litres/s/person, or m^3/hr'
'or air changes per hour based on the volume associated with a'
'particular node. '
' '
'The flow rate can be modified by the use of a range of controller'
'types (see control definition facility). This type of flow inducer'
'can also be run at a fraction of its nominal capacity at different'
'times of the day by adapting the control schedule.'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.3.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,18)
        CALL EASKABCD(prompt,' ','direct edit','l/s/person',
   20   CALL EASKR(VAL,prompt,'(help for synopsis)',0.,'W',0.,'-',1.,
  43    CALL EASKS(hold,' litres/sec/person and number of people?',
        call askok(prompt,' Is this ok? ',OK,dok,18)
   21   CALL EASKR(VAL2,prompt,'(help for synopsis)',0.,'W',0.,'-',10.,
        call askok(prompt,' Is this ok? ',OK,dok,18)
        call ASKRNOD(' volume from which node','-',IV,IER)
   22   CALL EASKR(VAL2,prompt,'(help for synopsis)',0.,'W',0.,'-',
        call askok(prompt,' Is this ok? ',OK,dok,18)
*subroutine MF035I
*item MF035I flow_cmp_035
'Type 35 is a constant mass flow rate component which is included as'
'a convenient constant flow inducer which can be combined with other'
'components. It can be used as an equivalent to a scheduled zone'
'infiltration or ventilation rate or to approximate a fan or pump.'
'  '
'  (m = a)'
' '
'Supplemental data: '
'  (1) fluid type (1=air, 2=water), '
'  (2) flow rate in kg/s.'
' '
'The flow rate can be modified by the use of a range based controller'
'(see control definition facility) or by application of an on-off'
'controller or as a fraction of its nominal capacity. '
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.3.'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,14)
   20 CALL EASKR(VAL,prompt,'(help for synopsis)',0.,'W',0.,'-',1.,
*subroutine MF040I
*item MF040I flow_cmp_040
'Type 40 is a common orifice flow component which is a basic'
'expression for turbulent flow through relatively large openings'
'such as a vent in the case of buildings or a pipe restriction in'
'a hydronic network.'
' '
'Supplemental data: '
' (1) fluid type (1=air, 2=water), '
' (2) opening area (m^2), '
' (3) discharge factor (-).'
' '
'The opening area can be modified by the use of a range of flow'
'controller types (see control definition facility) or by as a'
'fraction of its nominal opening area. '
'  '
'The discharge factor is used to represent the characteristic'
'friction of the perimeter of the opening (e.g. the door frame'
'grill housing). Another way to consider the discharge factor is'
'to adjust the aparent viscosity of the air movement at this'
'point in the building or duct.'  
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.4.'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,15)
  43  CALL EASKS(hold,' Opening area (m^2) and discharge factor (-)?',
*subroutine MF050I
*item MF050I flow_cmp_050
'Type 50 is a laminar pipe flow component which is a basic expression'
'for laminar flow through relatively long flow paths.  A warning is'
'given if the Reynolds-number exceeds 2320 during simulation.'
'  '
' (m = rho (dP/(8 mu L)) pi R**4) '
'  '
'Supplemental data: '
' (1) fluid type (1=air, 2=water), , '
' (2) path length (m),'
' (3) opening radius (m).'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.5.'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,14)
  43  CALL EASKS(hold,' Length of flow path (m) & opening radius (m)?',
*subroutine MF110I
*item MF110I flow_cmp_110
'Type 110 is a standard air flow opening (type 40) with the fluid type'
'set to air and a discharge factor of 0.65 (which is a general'
'approximation of openings in buildings). It can be used to speed up'
'the generation of initial flow networks.'
' '
'Supplemental data: opening area(m)'
' (1) fluid type (air only)'
' (2) opening area (m).'
' '
'The opening area can be modified by the use of a range of controller'
'types (see control definition facility) or by setting'
'a fraction of its nominal opening area.'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.6.'
*enditem
   20 CALL EASKR(VAL,'(help for synopsis)',prompt,0.,'F',0.,'-',1.,
*subroutine MF120I
*item MF120I flow_cmp_120
'Type 120 is an air flow crack component. It is applicable for'
'cracks in facades and openings which tend to be long and thin'
'(e.g. less than ~20mm wide).
'  '
'For example an undercut door is often represented by a crack'
'as are the small flows through cracks around windows. A crack'
'component is often used in a parallel path to a component which is'
'controlled to prevent isolation of a node when the controlled'
'component is in an off position.  If pressure flow relationships'
'have been established some users may prefer to use a polynomial'
'representation.'
' '
'Supplemental data:'
' (1) fluid type (air only)'
' (2) crack width (mm),'
' (3) crack length(m)'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.6.'
*enditem
  43  CALL EASKS(hold,' Crack width (mm) and length (m) ?',
*subroutine MF130I
*item MF130I flow_cmp_130
'Type 130 is an air flow door component which is applicable to'
'vertical opening where bi-directional flow may exist. Based on'
'an expression by Cockroft and experiments in the literature.'
'  '
'The underlying method is based on experiments of door shaped'
'openings. It accounts for flow induced by temperature differences'
'between the two adjacent flow nodes as well as the pressures'
'along the flow path.  At low pressure, temperature differences'
'are the primary driving force. Where a pressure difference exists'
'it may become the primary driver.'
'  '
'This bi-directional component is sometimes used to represent the'
'flow in window openings (where the vertical dimension is larger)'
'so that during calm conditions flow related to temperature'
'differences between inside and outside is captured. A common'
'orifice flow component is a one-directional component and only'
'captures flow through a window if there is another significant'
'opening in the room.'
'  '
'Care is needed - very large openings e.g. between zones in an'
'open plan office were not really part of the underlying method'
'although many practitioners use this bi-directional component'
'to represent such flows.'
' '
'After the solution converges the flow in both directions is'
'recorded and can be reported on separately or as an aggregate'
'flow rate.'
' '
'Supplemental data:'
' (1) fluid type (air only)'
' (2) door width (m)'
' (3) door height (m), '
' (4) vertical distance (m) between base of door and'
'     adjacent air nodes (nodes at each side should be '
'     at the same height). If this component type is used'
'     in several locations with different vertical heights'
'     you should create multiple door components.'
' (5) discharge factor (-) typically 0.6 but can be smaller'
'     to represent a door that is partially open.'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.6.3'
*enditem
  43  CALL EASKS(hold,
*subroutine MF210I
*item MF210I flow_cmp_210
'Type 210 is a general flow conduit component which takes into'
'account frictional and dynamic losses within a duct or pipe'
'assuming the following:'
' - a uniform x-section,'
' - no pressure gain from a pump or fan'
' - steady-state conditions.'
'  '
'This type is widely supported in the literature and can be'
'combined with component types 220, 230, 240 & 250 to form complex'
'networks.'
' '
'Supplemental data:'
' fluid type (1=air or 2=water),'
' conduit hydraulic diam (m) which is:'
'   (4*x-section area)/perimeter of conduit'
' x-section area (m^2)'
' conduit length (m), absolute wall roughness(mm),'
' sum of local dynamic loss factors (suggest looking'
'   this up in a handbook)'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.7'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,17)
  43  CALL EASKS(hold,
   60 CALL EASKR(VAL,' Sum of local dynamic loss factors',
*subroutine MF211I
*item MF211I flow_cmp_211
'Type 211 represents roof top ventilation cowl which is'
'based on experimental data and which takes into account'
'head losses and wind effects. '
' '
'The method is based on the work of Armando Pinto and '
'implements experiments reported in: '
' Gonzalez M.A. On the aerodynamics of natural ventilators'
' London. Pergamon Press, 1984, Building and environment.'
' Vol 19 No 3.'
' '
'Please read the paper if you want to understand the types'
'of cowls that this component can represent. '
'The paper mentions 7 different cowels models and Table 1'
'tgives several of the coefficients:'
' Model 1 coef B between 0.72 and 1.28 by wind direction'
'         coef n between 0.51 and 0.26 by wind direction'
' Model 2 coef B between 0.37 and 0.80 by wind direction'
'         coef n between 0.31 and 0.40 bt wind direction'
' Model 3 coef B 0.25  coef n 0.16'
' Model 4 coef B 0.12  coef n 0.17'
' Model 5 coef B 0.37  coef n 0.10'
' Model 6 coef B 0.21  coef n 0.19'
' Model 7 coef B 0.28  coef n 0.45'
' '
' Supplemental data: '
'  - fluid type (1=air)'
'  - Cowl hydraulic diameter (m)'
'  - local dynamic loss factors (-)'
'  - coefficient of cowl B (see above)'
'  - coefficient of cowl n (see above)'
'   Wind effect '
'     0 no wind effect '
'     1 include wind effect '
*enditem
      CALL PHELPD('comp 211',30,'-',0,0,IER)
  44  CALL EASKS(hold,
   20 CALL EASKR(VAL,' ',prompt,0.,'W',0.,'-',1.,'flow in comp',IER,14)
*subroutine MF220I
*item MF220I flow_cmp_220
'Type 220 is a variant of a general flow conduit which ends in'
'a converging 3-leg junction.  It represents only half of a junction'
'and the branch must be represented by a similar component.'
'It is well supported in the literature. For example a 30 converging'
'wye is described in the ASHRAE Duct Design Database and and extract'
'is in the ASHRAE Fundamentals section 34.34 and a diverging wye'
'example is shown in F34.50.'
'  '
'Supplemental data:'
'  '
' fluid type, conduit hydraulic diam, x-section area'
' conduit length, wall roughness, sum of local dynamic'
' loss factors, x-sectional area of common junction '
' section, Ccp coefficients a0 - a5 in:'
'  '
'    Ccp = a0+a1.X+a2.X.X+a3.Y+a4.Y.Y+a5.X.Y  '
'  '
'where X is the ratio between the volume flow rate in'
'this conduit and the common section, respectively and'
'Y is the ratio between the volume flow rate in the '
'other entrance of the junction and the common. '
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.8'
*enditem
      if(OK) CALL PHELPD('comp 220',19,'-',0,0,IER)
   20 CALL EASKR(VAL,
      CALL EASKR(VAL,outs,' ? ',0.,'-',0.,'-',0.,'Cf a0',IER,19)
*subroutine MF230I
*item MF230I flow_cmp_230
'Type 230 is a variant of a general flow conduit which ends in'
'a diverging 3-leg junction. '
' '
'Supplemental data:'
' fluid type (1=air or 2=water),'
' conduit hydraulic diam (m) which is:'
'   (4*x-section area)/perimeter of conduit'
' x-section area (m^2)'
' conduit length (m), absolute wall roughness(mm), '
' sum of local dynamic loss factors, '
' x-sectional area of common junction section,'
' '
' Ccp coefficients a0 - a5 in:'
'    Ccp = a0+a1.X+a2.X.X+a3.Y+a4.Y.Y+a5.X.Y  '
'  '
'where X is the ratio between the volume flow rate in this'
'conduit and the common section, respectively and Y is the'
'ratio between the volume flow rate in the other entrance of'
'the junction and the common. '
'  '
'For example a 45 degree diverging wye is described in the ASHRAE'
'Duct Design Database and and extract is in the ASHRAE Fundamentals'
'section 34.50.'
' '
'See discussion of type 210 & 220 as well as'
'Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.8'
*enditem
      if(OK) CALL PHELPD('comp 230',22,'-',0,0,IER)
   20 CALL EASKR(VAL,
      CALL EASKR(VAL,outs,' ? ',
*subroutine MF240I
*item MF240I flow_cmp_240
'Type 240 is a variant of a general flow conduit which ends in'
'a converging 4-leg junction. '
' '
'Supplemental data:'
' fluid type (1=air or 2=water),'
' conduit hydraulic diam (m) which is:'
'   (4*x-section area)/perimeter of conduit'
' x-section area (m^2)'
' conduit length (m), absolute wall roughness(mm),'
' sum of local dynamic loss factors (suggest looking'
'   this up in a handbook)'
' x-sectional area of common junction section'
' '
' Ccp coefficients a0 - a9 in:'
'    Ccp = a0+a1.X+a2.X.X+a3.Y+a4.Y.Y+a5.X.Y  '
'            +a6.Z+a7.Z.Z+a8.X.Z+a9.Y.Z'
'  '
'where X is the ratio between the volume flow rate in'
'this conduit and the common section, respectively and'
'Y & Z are the ratios between the volume flow rate in '
'the other entrances of the junction and the common. '
' '
'See discussion of type 210 & 220 as well as Hensen'
'J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems,'
'Eindhoven University of Technology section 4.4.8'
*enditem
      if(OK) CALL PHELPD('comp 240',24,'-',0,0,IER)
   20 CALL EASKR(VAL,
      CALL EASKR(VAL,outs,' ? ',
*subroutine MF250I
*item MF250I flow_cmp_250
'Type 250 is a variant of a general flow conduit which starts'
'with a diverging 4-leg junction. '
' '
'Supplemental data:'
' fluid type (1=air or 2=water),'
' conduit hydraulic diam (m) which is:'
'   (4*x-section area)/perimeter of conduit'
' x-section area (m^2)'
' conduit length (m), absolute wall roughness(mm),'
' sum of local dynamic loss factors (suggest looking'
'   this up in a handbook)'
' x-sectional area of common junction section,'
' '
'  Ccp coefficients a0 - a9 in:'
'    Ccp = a0+a1.X+a2.X.X+a3.Y+a4.Y.Y+a5.X.Y  '
'            +a6.Z+a7.Z.Z+a8.X.Z+a9.Y.Z'
'  '
'where X is the ratio between the volume flow rate in'
'this conduit and the common section, respectively and'
'Y & Z are the ratios between the volume flow rate in '
'the other entrances of the junction and the common. '
' '
'See discussion of type 210 & 220 as well as'
'the ESP-r manual section 3.6.'
*enditem
      if(OK) CALL PHELPD('comp 250',26,'-',0,0,IER)
   20 CALL EASKR(VAL,
      CALL EASKR(VAL,outs,' ? ',
*subroutine MF310I
*item MF310I flow_cmp_310
'Type 310 is a general flow inducer which approximates '
'a pump or fan by a performance curve (cubic polynomial)'
'which relates the total pressure rise to the volume '
'flow rate for a given fan or pump speed and fluid'
'density.'
' '
' (dP = SUM (i=0 to 3) ai.(m/ro)^i; which is '
'               only valid for q,min <= m/ro <= q,max )'
'Supplemental data:'
' (1) fluid type (1=air, 2=water) '
' (2,3) volume flow rate lower and upper limits (m^3/s),'
' (4-7) flow coef a0 (Pa),     a1 (Pa/(m^3/s)),'
'           a2 (Pa.(m^3/s)^2), a3 (Pa.(m^3/s)^3)'
'  '
' four or more coordinates read off a performance curve'
' in which case flow coef are not required. Coordinates'
' for the performance curve entered should be over the '
' entire range of the performance curve. (Not just the'
' preferred operating range) Ideally values for near max'
' and near min flow should also be used.'
'  '
'See Hensen J L M (1991) PhD Thesis On the thermal interaction of'
'building structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.9'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,20)
   20 CALL EASKR(VAL,
   30 CALL EASKR(VAL,' ',
      CALL EASKAB(' ',prompt,'coefficients','perf curve',IIW,20)
  43  CALL EASKS(hold,
      CALL PHELPD('curve fit',5,'-',0,0,IER)
 88   CALL EASKI(IVAL,
 63   CALL EASKS(HOLD,
      CALL ASKOK(' ',' Accept values?  ',OK,dok,1)
      CALL ASKOK(' ',' Accept this?  ',OK,dok,1)
*subroutine MF410I
*item MF410I flow_cmp_410
'Type 410 is a general flow corrector or variable '
'flow resistance such as a valve or damper. Actuation'
'of this component requires a model control file'
'otherwise it is assumed the valve (or damper) is open.'
' '
'Supplemental data: '
' (1) fluid type (1=air, 2=water),   choice of'
' (2) fluid density rho 0 (kg/m^3),'
' (3) presure drop dP0 (Pa),'
' (4) linear (1) or logarithmic (2)position dependency,'
' (5) volume flow when fully open  k,vs (m^3/s), '
' (6) theoretical flow when closed, k,v0 (%)'
' (7) lower validity limit k,vr (%).'
' '
'There is a lengthy discussion of this in Hensen J L M'
'(1991) PhD Thesis On the thermal interaction of building'
'structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.10'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,18)
   20 CALL EASKR(VAL,
   30 CALL EASKR(VAL,
      CALL EASKAB(' ',' Characteristic index: ',
   50 CALL EASKR(VAL,' ',
   60 CALL EASKR(VAL,' ',
   70 CALL EASKR(VAL,' ',
*subroutine MF420I
*item MF420I flow_cmp_420
'Type 420 is a flow corrector or variable flow resis-'
'tance such as a valve or damper which is represented'
'as a polynomial. This approach is as if it were a'
'conduit with local dynamic losses dependent on the '
'correctors relative position. For actuation in this'
'component the model control file must be used together'
'otherwise the valve (or damper) is kept open during the'
'whole simulation.'
' '
'Supplemental data: '
' (1) fluid type (air|water), , polynomial '
' (2) cross-sectional area (m^2)'
' (3-6) polynomial coefficients a0 - a3 (-) in:'
' '
'    C = a0+a1.(H/H100)+a2.(H/H100)^2+a3.(H/H100)^3'
'  '
' where H/H100 is the relative valve/damper position'
' (ie. valve stem displacement of damper blade angle),'
' '
'There is a lengthy discussion of this in Hensen J L M'
'(1991) PhD Thesis On the thermal interaction of building'
'structure and heating and ventilating systems, Eindhoven'
'University of Technology section 4.4.11'
*enditem
      CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,18)
   20 CALL EASKR(VAL,
  43  CALL EASKS(hold,
*subroutine MF460I
*item MF460I flow_cmp_460
'Type 460 is a fixed flow rate device, which unlike types 30'
'or 35  responds to a wide range of signals which are defined'
'by the user.  A typical use of this component is an an early'
'design stage substitute for a fan or pump in order to characterise'
'flow rates before specifying a specific device.'
'  '
'The advent of fractional control of tpe 30 and 35 components'
'allows them to do some tasks of type 460.'
'  '
'For actuation in this component the model control file must be'
'used together otherwise the flow rate will be equal to the'
'value above setpoint.'
' '
'Supplemental data: '
' (1) fluid type (air|water),'
' (2) flow (m^3/s) below setpoint, '
' (3) flow (m^3/s) above setpoint.'
' '
'See ESP-r manual section 3.6.'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,16)
  43  CALL EASKS(hold,' Flows when S < Ssp and S > Ssp (m3/s) ?',
*subroutine MF500I
*item MF500I flow_cmp_500
'Type 500 is a multiple configuration flow component. It'
'assumes the properties of up to three PREVIOUSLY DEFINED'
'components depending upon control action at simulation'
'run time. For example it can assume the action of a '
'window opening at control action 1, a smaller window'
'opening at control action 2 and a crack at control '
'action 3. Thereby removing the need for three different'
'parallel connections and corresponding control loops'
'  '
'When planning the network consider how many underlying'
'components will need to be defined to accomplish the control'
'intent of the project.  Keep clear notes about the underlying'
'components and type 500 components used in the network. If you'
'alter the characteristics of an underlying component this will'
'then be used in all tpe 500 components that reference it.'
' '
'Supplemental data:  '
' (1) fluid type (air|water),'
' (2) component number one'
' (3) control action setting for component one'
' (4) component number two'
' (5) control action setting for component two'
' (6) component number three'
' Component one is active above control action 1'
' Component two is active between control action 1 and 2'
' Component three is active below control action 2'
*enditem
        CALL EASKAB(prompt,'(help for synopsis)','air','water',IW,21)
        call ASKRCMP('select component','-',ICOMPN,IER)
        CALL EASKR(VAL,'Enter control action for this component',
*subroutine MMGFUN
*item MMGFUN ncm_assessment_period
'Assessment period choices allow you to do quick checks of'
'your model for the month of January or April or July.'
'  '
'And eventually you MUST do the annual assessment REQUIRED'
'by the code.'
*enditem
      CALL EASKABCD(' ','Initial assessment period (see help)',
*item MMGFUN ncm_context
'This facility takes information provided in the model'
'context menu NCM descriptions and will use it to'
'create several alternative models and optionally run'
'a series of assessments to confirm the performance of the'
'design.'
' '
'If the model is incomplete you may need to supply'
'additional information or return to the model context'
'or zone geometry menus. '
' '
'1. Generate models (with standard constructions'
'   and glazing areas) and usage patterns, run '
'   assessments and generate EPC.'
' '
'2. If you did not have time to run the assessments in'
'   step one you can use the model variants and run the'
'   assessments for the energy performance certificate'
'   EPC and/or generate BRUKL specific information.'
' '
'3. Scan existing results from assessments and re-generate'
'   the NCM file (for testing purposes).'
' '
'If you plan on using existing models and or existing'
'assessments check that you have loaded your ORIGINAL'
'model prior to asking for assessments or reports.'
' '
'If you are running your assessments on a Linux or OSX or'
'under the Cygwin emulation environment you will have to'
'transfer the BRUKL.inp and EPCGen.inp files to a Windows'
'computer to complete the final step. '
' '
'Remember to make backup copies of your models!'
*enditem
      CALL EASKABCD('Options (see help): ',' ',
*item MMGFUN ncm_run_now_later
'You are using new UK NCM stripped, notional,'
'reference and typical models. In order to generate'
'EPC and BRUKL (UK building regulations) specific'
'information annual simulations for all these models'
'need to run and may take some time. You may choose not'
'to run simulations at this time and run these at a'
'later time (via the 2nd option).'
'  '
'If you picked this choice in error just say no.'
*enditem
        CALL ASKOK(
        CALL ASKOK(
*item MMGFUN ncm_run_with_6
'You are using existing save level 6 files from'
'stripped, notional, reference and typical model runs.'
'In order to generate EPC and BRUKL (UK building'
'regulations) data will be re-scanned. FOR TESTING'
*enditem
        CALL ASKOK(
*subroutine sbmedit
*item sbmedit ncm_zone_rules
'You have chose to configure you model for UK NCM based'
'calculations to generate Energy Performance Certificate'
'(EPC_ Make sure that the original model follows the'
'following assumptions: '
'1. Exterior surfaces that have other surfaces within them'
'   are called parents. Parents may have more surfaces '
'   within them. Only a three tier hierarchy is allowed '
'   i.e. only parent, child and grandchild are allowed '
'   e.g. a wall with a frame and a window). '
'  '
'2. Each exterior surface needs to have a usage. You will'
'   be asked to provide it if not already defined in the'
'   geometry and attributions menu.'
'  '
'   Only the following usages can be associated with '
'   exterior surfaces that are parents: '
'   - if exterior & vertical & opaque = WALL '
'   - if exterior & horiz UP & opaque = ROOF FLAT'
'   - if exterior & horiz DOWN & opaque = not allowed'
'   - if exterior & pitched & opaque = ROOF PITCHED'
'   - if facing ground & horizontal = GROUND'
'   - if facing another room & any orientation = PARTN'
'  '
'   Usages associated with child and grandchild surfaces'
'   (e.g. not walls and roofs) :'
'   - if exterior & horiz UP & transp = WINDOW SKYLIGHT'
'   - if exterior & pitched & transp = WINDOW SKYLIGHT'
'   - if exterior & vertical & transp = WINDOW'
'   - if exterior & vertical & opaque = FRAME or DOOR'
'   - if facing another room = FRAME or DOOR'
'  '
'3. Exterior surfaces should   | |                      '
'   avoid extreme L shapes.    | |  obtuse interior     '
'   Surfaces with lots of      | | /   angle here       '
'   edges can cause problems.  | |/_____                '
'   (e.g. ceiling of passage)  |________                '
'  '
'4. Only one child surface is allowed per parent, if more '
'   child surfaces are required divide a parent into two '
'   surfaces and make one child in each.'
' '
'When generating the notional model all areas for parents'
'& children that are not glazed are conserved. Additional'
'glazing is added to all exterior surfaces as per UK NCM. '
'* if parent surface is not wall/roof no glazing is added'
'(This is exceptional and is discouraged)'
'In order to calculate the required glazed area, gross  '
'parent area is used (e.g. if a wall has a door in it then'
'the glazed area is some % of (wall area + door area))'
' '
'If glazing area in original is more than required for  '
'notional then the same area is retained in notional model'
' '
'5. If you have not attributed some use (eg door) to zone'
'   surfaces then do so before defining a notional model.'
' '
'For interior surfaces it is assumed that all vertical '
'surfaces are walls. Horizontal interior surfaces are '
'internal roofs/ceilings. '
*enditem
      CALL PHELPD('SBEM Assumptions',59,'-',0,0,IER)
      CALL ASKOK('Continue with UK NCM setup/calculations?',
*item sbmedit ncm_user_inputs
'UK NCM calculations require a number of inputs from'
'the user. You are presented with several sections'
'to document the project and specify the type of building'
'as well as standard occupancy profiles within the'
'building. If you have all of the relevant information'
'you can complete these discriptions in the current'
'session. If not you can continue in later sessions.'
' '
'The building, owner and certifier information forms '
'part of the energy certificate and is required. '
' '
'You must select a buidling type from the list provided'
'as well as select the region of the UK (there are'
'some differences in the calculations between regions).'
' '
'One or more HVAC system types need to be defined and'
'these need to be linked to the zones in the model.'
' '
'DHW use is associated with the activity assoicated with'
'each zone. If DHW is produced separately from the HVAC'
'system then define them. The link DHW systems option'
'allows you to define additional DHW use beyond what is'
'assumed in the zone activity schedules.'
' '
'Each zone in the model must be assigned with one of the'
'standard room activity profiles. Regardless of what'
'was defined in the original model, standard profiles of'
'occupancy, lighting and small power will be imposed along'
'with assumptions about infiltration.'
' '
'It is a GOOD IDEA to use the display current information'
'choice to review the current contents before proceeding'
'to the [setting up required models] stage. '
' '
'Facade surfaces in the model must be attributed for their'
'USE e.g. WINDOW DISPLAY prior to setting up the models.'
'It is recommended that you FIRST define the information'
'in the first three menu items (to register the model as'
'being used for code assessments and THEN return to the'
'zone attribution menu and define the surface USE'
'attributes (only certain USE types are allowed). '
' '
'It is a good idea to back up your model after you have'
'setup the required models. '
*enditem
      CALL EPICKS(IX,KSTR,' ','Define UK NCM data',
*item sbmedit ncm_save_changes
'You have been editing NCM data. If you want to save'
'recent changes in the model configuration say yes.'
*enditem
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
        CALL ASKOK('Update NCM descriptions (see help)',' ',OK,dok,2)
*item sbmedit ncm_no_help_yet
'Sorry but there is no help yet written for this topic in the'
'definition of the UK NCM.'
*enditem
          CALL PHELPD('DHW help not defined (yet)',2,'-',0,0,IER)
          CALL EASKABC('Choose option',' ',
            CALL EASKS(DHWNAME(NDHWSYS),'DHW system name',
 909        CALL EPICKS(IY,KSYS,' ','Select DHW system type',
            CALL EASKABC('Was the DHW generator built before 1998',
            CALL EASKR(HWEF(NDHWSYS),
 910        CALL EPICKS(IDA,JSTR,
              CALL EASKABC('Is there a water storage system',
                CALL EASKABC('Which of the following do you know',
                  CALL EASKR(DHWSPD(NDHWSYS,1),
                  CALL EASKR(DHWSPD(NDHWSYS,2),
                CALL EASKABC('Is there a water circulation loop',
                  CALL EASKAB('Do you know circulation losses (W/m)',
                    CALL EASKR(DHWSPD(NDHWSYS,3),
                  CALL EASKAB('Do you know pump power (kW)',
                    CALL EASKR(DHWSPD(NDHWSYS,4),
                  CALL EASKAB('Do you know loop length (m)',
                    CALL EASKR(DHWSPD(NDHWSYS,5),
 911        CALL EPICKS(IDA,JSTR,
          CALL EASKS(DHWNAME(IDHWSYS),'DHW system name',
 912      CALL EPICKS(IY,KSYS,' ','Select DHW system type',
          CALL EASKABC('Was the DHW generator built before 1998',
          CALL EASKR(HWEF(IDHWSYS),
 913      CALL EPICKS(IDA,JSTR,
          CALL EASKABC('Is there a water storage system',
            CALL EASKABC('Which of the following do you know',
              CALL EASKR(DHWSPD(IDHWSYS,1),
              CALL EASKR(DHWSPD(IDHWSYS,2),
            CALL EASKABC('Is there a water circulation loop',
              CALL EASKAB('Do you know circulation losses (W/m)',
                CALL EASKR(DHWSPD(IDHWSYS,3),
              CALL EASKAB('Do you know pump power (kW)',
                CALL EASKR(DHWSPD(IDHWSYS,4),
              CALL EASKAB('Do you know loop length (m)',
                CALL EASKR(DHWSPD(IDHWSYS,5),
*item sbmedit ncm_link_hvac_zone
'For each zone in the model you are asked to select the HVAC'
'system that is associated with it. If there are zones without'
'heating or cooling then your planning phrase should have'
'created a system that did nothing.'
*enditem
 914        CALL EPICKS(IA,JSTR,' ','Link zones to HVAC systems',
*item sbmedit ncm_link_dhw_zone
'For each zone in the model you are asked to select the DHW'
'system that is associated with it. If there are zones without'
'hot water requirements then your planning phrase should have'
'taken this into account.'
'  '
'You will also be asked the length of dead legs to water draw-off'
'points in the rooms.'
*enditem
            CALL EPICKS(IA,JSTR,' ','Link zones to DHW systems',
 916            CALL EPICKS(IA,KSYS,' ',
          CALL EASKR(DEADLEG(IZ),
*item sbmedit ncm_link_use_zone
'For each zone in the model you are asked to specify the activity'
'of the room from a standard list of room uses. This choice will'
'set a number of attributes of the room in terms of occupancy as'
'well as heating and cooling setpoints.'
*enditem
            CALL EPICKS(IX,KSYS,' ',OUTS(1:LNBLNK(OUTS)),
*item sbmedit ncm_link_lighting_zone
'For each zone in the model you are asked to select the lighting'
'system that is associated with it. If there are zones without'
'lighting requirements then your planning phrase should have'
'taken this into account.'
'  '
'You will be asked about the lighting gains in W/m2 per 100 lux'
'or a pre-defined pattern.'
'  '
'You are also asked about lighting controls. The logic is different'
'from the normal ESP-r lighting (casual gain controls). Instead it'
'matches the requirements of the NCM.'
'  '
'Photoelectric controls are based on one sensor at'
'the front of the room or front and back sensors '
'in the room. '
'  '
'If you selected a standalone sensor then parasitic'
'power is assumed to be 0.3W/m2. If the sensor is '
'addressable (advanced) the PP is assumed to be 0.57'
'W/m2. If you have other data please supply it now. '
'  '
'Olccupancy sensing equivalent to the choices offered by the UK'
'iSBEM application which is minimally documented in the UK'
'SBEM technical manual table 20. Your choice will set an'
'occupancy modifier which is used in the control.'
' '
'For systems without automatic presence or absence '
'detection the following options are allowed: '
' Manual on/off switching  Foc=1.0 '
' Manual on/off switching with additional automatic'
'   sweeping extinction signal  Foc=0.95'
' '
'For systems with automatic presence and/or abscence'
'detection the following options are allowed: '
' '
' Auto On with dimming on absence   Foc=0.95'
' Auto On with off on absence       Foc=0.90'
' Manual On with dimming on absence Foc=0.90'
' Manual On with off on absence     Foc=0.82'
*enditem
          CALL EASKABC(
            CALL EASKR(light_input_watt,
            CALL EPICKS(IY,LSYS,' ',OUTS(1:LNBLNK(OUTS)),
            CALL EASKABCD('Choose lighting control type for',
              CALL EASKAB('Type of photoelectric control in zone',
              CALL EASKAB('Type of photoelectric control sensor',
              CALL EASKABC('Choose lighting sensor location for',
              CALL EASKR(PE_sensor_PP(iz),
            CALL EASKATOG(
              CALL EASKR(Occ_sensor_PP(iz),
*item sbmedit ncm_no_ren_help_yet
'Sorry but there is no help yet written for this topic in the'
'definition of the UK NCM.'
*enditem
          CALL ASKOK('Edit this component?',' ',OK,dok,6)
          CALL EASKABC('Choose action',' ','add','delete','cancel',IA,6)
          CALL PHELPD('Renewables help',6,'-',0,0,IER)
            CALL EASKS(RENNAME(INDEX),'Name of renewable energy system',
            CALL EASKS(RENNAME(INDEX),'Name of renewable energy system',
          call MENUATOL('Choose renewable energy system',
              CALL EPICKS(IX,LSTR,'Choose which DHW system ',
            CALL EASKR(RENDATA(INDEX,2),
            CALL EASKR(RENDATA(INDEX,3),
            CALL EASKR(RENDATA(INDEX,4),
            call MENUATOL('Choose PV type','Choose PV type',
            CALL EASKR(RENDATA(INDEX,2),
            CALL EASKR(RENDATA(INDEX,3),
            CALL EASKR(RENDATA(INDEX,4),
            call MENUATOL('Choose terrain type',
            CALL EASKR(RENDATA(INDEX,2),
            CALL EASKR(RENDATA(INDEX,3),
            CALL EASKR(RENDATA(INDEX,4),
            CALL EASKR(RENDATA(INDEX,1),
            CALL EASKR(RENDATA(INDEX,2),
            CALL EASKR(RENDATA(INDEX,3),
            CALL EASKR(RENDATA(INDEX,4),
 993        CALL EPICKS(IDA,JSTR,
*item sbmedit ncm_hvac_ctl_options
'Are there any controls for the specific HVAC system?'
'This is only used in the recommendations report for EPC.'
'  '
'If you elect to define HVAC controls you have several'
'options that are based on the HVAC Non-Domestic'
'guide. They are only used for the Energy Performance'
'Recommendations report and they are not currently '
'affecting the calculated values for the energy loads.'
'This is in accordance with iSBEM vers. 3.2b '
*enditem
          CALL EASKAB('Define controls for system: ',
            CALL EPICKS(IPICKS,iselected,' ',
*item sbmedit ncm_testing_assumptions
'This option is password protected because it is'
'only meant to be used for testing DSM against'
'requirements set accrediting the software. They'
'do not have any practical use. The differences'
'when this flag is set are related with overheating'
'and the calculation of the auxiliary energy.'
'  '
'DSM test flags are as follows:'
'default 0: stripped does NOT follow the rules of '
'the notional/reference building.'
'if equal to 1: stripped follows the rules of the '
'notional building. '
'if equal to 2: stripped follows the rules of the '
'reference building. '
*enditem
        call easki(IPASS,' ','Password?',
        call easki(iDsmTestingFlag,' ','DSM tests flag (see help)?',
*subroutine edsbmsys
*item edsbmsys ncm_sys_help_a
'Sorry but there is little help yet written for this topic in the'
'definition of the UK NCM.'
'  '
'If you wish to add a HVAC system please consider tjhe following:'
'Choose the type of HVAC environment control system that satisfies'
'or comes closest to your requirements (see section 7.6.2 of the'
'iSBEM users guide). The available selections are summarized below:'
' '
'Central heating using water: radiators '
'  Centrally generated heat with water distribution'
'  using radiators in rooms. Natural vent assumed.'
' '
'Central heating using water: convectors '
'  As above but using convectors in rooms.'
' '
'Central heating using water: floor heating '
'  As above but with under floor heating.'
' '
'Central heating with air distribution '
'  As above but with air distribution.'
' '
'Other local room heater - fanned. Includes gas fires, gas'
'  convectors, direct electric heaters, electric storage (with'
'  fans). Large units should be treated as forced convection air'
'  heaters.'
' '
'Other local room heater - unfanned. Includes gas fires, gas'
'  convectors, direct electric heaters, electric storage (w/o fans).'
' '
'Unflued radiant heater - high temperature overhead'
'  radiant (electric or gas) without flue.'
' '
'Flued radiant heater - high temperature overhead'
'  radiant (electric or gas) with flue.'
' '
'Multi-burner radiant heaters - high temperature'
'  overhead gas units'
' '
'Flued forced-convective air heaters - optional fan'
'  to assist combustion.'
' '
'Unflued forced-convective air heaters - typically called direct'
'  gas heaters. Adequate ventilation must be provided.'
' '
'continued... '
*enditem
        CALL PHELPD('NCM HVAC help',2,'-',0,0,IER)
        CALL EASKABC('Choose option',' ','add','delete','cancel',JC,2)
          CALL PHELPD('SBEM HVAC choices',45,'-',0,0,IER)
*item edsbmsys ncm_sys_help_b
'Air based HVAC systems follow... '
' '
'Single-duct VAV - all air system where volume is adjusted'
'  to match cooling load. Reheat optional. Assumed to'
'  provide heating. Optional perimeter heating.'
' '
'Dual-duct VAV - as above except separate hot and cold air'
'  ducts.'
' '
'Indoor packaged cabinet (VAV) - local cooling & heating'
'  units supplying to room or floor or ceiling voids. Optional'
'  locally varied recirc rate and electric top-up heating.'
' '
'Fan coil system - local fanned terminal unit (in ceiling/'
'  on wall/on floor) with central chilled wateer.'
'  2/3/4-pipe. Assumed to provide heating.'
' '
'Induction system - high pressure central supply'
'  air with heating and cooling within terminal'
'  unit. 2/3/4-pipe. Assumed to provide heating.'
' '
'Constant volume system with fixed fresh air - '
'  Fixed air volume units w/o terminal reheat.'
'  Assumed to provide heating.'
' '
'Constant volume system with vairable fresh air -'
'  As above but with free cooling economiser.'
' '
'Multizone hot deck/cold deck - central AHU with a'
'  single duct to each room. Provides heating.'
' '
'Terminal reheat - Central chilled air supply with'
'  reheat at terminal. Assumed to provide heating'
'  and optional perimeter heating.'
' '
'Dual duct (constant volume) - separate hot and '
'  cold air supplies locally mixed at each zone.'
'  Assumed to provide heat, optional perimeter.'
' '
'Chilled ceilings or passive chilled beams - A '
'  combination of chilled ceiling or passive'
'  chilled beam with separate tempered ventilation'
'  air. Heating via LTHW. Assumes displacement vent.'
' '
'Active chilled beams - typically induction units'
'  via central high pressure air supply. Heating'
'  via LTHW. May include local fans.'
' '
'Water loop heat pump - local heat pumps served by'
'  common water loop. Central heating or cooling '
'  plant used. Assumed to provide heating.'
' '
'Split or multi-split system - outdoor and indoor'
'  units connected via refrigerant. No mechanical'
'  vent. Also for ducted split systems.'
' '
'Single room cooling - integral units w/o ducts. '
*enditem
          CALL PHELPD('SBEM HVAC choices',59,'-',0,0,IER)
          CALL EASKS(HVACNAME(NCMSYS),'HVAC system name',
 906      CALL EPICKS(IY,KSYS,' ','Select system type',
          CALL EPICKS(IY,KSYS,' ','Select heat generator',
*item edsbmsys ncm_sys_help_c
'You will be asked for system efficiency/COP next'
'For the district heating option note that default'
'emission factor specified in iSBEM v3.4.a is 0.293'
'kgCO2/kWh. Default efficiency of the system is '
'set to 0.65, this corresponds to natural gas as fuel'
'for aforementioned emission factor.'
*enditem
            CALL PHELPD('SBEM HVAC exceptions',6,'-',0,0,IER)
*item edsbmsys ncm_sys_help_d
'You will be asked for system efficiency/COP next'
'For heat pumps values for natural gas are quoted as'
'default values. The same values are applicable to '
'oil as well. If electricity is being used as fuel '
'then it is appropriate to multiply the COP with 2.5'
'(following iSBEM ver 3.4.a)'
*enditem
            CALL PHELPD('SBEM HVAC exceptions',6,'-',0,0,IER)
          CALL EASKR(HGEF(NCMSYS),
          CALL EPICKS(IY,KSYS,' ','Select fuel type',
 456        CALL EASKATOG(' Choose cooling system',' ',SYSNAME(MPT-4),
              CALL EASKABCD('Enter power rating of system (kW)',' ',
              CALL EASKAB('Is this system in the ECA list',
            CALL EASKR(CGEF(NCMSYS),
            CALL EASKR(SFPHS(NCMSYS),
*item edsbmsys ncm_sys_extract
'If supply/extract then additional ventilation '
'losses will be taken for the heating loads plus'
'additional auxiliary loads.'
' '
'Choose centralised system for centralised balanced'
'mechanical ventilation system including air supplies'
'to centralised air conditioning system'
''
'Choose zonal supply for where the fan in remote from'
'the zone such as ceiling void or roof mounted units'
''
'Choose zonal extract where the fan is remote from the'
*enditem
          CALL EASKABCD('Zone ventilation type (see help)',
          CALL EASKAB('Does system have local ventilation only units',
            CALL EASKR(SFPHS(NCMSYS),
*item edsbmsys ncm_sys_delete
'Choose HVAC system to delete or simply exit without'
'making any choice to retain all defined systems'
*enditem
          CALL EPICKS(IZ,KSYS,' ','HVAC system to delete',
*item edsbmsys ncm_sys_replace
'Choose HVAC system to replace current system'
'(see text feed back area) or exit to retain current'
*enditem
        CALL EASKS(HVACNAME(IHO),'HVAC system name',
        CALL EPICKS(IY,KSYS,' ','Select system type',
        CALL EPICKS(IY,KSYS,' ','Select heat generator',
*item edsbmsys ncm_sys_cop_a
'You will be asked for system efficiency/COP next'
'For the district heating option note that default'
'emission factor specified in iSBEM v3.4.a is 0.293'
'kgCO2/kWh. Default efficiency of the system is '
'set to 0.65, this corresponds to natural gas as fuel'
'for aforementioned emission factor.'
*enditem
          CALL PHELPD('SBEM HVAC exceptions',6,'-',0,0,IER)
*item edsbmsys ncm_sys_cop_b
'You will be asked for system efficiency/COP next'
'For heat pumps values for natural gas are quoted as'
'default values. The same values are applicable to '
'oil as well. If electricity is being used as fuel '
'then it is appropriate to multiply the COP with 2.5'
'(following iSBEM ver 3.4.a)'
*enditem
        CALL PHELPD('SBEM HVAC exceptions',6,'-',0,0,IER)
        CALL EASKR(HGEF(IHO),
        CALL EPICKS(IY,KSYS,' ','Select fuel type',
*item edsbmsys ncm_cooling_gen
'Please select the cooling generator from the list in the dialog.'
'  '
'Some cooling generators are specified via a power rating in'
'kW aat different ranges. Heat pumps will use the maximum kW.'
'  '
'For the cool generator efficiency or COP the default is 0.8'
'times the seasonal EER.'
*enditem
 457        CALL EASKATOG(' Choose cooling system',' ',SYSNAME(MPT-4),
              CALL EASKABCD('Enter power rating of system (kW)',' ',
              CALL EASKAB('Is this system in the ECA list',
            CALL EASKR(CGEF(IHO),
*item edsbmsys ncm_vent_fan_sfp
'Note the initial value presented is the default SFP.'
*enditem
          CALL EASKR(SFPHS(IHO),
*item edsbmsys ncm_vent_take_from
'If supply/extract then additional ventilation '
'losses will be taken for the heating loads plus'
'additional auxiliary loads.'
*enditem
          CALL EASKAB('Zone ventilation type',
            CALL EASKR(SFPHS(IHO),
*subroutine edsbmbld
*item edsbmbld ncm_contact_data
'This menu allows the definition of project details. These will be'
'used by BRUKL/EPC for reporting purposes and are required data.'
' '
'The enter all details will ask for for all the details shown in'
'the menu (in sequence):'
'  '
' - a succinct description of the project'
'  '
' - the building street accress '
'  '
' - names of the town/city of the building'
'  '
' - post code for the building'
'  '
' - the building owner name'
'  '
' - the telephone number of the owner'
'  '
' - the stree address of the owner'
'  '
' - city of the owner location'
'  '
' - post code of the owner location'
'  '
' - name of certifier'
'  '
' - telephone number of certifier'
'  '
' - street address of certifier'
'  '
' - city of certifier'
'  '
' - post code of certifier'
'  '
' - succinct description of the project name'
'  '
'This information is similar to that found in iSBEM.'
*enditem
        CALL PHELPD(HEAD,6,'-',0,0,IER)
        CALL EASKS(pjname,'project name?','(20 characters maximum)',
        CALL EASKS(baddress,'building address?','(<64 characters)',
        CALL EASKS(bcity,'building city?','(<64 characters)',
        CALL EASKS(buildingPC,'building post code?',
        CALL EASKS(ownername,'Name of owner?','(<64 characters)',
        CALL EASKS(ownertel,'Phone of owner?','(<64 characters)',
        CALL EASKS(owneraddr,'Address of owner?','(<64 characters)',
        CALL EASKS(ownercity,'City of owner?','(<64 characters)',
        CALL EASKS(ownerPC,'Post code for owner?','(<64 characters)',
        CALL EASKS(certifname,'Name of certifier?','(<64 characters)',
        CALL EASKS(certTel,'Phone of certifier?','(<64 characters)',
        CALL EASKS(certaddress,'Address of certifier?',
        CALL EASKS(certcity,'City of certifier?','(<64 characters)',
        CALL EASKS(certPC,'Post code of certifier?',
        CALL EASKS(pjname,'project name?','(20 characters maximum)',
        CALL EASKS(baddress,'building address?','(<64 characters)',
        CALL EASKS(bcity,'building city?','(<64 characters)',
        CALL EASKS(buildingPC,'building post code?',
        CALL EASKS(ownername,'Name of owner?','(<64 characters)',
        CALL EASKS(ownertel,'Telephone of owner?','(<64 characters)',
        CALL EASKS(owneraddr,'Address of owner?','(<64 characters)',
        CALL EASKS(ownercity,'City of owner?','(<64 characters)',
        CALL EASKS(ownerPC,'Post code for owner?','(<64 characters)',
        CALL EASKS(certifname,'Name of certifier?',
        CALL EASKS(certTel,'Phone of certifier?','(<64 characters)',
        CALL EASKS(certaddress,'Address of certifier?',
        CALL EASKS(certcity,'City of certifier ?','(<64 characters)',
        CALL EASKS(certPC,'Post code of certifier?',
*subroutine edsbmassor
*item edsbmassor ncm_assessor_data
'This menu allows the definition of project details. These will be'
'used by BRUKL/EPC for reporting purposes. You are asked about:'
' '
' - The Unisque Property Reference Number is applicable in England,'
'   Wales & Northern Ireland.'
'  '
' - The month and the day of the month of the inspection. Applicable'
'   only for England, Wales & Northern Ireland.'
'  '
' - The year of the inspection. Applicable only for England,'
'   Wales & Northern Ireland.'
'  '
' - name of certifier/energy assessor accreditation scheme.'
'   Applicable only for England, Wales & Northern Ireland.'
'   E.g. the scheme name from CIBSE or BRE. '
'  '
' - The assessor registration number should be in the'
'   form of CCCCNNNNNN where C is character and N is a'
'   number such as ABCD123456.'
'  '
' - Employer or the trading name of the energy assessor.'
'   Applicable only for England, Wales & Northern Ireland.'
'  '
' - Employer or the trading address of the energy assessor.'
'   Applicable only for England, Wales & Northern Ireland.'
'  '
' - Any other related party disclosure by the energy asessor.
'   Applicable only for England, Wales & Northern Ireland.'
'  '
' - Qualifications of the energy asessor. There are 3 choices: '
'   NOS3, NOS4 and NOS5.'
'   Applicable only for England, Wales & Northern Ireland.'
'  '
' - Name of insurance company. Applicable only for England,
'   Wales & Northern Ireland.'
'  '
' - Insurance company policy number. Applicable only for England,
'   Wales & Northern Ireland.'
'  '
' - Insurance start day month & year. Applicable only for England,
'   Wales & Northern Ireland.'
'  '
' - Insurance expiry day month & year. Applicable only for England,
'   Wales & Northern Ireland.'
'  '
' - Insurance policy cover limit. Applicable only for England,
'   Wales & Northern Ireland.'
'  '
' - Complexity level of the project. Applicable only for'
'   England, Wales & Northern Ireland.'
'   There are 4 choices: '
'     Undefined - no opinion (yet)'
'     Level 3 less than 100kW heating & less than 12kW cooling'
'     Level 4 more than 100kW heating & 12kW cooling'
'     Level 5 building cannot be done via sBEM.'
'  '
'<< help message is work-in-progress >> '
'  '
*enditem
        CALL PHELPD(HEAD,6,'-',0,0,IER)
        CALL EASKS(UPRN,'Unique Property Reference Number (UPRN)?',
        CALL EASKI(D_inspect,' ','Day of inspection?',
        CALL EASKI(M_inspect,' ','Month of inspection?',
        CALL EASKI(Y_inspect,' ','Year of inspection?',
        CALL EASKS(Accr_Scheme,'Accreditation scheme ?',
        CALL EASKS(assessRegNumber,
        CALL EASKS(empl_Trading_name,'Employer/trading name ?',
        CALL EASKS(addr_empl_Trading,'Employer/trading address ?',
        CALL EASKS(party_disclosure,'Party disclosure ?',
        CALL EASKABC(' ','Energy assessor qualifications:',
        CALL EASKS(insurer_Company,'Name of insurance company ?',
        CALL EASKS(policyNumberInsurance,'Policy number ?',
        CALL EASKI(S_Dinsur,' ','Insurance start (day)?',
        CALL EASKI(S_Minsur,' ','Insurance start (month)?',
        CALL EASKI(S_Yinsur,' ','Insurance start (year)?',
        CALL EASKI(E_Dinsur,' ','Insurance expiry (day)?',
        CALL EASKI(E_Minsur,' ','Insurance expiry (month)?',
        CALL EASKI(E_Yinsur,' ','Insurance expiry (year)?',
        CALL EASKI(pi_limit,' ','Insurance cover limit?',
        CALL EASKABCD(' ','Complexity level ?',
*subroutine edsbmregs
*item edsbmregs ncm_bldg_regs
'Select from the list of choices the appropriate building regulations'
'for this project.'
'  '
'Next select from list the stage of the project.'
'  '
'If you are using the Scottish regulations are are asked to nominate'
'a Scottish building type. Depending on the type of building the'
'notional model will have different assumptions about glazing areas.'
'The building type will also help in the selection of room '
'use patterns. '
'  '
'For all locations you are asked to define the building permeability'
'based on a 50Pa test in units of m^3/m^2/hour (where m^2 is the'
'building envelope area) You are also asked whether a compliance'
'check will be carried out.'
'  '
'A approximation of infiltration based on CIBSE data is used. The'
'selections allow you to define a number of levels and level floor'
'area so that a correlation can be recovered.'
'  '
'Based on the above information you are then asked to confirm the'
'air leakage rates (to be added to the fresh air requirement) in'
'terms of air changes per hour.'
*enditem
 902  CALL EPICKS(IX,JSTR,' ','Define building regulations to use',
 903  CALL EPICKS(IX,JSTR,' ','Define building regulations to use',
 904    CALL EPICKS(IX,JSTR,' ','Define building type',
        CALL EASKABC('Is the building built/designed following',
      CALL EASKR(BINF50,
      CALL EASKABC(
        CALL EPICKS(IX,JSTR,' ','CIBSE building selection',
        CALL EPICKS(IX,JSTR,'Pick storeys and floor area ',
        CALL PHELPD('AIR LEAKAGE',2,'-',0,0,IER)
        CALL EASKR(Air_infilt,' ',
 905  CALL EPICKS(IX,IVALSS,' ','Building type:',
*subroutine EMKSTRIPPED
*item EMKSTRIPPED ncm_str_ctl_warn
'A control file exists. Choose to overwrite in the'
'questions that will follow. '
'  '
'There is also a check to see if a temporal data file'
'also exists and let you confirm if it should be overwritten.'
*enditem
          CALL PHELPD('File exists',2,'-',0,0,IER)
          CALL PHELPD('File exists',2,'-',0,0,IER)
*subroutine EMKSBM
*item EMKSBM ncm_details_missing
'You have not defined NCM details about the building.'
'These can be defined by choosing model context in the'
'browse / edit / simulate menu and then choosing'
'option UK NCM specifications. '
'You are being returned to the NCM editing facility.'
*enditem
        CALL PHELPD('NCM details undefined!',5,'-',0,0,IER)
*item EMKSBM ncm_geom_scan_issue
'A problem was found when scanning the origial'
'model geometry. You may need to alter the original'
'model in order to proceed.'
'You are being returned to the NCM editing facility. '
*enditem
          CALL PHELPD('NCM details undefined!',4,'-',0,0,IER)
*item EMKSBM ncm_file_copy_issue
'A problem was found when copying origial'
'model files. Check if you have write permission.'
'You are being returned to the NCM editing facility. '
*enditem
          CALL PHELPD('NCM details undefined!',3,'-',0,0,IER)
*item EMKSBM ncm_bld_type_not
'A problem was found - the NCM building type'
'was not defined. Please do this and try again.'
*enditem
        CALL PHELPD('NCM building type undefined!',2,'-',0,0,IER)
*subroutine RSL6TF
*item RSL6TF ncm_save_six_file
'Please supply the name of the [level 6] text result file.'
*enditem
        CALL EASKS(LTXTF,'Name of text results file?',
*subroutine defLeakage
*item defLeakage ncm_ductwork_details
'This menu allows the definition of ductwork and air handling'
'Unit details. These will be used for the Auxiliary Energy'
'calculation for the stripped building. The defaults will'
'use the worse case options: this for the ductwork question'
'is [Class Worse than A] and for AHU is [Class worse than L3].'
'  '
'For the ductwork calss:'
'  The default is the same as Class Worse than A.'
'  Class B is the best option here. See '
'  EN 13779 Standard for more details.'
'  '
'For the AHU class:'
'  The default is the same as Class Worse than L3.'
'  Class L1 is the best option here. See EN 13779'
'  Standard for more details.'
*enditem
          call phelpd(head,7,'-',0,0,IER)
          call easkabcd(' ',
          call menuatol('Define AHU leakage',
*subroutine epltnet
*item epltnet
'This facility is used to define or edit a plant '
'network. The items in the main menu have the following'
' functions:'
' '
' (1) Allows you to define a new plant network.'
'     Before you proceed with the network '
'     definition, you will be asked to specify'
'     the network file name.'
' '
' (2) Allows you to modify an existing plant '
'     network. You will be asked to specify'
'     the network file name.'
' '
' (?) Displays this message.'
' (-) Exits to project description.'
'Graphical network definition is currently  '
'functional but is still at an early  '
'stage of development. Hence for the safety'
'of the novice user graphical network '
'definition is password protected.'
' '
'If you do not know the password select cancel'
'and you will be given a change to try again with '
'the text/menu based interface.'
*enditem
        call easki(ians,' ','Password: ',0,'-',0,'-',0,'Password',
*item epltnet
*enditem
         CALL PHELPD('pdf opening',15,'-',0,0,IER)
*subroutine edcomp
*item edcomp
'Each plant component has numerous parameters '
'associated with it. These are grouped into two sets:    '
' '
'heat flow parameters - these are associated with the heat'
'transfers in the plant component.'
' '
'fluid flow parameters - these are associated with pressure'
'driven fluid flow in the component and are necessary ONLY'
'if a fluid flow connection(s) is/are mapped to the plant '
'component. Each RECIEVING connection to the plant '
'component requires a set of fluid flow parameters, e.g.'
'the mixing box, with two incoming connetions, requires'
'two fluid flow parameter sets. '
' '
'All parameters can be edited by the user to suit their'
'particular component.'
*enditem
      CALL EASKABC('What do you want to edit? ',' ',
*item edcomp
'You can designate a meaningful name for the selected'
'component. This name will be used in the current '
'problem. The name must not exceed 15 characters.'
' '
*enditem
        CALL EASKS(t15,
*item edcomp
'A control variable may be subjected to control action.'
'For example, in a heating coil model, the heat'
'injected to the air may be an elected control variable.'
'If no control loop is defined, a realistic value must'
'be assigned to this variabel otherwise its value is '
'determined on the basis of some sensed condition and'
'the active control law.'
' '
*enditem
          CALL EASKR(value,' ',txt,0.,'-',0.,'-',0.,
*item edcomp
*enditem
   20   call askpar(itm,ival,ipcomp)
*item edcomp
*enditem
            call easkr(value,' ',txt,0.,'-',0.,'-',dvalue,
*item edcomp
*enditem
        call askmfpar(ipcomp)
*subroutine ASKPCMP
*item ASKPCMP
'The list shows the (currently) available components '
'defined in the plant network which is being edited. '
'Components can be added to the list only in the '
'component editing menu. Deletion is allowed'
'only during the editing phase, when an individual  '
'component is chosen from the displayed list. '
'Choose a component from the list or [Exit].'
*enditem
        CALL PHELPD('node connection selection',7,'-',0,0,IER)
*item ASKPCMP
'Supply the index of the plant component. '
' '
'A cancel continues without a component. '
*enditem
  96    CALL EASKI(IV,' ',' Index of component ? ',
*item ASKPCMP
*enditem
            CALL EASKABCD('Choose an option or continue ',' ','Add',
*item ASKPCMP
'If this is the item you want to edit say ok. If not'
'say no and try again. '
*enditem
          CALL ASKOK('Edit this item?',' ',OK,dok,2)
*subroutine ASKPCON
*item ASKPCON
'The list shows the (currently) available connections'
'defined in the plant network being edited/defined.'
'Connections can be added to the list only in the '
'connection editing menu. Connections deletion '
'is allowed only during the editing phase, when an '
'individual connection is chosen from the displayed'
'list. Choose a connection from the list or [Exit].'
*enditem
        CALL PHELPD('node connection selection',7,'-',0,0,IER)
*item ASKPCON
'Supply the index of the plant component. '
' '
'A cancel continues without a component. '
*enditem
  96    CALL EASKI(IV,' ',' Index of component ? ',
*item ASKPCON
*enditem
        CALL EASKABCD('Select option or continue',' ','Add ','Delete',
*item ASKPCON
' '
' '
*enditem
          CALL ASKOK('Edit this connection?',' ',OK,dok,2)
*subroutine ASKCONT
*item ASKCONT
'The list shows the  available containments defined'
'in the current plant network being edited/defined. '
'Containments can be added to the list only during '
'editing. Containment deletion is allowed only during'
'the editing phase, when an individual containment  '
'is chosen from the displayed list. '
'Choose a containment from the list or [Exit]. '
*enditem
        CALL PHELPD('node connection selection',6,'-',0,0,IER)
*item ASKCONT
'Supply the index of the plant component. '
' '
'A cancel continues without a component. '
*enditem
  96    CALL EASKI(IV,' ',' Index of component ? ',
*item ASKCONT
*enditem
          CALL EASKABCD('Containment options:',' ','Add ','Delete',
*item ASKCONT
' '
' '
*enditem
          CALL ASKOK('Edit this containiment',' ',OK,dok,2)
*subroutine LISTPNF
*subroutine opnpdb
*item opnpdb
'The plant component database binary file holds the'
'description of available components. If the name'
'given matches an existing file, it will be read in'
'and the components data will be available for'
'listing and editing. If there is no such file then'
'a new one will be created to hold data for new'
*enditem
          CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
*enditem
          CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
*enditem
          CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
*enditem
        CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
*enditem
        CALL EASKF(lltmp,'Plant component database file name? ',' ',
*item opnpdb
'An error occurred wheb opening the plant template'
'template database. Check that the file exists and has'
'not been corrupted. '
*enditem
            CALL ASKOK('Error occurred on opening file',
*item opnpdb
'An error occurred when opening the plant template'
'template database. Check that the file exists and'
'that the name you supplied is correct. '
*enditem
            CALL ASKOK(' Plant database file does not exist.',
*item opnpdb
'The file exists, but is either not a plant db file'
'or has been corrupted. This might happen if the file'
'was generated on a different type of computer.'
*enditem
            CALL ASKOK(' Not a plant data base file.',
*subroutine cpcdat
*item cpcdat
'The data is needed by CPCALC to calculate the pressure'
'distribution around a building.  '
' '
'Building width,depth and hight are the OVERALL '
'dimensions if the building. Roof type can be a flat'
'roof (type 0), a single sloped roof (type 1) or'
'a double sloped roof (type 2).'
'The surrounding buildings hight and plan area density '
'are related to the average hight and the layout'
'pattern of the buildings surrounding the building'
'under examination.'
'The wind velocity profile defines the terrain'
' '
'Detailed information about the points on the facade '
'where pressure coefficients are calculated should be '
'defined in the pressure coefficients database of the'
'database maintenence facility. '
*enditem
        CALL PHELPD('prim convers',18,'-',0,0,IER)
*item cpcdat
'The width (with no rotation) is along the x-axis.'
'Note that for a tilted roof this is the facade'
'with the roof ridge!'
*enditem
        CALL EASKR(ble,' ','Overall building width:',
*item cpcdat
'The depth (with no rotation) is along the y-axis.'
'Note that for a tilted roof this is the facade'
'with the gable!'
*enditem
        CALL EASKR(bwi,' ','Overall building depth:',
*item cpcdat
'Give the OVERALL hight of the building.'
'Note that for a building with a tilted roof the hight '
'of the building is defined from the bottom of the'
'building to the bottom of the roof (eaves).'
*enditem
        CALL EASKR(bhi,' ','Overall building hight:',
*item cpcdat
'This is the origin of the CPCALC domain that is used by'
'CPCALC to calculate the pressure coefficients.'
'It will define its south-westerly corner.'
'With the definition of the orientation the box'
'gets positioned at the exact place.'
'(this is in the same coordinate system as the zones)'
*enditem
        CALL EASKS(HOLD,'Origin of CPCALC domain (X Y Z metres):',
*item cpcdat
 'The orientation of the CPCALC domain is given in  '
 'a clockwise direction (i.e. 0 rotation is length  '
 'along X axis). The rotation point is x (see below).'
 'Rotation can be in between 0 and 180 degree.      '
 '                                                  '
 '   *****************                              '
 '   *               *      NORTH                   '
 '   *               *        ^                     '
 '   *  <-length->   *        |                     '
'   x****************        |                     '
*enditem
        CALL EASKR(orient,' ','Orientation of the building:',
*item cpcdat
'Choose one roof type. '
'The double slope roof is also known as a gable roof.'
'Note that for a building with a tilted roof the facade'
'along the length dimension (x-axis if no rotation) is '
'the one with the roof ridge!'
 '        ridge                                     '
 '   **.............**                              '
 '   *      or       *      NORTH                   '
 '   * ...ridge..... *        ^                     '
'   *  <-length->   *        |                     '
'   x****************        |                     '
*enditem
        CALL EASKABC('Choose one roof type: ',' ','flat roof',
*item cpcdat
'The roof tilt angle is measured from the horizontal'
'plane containing the reference flat roof.'
'The roof tilt angle has to be in between 0 - 50 degree'
*enditem
          CALL EASKR(ra,' ','Roof tilt angle:',
*item cpcdat
'The roof tilt angle is measured from the horizontal'
'plane containing the reference flat roof.'
'The roof tilt angle has to be in between 0 - 50 degree'
*enditem
          CALL EASKR(ra,' ','Roof tilt angle:',
*item cpcdat
'The surrounding buildings hight is related to the '
'average hight of the buildings surrounding the model'
'zones under examination.'
*enditem
        CALL EASKR(sbh,' ','Surrounding buildings hight:',
*item cpcdat
'The plan area density (PAD) is related to the layout'
'pattern of the buildings surrounding the building under'
' '
'PAD=(Building Area/Total Area)*100'
'[where total area is the overall site area (m^2) and '
' building area is the ground contact area of buildings'
' (m^2) within the overall site].'
' '
'The extension of the radius to be considered can be'
'calculated with the radius formula R:'
' '
'R=(7.67-PAD)/2.7*building height'
' '
'Wind tunnel test data shows that the radius of the'
'built area surrounding the building, and affecting the'
'wind pressure distribution on its envelop, is inversely'
'proportional to the plan area density. This is why a'
'greater PAD lead to a greater radius to be considered:'
'A PAD of 12 results in a considered radius of 240'
'and a PAD of 40 results in a considered radius of 135.'
' '
'If the area surrounding the buildings does not have an'
'homogeneous density - as often happens - homogeneous'
'sectors should be defined according to the average'
'density of their building blocks. The PAD value to '
'insert in the program is the average value of all'
' '
'This help message was extracted from the CPCALC user'
' '
*enditem
        CALL EASKR(pad,'Plan area density: ','(see help)',
*item cpcdat
'The wind velocity profile defines the terrain roughness.'
' '
'The following list shows reference values taken from'
'the CPCALC user menue:'
' '
'Level surface, surface of water basin, grass land:'
'-> 0.10'
'Flat open country few, very small and scattered'
'-> 0.14'
'Rolling or level surfaces broken by numerious'
'obstructions such as trees or small houses:'
'-> 0.22'
'Heterogeneous surface with obstacles larger than'
'one story:'
'-> 0.28'
'Low density suburban areas:'
'-> 0.34'
'Medium-high density urban areas:'
'-> 0.40'
'Very high density inner city areas:'
'-> 0.45'
' '
*enditem
        CALL EASKR(wvpe,' ',' Wind velocity profile:',
*subroutine EDCPFAC
*item EDCPFAC
'Here you can define the coordinates for which'
'CPCALC is going to calculate the pressure'
'[Add coordinates] allows a manual input of the '
'coordinates, [generate coordinates] will search the '
'model for windows and suggest a position.'
'Delete coordinates allows to remove allready defined'
*enditem
        CALL PHELPD('input cpcalc coordinates',8,'-',0,0,IER)
*item EDCPFAC
*enditem
 878    CALL EASKS(LTMP,' Facade coordinates file ? ',
*item EDCPFAC
*enditem
        CALL EASKS(LTMP,' Facade coordinates file ? ',
*item EDCPFAC
'You can delete one coordinate set'
*enditem
        CALL EPICKS(IX,IVAL,'Delete which one?',' ',
*item EDCPFAC
'Chance to not delete this cooordinate set. '
'(in case you picked the wrong set) '
*enditem
        CALL ASKOK(' ',' Are you sure? ',OK,dok,2)
*item EDCPFAC
'You can eiter provide the coordinates by manual input'
'or search the model for windows.'
'Windows are transparent external surfaces.'
*enditem
        CALL EASKAB('Options: ',' ','manual input',
*item EDCPFAC
*enditem
          CALL EASKGEOF('Select a zone for coords:',CFGOK,IC,'-',IER)
*item EDCPFAC
*enditem
 256      CALL EASKSUR(IC,ISO,'-','with respect to which external ',
*item EDCPFAC
'The X offset is the horizontal distance from the '
'lower left corner of the surface (looking from'
'the outside) to the considered point.'
*enditem
          CALL EASKR(DX1,' ',' X offset: ? ',
*item EDCPFAC
'The Z offset is the vertical distance from the '
'lower left corner of the surface (looking from'
'the outside) to the considered point.'
*enditem
          CALL EASKR(DZ1,' ',' Z offset: ? ',
*item EDCPFAC
'Chance to not use this cooordinate set.'
'(in case the location is incorrect) '
*enditem
          CALL ASKOK(t28,'Use this coordinate?',OK,dok,2)
*item EDCPFAC
'Give a name for the cordinates. This names will then'
'later also be used for the definition in the pressure'
'coefficient database.'
*enditem
            CALL EASKS(HOLD2,'Name cpcalc cordinates',
*item EDCPFAC
'Respond with ok if you want another cooordinate set.'
*enditem
          CALL ASKOK(' ','Define another point for this zone?',OK,dok,1)
*item EDCPFAC
'Chance to not use this cooordinate set.'
'(in case the location is incorrect) '
*enditem
                CALL ASKOK(t28,'Use this coordinate?',OK,dok,2)
*item EDCPFAC
'Give a name for the cordinates. This names'
'will then later also be used for the defi-'
'nition in the pressure coefficient database.'
*enditem
                  CALL EASKS(HOLD2,'Name cpcalc cordinates',
*subroutine CPCACAL
*item CPCACAL
'ESP-r will check whether the coordinates that '
'have been defines as locations to calculate the '
'pressure coefficients are close to one of the surfaces '
'of the CPCALC domain.'
'Here you can give a tolerance that will be applied'
'for this check.'
*enditem
      CALL EASKR(ditol,'maximum tolerance between the absolut',
*item CPCACAL
'ESP-r will project the coordinates that have been'
'defines as locations to calculate the pressure'
'coefficients on the surface of the CPCALC domain'
'with similar orentation and  elevation (projection '
'direction normal to the surface of the CPCALC domain).'
'As a control meachanism it compares the orentation of'
'the zone surface from which these coordinates had been'
'derived with the orentation of the surface of the'
'CPCALC domain. Here you can define the maximum'
'difference between these two values.'
*enditem
      CALL EASKR(aztol,
*item CPCACAL
'ESP-r will project the coordinates that have been'
'defines as locations to calculate the pressure'
'coefficients on the surface of the CPCALC domain'
'with similar orentation and  elevation (projection '
'direction normal to the surface of the CPCALC domain).'
'As a control meachanism it compares the elevation of'
'the zone surface from which these coordinates had been'
'derived with the elevation of the tilted roof of the'
'CPCALC domain. Here you can define the maximum'
'difference between these two values.'
*enditem
        CALL EASKR(eltol,
*item CPCACAL
'You can either append the data to the currently used '
'database or you can save it as a new database.'
'If you are using the default pressure coefficent'
'database ESP-r will suggest a file in your directory'
'to save the data since you do not have writing'
'permission to the default one. This file will then'
'include the default pc-sets but also the ones you'
*enditem
      CALL ASKOK(
*item CPCACAL
*enditem
        CALL EASKAB('How do you want to save the data?',' ',
*item CPCACAL
'To which file do you want to write the pressure data?'
' '
' '
*enditem
              CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
*enditem
              CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
*enditem
              CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
*enditem
            CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
*enditem
            CALL EASKF(lltmp,' ','Pressure coefficients database?',
*item CPCACAL
'To which file do you want to write the data?'
*enditem
C          CALL EASKS(LTMP,' Pressure coefficients database?',
*subroutine EMKAPCDB
*subroutine EDPCDB
*item EDPCDB
'To enable the calculation of wind-induced surface'
'pressures (as required by ESP-r-s fluid flow'
'simulators), this database of angle dependent'
'pressure coefficients is provided.'
' '
'Wind pressure coefficients are pressure coefficients'
'for surfaces in typical positions and within several'
'different exposure categories. '
' '
'The first 27 data sets in the standard pressure coef'
'database are from the Air Infiltration and Ventilation'
'Centre Handbook called <Air Infiltration Calculation'
'Techniques - An Applications Guide>. The 27 data sets'
'are only applicable for buildings up to 3 storeys and'
'come with the usual warnings about usage of the data.'
' '
'Each data set is described with the following terms: '
' a) facade or roof at different roof pitch angles'
' b) the ratio of the building length to width and'
'    for a non square building there will be a long and'
'    a short wall to select'
' c) site shielding as follows:'
'   exposed - open countryside with no obstructions'
'   simi-exposed - rural with some obstructions'
'   sheltered - urban, surrounded on all sides by'
'     obstructions of similar size.'
' '
'Here you can change the data of an existing pressure'
'coefficient set (by clicking on it), add/delete/copy'
'a set, list the file contents of the existing pc-file'
'or update changes you have made.'
'Recent changes to the coefficients might be lost if'
'you do not save it to the database. '
*enditem
          CALL ASKOK(' ',
*item EDPCDB
*enditem
        CALL PHELPD('pc help menue',31,'-',0,0,IER)
*item EDPCDB
'The continue option allows you to cancel choice. '
*enditem
        call easkatog('Modify sets:',' ','add (manually)',
*item EDPCDB
'Parameter a to j are general building parameters'
'required by CPCALC and are defined in the model'
'In [facade coordinates] the user can define for which'
'coordinates he wants to calculate pressure'
'[Calculate pressure coefficients] runs CPCALC.'
*enditem
            CALL PHELPD('cpcalc in mfs',7,'-',0,0,IER)
*item EDPCDB
'You can delete one pressure coefficient set'
*enditem
          CALL EPICKS(IX,IVAL,'Delete which one?',' ',
*item EDPCDB
'Chance to abort deletion of pressure coef set.'
*enditem
          CALL ASKOK(' ',' Are you sure? ',OK,dok,1)
*item EDPCDB
*enditem
          CALL EPICKS(IX,IVAL,'Copy which one?',' ',
*subroutine EDPCST
*item EDPCST
'Give a name for the pressure coefficient set'
*enditem
      CALL EASKS(HOLD2,'Name of pressure coefficient set',
*item EDPCST
'The values for the pressure coefficients should be '
'between -1.5 and 1.5.'
'The first pressure coefficient is defined as NORMAL'
'to the surface (see drawing) and the following'
'coefficients are defined at steps of 22.5 degree'
'in a clockwise direction.'
'   _____ '
'        |'
'        |'
'        |  <----'
'        | The first pressure coefficient is defined'
'   _____| as NORMAL to the surface'
*enditem
      CALL EASKS(HOLD,outs,' ',72,
*item EDPCST
*enditem
      CALL EASKS(HOLD,outs,' ',72,
*subroutine ERPRCDB
*subroutine prj
*item prj exit_without_save
'If you exit without saving, recent changes could be'
'lost. If you selected this option in error select'
*enditem
          CALL EASKABC('There are unsaved changes in the model.',
*item prj prj_welcome
'Welcome to the ESP-r Project Manager, a tool to help you to'
'specify, appraise and evolve your energy system designs.'
' '
'If you are new to ESP-r, you might like to start by looking'
'at the information available at the web site:'
'www.esru.strath.ac.uk/Programs/ESP-r.htm. The download page has a'
'users guide (aka the ESP-r Cookbook) as well as pre-compiled'
'versions of ESP-r.'
' '
'The ESRU web pages <http://www.esru.strath.ac.uk/publications.htm>'
'is a good source for publications related to ESP-r.'
' '
'There is an ESP-r users and developers club you can join at:'
'<www.esru.strath.ac.uk/Programs/user_club.htm> should you'
'require further information or wish to suggest enhancements.'
' '
'To list the invocation options supported by this tool'
'enter [prj -help] at the command line prompt.'
' '
'If you need to work with complex models then you may need to'
'update the parameters in the source include folder, re-compile'
'ESP-r and then test it on increasingly complex models. '
' '
'This version supports models of the following (maximum)'
'complexity: '
' '
*enditem
        CALL PHELPD('Introduction',35,'gen_esp_intr',0,0,IER)
*item prj find_out_more
'ESP-r is open source. Tou can look at the source code and'
'compile it yourself and even single step through'
'applications to see how they actually work.'
' '
'Have a look at the following web site for instructions about'
'downloading the ESP-r source and databases and example models:'
'<http://www.esru.stratyh.ac.uk/Programs/ESP_r_central.htm>.'
'  '
'Getting the source code is simple. Get a subversion client'
'for your computer, identify a place on your computer to'
'download the source distribution (takes about 400MB) and'
'issue the following command (all on one line):'
'  '
'  svn checkout https://espr.svn.cvsdude.com/esp-r/branches/'
'     development_branch'
'  (go and have a cup of coffee)'
'  '
'  cd development_branch/src'
'  ./Install -d /usr/esru --gcc4 --reuse_ish_calcs'
'  (go and have another cup of coffee)'
'  '
'  Follow the instructions for setting up environment variables'
'  so that ESP-r executables can be found.
'  '
*enditem
        CALL EASKABC(' ','Model selection options:',
*item prj command_line_cfg_file
'The model configuration file holds the definition'
'of the model to be simulated, including the names'
'of the composing files.  A configuration file'
'has been passed to the Project Manager as a command'
'line argument.'
' '
'If you selected this option in error click cancel. '
*enditem
            CALL EASKABC(outs,' ','use it as the model',
*item prj model_root_name
'This root name will be used to create the'
'ESP-r model folder structure that holds key'
'files such as the system configuration file.'
'  '
'If you have altered the name of the configuration'
'file you may want to modify the root name as well.'
*enditem
          CALL EASKS(t24,' ','Project root name (<24 chars)?',
*item prj prj_model_title
'Each model has an associated descriptor (<72 chars),'
'which should be suitably informative, e.g.:'
' '
' PV-facade office, daylight controlled, base case.'
*enditem
          CALL EASKS(ltmp,' ','Model description?',
*item prj updated_cfg_file_name
'The current model description will be copied'
'into this file.'
*enditem
   89     CALL EASKS(ltmp,' Updated configuration file?',
*item prj model_cnn_file_name
'The surface topology of the model is held'
'in a connections file.'
*enditem
              CALL EASKS(ltmp,' Surface connections file name?',' ',
*subroutine simula
*item simula prj_simulation_menu
' option p: Normally an integrated simulation is invoked by which'
'   the heat, fluid, electrical power and light flows within'
'   combined building/plant models may be evaluated.'
'  '
'   The integrated simulation option computes the pressure'
'   induced fluid flow within a network of connected flow'
'   components representing the building and/or plant'
'   system in whole or part.' '
'  '
' option r: fluid flow only invokes the mass flow solver if'
'   one exists and it uses fixed boundary conditions during'
'   the solution.  This can be useful for checking whether'
'   a flow network will solve.
'   If a CFD domain is defined then a CFD only 2D or 3D steady'
'   state or transient assessment will be started based on'
'   fixed boundary conditions and bouyancy effects. For models where'
'   this assumption is inappropriate, the Integrated simulation'
'   option should be used.'
'  '
' option s: this starts up the utility application e2r to generate'
'   a Radiane visual model from the current ESP-r model.'
'  '
' option t: If you have previously defined an Integrated Performance'
'   View (IPV) this option can be used to run the associated'
'   assessments and extract the required performance metrics and'
'   write them to an IPV report file. Some users use this to'
'   automate assessment tasks (it can run up to 5 simulations with'
'   no user interactions) or to break huge model assessments into'
'   managable seasonal results files.'
'  '
' option u: In the UK this can be used to automatically create the'
'   model variants (notional, reference etc.) and run the assessments'
'   used by the UK National Calculation Method.'
*enditem
        CALL PHELPD('Simulation',14,'-',0,0,IER)
        CALL EASKABC('Fluid flow analysis via:',' ','Nodal Network',
        CALL ASKOK('  ',' Proceed with parameter definitions?',
        CALL EASKABC(' ','Simulation interaction options:',
*item simula prj_sim_set_name
'Typical names are winter spring summer. You could also'
'give specific names such as test22 as long as it is less'
'than eight characters.'
*enditem
            CALL EASKS(de,'Name for set?',' ',8,'win','set name',IER,1)
*item simula prj_sim_set_menu
'Simulation options can be defined in advance with this facility and'
'and these preferences can be recorded in named sets (e.g. winter|'
'spring|summer|hottest) so that specific assessments can be invoked.'
'A simulator command line option uses these preferences to drive the'
'assessment silently or to provide defaults for interactive dialogs.'
'  '
'There is a relationship between Integrated Performance Views (IPV)'
'(see the model context menu) and simulation parameter sets. If'
'an IPV has been defined its directives will populate this menu.'
'  '
' option a: use this to select an existing parameter set (its values'
'   will be displayed and will be used if a simulation is requested.'
'  '
' option b: use this to name/re-name a set. You can use up to 8 char'
'   (no spaces). If an IPV has been defined these set names will be'
'   set and should not be edited.'
'  '
' option c: the pre-simulation start-up period is required to'
'   isolate the effects of initialisation assumptions from'
'   the simulation results. The suggested value, which is'
'   computed automatically, may be overridden.'
'  '
' option d: building-side timesteps range from 1 to 60 per hour.'
'   If the model includes temporal definitions data then'
'   you are advised, if possible, to set the building-side time step'
'   to match the value used for the temporal definitions.'
'  '
'   You will also be asked whether you want to save predictions'
'   at each timestep or as averaged data once per hour. This can'
'   save lots of disk space - but looses some of the reporting'
'   resolution in sub-hourly assessments. Consider this for short'
'   timestep runs where disk space is limited.'
'  '
' option e: Plant-side time step is an integer subdivision'
'   of the active building side time steps per hour. If you have'
'   a 6 tsph on the building side and 10 plant-side timesteps the'
'   plant will be assessed once per minute.'
'  '
' option f: the save level determines how much information is'
'   written to the zone results library:'
'   Level 0 - summary table written to an ASCII file'
'   Level 1 - zone temperatures and plant demand only'
'   Level 2 - as 1 + zone surface temperatures'
'   Level 3 - as 2 + zone construction node temperatures'
'   Level 4 - as 3 + zone and surface energy balances'
'   Level 6 - summary database friendly format or csv file'
'  '
' option g: the simulation period of the current assessment set'
'  '
' options h/i/j/k/l/m: you can pre-define the names of the results'
'   files that are to be created (great for simplifying scripts and'
'   enforcing naming strategies). If you defined an IPV these names'
'   will already have been determined.'

'After running an assessment, your next step is to explore the'
'predictions via the results analysis module the correct results file'
'should be identified automatically. NOTE: if you have run several '
'assessments, you should select the correct parameter set first. '
*enditem
          CALL PHELPD('Simulation sets',20,'-',0,0,IER)
          CALL EASKI(isstupt,' ',
        CALL EASKI(isbnstept,' ','Zone-side time steps per hour?',
        call askok(' Hourly results integration:',' ',hri,
          CALL EASKI(ispnstept,' ',
        CALL EASKI(issavet,' ','Results save level (0-4 & 6)?',
        call EASKPER('Assessment period:',ISDS,ISDF,IFDAY,IER)
        CALL EASKS(t72,' ','Building results library?',72,
          CALL EASKS(t72,' ','Network flow results library?',72,
          CALL EASKS(t72,' ','Plant results library?',72,
          CALL EASKS(t72,' ','Moisture results library?',72,
          CALL EASKS(t72,' ','Electrical results library?',72,
*item simula prj_ipv_res_file
'If you request an IPV assessment (option t) then as the performance'
'data is recovered from the ESP-r results files they are written into'
'an ASCII file which can later be accessed via an IPV report viewer'
'or opened up in a text editor.'
*enditem
          CALL EASKS(t72,' ','IPV transfer file name?',72,
*subroutine ipvactions
*item ipvactions prj_ipv_options
'An Integrated Performance View (IPV) is a collection'
'of standard performance indicators that have been'
'pre-defined. Some of the underlying assumptions may'
'be changed via the IPV facility in the Model Context menu.'
'  '
'If there is sufficient information to undertake assessments'
'(e.g. the model is syntactically correct and the IPV definition'
'if complete then you will be offered the following:'
' '
'The option to run required simulations will invoke '
'as many simulations as required, saving the results '
'to the files specified in the simulation parameter '
'sets.  '
'  '
'Interactive mode uses simulation parameters as defaults'
'which you can then confirm. The silent running mode uses'
'the parameters to run in automatic mode.'
'  '
'Extracting IPV reports is done by invoking the res module'
'with specific command line parameters. Results extraction'
'is usually done in a silent mode as there is minimal user'
'interaction required. '
'  '
'The recovery option you will want to select is ALL (the'
'intermediate step is no longer required).
'  '
'You can compare two IPV reports, extracting and reporting'
'on the differences found. The report includes both nominal'
'and whole building values for the following performance metrics:'
' '
' *for each variant it reports heating demand kWh/m^2/a'
'  and for the whole model (kWh/a), heating capacity kW/m^2'
'  and for the whole model (kW/a diversified).'
' *for each variant it reports heating therms (converted'
'  as kWh * 0.0341296)'
' *for each variant it reports cooling demand kWh/m2/a'
'  and for the whole model (kWh/a), cooling capacity kW/m^2'
'  and for the whole model (kW/a)'
' *difference in heating, therms and cooling by area and'
'  for the whole building.'
'  '
'When generating the comparison report you have the option of'
'using different delimeters:'
'  - spaces (use spaces to lineup columns);'
'  - single space between columns;'
'  - comma separator (e.g. for excel);'
'  - tab separator (e.g. for excel);'
'  - tagged (marked up data).'
'  '
'After defining the delimeter to be used to report the'
'results of the comparison you will be asked to provide'
'the names of the IPV rpoert for the base case model'
'(or the model you want to reference against).'
'  '
'And then you are asked for the second IPV report file.'
*enditem
      CALL PHELPD('IPV message',4,'-',0,0,IER)
      CALL EASKABCD(' ','IPV options:',
      CALL EASKABC(' ','Simulation options:',
      CALL EASKABC(' ','IPV extraction options:',
      call easkabcd('IPV recovery options:',' ','intermediate',
      CALL EASKATOG('Column delimeter:',' ',
      CALL EASKF(basefile,'IPV base case report file ?',
      CALL EASKF(variantfile,'IPV variant report file ?',
      CALL EASKAB('Comparison options:',' ','return to menu',
*subroutine checkmodel
*item checkmodel has_unknown_attributes
'A model with UNKNOWN surface construction attributes'
'cannot be simulated. You can see where by clicking ok.'
*enditem
        call askok(
        CALL PHELPD('lacking construction attrib',lh,'-',0,0,IER)
        call askok(
        CALL PHELPD('questioned boundary attrib',lh,'-',0,0,IER)
*item checkmodel  has_unknown_connects
'A model with inconsistent surface topology attributes'
'might fail when simulated. This will list where.'
*enditem
        call askok(
          CALL PHELPD('questioned boundary attrib',lh,'-',0,0,IER)
        CALL PHELPD('boundary checks',lh,'-',0,0,IER)
*item checkmodel has_unknown_files
'The model was scanned for missing files. These are:'
*enditem
        CALL PHELPD('geometry checks',lh,'-',0,0,IER)
        CALL PHELPD('operations checks',lh,'-',0,0,IER)
        CALL PHELPD('constructions checks',lh,'-',0,0,IER)
*item checkmodel has_unknown_shading
'The model was scanned for missing or corrupt shading files:'
*enditem
        CALL PHELPD('shading checks',lh,'-',0,0,IER)
*subroutine imgdisp
*subroutine CFGVER
*item CFGVER
'Images can be associated with a model for various'
'purposes: '
' * document conditions at the physical site'
' * document assumptions in the model'
' * indicate what performance is expected'
'   '
'Images are added to a model via the context->images'
'with a model. '
'Images of type GIF and XBM and JPG are supported.'
'This menu supports the creation of design variants.'
'The assumption is that a working model exists from'
'which other permutations can be derived.'
' '
'Variants may be created in the following ways.'
' '
'Project Variant: asks specific questions about the '
'changes the user wishes to make to the model. The'
'changes once implemented are saved to new model'
'files, i.e. the original model is preserved.'
' '
'For example, a variant corresponding to a different'
'location will require a different climate file,'
'modified ground temperatures and recalculated shading'
'factors.'
' '
'As another example, a variant with alternative'
'constructions may requires new geometry, construction'
'and optical property files.'
' '
'Several changes may be applied within a single'
'variant.'
' '
'A five character postfix is requested from the'
'user and this is appended to the names of new files.'
' '
' '
'*****SBEM Notional Model*****'
' ESP-r creates the SBEM notional model in compliance with'
' CIBSE TM33 ??? This creates a model with the postfix'
' _not [i.e. filname.cfg is copied to filename_not.cfg]'
' '
' Details of how the notonal building relates to the '
' original building and plant model is defined in relevant'
' SBEM documentation'
' '
*enditem
        CALL EASKS(APP,' ',
*item CFGVER
*enditem
        CALL EASKS(modeltitle,' ','Description for this variant?',
*item CFGVER
'Change options:'
' global tasks - work in progress - use with caution.'
' '
' site exposure & ground reflectivity - modifies these'
'   values within revised configuration file.'
' '
' geometry & attribution - copies zone files so that'
'   subsequent changes are saved to new files. If there'
'   are viewfactor, shading, obstruction, hc regime or'
'   or casual gain ctl files these are copied as'
'   well as revised configuration and connections files.'
' '
' shading - if selected will duplicate and then update'
'   existing shading files e.g. a change in site.'
' '
' weather data & latitude/longitude - finds dependencies'
'   associated with such changes (ground temps, shading,'
'   IPV) and updates the model accordingly.'
' '
' pressure distributions - either alters cp definitions'
'   (so-called cpcalc method) or copies and then edits'
'   pressure distributions database.'
' '
' glazed area - not yet operational'
' '
' zone constructions - copies geometry, construction '
'   and tmc files to hold subsequent changes by the'
'   user. Also creates variant connections and model'
'   configuration file. If number of surfaces will'
'   be altered select [geometry & attribution] first.'
' '
' materials database - makes copy of current database'
'   to hold subsequent changes by the user.'
' '
' cfd domain - makes copy of current domains to hold'
'   subsequent changes by the user.'
' '
' ground temperature profiles - select this if site'
'   details are being altered.'
' '
' convection regimes - make copy of current regimes'
'   to hold subsequent changes by the user'
' '
' active materials - not yet implemented'
' adaptive gridding - not yet implemented'
' '
' building integrated reneuables - not yet implemented'
' '
' integrated performance view - select this to update'
'   documentation and title (probably should be done'
'   in conjunction with any other variant task).'
' '
' flow network - copy current network to hold'
'   subsequent user changes.'
' '
' schedules - copy current zone operations to hold'
'   subseuent user changes.'
' '
*enditem
          CALL PHELPD('version tasks',58,'-',0,0,IER)
*item CFGVER
*enditem
        CALL PHELPD('version intro',36,'-',0,0,IER)
*subroutine VERMAN
*item VERMAN
'global tasks currently not supported'
*enditem
        CALL PHELPD('global tasks not supported',1,'-',0,0,IER)
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
'The site exposure defines the relative view factors'
'between a vertical surface and the sky, ground and'
'surrounding buildings.  These data are used in the'
'calculation of external longwave radiation exchanges.'
*enditem
        CALL EPICKS(IX,IVALSS,' ',' Site exposure:',
*item VERMAN
'0 <= Sky view factor <= .99'
*enditem
  290     CALL EASKR(skyview,' ',' Sky view factor?',
*item VERMAN
'0 <= Ground view factor <= .99'
*enditem
          CALL EASKR(groundview,' ',' Ground view factor?',
*item VERMAN
'0 <= Surroundings view factor <= .99'
*enditem
          CALL EASKR(buildingview,' ',' Surroundings view factor?',
*item VERMAN
'0 <= ground reflectance <= .99'
*enditem
        CALL EASKR(groundrefl,' ',' Ground reflectance?',
*item VERMAN
'There are no current instructions to evaluate detailed'
'shading and/or insolation patterns. '
' '
'You can nominate zones which you want to include an'
'insolation analysis (i.e. track direct solar radiation'
'within zones). '
' '
'You can nominate zones which you want to create solar'
'obstructions in so that shading and insolation can'
'be assessed.'
' '
'Selecting continue at this point you will be asked'
'if you want to make any other changes to the model'
'before the information is written out. '
*enditem
          CALL EASKABC(
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
'The model includes detailed evaluations of'
'shading and/or insolation patterns. '
' '
'You can nominate zones which you want to dereference'
'the insolation analysis (select from provided list)'
' '
'You can nominate zones which you want to dereference'
'obstruction(s). Note: does not remove the file only'
'the reference to the obstruction file. '
' '
'You can nominate zones which you want to dereference'
'both obstructions and shading files. Note: does not'
'remove the files only the reference.'
' '
'You can either modify existing obstruction files '
'or create obstructions for zones which do not'
'have any. In both cases place-holder shading'
'files will also be created.'
' '
'Note: modifications to obstructions files does not'
'have an impact on zone geometry files. '
' '
'Selecting continue at this point you will be asked'
'if you want to make any other changes to the model'
'before the information is written out. '
*enditem
          CALL EASKATOG(
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
            call askmultizone(inpic,ivals,
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
'Area weighted is a simplified techniques that is'
'appropriate where geometry has been approximated.'
'Otherwise choose ray traced, which is accurate'
'(but time consuming).'
*enditem
          CALL EASKABC('View factor options:',' ',
*item VERMAN
*enditem
          CALL EASKS(ipvtitl,'Enter project title for this variant?',
*item VERMAN
*enditem
          CALL EASKS(ipvvers,'Enter project version for this variant?',
*item VERMAN
*enditem
          CALL EASKS248(ipvsynop,'Synopsis',' ',72,
*item VERMAN
'Pressure coefficients are used to calculate pressure'
'distribution. These are defined at two levels.'
'Building parameters include overall dimensions, roof'
'detail, plan area etc. Invoking this facility will'
'allow these values to be changed.'
'The database option defines pressure coefficients that'
'are used where an air flow network exists.'
*enditem
        CALL EASKABC('Change to be made to:',
*item VERMAN
*enditem
          CALL ASKOK('  ','Edit database now?',OK,DOK,5)
*item VERMAN
'glazing area currently not supported'
*enditem
        CALL PHELPD('glazing area not supported',1,'-',0,0,IER)
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
*enditem
          CALL ASKOK('  ','Edit CFD data now?',OK,DOK,5)
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
'active materials currently not supported'
*enditem
        CALL PHELPD('active mat not supported',1,'-',0,0,IER)
*item VERMAN
'adaptive gridding currently not supported'
*enditem
        CALL PHELPD('adaptive gridding not supported',1,'-',0,0,IER)
*item VERMAN
'renewables currently not supported'
*enditem
        CALL PHELPD('renewables not supported',1,'-',0,0,IER)
*item VERMAN
*enditem
          CALL EASKS(ipvtitl,' Enter project title for this variant?',
*item VERMAN
*enditem
          CALL EASKS(ipvvers,' Enter project version for this variant?'
*item VERMAN
*enditem
          CALL EASKS248(ipvsynop,'Synopsis',' ',72,
*item VERMAN
*enditem
          CALL EASKS(ipvtitl,' Enter project title for this variant?',
*item VERMAN
*enditem
          CALL EASKS(ipvvers,' Enter project version for this variant?'
*item VERMAN
*enditem
          CALL EASKS248(ipvsynop,'Synopsis',' ',72,
*item VERMAN
'electrical network currently not supported'
*enditem
        CALL PHELPD('electrical net not supported',1,'-',0,0,IER)
*item VERMAN
'plants currently not supported'
*enditem
        CALL PHELPD('plant not supported',1,'-',0,0,IER)
*item VERMAN
*enditem
        call askmultizone(inpic,ivals,
*item VERMAN
'casual gains currently not supported'
*enditem
        CALL PHELPD('Not supported',1,'func not supported',0,0,IER)
*item VERMAN
'event profiles currently not supported'
*enditem
        CALL PHELPD('Not supported',1,'func not supported',0,0,IER)
*item VERMAN
'Moulds and mycotoxins not currently supported.'
*enditem
        CALL PHELPD('Not supported',1,'func not supported',0,0,IER)
*item VERMAN
'You may wish to make a number of changes to the'
'model variant. If so, select another option.'
' '
'Remember all the affected files will have the variant'
'extension characters in their file name.'
*enditem
      CALL ASKOK(' ','Make more changes?',OK,DOK,5)
*subroutine FNCNGR
*subroutine PRJDMDS
*item PRJDMDS
'Each model has a master calendar which indicates the'
'day type for each Julian day (initially based on the'
'year and a basic Weekday Saturday Sunday scheme. '
' '
'No calendar has been defined so if you want the basic '
'Weekday Saturday Sunday scheme it will be created. If '
'you want to setup a more specific calendar then you '
'should do that first. '
*enditem
        CALL EASKABC('Calendar options','(see help) :',
*item PRJDMDS
'A project demands file contains project level info'
'on fans, pumps, lifts, DHW demands which may '
'be applied to an integrated performance view. '
*enditem
      CALL EASKS(ltmp,' Project demands file name: ',
*item PRJDMDS
'Dispersed demands are casual gains which are not'
'associated with a specific zone in the model.'
'Examples are fans and lifts and their electrical'
'requirements are often taken into account in '
'reports on building energy use. '
' '
'This facility allows you to define schedules for'
'seven types of dispersed gains either as W/m2 '
'or in absolute W. '
' '
'If the calendar of the model (see Model context)'
'includes the standard Weekday Saturday Sunday day '
'types then you may work at that resolution. If you'
'have also defined holidays then dispersed gains can '
'also be assigned (UNDER TESTING) '
' '
' '
'The data requirements are summarized below :- '
' 1) Description '
' 2) For each calendar day type e.g. Weekday, Saturday,'
'    Sunday, holiday (etc.) demands data:'
'       Start and finish hours for each period'
'       Casual gain type:'
'         type 1: usually occupant demands'
'         type 2: usually lighting demands'
'         type 3: usually small power demands'
'         type 4: usually fan demands'
'         type 5: usually pump demands'
'         type 6: usually lift demands'
'         type 7: usually DHW demands'
'       Sensible and Latent magnitudes'
'       Radiant and Convective portions'
'The dispersed demand periods do not cover the entire'
'day or might have gaps or overlaps. You should correct'
'this prior to leaving this facility. If you say no then'
'the dispersed demands might be mis-interpreted. '
*enditem
          CALL askok(
*item PRJDMDS
'Recent changes might be lost if you do not save the'
'data. '
*enditem
          CALL askok(' Before exiting do you wish to save any',
*item PRJDMDS
'A project demands file contains project level info'
'on fans, pumps, lifts, DHW demands which may '
'be applied to an integrated performance view. '
*enditem
          CALL EASKS(LTMP,' Project demands file name: ',
*item PRJDMDS
'Project demands schedules have notes'
'(<248 char) which will be included in reports.'
*enditem
        CALL EASKS248(tcname,' Dispersed demands notes: ',' ',
*item PRJDMDS
'Optional base area associated with each demand type. '
'This will be used to support IPV creation for period '
'data which is per m^2. '
*enditem
        CALL EASKS(hold,
*item PRJDMDS
'A project demands file contains building level info'
'on fans, pumps, lifts, DHW casual gains which may '
'be applied to an integrated performance view. '
*enditem
        CALL EASKS(LTMP,' Dispersed demands file name: ',
*item PRJDMDS
'Older file format does not include a date stamp.'
'If you say ok then a newer format will be used. '
*enditem
          CALL askok(
*item PRJDMDS
'A problem was encountered while trying to save the'
'demands to file. Check that you have permission to'
'update the file and that you have sufficient disk '
'space. '
*enditem
            CALL ASKOK(' ',
*item PRJDMDS
*enditem
        CALL PHELPD('demands help 1',35,'-',0,0,IER)
*subroutine EDBCAS
*item EDBCAS
'Casual gains are defined via one or more periods, the'
'magnitude at a given time being the summation of the '
'gains in all periods which include that time.  In '
'this way complex patterns may be described. '
' '
'Please note that neither the order in which periods'
'are described nor their position in the display is'
'important.  You may use an [additive] or [sequential]'
'approach or a combination as you choose. '
' '
'You may insert or delete a period at any point in '
'the list by selecting it-s key  (a,b,c...).'
' '
'See section 3.4 of the users manual for more info. '
*enditem
        CALL PHELPD('gains menu',14,'-',0,0,IER)
*item EDBCAS
'You can apply a scaling factor to all entries of a '
'particular casual gain type (useful for parametric '
'studies on profiles which have been imported).'
*enditem
        CALL EASKATOG('Apply scaling factor to which casual gain type?',
*item EDBCAS
*enditem
        CALL EASKR(VAL,' ',' Factor to be applied (0.1 to 5.0) ',
*item EDBCAS
*enditem
        CALL EASKAB(' ','Modify list:','delete period','insert period',
*item EDBCAS
'Period during which demand applies. '
*enditem
        CALL EASKS(hold,outs,' : ',40,' 0 24 ','st-fn hr',IER,1)
*item EDBCAS
'The type of demand can be one of those listed in the '
'selections. '
*enditem
        CALL EASKATOG('Which casual gain type?',
*item EDBCAS
*enditem
        call easkab('Are values',' ','absolute','per m^2',IW,8)
*item EDBCAS
'Sensible and latent demands are specified in '
'Watts. '
'Also supply the radiant and convective fraction for'
'the sensible load (should sum to ~1.00) '
*enditem
        CALL EASKS(HOLD,
*subroutine SBCASL
*item SBCASL
'Any one of the profiles may be selected.'
*enditem
      CALL EPICKS(IX,IPRVAL,' ',' Profiles in database: ',
*item SBCASL
'Project level demands can be be designated to be '
'of one of four user-defined types so that for example '
'pump demands can be separately tracked from that of '
'other equipment.  Values from 1 to 4 are accepted'
'and can have any meaning that the user chooses. '
*enditem
      CALL EASKATOG(' ','Type of casual gain: ',ll1,ll2,ll3,ll4,ll5,
*item SBCASL
*enditem
      call easkab('Are values',' ','absolute','per m^2',IW,5)
*item SBCASL
'In order to expand the profile into energy values the'
'sensible and latent load in Watts equivalent to 100% is'
' required. '
' '
'Also supply the radiant and convective fraction for the'
'sensible load (these normally should sum to 1.00) '
*enditem
      CALL EASKS(HOLD,
*subroutine PRJFMK
*item PRJFMK operations_need_to_ask
'The zone operations file was not found or has not'
'yet been created. The file contains schedules of air'
'flow and casual gains. Air flows may have thermostatic'
'or wind speed control. If electrical details are'
'included then casual gains and electrical loads are'
'combined into a [zone load].'
' '
'The browse option presents a list of files in the'
'project [zones] folder in case you want to share.'
'the same definition as used by another zone.'
*enditem
        CALL EASKSCMD(LTMP,' ','Zone operations file options:',
        CALL EASKS2CMD(LTMP,' ','Zone operations file options:',
*item PRJFMK 'operations_need_confirm
'Operations details have already been defined for this'
'zone so if you want to use and/or modify the current'
'definition accept the presented file.'
' '
'A zone operations file contains schedules of air flow'
'and casual gains. Air flows may have thermostatic or'
'wind speed control. If electrical details are included'
'then casual gains and electrical loads are combined'
'into a [zone load].'
' '
'The browse option presents a list of files in the'
'project [zones] folder in case you want to associate'
'another operations file with the current zone In that'
'case you the file will be shared between zones so that'
'any change to its contents will affect more than one'
*enditem
          CALL EASKSCMD(LTMP,' ','Confirm zone operations file:',
          CALL EASKS2CMD(LTMP,' ','Confirm zone operations file:',
          CALL EASKS(LTMP,' ','Zone operations file name?',
          CALL EASKS(LTMP,' ','Zone operations file name?',
*item PRJFMK operations_creation
'Options: '
' define from scratch - you are asked to define all casual'
'   gain periods for each day type as well as schedules of'
'   infiltration and ventilation.'
' '
' import air flow schedules - you select a zone with an air'
'   flow schedule pattern and it is copied into this zone,'
'   optionally with adjustments if the zone volumes are'
'   different. You can then define the casual gains.'
' '
' import casual gains - you select a zone with casual gain'
'   patterns and they are copied into this zone, optionally'
'   with adjustments if the zone base areas differ.'
' '
' import air flows and casual gains - both of the above and'
'   you will be given the option to import air flow schecules'
'   and casual gains from different zones (You may wish to'
'   take a note of which zones you used and include this in'
'   the documentation of the zone operations file.)'
' '
' import < pattern - has the same functionality as above except'
'   that the list of operations files are taken from a folder'
'   within the standard ESP-r distribution located on your'
'   computer. Files placed in this folder serve as a resource for'
'   often-used patterns of casual gains and scheduled air flows.'
' '
' nothing happens in the zone - does just this. It fills the'
'   file with zero occupants, lights and small power for the'
'   whole of each day as well as no infiltration or ventilation'
'   for all day types.'
' '
' cellular office creates a typical pattern for a single occupant'
' cellular office with a bit of diversity for occupants lights and'
' small power. Saturday has morning use. Sunday & holiday minimal.'
' '
' open plan office creates a typical pattern with a bit of'
' diversity for occupants lights & small power. 9 m2/person'
' lighting ~7W/m2 & small power 11.7W/m2. Saturday morning use.'
' Sunday & holiday minimal.'
' '
'After initiating one of the above actions you can edit the data'
'as required. The file also contains schedules of air flow'
'schedules which may have thermostatic or wind speed control.'
*enditem
          CALL EASKS(LTMP,' ','Zone operations file name?',
          call askzone(isource,izdef,
          CALL EASKABC(' ','Options:','all flow schedules & ctl',
          CALL EASKABC(' ','Infiltration import:','preserve ac/h',
          CALL EASKABC(' ','Ventilation import:','preserve ac/h',
*item PRJFMK operations_synopsys
'New operations for this zone. Please check your notes'
'and provide initial casual gain period start times'
'for each day type (Weekday, Saturday, Sunday etc.) and'
'for each casual gain type (occupants, lighting and'
'small power). Do not include periods to be imported'
'from events profiles.'
' '
'Example of a schedule including 6 periods:'
' '
'       |       ________               '
' Watts |       |      |___            '
'       |    ___|         |____        '
'       |   |   schedule       |       '
'       |___|____..____________|_______'
'       0   7  10..    13  14  18    24'
'                   Time'
' '
'The default assumption is that there is one period'
'(from 0h00 to 24h00) with zero sensible and latent'
'gains for each casual gain type on each day type.'
'This ensures that nothing is happening in the zone'
'until you provide relevant information (e.g. insert'
'at least one period and define a casual gain).'
*enditem
          CALL PHELPD('operation setup',23,'-',0,0,IER)
          call askzone(isource,izdef,'Casual gains from which zone?',
          CALL EASKABC(' ','Casual gain import:','preserve Watts',
*item PRJFMK check_automatic
'An automated process has been used to manage the imported'
'schedules. It is recommended that you confirm that the'
'resulting file is correct. '
' '
'One approach is to generate a new QA report and check this'
'against the previous model and then run a short assessment'
'to confirm that performance is as expected.'
*enditem
          CALL PHELPD('operation import confirm',7,'-',0,0,IER)
*item PRJFMK operations_summary
'A summary of the data held within a zone operations file'
'follows.'
' '
' 1) Operations description - up to 248 characters summarising'
'    what is happening in the zone for casual gains and another'
'    describing scheduled air flows (infiltration and ventilation).'
'  '
' 2) Weekday, Saturday, Sunday (& other day types if defined)'
'    air flow data:  start and finish hours and for each period '
'    infiltration and ventilation rates where the'
'    (ACH) coupling index: '
'         > 0 is coupled zone number'
'         = 0 source at specified temperature'
'  '
' 3) Air flow thermostatic control definition:'
'       sensed zone number '
'       upper and lower limits'
'       upper and lower air flow rates'
' '
'The relationship between control and schedules is as follows:'
' '
'      |       ________               '
' ac/h |       |      |___            '
'      |    ___|         |____        '
'      |   |   scheduled rate |       '
'      |___|____:_____________|_______'
'               : <- time ->          '
'      |        :                     '
' ac/h |flow |  V     | flow | flow | '
'      |__x__|________|___y__|__z___| '
'       low   default   high  extreme '
'         <-  temperature ranges  ->  '
' '
' 4) Weekday, Saturday and Sunday (& other day types if defined)'
'    casual gains data: start and finish hours and for each '
'    period casual gain type:'
'         1: usually occupants'
'         2: usually lighting'
'         3: usually equipment'
'       sensible and latent load magnitudes'
'       radiant and convective portions'
' '
'Where electrical data are associated with a particular zone'
'load (to enable electrical simulation), the required data'
'items are: power factor,load type (inductive or capacative),'
'real power consumption, operational voltage and the generator'
'phase to which the load is connected.'
' '
'When exiting you are asked about sorting casual gains because'
'periods might have been altered and require re-sorting. '
*enditem
          CALL ASKOK(
          CALL ASKOK('Before exiting do you wish to',
          CALL EASKS248(tcname,' ','Zone operations notes:',
          CALL EASKS248(tcname,' ','Zone scheduled air notes:',
          CALL EASKS248(tcname,' ','Zone operations notes:',
          CALL EASKS(LTMP,' ','Zone operations file name?',
*item PRJFMK operations_save_error
'You were presented with this message because a problem'
'was detected while trying to update the zone operations'
'file. Check that you have sufficient disk space and/'
'or permission to update the model'
*enditem
            CALL ASKOK('Problem encountered saving data!',
*subroutine EDAFCTL
*item EDAFCTL zone_flow_menu_summary
'This interface supports range based control of scheduled'
'air infiltration and ventilation based on temperature and'
'wind velocity.'
' '
'If you do not select control then the nominal infiltration'
'and ventilation rates in the schedules will be used.'
'  '
'Thermostatic control of air flow can be based on one of the'
'following parameters: '
' '
'  air temperature within the current zone;'
'  air temperature within another modelled zone;'
'  external air temperature;'
'  '
'For temperature control the limit is in degC.'
'For wind speed control the limit is in m/s.'
' '
'Infiltration is defined in terms of air changes per hour and'
'ventilation is in air changes (based on the volume of the'
'receiving zone) or a constant temperature source.'
' '
'The scope of flow control can be restricted to infiltration'
'(outside), to ventilation (from another zon at a specific'
'temperature) or to both.'
' '
'Infiltration control is range based similar to that used in' 
'mass flow network control. '
' '
'Lower limit: point below which an alternative flow rate takes'
'  effect (e.g. closing windows when the lower limit is reached).'
' '
'Middle limit: point above which the 1st stage of an alternative'
'  flow regime takes effect).'
' '
'High limit: point above which a 2nd stage flow regime takes'
'  effect. (Set high, e.g. 100degC, to prevent use.)'
' '
'The relationship between control and schedules is as follows:'
' '
'      |       ________               '
' ac/h |       |      |___            '
'      |    ___|         |____        '
'      |   |   scheduled rate |       '
'      |___|____:_____________|_______'
'               : <- time ->          '
'      |        :                     '
' ac/h |flow |  V     | flow | flow | '
'      |__x__|________|___y__|__z___| '
'       low   default   high  extreme '
'         <-  temperature ranges  ->  '
'         <-  wind-speed ranges   ->  '
'  '
'Note that thermostatic control applies to day types within'
'a simulation.'
*enditem
      CALL ASKOK(' ','Is air flow thermostatically controlled?',
      CALL EPICKS(IX,IVAL,' ','Air Flow Control Options',
   12 CALL EPICKS(IX,IVALS,' ','Air flow control scope:',
      CALL EASKS(HOLD,' ',
      CALL EASKR(VAL,' ','Lower range infiltration rate?',
      CALL EASKABC(' ','Ventilation options:',
      CALL EASKR(VAL,outs,outs2,0.0,'F',200.0,'W',1.0,'lwr vnt',
      CALL EASKR(VAL,' ','Lower range ventilation rate?',
      CALL EASKR(V,' ',
      CALL EASKR(V,' ','1st stage infiltration rate?',
      CALL EASKABC(' ','First stage ventilation options:',
      CALL EASKR(VAL,outs,outs2,0.0,'F',200.0,'W',1.0,'mid vnt'
      CALL EASKR(VAL,' ','Mid-range ventilation rate?',
      CALL EASKR(V,' ','Mid range ventilation source temperature?',
      CALL EASKR(V,' ','High stage infiltration rate?',
      CALL EASKABC(' ','High stage ventilation options:',
      CALL EASKR(VAL,outs,outs2,0.0,'F',200.0,'W',1.0,'high vent',
      CALL EASKR(VAL,' ','High-range ventilation rate?',
      CALL EASKR(V,' ',
*subroutine EDAIR2
*item EDAIR2 air_flow_period_setup
'Air flows are defined via one or more sequential periods, the'
'magnitude at a given time being the flow specified a period that'
'includes that time.'
' '
'In cases where ventilation will occur with more than one modelled'
'zone then a fluid flow network or temporal definition file should'
'be employed.'
' '
'Note that large changes in flow rates between periods can result'
'in unacceptable interpolation.'
' '
'The add/delete/copy/import option are as follows.'
' add - adds a period to one or all day types. BE SURE to read the'
'   extended help messages in this dialog to understand how to use'
'   the add function to insert a period into a profile.'
' '
' delete - deletes one or more periods (within a list of all periods'
'   in all days).'
' '
' copy - copies Weekdays to Saturdays or Weekdays -> Sundays or'
'   Saturdays -> Sundays'
' '
' import - copies infiltration, ventilation and control (or a'
'   subset of these data) from another zone.'
' '
'When importing you can specify whether to:'
' a) preserve the ac/h being imported, e.g. 1.5 ac/h in'
'    the source zone is 1.5 ac/h in the destination zone;'
' b) preserve the volume of air implied by the ac/h in'
'    the source zone, e.g. 1.5 ac/h in a 50m^3 source'
'    zone becomes 1.07 ac/h in a 70m^3 destination zone.'
*enditem
        CALL PHELPD('flows menu',33,'-',0,0,IER)
*item EDAIR2 air_flow_period_copy
'The options: '
'The add/delete/copy/import option are as follows.'
' add - adds a period to one or all day types. IF there is'
'   already a defined period which overlaps this period'
'   then the volumes of air flow will be summed. '
'   For example: if there is a period from 8h00-24h00 with'
'   1 ach infiltration and you want to add a period 20h00-'
'   24h00 with 0.5 the time from  20h00-24h00 will become 1.5 ach.'
' '
'   If you want to adjust the profile so the inserted period'
'   has a different value then initailly give 0.0 for the'
'   flows. After the periods have been revised then edit the'
'   newly created period.'
'  '
'   The alternative approach is to edit the start and'
'   end time of the existing period so that a gap is'
'   created and then use the add facility to fill in'
'   the gap.'
' '
' delete - deletes one or more periods (within a list'
'   of all periods in all days).'
' '
' copy - copies Weekdays to Saturdays or Weekdays -> '
'   Sundays or Saturdays -> Sundays'
' '
' import - copies infiltration, ventilation and control'
'   (or a subset of these data) from another zone.'
' '
'When importing you can specify whether to:'
' a) preserve the ac/h being imported, e.g. 1.5 ac/h in'
'    the source zone is 1.5 ac/h in the destination zone;'
' b) preserve the volume of air implied by the ac/h in'
'    the source zone, e.g. 1.5 ac/h in a 50m^3 source'
'    zone becomes 1.07 ac/h in a 70m^3 destination zone.'
*enditem
        CALL EASKATOG(' ','Options (see help):',
        CALL EASKAB(' ','Add period to ','one day type',
        CALL EPICKS(IX,KSTR,' ','choose daytype to add period in'
        CALL EASKABC(' ','Import:','all flow schedules & ctl',
        CALL EASKABC(' ','Infiltration import:','preserve ac/h',
        CALL EASKABC(' ','Ventilation import:','preserve ac/h',
*subroutine EDAIR3
*item EDAIR3 air_flow_period_setup
'Air flows are defined via one or more sequential'
'periods, the magnitude at a given time being the'
'flow specified a period that includes that time.'
' '
'In cases where ventilation will occur with more'
'than one modelled zone then a fluid flow network'
'or temporal definition file should be employed.'
' '
'Note that large changes in flow rates between'
'periods can result in unacceptable interpolation'
' '
'The add/delete/copy/import option are as follows.'
' add - adds a period to one or all day types. BE SURE'
'   to read the extended help messages in this dialog'
'   to understand how to use the add function to insert'
'   a period into a profile.'
' '
' delete - deletes one or more periods (within a list'
'   of all periods in all days).'
' '
' copy - copies periods for different days e.g. Weekdays ->'
'   Sundays or Saturdays -> Sundays'
' '
' import - copies infiltration, ventilation and control'
'   (or a subset of these data) from another zone.'
' '
'When importing you can specify whether to:'
' a) preserve the ac/h being imported, e.g. 1.5 ac/h in'
'    the source zone is 1.5 ac/h in the destination zone;'
' b) preserve the volume of air implied by the ac/h in'
'    the source zone, e.g. 1.5 ac/h in a 50m^3 source'
'    zone becomes 1.07 ac/h in a 70m^3 destination zone.'
*enditem
        CALL PHELPD('flows menu',33,'-',0,0,IER)
*item EDAIR3 air_flow_period_copy
'The options: '
'The add/delete/copy/import option are as follows.'
' add - adds a period to one or all day types. IF'
'   there is already a defined period which overlaps'
'   this period then the volumes of air flow will be '
'   summed.  For example: if there is a period from'
'   8h00-24h00 with 1ach infiltration and you want to '
'   add a period 20h00-24h00 with 0.5 the time from '
'   20h00-24h00 will become 1.5 ach.'
' '
'   If you want to adjust the profile so the inserted'
'   period has a different value then initailly'
'   give 0.0 for the flows. After the periods have'
'   been revised then edit the newly created period.'
'  '
'   The alternative approach is to edit the start and'
'   end time of the existing period so that a gap is'
'   created and then use the add facility to fill in'
'   the gap.'
' '
' delete - deletes one or more periods (within a list'
'   of all periods in all days).'
' '
' copy - copies periods for different days e.g. Weekdays'
'   -> Sundays or Saturdays -> Sundays'
' '
' import - copies infiltration, ventilation and control'
'   (or a subset of these data) from another zone.'
' '
'When importing you can specify whether to:'
' a) preserve the ac/h being imported, e.g. 1.5 ac/h in'
'    the source zone is 1.5 ac/h in the destination zone;'
' b) preserve the volume of air implied by the ac/h in'
'    the source zone, e.g. 1.5 ac/h in a 50m^3 source'
'    zone becomes 1.07 ac/h in a 70m^3 destination zone.'
*enditem
        CALL EASKATOG(' ','Options (see help):',
        CALL EASKAB(' ','Add period to ','one day type',
        CALL EPICKS(IX,KSTR,' ','choose daytype to add period in'
        CALL EASKABC(' ','Import:','all flow schedules & ctl',
        CALL EASKABC(' ','Infiltration import:','preserve ac/h',
        CALL EASKABC(' ','Ventilation import:','preserve ac/h',
*subroutine EDAIRFL
*item EDAIRFL operations_air_details
'There are several inputs describing air flows at a specific'
'period on the current day type:'
' '
' Period during which air flow applies defined by a start hour'
' and finish hour.
'  '
' Infiltration air flow rates are specified in air change per hour'
' or m^3/s.'
' '
' Ventilation air flow rates are specified in air changes (relative'
' to the volume of the recieving zone) or in ^3/s. You are asked'
' which zone is the source.'
'  '
' For ventilation you may also specify a fixed temperature source'
' of air (degC) at a specific flow rate or the outside ambient'
' temperature.'
*enditem
        CALL EASKS(HOLD,OUTS,' ',16,' 0 24 ','air st-fn hr',IER,1)
        CALL EASKAB(' ','Air flow specified in:','AC/h',
        call EASKR(XACH,' ','Infiltration rate?',
        call EASKR(XACH,' ','Ventilation rate?',
        call EASKR(XACH,' ','Infiltration rate?',
        call EASKR(XACH,' ','Ventilation rate?',
        CALL EASKABC(' ','Ventilation air temperature:',
        call askzone(IV,IPTX,'Ventilation from which zone?',
        call EASKR(XTA,' ','Supply temperature?',
*subroutine ADDAFP
*subroutine CDAIRFL
*item CDAIRFL operations_copy_flow
'There are a number of options for managing the air flow schedule:'
'  '
' One or more of the periods may be deleted.'
'  '
' All the flows associated with a specified day type'
' can be copied to another day type.'
'  '
*enditem
        call EPICKS(ilistlen,IVERT,' ','Air flow period(s) to delete:',
        CALL EPICKS(IX,KSTR,' ','choose daytype to copy periods from',
        CALL EPICKS(IX,KSTR,' ','choose daytype to copy periods to',
*subroutine COPYAIRFL
*item COPYAIRFL copy_air_via_import
' Air flows from a [pattern file] can be copied into the current'
' zones air flow schedule. You must specify the assumed volume of'
' the pattern file source zone so that it can be scaled to the'
' destination zone volume.'
*enditem
          CALL EASKS(ltmp,' New zone operations file: (confirm) ',
          CALL EASKR(VAL,' ','Assumed volume of source?',
*subroutine CHKAIRFL
*subroutine PLTAIR
*subroutine EDCAS
*item EDCAS operations_warn_overlap
'You were presented with this message because the file is an older'
'format which might have overlaps in the casual gain periods. The'
'current definition of casual gain periods does not support
'overlapping periods and stores the periods by time and day type.'
' '
'It is recommended that you say YES and then check that the'
'updated periods are correct.'
*enditem
          call askok(' ','Sort and remove overlaps from casual gains?',
*item EDCAS operations_casual_menu
'Casual gains are defined via a profile (one or more periods) for each'
'day type in the model calendar. The magnitude at a given time being'
'found via checking the period data. To define a complex profile'
'many periods may be required. Please plan carefully so that you can'
'input the data correctly (correcting errors takes longer than'
'planning).
' '
'The total gain is displayed in the graphic feedback window.'
'  '
'If electrical definitions are included the menu will show the'
'power consumption of the load and the power factor. The graphs'
'will continue to show the casual gains to the zone.'
'  '
'If you choose to incorporate electrical data into the operations'
'file you will be asked to specify additional data items for the'
'casual gain so that both thermal and electical information is
'included.
'  '
'Import casul gains - you select a zone with casual gains patterns'
'and they are copied into this zone, optionally with adjustments'
'if the zone base areas differ.'
'  '
'Import pattern - imports casual gain patterns for all gains and'
'day types from file outwith the model (overwrites current data)'
' '
'When importing you can specify whether to:'
' a) preserve the absolute W being imported e.g. 123W'
'    in the source zone is also 123W in destination'
' b) preserves W/m^2 implied by the source zone and'
'    destination zone base areas e.g. 123W in source'
'    zone of 2.3m^2 becomes 267W in a 5.0m^2 base area'
'    zone.'
'  '
'An automated process has been used to manage the imported'
'schedules. It usually does it as intended and, as with all'
'automated processes it is recommended that you confirm '
'that the resulting file is correct. '
' '
'One approach is to generate a new QA report and check this'
'against the previous model and then run a short assessment'
'to confirm that the predictions are as expected. '
' '
'You may also manage the casual gain periods by removing a period'
'or by adding a period to one or all day types.'
' '
'You may also copy periods from one day type to another. Currently'
'it adds the copied periods to the destination in addition to'
'existing periods already present in the destination day type '
'  '
'You can apply a scaling factor to all entries of a particular'
'casual gain type (useful for parametric studies on profiles'
'which have been imported). If you are not scaling gains choose'
'all gains and then choose a factor of 1.0'
*enditem
        CALL EPICKS(IX,KSTR,' ','Import a profile for which day type?',
        call easkabc('Do you wish to include definition of electrical',
        call easkab(' Do you wish to remove definition of  ',
        CALL EASKATOG('Apply scaling factor to which casual gain type?',
        call EASKABC('Import profile for one or all day types',
        CALL EPICKS(IX,KSTR,' ',
        CALL EASKR(VAL,outs,'(typically between 0.1 and 5.0)',
        CALL EASKATOG('Casual gain period options:','(see help)',
        CALL EASKABCD('New casual gain of which type?',' ',
        call EASKABC('Add period for one or all day types',
        CALL EPICKS(IX,KSTR,' ',outs,12,NBDAYTYPE,
        call askzone(isource,izdef,'Casual gains from which zone?',
        CALL EASKABC('Casual import:',' ','preserve absolute W',
        CALL PHELPD('operation import confirm',8,'-',0,0,IER)
*item EDCAS operations_casual_labels
'Casual gains have initial type labels which may not'
'be appropriate for your project. You can adapt the '
'labels if it clarifies your model. '
'  '
'Note the option for a so-called dynamic occupant. This requires'
'additional attributes to be entered.
'  '
'If you want to use the standard labels select them from the list.'
*enditem
        call askok(' ','Change type labels?',OK,dok,3)
        call easks(TYPSTR,' ',outs,8,
*subroutine SCASL
*item SCASL operations_event_import
'The periods defined in an event profile database can be used'
'to form operational schedules. A list of the event profiles'
'database entries is presented and any one of the profiles'
'may be selected.'
'  '
'After selecting the profile you are asked which of the three'
'user-defined casual gain types (occupant light small-power) to'
'associate with the profile.  You can assign what-ever meaning'
'you need to the three types - you could use two of them to'
'represent two different kinds of lighting. If you want you can'
'edit the label of a casual gain type to reflect your specific'
'use.'
'  '
'Event profiles include values between zero and one for two'
'separate data types. For use with casual gains you are requested'
'to supply the Watts equivalent to 100%.  You are also asked to'
'specify the radiant and convective fracion for the sensible'
'(they should sum to 1.00). You are warned if they sum to less'
'than 0.98 or more than 1.00.'
' '
'The radiant and convective split of lighting fixtures is'
'listed below(CIBSE Consice Handbook Table A6.5) : '
'  fluorescent radiant = 30  convective = 70'
'  tungsten    radiant = 85  convective = 15'
'  HP mercury sodium radiant = 50 convective = 50'
'  low pressure sodium radiant = 43 convective = 57'
' '
'The position of lamps determines the distribution of '
'heat into room or ceiling void (CIBSE Table A6.4) '
'  recessed open fixture  upwards = 38 downwards = 62'
'  recessed with louvre   upwards = 45 downwards = 55'
'  recessed with diffuser upwards = 53 downwards = 47'
'  surface mount open fixt upwards = 12 downwards = 88'
'  surface mount enclosed prismatic up= 22 down = 78'
'  suspended near ceiling enclosed prismatic upwards = 6'
'     downwards = 94'
'  suspended or wall mounted or desk lamp upwards = 0'
' '
'The radiant and convective split for office equipement'
'is typically: (CIBSE Table A6.9) '
' desktop computer radiant = 14 convective = 86'
' monitor (type not defined) radiant = 35 conv = 65'
' laser printer  radiant 33 convective 67'
' '
'CIBSE Guide A Section 6.3 states that occupant radiant'
'fraction can be between 20 & 60 % depending on clothing'
'and activity.'
*enditem
      CALL EPICKS(IX,IPRVAL,' ','Profiles in events db: ',
      CALL EASKABC(' ','Type of casual gain: ',ll1,ll2,ll3,ICGTX,6)
      CALL EASKS(HOLD,
      call askok(' The Sum of radiant and convective fractions is',
*item SCASL operations_electrical
'Electrical data (e.g. power factor, leading/lagging'
'loads, real power, phase) might be used by electrical'
'engineers and in models where other power components'
'are being defined. If not just say no. '
'  '
' Power factor values between 0.-1. Power factor is the ratio of'
' real to apparentvpower drawn by the load.'
'  '
'A lagging load is one with an inductive component i.e. flourescent'
'lighting, a leading load is one with a capacative element. Unity'
'loads are purely resistive i.e. incandescent lighting.'
' '
'A cancel leaves the model without electrical data for this item.'
'  '
'To expand the profile into energy values it is necessary to supply'
'the power consumption equivalent to 100%.'
'  '
'You will also be asked about:'
'  Voltage for the electrical device represented'
'  '
'  Phase of the three phase supply is the load connected to ? (1-3)'
'  or 4 - all three i.e. for a large induction motor.'
' '
'A cancel leaves the model without electrical data for this item.'

*enditem
        CALL ASKOK('Include electrical data with this profile?',
        CALL EASKR(PPF,' ','Power factor? [0-1] ? ',
        CALL EASKI(ippft,'Lagging -1, Leading 1 or Unity 0?',
        CALL EASKR(PE,' ','Power consumption? (W) ? ',
        CALL EASKR(PBVOLT,' ','Operational voltage ? (W) ? ',
        CALL EASKI(IPPHAST,'Supply phase 1-3 or 4 ?','(see help)',
*subroutine EDCASGN
*item EDCASGN
'The scheduling of casual gains involves defining a number of'
'periods in each calendar day type.'
'  '
'A gain can be specified as:'
' Watts - explicitly set the gain.'
'  '
' Watts per square meter - will use the floor area of the '
'  zone to calculate the total gain.'
'  '
' Watts per object - gain/object and number of objects are'
'  required (an object could be a person or computer).'
'  '
' Square meters per object - will use the floor area of the'
'  zone to calculate the total gain. For the particular'
'  case of an occupant there is an assumption that each'
' person is 95W sensible and 45W latent.'
' '
'ESP-r asks for fixed sensible and latent values. The'
'values for occupants are really a function of the current'
'zone temperature (CIBSE Concise Handbook Table 6.1)'
'If possible pick a value for the likely temperature rnage.'
'For an adult and average mix '
'                   Tot 15C sen lat 20C sen lat 24C sen lat'
'Seated inactive    115     100  15     90  25      75  40'
'       avg mix     100      87  13     78  22      65  35'
'Seated light work  140     110  30    100  40      80  60'
'       avg mix     126      99  27     90  36      72  54'
'Seated office work 140     110  30    100  40      80  60'
'       avg mix     130     102  28     93  37      74  56'
'Standing light work 160    120  40    110  50      85  75'
'       avg mix      141    106  35     97  44      75  66'
'Light factory work 235     150  85    130 105     100 135'
'       avg mix     209     133  76    116  93      89 121'
'Medium factory work 265    160 105    140 125     105 160'
'       avg mix      249    150  99    132 117      99 150'
'Heavy factory work 440     220 220    190 250     135 305'
'       avg mix     440     220 220    190 250     135 305'
' '
'CIBSE Guide A Section 6.3 states that occupant radiant'
'fraction can be between 20 & 60 % depending on clothing'
'and activity.'
*enditem
      CALL EASKS(hold,outs,' ',24,' 0 24 ','cas st-fn hr',IER,1)
      CALL EASKABCD('Gain to be specified as: (see help)',' ','Watts',
      call EASKS(HOLD,'Sensible and latent gain (W):',
        call EASKS(HOLD,'Sensible and latent gain (W/m^2):',
        CALL EASKI(NOBJ,' ','Number of objects (e.g. people)?',
        call EASKS(HOLD,'Object sensible and latent gain (W):',
        call EASKR(XFLA,'Floor area per object (e.g. people)?','  ',
            call EASKS(HOLD,'Sensible and latent gain (W/object):',
*item EDCASGN operations_lighting_data
'Supply the radiant and convective fraction for the sensible load'
'(should be ~1.00). Setting the total radiant and convective split'
'of a casual gain to less than 0.9 can lead to confusion. For example:'
'(600W with 0.4 rad and 0.4 conv is 480W total) and should only be'
'done by experts.'
' '
'The radiant and convective split of lighting fixtures is listed'
'below(CIBSE Consice Handbook Table A6.5) : '
'  fluorescent radiant = 30  convective = 70'
'  tungsten    radiant = 85  convective = 15'
'  HP mercury sodium radiant = 50 convective = 50'
'  low pressure sodium radiant = 43 convective = 57'
' '
'The position of lamps determines the distribution of heat into'
'a room or ceiling void (CIBSE Table A6.4) '
'  recessed open fixture  upwards = 38 downwards = 62'
'  recessed with louvre   upwards = 45 downwards = 55'
'  recessed with diffuser upwards = 53 downwards = 47'
'  surface mount open fixt upwards = 12 downwards = 88'
'  surface mount enclosed prismatic up= 22 down = 78'
'  suspended near ceiling enclosed prismatic upwards = 6'
'     downwards = 94'
'  suspended or wall mounted or desk lamp upwards = 0'
' '
'The radiant and convective split for office equipement is typically'
'(CIBSE Table A6.9): '
' desktop computer radiant = 14 convective = 86'
' monitor (type not defined) radiant = 35 conv = 65'
' laser printer  radiant 33 convective 67'
'   '
'CIBSE Guide A Section 6.3 states that occupant radiant'
'fraction can be between 20 & 60 % depending on clothing'
'and activity.'
'  '
'Electrical data (e.g. power factor, leading/lagging loads, real power,'
'phase) might be used by electrical engineers and in models where other'
'power components are being defined. If not just say no. '
'  '
' Power factor will vary between 0 - 1.0'
'  '
'The load will either be capacitive, leading current, or reactive with'
'a lagging current, most loads take a lagging current.'
' '
'You are also asked about the following: '
'  What is the real power consumption in watts? This might be the same'
'  as the sensible load for some devices (please check). '
'  '
'  Voltage the load operate at i.e. 220V'
'  '
'  Phase of the 3-phase supply is the load connected, 1-3 or'
'  4-all three.'
' '
'A cancel leaves the electrical data unchanged.'
*enditem
      call EASKS(HOLD,'Radiant & convective fraction: (see help)',
      CALL ASKOK(outs,
      call ASKOK(' ','Does this load need electrical data?',OK,DOK,4)
      call EASKR(pft,' ','Load power factor?',
      call EASKAB('Is the load current leading or lagging?',
      call EASKAB('Is the load current leading or lagging?',
      call EASKAB('Is the load current leading or lagging?',
      call EASKR(pwrt,'Real power consumption ?','  ',
      call EASKR(bvoltt,' ','Operational voltage?',
      call EASKI(IPHAST,'Which phase is load connected to?',
*subroutine CDCASGN
*item CDCASGN casual_copy_delete
'You can manage casual gains by removing one or more casual gain'
'periods. A list of the current casual gains is presented and'
'you must choose the period to delete.'
'  '
'You can copy the casual gains for a specified day type to another'
'day type.'
'  '
*enditem
        CALL EPICKS(IX,KSTR,' ',
        CALL EPICKS(IX,KSTR,' ',
        call EPICKS(ilistlen,IVERT,' ',
        CALL EPICKS(IX,KSTR,' ',
        call EPICKS(IXX,IVERT,' ','Casual gain period(s) to copy:',
*subroutine IMPORTZCASG
*item IMPORTZCASG oper_import_dialogs
'There are several user interactions associated with importing'
'data from an external-to-the-model operations file (including'
'so-called pattern files which are zone operation files located'
'in the pattern folder of the ESP-r distribution).'
'  '
'In the case of a [pattern] file there is no associated zone'
'and thus no inference can be made as to the volume and floor'
'area associated with the data to be imported. You will be asked'
'to supply a value.'
'  '
'If there is no current zone operations file to copy into then'
'you will be asked to confirm the name of the zone operation'
'file. '
'  '
'During the import process you will be asked to confirm or adapt'
'the documentation for the zone operations. You may accept the'
'text in the import source. '
*enditem
          CALL EASKS(ltmp,' New zone operations file: (confirm) ',
          CALL EASKR(VAL,' ',' Assumed floor area of source ? ',
          call askok('Use the source documentation?',' ',OK,DOK,0)
          CALL EASKS248(oprdescc,'Operations notes (please edit):',
*subroutine PLTCASGN
*subroutine insdelcasper
*subroutine initcasday
*item initcasday operations_initial
'For the current day type specify how many periods for each'
'casual gain type (typically occupants, lights and small '
'power). Do not include periods for gain types which you will'
'be importing from an Events Profiles Database.'
' '
'If you set the number of periods for a type to zero or one you can'
'update it later. The number of periods should cover the whole day'
'(i.e. from 0h00 to 24h00). For example:'
'  if there are gains between 8h00 and 18h00 and nothing at other'
'  times, define this as three periods - 0h00 to 8h00 with no gains,'
'  8h00 to 18h00 with gains and 18h00 to 24h00 with no gains.'
'  '
'Period start times should be in ascending order. The process works'
'better (faster and fewer errors) if you plan the schedules for each'
'day type in advance. If you input the correct start times subsequent'
'editing tasks will take less time.'
*enditem
        CALL EASKS(HOLD,VOUTS,
*subroutine initcasper
*item initcasper operations_allocate_per
'If your initial definition of start times is correct then subsequent'
'editing tasks will be easier.'
*enditem
      CALL EASKS(CSTR,' ',msg,72,' 0  5  6  8 ','time starts',IER,2)
*subroutine prjqa
*item prjqa setup_qa_report
'Normally reports are generated from a standard pattern'
'and edited to fit the current project. The [notes] file'
'is created during project registration and many groups'
'like to update this file as the project evloves. If you ask'
'to look at or edit the file make sure you spell the file'
'name correctly (name is not held in the model cfg file).'
' '
'The graphing tool can be invoked after exporting'
'performance data from the assessment tool.'
' '
'If you wish to view bitmapped images oor capture images'
'from the screen use option [h]. '
' '
'The preview tool has a default assumption that the report'
'uses the troff typesetting convention. '
' '
'This menu also defines the contents of a QA report for the'
'current model. A number of topics can be selected for '
'inclusion in the report and each topic can be reported in'
'a compact or verbose format.'
' '
'Topics which are not included in the current model will show'
'up as not applicable. You can include none or some or all'
'zones in the report as well as alter the level of detail'
'included in the report.'
' '
'One use of this report is to track the progress of a model'
'(comparing reports generated as the model evolves).'
' '
'Another use of this report is to confirm that different'
'versions of a model have been correctly defined. '
' '
'The primary use of this report is as an aide to check models'
'and provide a text based synopsis of the model composition. '
' '
'Once you generate a QA report file you can select the'
'[edit QA report] option and an editor will be launched.'
*enditem
        CALL PHELPD('QA overview',37,'-',0,0,IER)
        CALL EASKS(ltmp,
        CALL ASKOK(' Problem detected while trying to preview',
        CALL ASKOK(' Problem detected while trying to open',
        CALL ASKOK(' ',' Edit this file?',OK,dok,2)
        CALL EPICKS(INPIC,IVALS,' ',' Which zones to summarise:',
*item prjqa qa_filters
'Often it is convenient to review which surfaces in a '
'project have particular attributes.'
' '
'The following questions will allow you to define a subset'
'of surfaces via filters for position,  orientation, opacity, etc.'
'  '
'Filter options:'
'  surfaces which are fully attributed or partly attributed'
' '
'  surfaces which are opature or transparent'
' '
'  surfaces which face the outside or are internal partitions'
' '
'  surfaces which have a particular orientation'
' '
'After the report is generated it can be edited using the current'
'standard text editor (as defined in the default file).'
*enditem
        CALL PHELPD('global search by attribute',6,'-',0,0,IER)
        CALL EASKABCD(' Filter for surface composition:',' ',
        CALL EASKABCD(' First filter--surface opacity:',' ',
        call EASKATOG(' Second filter--surface contiguity:',' ',
        call EASKATOG(' Third filter--surface orientation:',' ',
        CALL EASKF(LFIL,'ASCII file name?',
        CALL EASKF(llitem,'ASCII file name?',
        CALL EASKF(LFIL,'ASCII file name?',
*subroutine mupdate
*item mupdate model_upgrade_older
'Older models should be updated to take advantage of'
'extended geometric data structures and file formats.'
' '
'An update will also reduce the number of model '
'files which have to be managed. '
*enditem
        call askok('The current model uses an out-of-date format for',
*item mupdate 'model_upgrade_v3
'Older models should be updated to take advantage of'
'extended documentation and quality assurance facilities'
'as well as enhanced databases.'
'  '
'An update will also reduce the number of descriptive '
'files which have to be managed. '
' '
'Older models with seaparate IPV (integrated performance'
'view files will have this data moved into the cfg file.'
' '
*enditem
        call askok('The current model uses an out-of-date format for',
*item mupdate shading_upgrade
'Older shading files should be recalculated to reflect'
'changes in the allowable number of surfaces in each'
'zone. Each affected zone will be done in turn.'
' '
'Recent versions of the ish module are able to make a'
'backup copy of shading databases in ASCII format. '
*enditem
        CALL EASKABC(' Update of shading options:',' ',
*subroutine SDDEF001
*item SDDEF001 uncert_material
'To further specify the extent of the uncertainty, please'
'pick the required material from the list provided. '
'  '
'You will then be asked to pick the required thermophysical'
'property for this sensitivity study. You will also be asked'
'to specify the bounds of the property to which the random.'
'change will be applied.'
'   '
'Exit will return to the main menu without saving any data.'
*enditem
      CALL EPICKS(IEPIC,IVALE,' ',' Which material : ',
      CALL EPICKS(IPPIC,IVALP,' ',' Which property : ',
      call EASKAB('Define parameter bounds:','  ',
*subroutine SDDEF002
*item SDDEF002 uncert_MLC
'Currently you can adjust one material peroperty - the thickness of'
'a specific layer of a MLC. First select which material you want to'
'alter.'
*enditem
      call EASKAB('Which composite construction parameter?','  ',
      CALL EPICKS(INPIC,IVALE,' ',' Which material:',
*subroutine SDDEF003
*item SDDEF003 uncert_climate
'Pick the required climate parameter from the list. '
'   '
'Exit will return to the main menu without saving any data.'
*enditem
      CALL EPICKS(INPIC,IVALP,' ','Which parameter:',
*subroutine SDDEF004
*item SDDEF004 uncert_operations
'You can nominate casual gains or scheduled air flows as uncertain.'
' '
'If casual gains then you will be asked which casual gain, and'
'then whether it is the radiant or convective portion of the gain,'
'or the total magnitude of the gain or the period start time.'
'  '
'If schedules air flows selected then you are asked if it is'
'infiltration or which zone is a ventilation source or if it'
'is the source temperature of the ventilation which is uncertain.'
'  '
'For either casual gains or scheduled air flows you need to link'
'with a defined (zone) location.'
*enditem
      call EASKAB('  ','Which scheduled parameter? ',
      call EASKABC('  ','Which casual gain? ',
      call EASKATOG('Which property? ',' ','Sensible','Latent',
      call EASKATOG('Which property? ',' ','Infiltration',
*subroutine SDDEF005
*item SDDEF005
*enditem
      call EASKAB('Only Halcrow time invarient enabled ! ','  ',
*subroutine SDDEF101
*item SDDEF101 uncert_air_volume
'You can identify that the volume of air in the zone is uncertain.'
'This is the only geometric variant currently implemented.'
*enditem
      call EASKAB('Only zone air volume enabled ! ','  ',
*subroutine SDDBOUND
*item SDDBOUND uncert_bounds_3
'The upper and lower values that the parameter can '
'take are defined via one of three processes:'
'1) Percentage change: the upper and lower values will'
'   be the base case value +/- the percentage change.'
'   This will be multipled by the random seed for the run'
'   to get the specific change to apply.'
'   A % value greater than zero is expected.'
'  '
'2) Absolute change: the upper and lower values will be'
'   the base case value +/- the absolute change. For example'
'   to increment or decrement thickness by 10mm (0.01m).'
'   This will be multipled by the random seed for the run'
'   to get the specific change to apply.'
'   A value greater than zerio is expected.'
'  '
'3) Explicitly: the upper and lower values will be '
'   defined separately. Two values are expected and the'
'   upper must be greater than the lower. '
*enditem
        call EASKABC(' Define parameter bounds',' via:',
        call EASKR(PERC,' ',' Percentage change value? ',
        call EASKR(ABS,' ',' Absolute change value? ',
22      call EASKR(EXPU,' ',' Explicit definition of upper value? ',
        call EASKR(EXPL,' ',' Explicit definition of lower value? ',
*item SDDBOUND uncert_bounds_2
'The upper and lower values that the parameter can '
'take are defined via one of two processes:'
'1) Percentage change: the upper and lower values will'
'   be the base case value +/- the percentage change.'
'   This will be multipled by the random seed for the run'
'   to get the specific change to apply.'
'   A % value greater than zero is expected.'
'  '
'2) Absolute change: the upper and lower values will be'
'   the base case value +/- the absolute change * the current'
'   random number seed (+-2.0). For example to increment or'
'   decrement thickness by a nominal 10mm set a value of 0.01m'
'   (be sure the value reflects the units of the attribute).'
'   This will be multipled by the random seed for the run'
'   to get the specific change to apply.'
'   A value greater than zero is expected.'
*enditem
        call EASKAB(' Define parameter bounds',' via:',
        call EASKR(PERC,' ',' Percentage change value? ',
        call EASKR(ABS,' ',' Absolute change value? ',
*subroutine SDDFLT001
*item SDDFLT001
'The classifications shown in the display include up to'
'18 elements. To get a listing of the items included'
'select one of the classifications.'
*enditem
        CALL PHELPD('materials menu',3,'-',0,0,IER)
*item SDDFLT001
*enditem
        call EASKS(t32,outs,'default uncertainties:',32,d32,
*subroutine UNCERTA
*item UNCERTA
*enditem
        CALL EASKAB(' You are working in a remote folder... ',
*item UNCERTA
*enditem
      call EASKS(LTEMP,' Uncertainty definitions file name ?',
*item UNCERTA uncert_overview_a
'ESP-r includes formal descriptions of uncertainty for the following'
'topics: 1) thermophysical properties, 2) layer thickness, 3) weather'
'4) zone operations, 5) convection coefficients, zone air volume.'
'  '
'Uncertainties are defined in a three stage process '
'analogous to mass flow.'
'  '
'1 One or more distributions are defined. For example, if thickness'
'  of insulation is of interest we might create named distributions'
'  [wall_thickness] & [roof thickness] and identify specific materials'
'  to perturb (% or +- absolute increments).'
'  '
'2 One or more named physical locations in the model are defined e.g.'
'  [facades] & [roof] each of which are linked to specific zones &'
'  surfaces. Thermophysical properties & layer thickness & zone'
'  operations need a zone location. Weather needs a temporal location.'
'  '
'3. Distributions and locations are linked to define one or more'
'   uncertanties e.g. [wall_thickness] + [facades].  The validity'
'   of the uncertainty is checked at simulation time.'
'  '
'When the assessment is run you are given a choice of: differential,'
'factorial, Monti-Carlo assessments. For each run a random see will be'
'generated (within the range +-2.0 and applied to the user defined'
'bounds. The results file will include a base case pluse all of'
'the separate variants (sets) required.' 
'NOTE: bps must be run in silent mode to support sensitivity studies.'
'  '
'When res is run you are given the option to work with all of the  '
'sets or specific result sets. Look for the [sensitivity] menu option. '
'  '
'The initial option [a create default bounds] allows you to define'
'bounds for uncertainty for thermophysical properties in advance'
'and reference these defaults rather than manually stipulating the'
'bounds to apply.'
*enditem
        CALL PHELPD('Uncertainty definitions file',12,'-',0,0,IER)
*subroutine DISPOPT
*item DISPOPT uncert_display
'To create a new definition select + add entry. '
' '
'To edit an existing entry then select it.'
' '
'To remove an existing entry select -> delete entry and then'
'  identify the entry you wish to delete.'
*enditem
        CALL PHELPD('UA file entries',4,'-',0,0,IER)
        call EPICKS(INDEL,IDEL,' ',' ',15,NICNG,LCNG,
        call EPICKS(INDEL,IDEL,' ',' ',15,NILOC,LLOC,
        call EPICKS(INDEL,IDEL,' ',' ',15,NIACT,ta15,
*subroutine DEFUAL
*subroutine CNGDEF
*item CNGDEF uncert_distribution
'Pick the required uncertainty category. You will then '
'be asked further questions to define the uncertainty '
'distribution:  '
'  '
'  name (up to 15 characters) which is unique is required'
'   '
'Exit returns to the main menu without saving any data. '
*enditem
        CALL PHELPD('Uncertainty categories',5,'-',0,0,IER)
        CALL EASKS(t15,' ',' Name for uncertainty ? ',
        CALL EASKS(t15,' ',' Name for uncertainty ? ',
*subroutine LOCDEF
*item LOCDEF uncert_location
'The location of the uncertainty can be:'
' - spatial (zones or zones:surfaces) and in all temporal locations.'
' - temporal and in all spatial locations.'
' - both.  Only use this option if both domains have a restriction'
' '
'Each [location] you define should be given a unique name (up to'
'15 characters with no spaces.'
' '
'If you select cancel (where a number is requested) the current'
'model the uncertainty data will not be changed. '
'  '
'When selecting zones you can pick one, several or All zones for'
'inclusion and you may select them in any order.'
'  '
'If you are also selecting surfaces then you can select from the'
'list of surfaces (suggest making a note of what you have selected.'
'  '
'For temporal selections (i.e. weather) you must define a period when'
'uncertainty is applicable (start day of the year and hour of the day'
'and finish day of the year and hour of the day). If you cancel then'
'the data is not changed.'
*enditem
      CALL EASKABC(' ',
      CALL EPICKS(INPIC,IVALZ,' ',' Which zones to include: ',
      call EPICKS(INPIC,IVALS,' Which surfaces to include: ',
      call EASKI(IDST,' ','Start day? ',1,'F',365,'F',9,
      call EASKI(IHST,' ','Start hour? ',1,'F',24,'F',1,
      call EASKI(IDFT,' ','Finish day? ',1,'F',365,'F',15,
      call EASKI(IHFT,' ','Finish hour? ',1,'F',24,'F',24,
      CALL EASKS(t15,' ',' Name for location ? ',
*subroutine LINKDEF
*item LINKDEF uncert_types
'Pick the required uncertainty definition(s).'
'  '
'Next pick the required location definition.'
'  '
'With a good naming regime the pairs of uncertainty and location'
'will provide a clear indication of intent.  '
'  '
'Exit returns to the main menu without saving any data. '
*enditem
      CALL EPICKS(INPIC,IVALC,' ',' Which uncertainty definition : ',
      CALL EPICKS(INPIL,IVALL,' ',' Which location definition : ',
*subroutine UPELM
*subroutine SETUP
*item SETUP setup_date_format
'This menu allows the display format for dates and times to be'
'changed.  The active year can also be defined as required by'
'controllers that require day of the week information.'
' '
'One option lists a specified ASCII file - sometimes useful if'
'you have need to directly view the contents of a model entity'
'such as the system configuration file or a zone geometry file.'
'Remember, some files are easier to read than others.'
'The file is shown section by section in the text feedback.'
' '
'The wireframe view option allows you to set a different initial'
'wireframe view. This is also useful if you are going to work with'
'Radiance to set the initial viewing position.'
' '
'The external editor is currently defined in the .esprc file.'
'If you want to use a different text editor then you will need to'
'modify your .esprc file.  Remember, ESP-r model files tend to get'
'corrupted if you use an appication like Word for editing.'
' '
'The feedback level allows you to see more or less information as'
'model files are being scanned. Verbose can help tracking errors.'
' '
'As ESP-r evolves file formats change. Use the toggle in the menu'
'to upgrade model files to a newer format (if available). You cannot'
'revert to an earlier version of ESP-r with this facility.'
' '
'The edit [defaults] file option allows you to change where ESP-r'
'looks for certain files. TAKE CARE when editing this file. '
' '
'The edit [exemplars] file option allows you to change where'
'ESP-r looks for example models. TAKE CARE when editing this file.'
' '
'The edit [3rd party application] allows you to specify a text'
'editor, image display tool, CAD tool and the location of example'
'models and where the [defaults] file (see above) is located. '
' '
'The option for scanning an ESP-r META file should only be used if no'
'model is loaded in the project manager. A META file is a compact'
'single-file representation of much of an ESP-r model. Typically'
'it is generated by 3rd party tools and treated as a command line'
'specified input file by prj. You can also export an existing model'
'as a META file.'
' '
'Unless other wise specified the initial view of the model is'
'a standard default. If a user defined view is more appropriate'
'then specify this here.  The EYEPOINT is in metres in the model'
'coordinate system. The VIEWPOINT is also in metres in the model'
'coordinate system (it defaults to the centre of the model).'
'The ANGLE of view is in degrees (between 1 and 120 degrees).
*enditem
        CALL EASKABCD(' Initial view position options',' :',
        CALL EASKS(HOLD32,' Eye point  X  Y  Z (in metres): ',
        CALL EASKS(HOLD32,' Viewpoint  X  Y  Z (in metres): ',
        CALL EASKR(ANGI,' ',' New angle of view ? ',
  6     CALL EASKXORGTKF(LFIL,'ASCII file name?',' ',
*item SETUP setup_list_ascii_error
'Either the file you selected did not exist or included characters'
'which would not print. '
*enditem
          CALL ASKOK(' Problem detected while trying to open',
*item SETUP setup_edit_ascii
'An ASCII format file that you select can be edited using the current'
'defined text editor (as defined in the default file). The usual'
'caviats apply - be certain you know the format of the file prior'
'to making any changes in an ESP-r model file.'
*enditem
        CALL EASKXORGTKF(LFIL,'ASCII file name?',' ',
*item SETUP 'setup_edit_defaults
'The edit [defaults] file allows you to change where ESP-r looks'
'for certain files. TAKE CARE when editing this file.'
'The key words are:'
' '
' *ipth - where ESP-r is installed. This was set during the initial'
'         Installation and compile sequence. Leave this alone!'
' '
'Names of default files (typically used for demonstrations)'
' *cfg - a default model to open'
' *ctl - a default zone control definition'
' *mfn - a default mass flow network'
' *dfd - a default CFD domain'
' *pnf - a default plant-only model'
' *res - a default simulation results file'
' *mfr - a default mass flow simulation results file'
' '
'Names of databases initially associated with models. Edit'
'these so as to be appropriate for your region'
' *clm - initial climate file'
' *prs - initial wind-pressure coefficients database'
' *prm - initial materials database'
' *mlc - initial constructions database'
' *opt - initial optical properties database'
' *env - initial event profiles database'
' *pdb - initial plant component template database'
' *ecdb - initial electrical component database'
' *mcdb - initial active materials database'
' *icdb - initial icons for the net module'
' *mldb - initial micotoxin database'
' *sbem - initial UK National Calculation Method'
'         database (or code complience rules)'
' '
'After edting and saving the information is available the next'
'time applications are invoked. '
' '
'NOTE: do not change the name of the default file itself! '
*enditem
        CALL EASKXORGTKF(defdbfl,'ESP-r default files?',' ',
*item SETUP setup_edit_esprc
'The edit [esprc] file allows you to change 3rd party tools used'
'by ESP-r. A standard esprc file is included in the installation'
'folder. ESP-r also checks for an .esprc (note the dot) file in'
'the users home folder for user specific settings. '
' '
'        TAKE CARE when editing this file. '
' '
'Data in the file are comma separated. The first token in each line'
'is a key, the second is (typically) a label followed by a command'
'or exedutable to invoke.'
' '
'Key words in thefile are: '
' *ESPRC  - first line tag (leave alone)'
' '
' *gprn line specifies an application to invoke for capturing a'
'    portion of the graphic display. For Linux and OSX and Solaris'
'    the [import] tool in Imagemagik is suggested.'
' '
' *cad  line specifies a CAD application to start. There are 3'
'   tokens after the tag, a user description, a file format and'
'   the name of the executable.'
' '
' *image_display line(s) define how specific image types can be'
'    displayed. The 2nd token is TIF XMBP GIF XWD and the 3rd token'
'    is the name of the executable.'
' '
' *journal is a line specifying whether a detailed log should be'
'    kept of the users actions. The 2nd token is OFF or ON.'
' '
' *editor line specifies what text editor to invoke the 2nd token'
'    is a label and the 3rd token is the application to start.'
'    Typically on Windows we suggest NotePad++ or WordPad. '
'    Notepad does not work well. On Linux/OSX nedit is a good choice.'
' '
' *exemplars line provides the path to the list of exemplar'
'    models.'
' '
' *validation_stds line provides the path to the list of standard'
'    validation models.'
' '
' *db_defaults line provides the path to the file that holds default'
'    database and model file names as well as default constructions 
'    to use.'
' '
' *db_climates line provides the path to the file that holds a list'
'    of climate files (that populate the climate selection list).'
' '
' *end  the last line of the file (please leave alone)'
*enditem
        CALL EASKXORGTKF(esprc,'ESP-r esprc file?','(see help)',
*item SETUP setup_edit_climatelist
'The edit [climatelist] file allows you to change the list of'
'climate files available for browsing. TAKE CARE when editing'
'this file. '
' '
'The blocks of text that form an entry within this file are'
'typically created within the clm module and both the text'
'block and the climatelist file can be edited clm. '
' '
'Key words in the file are: '
' '
' *CLIMATE_LIST  - 1st line identifier (leave alone)'
' '
' *group <tab> text for menu'
' '
' *item'
'    marks the start of one climate'
' '
' *name <tab> text for menu'
' '
' *aide <tab> description of climate'
' '
' *dbfl <tab> full path to the climate file'
' '
' *winter_s  winer season tab has 4 numbers for:'
'    winter begining January 1 and 4 numbers for winter'
'    ending 31 Dec. Each set of 4 is:'
'   start day, start month, finish day, finish month'
' '
' *spring_s has 4 numbers representing start and end of spring'
'     and 4 numbers representing start and end of autumn season'
' '
' *summer_s has 4 numbers representing start and end of summer'
'     season'
' '
' *winter_t is like *winter_s but for a typical period'
' *spring_t is like *spring_s but for typical periods'
' *summer_t is like *summer_s but for typical period'
' '
' *avail <tab>  ONLINE'
' '
' *help_start'
'    signals start of a block of contextual help'
' '
' *help_end'
'    signals end of a block of contextual help'
' '
'After edting and saving the information is available the next'
'time applications are invoked. '
*enditem
        CALL EASKXORGTKF(cdblfil,'ESP-r climatelist file?',
*item SETUP setup_edit_exemplars
'The edit [exemplars] file allows you to change the list of exemplar'
'models. TAKE CARE when editing this file. The key words are:'
' '
' *EXEMPLARS - fist line identifier (leave alone)'
' '
' *help <tab> some text'
' '
' *label <tab> label text'
' '
' *group <tab> name of group'
' '
' *item'
'    marks the start of the model information'
' '
' *name <tab> some text for the menu'
' '
' *cfg <tab> full path to model configuration file'
' '
' *root <tab> full path to model folder'
' '
'To add an additional item find the relevant group and add in'
'the *item line, *cfg line and *root line '
' '
'After edting and saving the information is available the next time'
'applications are invoked. '
*enditem
        CALL EASKXORGTKF(exemfl,'ESP-r exemplars?','(see help)',
*item SETUP surface_corner_detect
'ESP-r provides two methods for scanning for geometric surface'
'matches - within the topology checking facility and in the surface'
'attribution [scan for nearby surfaces] option. Both check for a'
'number of tollerances vis-a-vis how close vertices are, how close'
'the angles between surface normals are, how close the COG of surfaces'
'are etc. If your model includes fine details and/or small surfaces'
'then changing to smaller tollerances helps to constrain the tests.'
*enditem
*subroutine tdfedit
*item tdfedit tdf_time_format
'The selected format for the input of time is currently'
'set as a fraction of a day 0.4271 (eq 10h15).'
'  '
'You are also asked for the number of timesteps of data to'
'recover from the input file.'
*enditem
        CALL EASKR(TIMEJD,' Time (as julian day) to start recovery? ',
*item tdfedit
*enditem
        CALL EASKI(incr,' Number of steps to recover ',' ? ',
*item tdfedit tdf_overview_menu
'The ESRU Temporal Definition supports the creation and management'
'of temporal data from experiments or 3rd party software.'
'It can also hold scheduling for short timestep casual gains, air'
'movement and boundary conditions. It is also useful for data'
'that changes at each timestep.'
' '
'Preferences : file names & types, periods, import/export'
'             files & date display.'
'Save : Update the TDF file and/or convert between ascii.'
'       and binaray versions. '
' '
'Currently the following item types are offered: '
' ALLCLMT - all climate data (includes next 6 items)'
' BDTEXTT - ambient temperature'
' WINDVLT - wind velocity'
' WINDDRT - wind direction'
' RELHUMT - ambient relative humidity'
' DIFHSLT - diffuse horizonal radiation'
' GLOHSLT - global horizonal radiation'
' DIRSOLT - direct normal solar radiation'
' SETPTTT - control setpoint temperature (single)'
' CASUALT - zone casual gains (combined gains)'
' CASUAL3T -zone casual gains (Occup/Lights/SM Pwr)'
' ACTIVITY -global database: gains,setpoints, etc.'
' BIDIRSET -alternate bidirectional datasets'
' HTCLSETP -Specify columns to read H/C setpoints.'
' DBTZNM   - measured zone db temperature'
' SURTM    - measured surface temperature'
' '
'To create a new file, select option 1 and follow the instructions'
'given. You will be asked for the year and the period and the'
'timesteps per hour and then for an initial temporal type its '
'attributes.'
' '
'Insert by selecting an insertion point, the list will expand'
'and you can select a generic type. '
' '
'Delete by selecting an item and the list will contract.'
' '
'Copy by selecting source and then destination. The destination'
'data will be overwritten - so you need to have created a'
'destination item to overwrite before you ask for a copy.'
' '
'In the menu, the TDF file is the main temporal file.'
'  '
'The period shown is related to all tabular data and includes'
'any [startup] time required by the simulation. Example:'
'for a simulation at half hour intervals over 10 days and with'
'2 startup days the temporal file should include 288 timesteps. '
' '
'Note on file headers:'
'Older asci temporal files may start with [TDFdatabase2]. Before'
'using them please change 1st line to use the identifier ASCIITDF2'
'in a text editor.'
' '
'Newer ascii files will start with [ASCIITDF3].  Also note that'
'binary/scratch temporal files are machine dependant and are not'
'always safe for use on another computer.'
*enditem
*item tdfedit tdf_file_name
'The TDF file is the name of an ascii file which holds the'
'attributes and temporal (short timestep) data of casual gains,'
'boundary conditions, flow measurements etc.'
' '
'While editing temporal data, during a simulation or as'
'results are being recovered, a scratch (binary) file is created.'
' '
'If you supply the name of a binary version of the temporal'
'file it will be translated into an ascii version and a new'
'scratch file created. '
'  '
'If no temporal file is found a minimal file will be created'
'if you agree. This initial setup prompts you for the necessary'
'data to setup a new temporal definition. You can also do it'
'manually.'
*enditem
        CALL EASKS(tfile,' Temporal file name? ',
        CALL ASKOK(outs,' Create a new scratch & asci file?',
        CALL EASKAB(' Empty file. Options:',' ',
*item tdfedit tdf_save_data
'You may save the current binary file or import or export'
'an ASCII version. '
'  '
'If you choose an ascii file you will be asked for a file'
'name.'
'  '
'The selected format for the input of time is currently'
'set as a fraction of a day 0.4271 (eq 10h15).'
'  '
'You will also be asked how many timesteps of data to recover.'
*enditem
        CALL EASKATOG(' File options:',' ','save ascii file',
        CALL EASKS(afil,' Ascii export file name? ',' ',
        CALL EASKR(TIMEJD,' Time (as julian day) to start recovery?',
        CALL EASKI(incr,' Number of steps to recover ',' ? ',
        CALL EASKS(afil,' Ascii export file name? ',' ',
*item tdfedit tdf_add_an_item
'Options are:'
'  Adding an item - placed at the end of the list. '
' '
'  Deleting an item (irreversable) shifts subsequent '
'  items up in the list. '
' '
'  Copy of item will overwrite the contents of the  '
'  destination item. '
'  '
'In order to find items in the TDF db a unique name must'
'be assigned to each entry. This name is a string up to 12'
'characters long with no blanks.'
'  '
'You can manage temporal entries by deleting one or copying'
'one (you are asked to select it in the list).'
' '
'If you copy the static items from an entity then'
'you will be asked for the item to copy the information'
'into.'
*enditem
        CALL EASKABC('Entry options:',' ',
        CALL EASKS(TTAG,' ','Name for entry? ',
        CALL EPICKS(INPIC,itemval,' ',' Which item to delete?',
        CALL EPICKS(INPIC,itemval,' ',' Which item to copy?',
        CALL EPICKS(INPIC,itemval,
*subroutine CLRTABC
*subroutine glbset
*item glbset tdf_global_questions
'Period of the temporal file:'
'The year is required. It should match that of '
'the climate file used in a simulation and can hold'
'data for a few days up to a year. '
' '
'The start day applies to all of the items in the '
'file.  Example:'
' '
' A week long simulation in July (say 7-14th) requires'
' a 4 day startup period. A minumum TDF db would be'
' 3-14 July.'
' '
'If you are planning on importing timestep data'
'from an external file then the TDF start date '
'includes the startup period. SORT THIS OUT BEFORE'
'importing data (or it might be truncated).  '
'Check initial help on dates. '
'  '
'Frequency of data:'
'Timestep data in your file will be at a fixed'
'timestep which should match that of the'
'simulation timestep.'
' '
'If you are planning on importing TABULAR (timestep) '
'data then the TDF timestep and that of the other '
'file should match. '
'  '
'The temporal file holds two documentation lines.  Such '
'documentation can save a lot of grief later.....'
*enditem
        CALL EASKI(itdyear,' ',' What is the year?',
        CALL EASKPER('Period:',itdbdoy,itdedoy,IFDAY,IER)
*item glbset tdf_global_frequency
'Frequency of data:'
'Timestep data in your file will be at a fixed'
'timestep which should match that of the'
'simulation timestep.'
'  '
'If you are planning on importing TABULAR (timestep) '
'data then the TDF timestep and that of the other '
'file should match. '
'  '
'In order to find items in the TDF db a unique name must'
'be assigned to each entry. This name is a character'
'string up to 12 characters long with no blanks.'
*enditem
        CALL EASKI(NTSPH,' ','No of timesteps/hour ? ',
        CALL EASKS(tmp72,' 1st line of documentation ?',
        CALL EASKS(tmp72,' 2nd line of documentation ?',
        CALL EASKS(TTAG,' ','Name for entry? ',
*subroutine extracts
*subroutine SETUPTDF
*item SETUPTDF 'tdf_inport_options
'The import facility is available to allow users with '
'tabular data in a text file to select one or more '
'columns of such information and associate it with a '
'DB item which is of type TABULAR.  First define the '
'import file and its format in this menu, then select '
'the item which is to be filled and issue an import  '
'command. '
' '
'One import source file will be assumed throughout this'
'session. If this needs to be altered then the user'
'should return to this menu to give the new name.'
' '
'The export command supports export to an ASCII format'
'file, binary and export which can be read via grtool.'
'One export file will be used as the default name which'
'you may alter if you want.'
' '
'The date and time formats may be used to alter the '
'display as well as that of any exported data. '
'It is possible to import temporal information via an'
'ASCII file with columns of data.'
*enditem
        CALL EASKABC('Import options:',' ',
        CALL EASKS(tfile,' Import file name? ',
        CALL EASKI(ITEXP,' Several export formats are available: ',
        CALL EASKS(tfile,' Export file name? ',
*subroutine FMI_ED
*item FMI_ED FMI_disabled
'This version of ESP-r has not been compiled with FMI support.'
'Instructions to enable this functionality can be found in:'
'[ESP-r installation directory]/manual/FMI/Users.txt.'
*enditem
      CALL PHELPD('FMI not available',nbhelp,'-',0,0,IER)
*item FMI_ED FMI_spec_none
'This facility allows creation and editing of directives to co-simulate'
'with external programs called Functional Mock-up Units (FMUs). The'
'data exchange is defined by the Functional Mock-up Interface (FMI)'
'standard. Information on the FMI implementation in ESP-r, including'
'a list of supported FMUs and their functionality, can be found in:'
'[ESP-r installation directory]/manual/FMI'
' '
'Currently there are no FMU specifications. Please add one using'
'option +.'
*enditem
        CALL PHELPD('FMI specification help',nbhelp,'-',0,0,IER)
*item FMI_ED FMI_spec_some
'This facility allows creation and editing of directives to co-simulate'
'with external programs called Functional Mock-up Units (FMUs). The'
'data exchange is defined by the Functional Mock-up Interface (FMI)'
'standard. Information on the FMI implementation in ESP-r, including'
'a list of supported FMUs and their functionality, can be found in:'
'[ESP-r installation directory]/manual/FMI'
' '
'Note that multiple instances of an FMU can be defined from the same'
'FMU specification (often there is one instance per zone). In most'
'cases you should use a separate FMU specification for each different'
'FMU you plan to co-simulate with, not for each instance.'
' '
'Option a: cycle through FMU specifications.'
'Option b: set path to the FMU file (can be relative from model cfg'
'          directory).'
'Option c: define a brief identifying phrase for the FMU (maximum'
'          30 characters).'
'Option d: define the maximum time allowed for communication between'
'          ESP-r and the FMU (in milli-seconds). A value of zero means'
'          no limit.'
'Option e: toggle debug logging for the FMU on or off. Only advanced'
'          users should put this on.'
'Option f: define FMU inputs, i.e. data passed from ESP-r to the FMU.'
'Option g: define FMU outputs, i.e. data passed from the FMU to ESP-r.'
'Option +: manage FMU specifications.'
'Option !: list data for the currently selected FMU specification.'
'Option >: save all FMU specification data to a file. By default this'
'          file is given the extension .fmi and is placed in the ctl'
'          model directory. Before saving, you will be warned if any'
'          FMU files have not been specified.'
'Option ?: show this help text.'
'Option -: exit this menu. If there is unsaved data, you will be asked'
'          if you want to save this before exiting.'
*enditem
        CALL PHELPD('FMI specification help',nbhelp,'-',0,0,IER)
*item FMI_ED manage_FMUs
'Here you can add, delete or copy an FMU specification. All inputs and'
'outputs will also be deleted or copied along with the FMU'
'specification. There is no undo for deleting an FMU specification'
'(except reloading a previous file), so think carefully before doing'
'so!'
' '
'When deleting or copying an FMU, you will be prompted for a number.'
'This corresponds to the FMU specification index, listed when the'
'prompt is given. Specifications are added at the end of the list'
'(i.e. if there are 2 existing specifications and one is added, the'
'new one will become number 3).'
*enditem
C Manage FMU specifications.
        helptopic='manage_FMUs'
        CALL gethelptext(helpinsub,helptopic,nbhelp)
        CALL EASKABCD(' ','Options:',
     &    'add','delete','copy','cancel',itmp,nbhelp)
*item FMI_ED enter_FMU_file
'This is a path to the FMU file, which normally has extension .fmu.'
'This can be a relative path from the model cfg directory, or an'
'absolute path. 72 characters maximum. After entering the file path,'
'you will be warned if it cannot be found in the specified location.'
*enditem
          CALL EASKS(FMUFIL(IFMU),' ',' FMU file?',72,ctmp,'FMU file',
     &      IER,nbhelp)
*item FMI_ED FMU_file_not_found
'The FMU file cannot be found at the location you have specified. This'
'is not a fatal error, but please be aware that you will be unable to'
'run a simulation with FMI active if any FMUs cannot be found at run'
'time. You can try entering the file path again, or continue with the'
'previously specified path.'
*enditem
            CALL EASKAB(' Cannot find this file!','Options:',
     &        'respectify','continue',itmp,nbhelp)
*subroutine FMI_EDINP
*item FMI_EDINP FMU_input
'Here the FMU inputs are defined. This creates directives for ESP-r to'
'pass data to the FMU, for example a temperature. Inputs are first'
'associated with a zone (including the ambient environment), and then'
'a specific variable is selected. The available choice of variables is'
'different depending on whether the ambient environment or a building'
'zone is selected.'
' '
'There are two other data items, which correspond with entities defined'
'in the FMU. The FMU instance name is an identifier for each component'
'of the FMU. Guidance on this may be found in the relevant entry in the'
'ESP-r manual FMU listings ([ESP-r installation directory]/manual/FMI),'
'or the documentation for the FMU itself. The FMU variable name is an'
'identifier that should be defined in the modelDescription.xml file'
'within the FMU.'
' '
'Options a-z: edit data for a specific input. If there are a large'
'             number of inputs, this part of the menu will be'
'             paginated.'
'Option 0: if the menu is paginated, this allows page control.'
'Option +: manage inputs.'
'Option !: list data for all inputs of the active FMU specification.'
'Option ?: show this help text.'
'Option -: exit this menu.'
*enditem
        CALL PHELPD('FMU inputs help',nbhelp,'-',0,0,IER)
*item FMI_EDINP manage_inputs
'Here you can add, delete or copy an FMU input. There is no undo for'
'deleting an input (except reloading a previous file), so think'
'carefully before doing so!'
' '
'When deleting or copying an input, you will be prompted for a number.'
'This corresponds to the FMU input index, listed when the prompt is'
'given. Inputs are added at the end of the list (i.e. if there are 2'
'existing inputs and one is added, the new one will become number 3).'
*enditem
C Manage inputs.
        helptopic='manage_inputs'
        CALL gethelptext(helpinsub,helptopic,nbhelp)
        CALL EASKABCD(' ','Options:',
     &    'add','delete','copy','cancel',itmp,nbhelp)
*item FMI_EDINP edit_input
'Here you can edit data for an individual FMU input. Inputs are first'
'associated with a zone (including the ambient environment), and then'
'a specific variable is selected. The available choice of variables is'
'different depending on whether the ambient environment or a building'
'zone is selected. Some variable types require supplementary data; for'
'guidance please refer to the FMI users manual found at:'
'[ESP-r installation directory]/manual/FMI/Users.txt'
' '
'There are two other data items, which correspond with entities defined'
'in the FMU. The FMU instance name is an identifier for each component'
'of the FMU. Guidance on this may be found in the relevant entry in the'
'ESP-r manual FMU listings ([ESP-r installation directory]/manual/FMI),'
'or the documentation for the FMU itself. The FMU variable name is an'
'identifier that should be defined in the modelDescription.xml file'
'within the FMU.'
' '
'Option a: choose associated zone.'
'Option b: choose ESP-r variable.'
'Option c: define supplementary data.'
'Option d: define FMU instance name.'
'Option e: define FMU variable name.'
'Option ?: show this help text.'
'Option -: exit this menu.'
*enditem
          CALL PHELPD('FMU input editing help',nbhelp,'-',0,0,IER)
*item FMI_EDINP sup_data
'Supplementary data depends on what ESP-r variable you have selected for'
'this input. Guidance on which variables require supplementary data, and'
'what the supplementary data represents, is given in the FMI users'
'manual found at:'
'[ESP-r installation directory]/manual/FMI/Users.txt'
*enditem
              EASKS(ctmp_30,' ',' Supplementary data?',30,'  ',
     &          'FMU sup data',IER,nbhelp)
*subroutine FMI_EDOUT
*item FMI_EDOUT FMU_output
'Here the FMU outputs are defined. This creates directives for ESP-r to'
'receive data from the FMU, for example a control signal. Outputs are'
'first associated with a zone (including the ambient environment), and'
'then a specific variable is selected. The available choice of'
'variables is different depending on whether the ambient environment or'
'a building zone is selected.'
' '
'There are two other data items, which correspond with entities defined'
'in the FMU. The FMU instance name is an identifier for each component'
'of the FMU. Guidance on this may be found in the relevant entry in the'
'ESP-r manual FMU listings ([ESP-r installation directory]/manual/FMI),'
'or the documentation for the FMU itself. The FMU variable name is an'
'identifier that should be defined in the modelDescription.xml file'
'within the FMU.'
' '
'Options a-z: edit data for a specific output. If there are a large'
'             number of outputs, this part of the menu will be'
'             paginated.'
'Option 0: if the menu is paginated, this allows page control.'
'Option +: manage outputs.'
'Option !: list data for all outputs of the active FMU specification.'
'Option ?: show this help text.'
'Option -: exit this menu.'
*enditem
        CALL PHELPD('FMU outputs help',nbhelp,'-',0,0,IER)
*item FMI_EDOUT manage_outputs
'Here you can add, delete or copy an FMU output. There is no undo for'
'deleting an output (except reloading a previous file), so think'
'carefully before doing so!'
' '
'When deleting or copying an output, you will be prompted for a number.'
'This corresponds to the FMU output index, listed when the prompt is'
'given. outputs are added at the end of the list (i.e. if there are 2'
'existing outputs and one is added, the new one will become number 3).'
*enditem
C Manage outputs.
        helptopic='manage_outputs'
        CALL gethelptext(helpinsub,helptopic,nbhelp)
        CALL EASKABCD(' ','Options:',
     &    'add','delete','copy','cancel',itmp,nbhelp)
*item FMI_EDOUT edit_output
'Here you can edit data for an individual FMU output. Outputs are first'
'associated with a zone (including the ambient environment), and then'
'a specific variable is selected. The available choice of variables is'
'different depending on whether the ambient environment or a building'
'zone is selected. Some variable types require supplementary data; for'
'guidance please refer to the FMI users manual found at:'
'[ESP-r installation directory]/manual/FMI/Users.txt'
' '
'There are two other data items, which correspond with entities defined'
'in the FMU. The FMU instance name is an identifier for each component'
'of the FMU. Guidance on this may be found in the relevant entry in the'
'ESP-r manual FMU listings ([ESP-r installation directory]/manual/FMI),'
'or the documentation for the FMU itself. The FMU variable name is an'
'identifier that should be defined in the modelDescription.xml file'
'within the FMU.'
' '
'Option a: choose associated zone.'
'Option b: choose ESP-r variable.'
'Option c: define supplementary data.'
'Option d: define FMU instance name.'
'Option e: define FMU variable name.'
'Option ?: show this help text.'
'Option -: exit this menu.'
*enditem
              CALL PHELPD('FMU output editing help',nbhelp,'-',0,0,IER)
*item FMI_EDOUT sup_data
'Supplementary data depends on what ESP-r variable you have selected for'
'this output. Guidance on which variables require supplementary data,'
'and what the supplementary data represents, is given in the FMI users'
'manual found at:'
'[ESP-r installation directory]/manual/FMI/Users.txt'
*enditem
              EASKS(ctmp_30,' ',' Supplementary data?',30,'  ',
     &          'FMU sup data',IER,nbhelp)
