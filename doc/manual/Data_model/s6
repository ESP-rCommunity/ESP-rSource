.de MT    \"macro to start text
.ft R
.nr VS 14
.nr PS 12
.vs 14
.ps 12
..
.de mT    \"macro to start table
.nr VS 10
.nr PS 8
.vs 10
.ps 8
..
.de ML    \"macro to start listing
.LD
.ft B
.vs 8
.ps 7
.cs 1 22
.cs 3 22
..
.de ES    \"macro to end code listing
.DE
.ft R
.cs 1
.cs 2
.cs 3
..
.ds CH
.ds RH %
.ds LH Data Model Summary: ESP-r Version 9 Series
.EQ
delim $$
.EN
.LP
\ 
.ce
\fB\s+9Table of Contents\s0\fR
.sp
.nf
0 Introduction
1 General format of data files
2 Zone geometry file
3 Zone construction file
4 Zone operation file
5 Zone utilities file
5.1 Zone shading/insolation file
5.2 Zone blind/shutter control file
5.3 Zone view factor file
5.4 Zone air flow file
5.5 Zone casual gain file
5.6 Zone convection-calculation control file
5.7 Zone transparent multi-layered constructions file
5.8 Zone casual gain control file
5.9 Zone CFD domain file
6 Fluid mass flow network description file
7 Pressure coefficients file
8 System configuration file
9 Configuration control file
10 Site obstructions file
11 Operation of \fIesp-r\fR
12 Adaptive gridding

Appendix Representative data for building energy analysis
.fi
.bp
.TS
doublebox center;
l.
T{
As of ESP-r Version 8 Series the original user-unfriendly
input data management program \fIimp\fP has been replaced
by the generalised project manager \fIesp-r\fP.  This
new module offers a more coherent and user-friendly interface
by hiding much of the file structure which underlies
the use of ESP-r and giving on-line help and data definitions.
.br
It is important to realise however
that advanced use of ESP-r will require a working
knowledge of its data structures and inherent relationships.
Hence the need for this document.  Note however that
because of the pace of change of ESP-r, the file content
definitions which follow may not correspond exactly with
the version of ESP-r you are using.  In cases of doubt, the
information given by the project manager should be
assumed correct.
T}
.TE
.sp
.SH
0 Introduction
.LP
Prior to commencing data preparation, the target building
(or building portion) and/or plant (or plant portion)
must be subdivided into a
number of discrete zones and plant components. This should be
done in a manner which will accommodate the various issues to
be examined. For example, a space within a building, represented as
one zone, will allow an assessment of average energy states
and comfort levels; it cannot provide information on
temperature stratification or the enhanced loss of heat due
to localised heating near the ceiling. This would require (at
least) a two zone space representation scheme. The standard version
of ESP-r allows the simultaneous processing of up to 50
building zones and up to 100 plant components. Each zone is
considered as a volume of fluid (usually air) bounded by up
to 25 polygonal surfaces of transparent, opaque or fictitious
(not existing) composition; while plant components are
considered as a number of fluid and solid regions in
intimate contact. In both cases (zones and components), a
number of differential equations will be active within
\fIbps\fP to describe sub-region energy balance. The data
required by \fIbps\fP, and described in this section in
relation to the operation of \fIesp-r\fP, is required to
establish and then integrate these differential
equations. The theory underlying \fIbps\fP's operation is
reported in
section 5.
.LP
It is possible to process
configurations which exceed the upper limit in terms of
zones, plant components or both. In this case a new version
of \fIesp-r\fP, \fIbps\fP and \fIres\fP must be created by
changing a `parameter' statement in the appropriate
Fortran `include' file and then re-creating the object files.
.LP
Having established the desired building zoning strategy, the
following 10 files (3 mandatory, 7 optional)
can be created
for each zone via the facilities of \fIesp-r\fP (see sub-section 4.2).
.IP "Mandatory:" 12
.ul 1
geometry, construction and operation.
.IP "Optional:" 12
.ul 2 
utilities, shading/insolation, blind/shutter control, view factor,
air flow, casual gains, convection coefficients
and
.ul 1
transparent multi-layered constructions.
.LP
The mandatory files contain the minimum
descriptive information required for simulation purposes
(that is, differential equation coefficient generation). This
includes zone geometry, window and door locations and
dimensions, default insolation schemes,
construction (walls, ceilings, floors, windows
and doors) thermophysical properties, surface finishes,
casual gains, and default infiltration and zone coupled air
flows. The zone utilities file holds a number of flags
which exist to indicate
whether or not one of the other optional zone files will exist.
If it does, then its contents will
supersede any corresponding default scheme held in a
mandatory file. To summarise the data utilisation protocol:
.IP \(bu
If a zone shading/insolation file does not exist, then the
default insolation data of the zone geometry file is used
with external shading set to zero. If the file does exist,
then the time-series shading and/or insolation data held
therein will be used in preference to the default. Of
course, the default is only replaced if the data of the
shading/insolation file is valid for the simulation period
and surface (shading) or window/surface (insolation) being
considered. \fIIsh\fP can be used to create
the shading/insolation file or, alternatively, data acquired
from elsewhere (eg a monitoring scheme) can be inserted in the file via the facility
of \fIesp-r\fP.
.IP \(bu
If a zone blind/shutter control file does not exist, then
zone windows are given the thermophysical and optical properties assigned
to them in the zone constructions file. If this file does exist, then,
during some defined period of time, or above some stated solar
intensity level, given replacement
properties are assumed. This allows window insulation
or solar control devices to operate as a function of
time and/or solar intensity. A blind/shutter control file can
only be created via \fIesp-r\fP.
.IP \(bu
If a zone convection coefficients file does not exist, then
\fIbps\fP will assume buoyancy driven (or natural) convection at
internal opaque and transparent surfaces and compute heat transfer coefficients
from empirical equations derived from experimental data
correlations. The corresponding external surface values are determined as a
function of wind speed and direction and again use empirical
correlations. When a convection coefficients file exists
these computed convective heat transfer
coefficients can be replaced, at any
time within a simulation, by fixed user-specified values.
The file is created via \fIesp-r\fP.
.IP \(bu
If a zone view factor file does not exist, then simplified
view factor assessment techniques are utilised by \fIbps\fP
at run time. This is probably adequate for many simulation
exercises. Should greater accuracy be desired, a view factor
file can be created by
\fImrt\fP or by \fIesp-r\fP using data acquired from some other
source.
.IP \(bu
If a zone air flow file does not exist, then the default air
flow profiles of the operations file,
defining infiltration and zone-coupled air
flow with potential thermostatic constraints superimposed,
will be used. Alternatively, a time-series air flow file can
be created via \fImfs\fP (by prediction) or \fIesp-r\fP (if
actual data is to hand). The contents of this file is then
used in preference to the default profiles. Note that \fIbps\fP
will override both mechanisms if a leakage and pressure
distribution
description is supplied to enable simultaneous heat and mass
flow calculations. In any event, thermostatic constraints,
as defined in a zone's operations file, will be applied so that
prescribed or predicted air flow may be modified as a function
of building temperatures or ambient conditions.
.IP \(bu
If a zone casual gain file does not exist, then the casual
gain profiles of the operations file are used. If such a
file does exist then the time-series data supplied is used
in addition to the operations file entries.
.IP \(bu
If a transparent multi-layered constructions file does not
exist then the simulation will proceed with all constructions
assumed opaque. If a file does
exist then the flagged constructions will be assumed transparent
so that capacity and short- and long-wave effects will be modelled
explicitly.
.LP
At any time after
completion of the mandatory file set for all zones, the
system configuration file is created. This, and the
configuration control file, are the only files passed to
\fIbps\fP at simulation time. Four other files can be
constructed by \fIesp-r\fP: the configuration leakage
distribution file defines the air flow leakage paths; the
pressure coefficients file holds a number of coefficient sets
which can be referenced by the previous file; the site
obstructions file contains the geometry of site obstructions
as required by \fIish\fP; and the perspective display file
contains the input geometry required by a separate
perspective program. All data, as input, is validated
before being output to disk file. In addition, \fIesp-r\fP offers area,
volume and surface orientation
checking as well as file editing and listing.
On entering \fIesp-r\fP, the first action is usually to
define the ESP-r databases for use in specifying the problem for simulation.
This allows the
event profiles database, both constructions
databases and the windows database to be assigned for access during zone
construction and operation
file creation. Zone profiles, constructions and windows can then
be defined by simple code number reference.
.LP
The required input data structures are detailed in the
sub-sections that follow. Disk file formats are also given
although this knowledge is not required by an \fIesp-r\fP
user since formatting is automatic.
.LP
\fINB.\fP During data preparation it is important to
sensibly simplify the problem in hand since end results are
often,
paradoxically perhaps, only weakly related to the
effort expended on setting up a configuration description.
As a simple rule, a moderately experienced user should
attempt to achieve the creation of the mandatory zone
file-set within about 30 minutes/zone: but the data must be
representative and be accurately entered (rubbish in,
rubbish out!). Some simplification ideas include: zone
combination to reduce the total number of zones for processing;
considering zones as rectilinear if they deviate only
slightly or if the boundary conditions are simple (for
example temperature only with negligible shortwave radiation
effects); the concatenation of several windows in the same
facade into a single window of equivalent area (of course
this is not possible if detailed shading/insolation
treatment is required); omitting vapour barriers in summer
overhearing assessment applications; omitting doors
completely when judged to have negligible impact;
simplifying casual gain and air flow profiles to eliminate
complexity whilst retaining underlying trends; and so on.
The acceptability of such simplifications will depend
entirely on the problem in hand, in terms of the accuracy
expectations and the range of performance measures required
from the simulation.
.LP
It should also be noted that ESP-r treats doors in a simplified
manner as pure resistances with no associated storage.  Thus
in a problem where doors form a significant proportion of the 
surface, they should be modelled more rigorously as multilayered
constructions.
.SH
1 General format of data files
.LP
File formatting is handled automatically by \fIesp-r\fP and,
with the exception of the shading/insolation file (binary
random access), all \fIesp-r\fP produced files are
ASCII, sequential files written in free format. This allows
entries to be placed without regard to exact positions on
the line and separated by a comma or spaces. For example
\fI2.3,6.7,9.11,1.5\fP or \fI2.3\  6.7\  9.11\  1.5\fP.
.LP
All data in ESP-r are expressed in \fISI\fP units with
the exception of air change rates which are expressed in
volume changes per hour ($hr sup -1$).
.bp
.SH
2 Zone geometry file (mandatory)
.LP
There are basically three mechanisms for defining zone
geometry. The first involves the creation, graphically, of
primitive polygons or volumes which can then be stored for
later concatenation to form the required shape. The second
involves plan digitizing, with extrusion to obtain the third
dimension. And the last involves the definition of body
topography and topology by specifying vertex coordinates and
giving an ordered list of the vertex numbers comprising each body
polygon. The last mechanism is the one offered by \fIesp-r\fP,
whilst the first two are offered as free-standing
programs outside ESP-r.
.LP
\fIesp-r\fP allows three levels of geometry data input:
corresponding to rectangular
(\fIREC\fP),
regular
(\fIREG\fP)
and general
(\fIGEN\fP)
shaped zones as follows
.IP "\fIREC\fP" 6
Each of the 4 zone walls are rectangular, vertical and of
equal height. The ceiling and floors are rectangular,
horizontal and of equal area.
.IP
An arbitrary site cartesian coordinate system is located so
that the x-axis points east, the y-axis north and the z-axis
vertically up. The x, y and z coordinates of the bottom
left-hand corner (when viewed from the south) are specified,
along with the length, DX, from the previous point along the
easternmost pointing side, width, DY, and internal floor to
ceiling height, DZ. Note that this definition allows
the `length' side to be less than the `width' side. The
orientation angle, DA, is also required. This is the angle
measured from due east (the x-axis) to the `length' side,
where anticlockwise is positive. Figure 1 summarises the
input requirements for this zone type.
.IP "\fIREG\fP" 6
Each of the zone walls are rectangular, vertical
and of equal height. Ceiling and floors are horizontal
polygons.
.IP
An arbitrary site cartesian coordinate system is located so
that the x-axis points in any convenient direction but with
the x-y plane horizontal. The following quantities are then
specified: the number of vertical walls bounding the zone,
the internal floor finish height (relative to the x-y
plane), the internal ceiling surface height and the x and y
coordinates of each zone corner vertex, commencing at any
vertex and proceeding anticlockwise when viewed from above.
The angle between the y-axis and north (anticlockwise
positive) is also required to
permit surface orientation determination. Figure 2
summarises the input requirements for this zone type.
.IP "\fIGEN\fP" 6
Any polyhedral zone bounded by planar polygons.
.IP
An arbitrary site cartesian coordinate system is located so
that the x-axis points in any convenient direction but with
the x-y plane horizontal. Relative to this is specified the
total number of vertices comprising the zone, the total
number of bounding surfaces, the x, y and z coordinates of
each vertex (in any convenient order), the number of
vertices comprising each surface and their anticlockwise order
when viewed
from outside the zone. The angle between the y-axis and
north (anticlockwise positive) is then given to allow
surface orientation computation.
.\".IP
.\"On selection of the \fIGEN\fP shape type a further sub-shape
.\"is requested. Five options are active as follows.
.\".IP
.\"\fIUSR\fP allows keyboard entry of the body topography and
.\"topology as previously defined.
.\".IP
.\"\fISTn\fP, where n=1,2,3 or 4 are standard shapes which can be entered
.\"by minimum keyboard inputs. On selection the user is prompted for
.\"certain dimensional data. This is then transformed, by software, to
.\"the \fIGEN\fP format.
.IP
Figure 3 summarises the
input requirements for the \fIGEN\fP zone type.
.\"and shows the zone shapes
.\"and data requirements of the four sub-shapes.
.LP
To ease the input burden, it is desirable to simplify zone
geometry as far as is allowed by the simulation objectives.
For the same reason, it is also possible to change coordinate
systems between zones, specifying each zone relative to
a local coordinate system as though the other zones did
not exist.
For example, by considering all zones
as type REC and located at the origin of a single
coordinate system, the time required to specify zone
geometry is reduced to less than a minute per zone.
However, if this option is taken, it is then
not possible to conduct a shading analysis, or to produce
perspective views if required, since no information is available on
relative position.
.LP
Zone window and door geometry is described relative to a
local $x sup ' - z sup '$ coordinate system located in the
plane of the surface to which the window or door is
attached. The $x sup '$, $z sup '$, $DX sup '$ (width) and $DZ sup '$
(height) dimensions (as shown in figures 1 through 3)
are required for windows and the $x sup '$, $DX sup '$ and
$DZ sup '$ dimensions for doors.
With a REC zone, the origin of this local coordinate system
is situated at the bottom left-hand corner of each vertical
wall (when viewed from outside the zone), the $x sup '$-axis
extends along the length of the wall and in its
plane, and the $z sup '$-axis is at right angles extending
along the height. For the horizontal ceiling and floor, the
$x sup ' - z sup '$ coordinate system origin
is located at the zone origin x, y and z
coordinate with the $x sup '$-axis extending towards the
next face vertex located anticlockwise when viewed from above
(ceiling) or below (floor).
With REG zones, the origin or wall coordinate systems are
located as with type REC. For the horizontal ceiling and
floor, the origin is located at the x and y coordinate
of the first defined wall corner in the REG specification,
with the axes extending as with a REC.
With GEN zones, the origin of
.ul 1
each
surface local coordinate system is located at the first
vertex (in the ordered face list), with the $x sup '$-axis
extending coplanar with the face and passing through the
second vertex. The $z sup '$-axis is then placed at right
angles to the $x sup '$-axis and pointing in the direction of
the third vertex.
.LP
The following table lists the contents of each record as held within
the zone geometry file (normally called ?.geo).
.sp
.ce
Table 1 The contents of a zone \fIgeometry\fP file.
.sp
.TS H
box center expand;
l c
l lw(4.5i).
Record	Description of fields
_
.TH
1	T{
Zone shape type (\fIREC\fP, \fIREG\fP or \fIGEN\fP)
T}
2 for \fIREC\fP	T{
x,y & z coordinate of bottom left-hand corner, length,
width, height and angle of orientation.
T}
2/1 for \fIREG\fP	T{
Number of vertical walls, floor height, ceiling height and axes
rotation angle.
T}
2/2 for \fIREG\fP	T{
x & y coordinates of each base corner vertex in
anticlockwise order when viewed from above.
T}
2/1 for \fIGEN\fP	T{
Total number of vertices comprising zone, number of bounding
surfaces and axes rotation angle.
T}
2/2 for \fIGEN\fP	T{
x,y & z coordinates of each vertex in any convenient order.
T}
2/3 for \fIGEN\fP	T{
For the first surface, the number of vertices and an
anticlockwise description of
each as seen from outside the zone.
T}
2/4 for \fIGEN\fP	T{
Repeat 2/3 for surface 2 .....
T}
2/N for \fIGEN\fP	T{
and continue until last surface.
T}
3	T{
Number of windows in each surface.
T}
4/1	T{
For first surface with windows, the $x sup '$ &
$z sup '$ coordinates of bottom left-hand corner, width and
height for each window in turn.
T}
4/2	T{
Repeat for next surface with windows .....
T}
4/?	T{
and continue until last window surface.
T}
5	T{
Number of doors in each surface.
T}
6/1	T{
For first surface with doors, the $x sup '$ coordinate of
bottom left-hand corner, width and height for each door in
turn.
T}
6/2	T{
Repeat for next surface with doors .....
T}
6/?	T{
and continue until last door surface.
T}
7	T{
Default insolation scheme: number of internal surfaces to
receive direct radiation [1,2 or all(3)], surface 1 number
(for 1 or 2 receiving), surface 2 number (for 2 receiving)
and surface with windows receiving [0(no surface) or receiving
surface 1 or 2].
T}
.TE
.sp 0.5
.ce
Table 1  Contents of a zone \fIgeometry\fP file.
.sp 0.5
.LP
Note the contents of record 7: this contains a default insolation scheme
to be used throughout a simulation in the absence of detailed
insolation time-series data generated by \fIish\fP and
located in the zone shading/insolation file.
Firstly, the number of internal zone surfaces which will
share (receive) direct solar radiation penetrating zone
windows must be defined.
To the question,
.ul 1
\ `Number of insolated surfaces?',
the following replies are permitted.
.IP "1:" 4
Means that only one internal surface will receive window
transmitted shortwave radiation. For example, if the zone
represents
a solar collector, the receiving surface would be defined as
the collector back plate. There is then no need to utilise
\fIish\fP.
.IP "2:" 4
Means that the incoming radiation will be split between two
internal surfaces on the basis of simple area
weighting. This is the appropriate choice for most building
zones where simultaneous floor and wall insolation often
occurs. Note that if more than one wall is insolated then it
is necessary to invoke \fIish\fP.
.IP "3:" 4
Means that the incoming radiation will be apportioned
between all internal surfaces; that is, treated diffusely.
This is an appropriate option in the case of translucent
window coverings or diffusing direct gain devices in
a passive solar design.
.LP
In the case of one or two insolated planes, their reference
numbers are requested and the user is asked whether or not
any windows in those surfaces should receive their share of
the impinging radiation. If they do, then some of the
incoming radiation will be re-transmitted to another zone or
back to outside depending on the window's exposure. In the
case of diffuse treatment, any windows in an insolated
surface will be treated in this way. Note that the
insolation data (in default form or as held in the
shading/insolation file) merely serves to direct the point of
application of the directly transmitted window radiation up
to first reflection.  The subsequent processing of the
reflected flux and the initially transmitted diffuse beam is
handled automatically by \fIbps\fP. The following table shows some
example default insolation set-ups.
.sp
.TS
box center expand;
c c
c lw(4.5i).
Default insolation data	Meaning
_
1,6,0,0	T{
Default plane is opaque portion of surface 6.
T}
1,6,0,6	T{
Default plane is opaque \fIand\fP transparent portions of
surface 6.
T}
2,6,3,3	T{
Opaque portion of surfaces 6 and 3 are insolated plus the
transparent portion of
surface 3.
T}
2,6,3,-1	T{
As last case but with transparent portions of both surfaces
(6 and 3) insolated.
T}
2,6,3,0	T{
As last case but with transparent portion excluded.
T}
3,0,0,0	T{
Direct beam treated diffusely so that all internal surfaces
are insolated
T}
.TE
.sp 0.5
.ce
Table 2  Example default insolation plane definitions.
.sp 0.5
.LP
\fIIn specifying zone coordinates all quantities relate to
internal dimensions\fP. This forms a wireline skeleton from
which internal surface areas, contained volumes and surface
orientations can be deduced. The multilayered constructions
of the zone
construction file are then superimposed on this skeleton.
ESP-r adopts the following surface numbering scheme.
This is the mechanism by which surfaces are referenced
during problem definition and results recovery.
.IP "REC" 5 
zones have six surfaces numbered as follows:
1 is the first vertical wall, encountered anticlockwise from
the origin point;
2, 3 & 4 are the three following vertical walls, anticlockwise from
the first;
5 is the horizontal ceiling;
and 6 is the horizontal floor.
.IP "REG" 5
zones have N surfaces numbered as follows:
1 is the first vertical wall, encountered anticlockwise from
vertex 1 as defined at input time;
2 to N-2 are the following vertical walls, anticlockwise
from the first;
N-1 is the horizontal ceiling; and N is the horizontal
floor.
.IP "GEN" 5
zones have N surfaces where
.\", in the case of the USR sub-shape,
the order is defined by the user.
It is advisable to adopt the convention that all walls
are defined first in anticlockwise (when viewed from above)
order commencing at the
southernmost facing wall, followed by the ceiling/roof and,
lastly, the floor.
.\"For the other sub-shapes, figure 3 shows the surface numbering scheme.
.LP
In reply to \fIesp-r\fP's promptings a few points should be
remembered:
.IP \(bu
Zone geometry is defined relative to some arbitrary site cartesian
coordinate system. Windows and doors are defined relative to a local
coordinate system located in the plane of the surface to which the window
or door belongs.
.IP \(bu
\fIThe orientation angle of a REC zone defines the zone's orientation
relative to east.
The rotation angles of the other two shape types
are specified relative to north and are there to allow coordinate
specification relative to some convenience coordinate system, with
subsequent rotations giving final topography\fP. See above for
angle definitions.
.IP \(bu
The default insolation data is only used if more detailed time-series
insolation data is not made available via \fIish\fP. The availability
of such data is indicated by the setting of a corresponding flag in
the zone utilities file.
.LP
Figures 1 through 3 demonstrate the surface numbering
scheme for the three zone shape types and Figure 4 shows
an example zone geometry file.
.KF
.sp
.ML
.ps 6
.vs 7
.so /usr/esru/esp-r/training/simple/zones/reception.geo
.ps
.vs
.ES
.MT
.sp 0.5
.LP
Figure 4  Example zone \fIgeometry\fR file listing.
.sp 0.5
.KE
.bp
.SH
3 Zone construction file (mandatory)
.LP
The following table lists the contents of a zone
construction file (usually held as ?.con).
.sp
.TS H
box center;
l cw(4.5i)
l lw(4.5i).
Record	Description of fields
_
.TH
1/1 $->$ 	T{
For each surface in turn, the construction is defined
in terms of the total number of homogeneous
elements (including air gaps)
and, separately, the number of air gaps.
T}
\ \ 1/N	T{
Repeating 1/1 for each surface in turn.
T}
2/1 $->$	T{
The position (an integer count from outside) and overall thermal resistance
of each air gap in first construction with air gaps.
T}
\ \ 2/N	T{
Repeating 2/1 for all constructions with air gaps.
T}
3/1 $->$	T{
For each element in surface 1: conductivity, density,
specific heat and thickness; outside to inside order. For
air gaps, only thickness is held, all other properties being
set to zero.
T}
\ \ 3/N	T{
Repeat 3/1 for all other constructions.
T}
4/1 $->$	T{
Window thermophysical properties for each window in turn
in first surface with windows. Properties include shortwave
direct transmittance and total transmittance for each of 5
angles of incidence. The window U-value is also held.
T}
\ \ 4/N	T{
Repeat 4/1 for all other surfaces with windows.
T}
5/1 $->$	T{
Thermal transmittance value (U-value) for each door in first
surface with doors.
T}
\ \ 5/N	T{
Repeat 5/1 for all other surfaces with doors.
T}
6	T{
Internal surface emissivity for each construction, then
external surface emissivity.
T}
7	T{
Internal surface solar absorptivity for each construction,
then external surface solar absorptivity.
T}
.TE
.sp 0.5
.ce
Table 3  Contents of a zone \fIconstruction\fP file.
.sp 0.5
.LP
In use \fIesp-r\fP allows pre-defined constructions to be
extracted from the multilayered constructions database for
re-location in the zone construction file. In this case the
number of homogeneous elements and air gaps, their relative
positions, the data on thermophysical properties, and the
surface finishes are all defined by the typing of a single
coded database reference. Specifying a zone's construction
is then very simple. It is also possible to mix the database
facility with manual input so that some constructions are
defined by multilayered database reference, some are built
up element-by-element by primitives' database reference, and
some are created by inputing the thermophysical properties for
each homogeneous element.
.LP
In the same manner windows can be specified by
giving index values which are coded pointers to a windows
database where the incidence angle dependent, spectrally
integrated values of solar transmittance, absorptance and
reflectance are held, along with standard U-values.
.LP
In reply to \fIesp-r\fP's prompting, a few points should be
remembered:
.IP \(bu
All units are S.I. which means that construction thicknesses
are given in metres.
.IP \(bu
Each data item has a corresponding default value as detailed
in the on-line tutorial, which also describes the use of this facility.
.IP \(bu
The total number of homogeneous elements comprising a
construction includes any air gaps. Note that the number of
air gaps is then specified separately.
.IP \(bu
Air gap thermal resistances are combined
convective/radiative values and will represent cavity
conditions. The appendix gives some typical design values.
.IP \(bu
When entering construction thermophysical properties
directly at the terminal - that is, neither constructions'
database is being used - the appropriate entry for an air
gap is
0,0,0,x ; where x is the air gap thickness.
.IP \(bu
The window indices are simply pointers to the windows'
database managed by \fIwin\fP. \fIesp-r\fP will
access this database to recover, for each window type, the
required thermophysical properties.
.IP \(bu
Surface emissivity and solar absorptivity values are
spectrally integrated and, in the case of absorptivity, are
assumed to be independent of incidence angle.
.TS
box center;
lbw(5.5i).
T{
During zone construction file creation
it is normal to refer to the materials and
composite constructions' databases. The former database is
named with a .materialdb ending and the latter will have a name assigned by the
user at the time of its creation. An optics' database can
also be accessed. These tend to be named optics.???.
These databases names are held in the model configuration file and
scanned prior to commencing zone construction file creation or
editing.
T}
.TE
.LP
Figure 5 shows an example listing of a zone \fIconstructions\fR file.
.sp
.ML
.ps 5
.vs 6
.so /usr/esru/esp-r/training/simple/zones/reception.con
.ps
.vs
.ES
.MT
.sp 0.5
.LP
Figure 5  Example zone \fIconstructions\fR file listing.
.sp 0.5
.bp
.SH
4 Zone operation file (mandatory)
.LP
The following table lists the contents of each record of a
zone operation file (usually held as ?.opr).
.sp
.TS H
box center;
lw(1i) cw(4.5i)
lw(1i) lw(4.5i).
Record	Description of fields
_
.TH
1	T{
Zone character descriptor.
T}
2	T{
Control index (see following text), lower and
upper control temperatures (or wind speeds if index is 4, -4 or
-14).
T}
3	T{
lower infiltration air change rate, zone-coupled air change rate
and coupled zone definition (2 data items, say d1 and
d2 - see following text) as required (depends on index).
T}
4	T{
upper infiltration air change rate, zone-coupled air change rate
and coupled zone definition (2 data items, say d1 and
d2 - see following text) as required (depends on index).
T}
5	T{
Default air flow scheme (records 3 and 4): number of
distinct intervals within a typical weekday .....
T}
6/1 $->$	T{
then for each interval, the start time, finish time,
infiltration air change rate, zone-coupled air change rate
and coupled zone definition (2 data items, say d1 and
d2 - see following text).
T}
\ \ 6/N
7 & 8	T{
As 5 & 6 but for a typical Saturday.
T}
9 & 10	T{
As 5 & 6 but for a typical Sunday.
T}
11	T{
Default casual heat gain scheme (records 9 and 10): number
of distinct intervals within a typical weekday .....
T}
12/1 $->$	T{
then for each interval: the gain type, the start time, finish time,
sensible heat gain, latent heat gain, radiant component and
convective component.
T}
\ \ 12/N
13 & 14	T{
As 11 & 12 but for a typical Saturday.
T}
15 & 16	T{
As 11 & 12 but for a typical Sunday.
T}
.TE
.sp 0.5
.ce
Table 4  Contents of a zone \fIoperation\fP file.
.sp 0.5
.LP
At an early stage in design, it is usual to operate on the
basis of design air flow and casual gain profiles as held in
the zone operation file. As the design evolves, and more
information becomes available on site conditions and
constructional details, it is possible to override these
profiles by data placed in a zone casual gain or air flow
file. In the latter case the time-series data may be
obtained by simulation using \fImfs\fP. If even greater
accuracy is required, a description of leakage and pressure
distribution
can be created so that energy and mass balance can be
pursued simultaneously by \fIbps\fP.
.LP
In constructing a zone operation file, the following points
should be noted.
.IP \(bu
Thermostatic constraints can be imposed on zone air flows.
An integer index controls the type of constraint as follows.
.IP
\fI0\fP indicates that no thermostatic control is active so that
the default profiles will prevail irrespective of zone or
incoming air temperatures.
.IP
\fI1\fP indicates that both infiltration and zone-coupled air
flow will be controlled on the basis of tests applied to the
temperature of the zone air.
.IP
\fI2\fP indicates that both infiltration and zone-coupled air
flow will be controlled on the basis of tests applied to the
temperature of the coupled zone air.
.IP
\fI3\fP indicates that both infiltration and zone-coupled
air flow will be controlled on the basis of tests applied to
outside air temperature.
.IP
\fI4\fP indicates that both infiltration and zone-coupled
air flow will be controlled on the basis of tests applied to
the outside wind speed.
.IP
\fI-1\fP, \fI-2\fP, \fI-3\fP and \fI-4\fP are the same as \fI1\fP, \fI2\fP,
\fI3\fP and \fI4\fP respectively
but control is imposed only on the zone-coupled
air flow, with infiltration uncontrolled.
.IP
\fI-11\fP, \fI-12\fP, \fI-13\fP and \fI-14\fP are the same as \fI1\fP,
\fI2\fP, \fI3\fP and \fI4\fP respectively but control is
imposed only on zone infiltration, with zone-coupled air
flow uncontrolled.
.IP
This allows air flow to be controlled on the basis of
time-dependent zone air temperatures or ambient conditions.
The lower and upper temperature limits
define the range within which the
specified air flow is \fION\fP. Outside this range the
appropriate substitute air flow information is assumed
as supplied by the user.
.IP
Index values 4 and -4 allow zone air flow to be
controlled on the basis of the prevailing wind speed as
follows. Note that in this case the upper and lower control
temperatures become upper and lower control wind speeds.
.IP
\fI4\fP indicates that both infiltration and zone-coupled
air flows will have a magnitude
arrived at by linear interpolation between the
stated upper and lower ambient wind speed values. If the
wind speed is greater than, or equal to, the upper value then
the user-assigned air change magnitudes prevail. If the wind speed is
equal to, or less than, the lower value then the air flows
are set to zero. No information is then taken from the
corresponding zone operations file.
.IP
\fI-4\fP is as \fI4\fP but only infiltration is affected.
.IP \(bu
A distinct interval is an interval of time during which
air flow or casual gain regimes remain essentially
constant. Start and finish times are expressed as decimal hour
values lying between 0 and 24 inclusive. An interval is deemed to
finish at the specified finish time but to start at the future
time-row of the first computational time-step after the
start time. This strategy gives the correct number of operational hours.
The actual start time will therefore depend on
the time-step size used at simulation time.
.IP \(bu
All air change rates are specified relative to the volume of the zone
in question. In the case of zone-coupled flow, the direction is from
the coupled zone to the zone for which the zone operations file is
being created.
.IP \(bu
If zone-coupled air flow is active then the coupled zone
must be referenced. Two data items are required to do this;
say $d sub 1$ and $d sub 2$. If $d sub 1$ is set to a positive integer
then this is taken to be the code number of the
coupled zone; as assigned to that zone in the
system configuration
file (see Section 8) to uniquely identify it. In this case $d sub 2$ is
not required. If, on the other hand, $d sub 1$ is set to 0 then
this implies that the incoming air is at the constant
temperature of $d sub 2$\(deC. All a user need do is to inform \fIesp-r\fP
that zone-coupling exists, defining the
coupled zone by giving its code number. If this is zero then
the source air temperature will be requested.
.IP \(bu
When defining an air flow or casual gain regime without
making reference to the event profiles database, it is first
necessary to estimate the number of distinct intervals which
comprise the profile. This is done automatically when using
database extraction. For example, consider the two casual
gain profiles of figure 6: after decomposition, some 20
distinct casual gains must be entered to \fIesp-r\fP. Note
that gains for different sources, if they exhibit different
convective/radiant splits, must be treated separately.
The radiant/convective portions will normally sum to
unity, but need not, as with the case of a ventilated lighting
fitting (remember the gain is defined relative to the zone
not the source).
.IP \(bu
Each casual gain must be assigned an integer type index in addition to
the data describing its time of operation and heat gain characteristics.
The requested type index will have one of the following values: 1 for occupants;
2 for lights; 3 for equipment.
.IP
In the case of occupants, the heat gain is a function of the activity level.
For example, for sedentary activity the metabolic rate is approximately
58 Watts per square metre (1 MET). In the case of jogging, this will rise to
about 8 METS. An average person is of the order of 1.7 square metres
of surface area.
.IP
In addition, each of these indices may be negated. In this case
the corresponding heat gain may be specified in units other than Watts.
With occupants, the unit is floor area per person, each person
emitting 95 Watts sensible, 45 Watts latent. With
lights and equipment, the unit is Watts per square metre. 
.LP
Figure 6 shows an example zone
operation file (note that there is
no thermostatic control on air flow).
.KF
.sp
.ML
.so /usr/esru/esp-r/training/simple/zones/reception.opr
.ES
.MT
.sp 0.5
.LP
Figure 6  Example zone \fIoperations\fR file listing.
.sp 0.5
.KE
.LP
There are several standard profiles within the profiles' database,
devised to cover a wide range of occupancy, lighting
and equipment usage.
These profiles can be used directly or modified as required.
The profiles are as follows.
.IP 1.
100% Continuous.
This is the simplest case of 24 hour behaviour.
.IP 2.
Normal working day profile.
The heat source operates at its 100% level from 7h00 to 18h00.
.IP 3.
Late night working.
As profile 2 but with the off time later at 21h00.
.IP 4.
Typical office operation.
100% level is from 9h00 to 12h00 and 14h00 to 17h00, with a reduced
level between 7h00 and 9h00 and between 12h00 and 14h00.
.IP 5.
Late night office operation. 
As profile 4 but with a full load extension to 21h00.
.IP 6.
Typical factory operation.
Two full load periods each of four hours duration with a reduced
lunch-time and overnight load.
.IP 7.
In term school operation.
the load increases rapidly at 9h00, falls markedly
at lunch-time and terminates at 16h00.
.IP 8.
As profile 7 but with evening activity.
.IP 9.
Domestic evening case.
.IP 10.
Domestic, working household case.
.IP 11.
Domestic, day-time occupancy case.
.IP 12.
Hospital ward operation.
Low night-time load, rising during the day to a maximum during visiting hours.
.LP
The profiles database is managed via the program \fIpro\fP from
which profile graphs can be obtained.
.bp
.SH
5 Zone utilities file (no longer used)
.LP
This file contains a series of flags to indicate the
existence of one or more of the optional zone files. In each
case 1 means that the file exists, 0 that it does not.
If a file is flagged to exist then its name is also held.
The following table lists the contents of the zone utilities
file (usually named ?.utl).
.sp
.TS H
box center;
l cw(3.5i)
l lw(3.5i).
Record	Description of fields
_
.TH
1	T{
Zone air flow file flag.
T}
2	T{
Air flow file name if flag=1.
T}
3	T{
Zone casual gains file flag.
T}
4	T{
Casual gains file name if flag=1.
T}
5	T{
Zone view factor file flag.
T}
6	T{
View factor file name if flag=1.
T}
7	T{
Zone shading/insolation file flag.
T}
8	T{
Shading/insolation file name if flag=1
T}
9	T{
Zone convection coefficient file flag.
T}
10	T{
Convection coefficient file name if flag=1.
T}
11	T{
Zone blind/shutter file flag.
T}
12	T{
Blind/shutter file name if flag=1.
T}
13	T{
Zone transparent multi-layered construction file flag.
T}
14	T{
Transparent multi-layered construction file name if flag=1
T}
15	T{
Zone casual gain control file flag.
T}
16	T{
Casual gain control file name if flag=1
T}
17	T{
Zone domain flow file flag.
T}
18	T{
Domain flow file name if flag=1
T}
.TE
.sp 0.5
.ce
Table 5  Contents of a zone \fIutilities\fP file.
.sp 0.5
.\".LP
.\"When giving the zone file names (if they exist) it is
.\"advisable to specify the complete file address including any
.\"sub-directory paths as appropriate. This will ensure that
.\"the files can be recovered by \fIbps\fP even if
.\"simulations are performed from another disk area.
.\".LP
.\"Figure 7 shows a typical zone \fIutility\fR file listing.
.\".KF
.\".sp
.\".ML
.\".so /usr/esru/esp-r/training/simple/zones/reception.utl
.\".ES
.\".MT
.\".sp 0.5
.\".LP
.\"Figure 7  Typical zone \fIutility\fR file listing.
.\".sp 0.5
.\".KE
.bp
.SH
5.1 Zone shading/ insolation file (optional)
.LP
\fIBps\fP is designed to use time-series shading/insolation
(S/I) information extracted from the zone S/I file,
if one exists. This allows the accurate modelling of the
point of injection of the solar beam impinging on external
and internal surfaces. The S/I file is a binary, random
access, unformatted file of variable length records
containing the following data.
.IP \(bu
Hourly time-series of external opaque and transparent,
direct beam, surface shading factors (0 to 1)
for any user-specified surface, as caused by facade and/or
surrounding obstructions.
.IP \(bu
And/or the hourly time-series of internal opaque and
transparent surface insolation
to result from direct solar penetration through
user-specified windows. This data is held separately for
each
.ul 1
external window/receiving internal surface
combination.
.LP
In an attempt to restrict file size - a 10 sided zone with 5
windows would require 6Mbytes to hold the time-series
data for 1 year! - the data is held only for user-specified
surfaces.
Also, the hourly data is only retained for each
sun-up hour within that day of each month which possesses a
solar declination judged to be closest to the average value
for the month. This means that a whole year is represented
by 12 sets of surface shading/insolation data; a mechanism
which retains reasonable accuracy but greatly reduces disk
space demands. In the absence of a S/I file, or if the S/I
file does not contain data for the period or surface under
consideration, then \fIbps\fP will default to zero external
surface shading. The window transmitted radiation is then
internally apportioned as a function of the default
insolation scheme held in the zone geometry file.
.LP
A zone S/I file can be created via \fIesp-r\fP.
In this case any shading and/or insolation data is
entered manually for the surfaces and months of
interest. Alternatively, \fIish\fP can be
used to predict external shading and internal insolation
and to build the S/I file piecemeal over time.
.LP
Building surfaces which are self-shaded - that is face in a
direction \fIaway\fP from the sun - need not be
considered since this occurrence is handled automatically by
\fIbps\fP. 
However, shading by adjacent zones is not automatically taken into account,
and in this case the shading factors need to be calculated by setting up
the adjacent zones as obstruction blocks and running \fIish\fP.
Note also that window blinds are not treated as shading
devices but are specified by means of a zone \fIblind/shutter control\fP file
(in the case of default window treatment)
or a zone \fItransparent multi-layer constructions\fP file (if windows
are modelled explicitly).
.bp
.SH
5.2 Zone blind/ shutter control file (no longer used)
.LP
This file (usually named ?.bld) allows window solar coverings or insulating
devices to be controlled as a function of time, solar
intensity or ambient temperature. File contents are itemised in
the following table.
.sp
.TS H
box center expand;
l cw(4.5i)
l lw(4.5i).
Record	Description of fields
_
.TH
1	T{
Number of distinct control intervals during a day.
T}
	T{
Also the surface number of the radiation sensor (if one exists).
T}
2	T{
Start and finish hours for the first interval.
T}
3 *	T{
For first interval: replacement shortwave direct 
transmittance for 5 angles of incidence and visible transmittance.
T}
4 *	T{
replacement total transmittance for 5 angles of incidence and U-value.
T}
5	T{
control index and activation point for first period.
T}
6 $->$	T{
Repeat records 2 - 5 for each additional control interval.
T}
_
.T&
l s.
T{
* Note that the window properties may define a window
arrangement which has a blind
or shutter in place. In this case the zone construction file
will point to the uncovered window case. Conversely, the
role of the two zone files can be reversed.
T}
.TE
.sp 0.5
.ce
Table 6  Contents of a zone \fIblind/shutter control\fP file.
.sp 0.5
.LP
A day period is firstly divided into a number of distinct
intervals which may or may not span the complete day. Then,
for each interval, a window is defined which will be
accepted only if the
.ul
total
radiation intensity (direct + diffuse impinging on the
window's facade after shading adjustments on the direct component) 
or ambient temperature, is greater than the specified
actuation point defined in $W m sup -2$
or \(deC respectively. The control index
is used to select the control variable type (radiation; 0 or temperature; 1).
By setting the
actuation point at -99, the window device can be forced to
operate for the entire interval regardless of solar
intensity or temperature magnitudes. 
In the case of radiation control of the blind/shutter, the surface
on which the radiation sensor is situated can be specified, and the 
operation of all external windows in the zone will then depend on 
the radiation intensity on that one surface.  
If the sensor surface is set to \fIzero\fP, then
each external surface containing windows is treated separately; 
only windows in those surfaces receiving greater than the 
specified radiation limit will inherit the replacement properties.
.LP
Internal windows can be assigned the replacement properties if the
U-value is specified as a negative quantity. To avoid inconsistency,
it is necessary in this case to ensure that
adjacent zones are given the same set of replacement properties 
and that they have the same control settings.  Note that it is
possible to set all internal and external window properties to be
modified during a control period by specifying both a negative replacement
U-value and a control value of -99.
.LP
The specified control scheme relates to
each external window in a zone but that, at any point in
time, different window arrangements may be in place depending on the
incident radiation levels. If it is necessary to impose more
than one control scheme on a zone, it will first be
necessary to introduce additional zoning so that each
sub-zone can still possess a unique window control file. As with
zone event profile definition, an interval is deemed to
finish at the specified finish hour but to commence at the
future time-row of the first computational time-step
following the specified start hour. The start time will
therefore depend on the simulation time-step.
.LP
Figure 8 shows a typical \fIblind/shutter control\fR file listing.
.sp
.ps 8
.vs 9
.TS
box center;
c c | c c
c l | c l.
Record	Contents
_
1	2,  0,	6	15, 18,
2	9, 12,	7	0.80, 0.70, 0.60, 0.50, 0.40, 0.6
3	0.70, 0.60, 0.50, 0.40, 0.30, 0.5,	8	0.83, 0.73, 0.63, 0.53, 0.43, 2.00,
4	0.73, 0.63, 0.53, 0.43, 0.33, 2.5,	9	1, 100.0,
5	0, -99.0,
.TE
.ps
.vs
.MT
.sp 0.5
.ce
Figure 8  Typical \fIblind/shutter control\fR file listing.
.bp
.SH
5.3 Zone view factor file (optional)
.LP
This file allows the transfer of diffuse view factor
information to \fIbps\fP, where it is used to improve the
accuracy of the inter-surface longwave radiation exchange
calculations. In the absence of such information \fIbps\fP
generates approximate view factors on the basis of simple
area weighting techniques.
.LP
Table 7 details the contents of this zone file (usually named ?.mrt) which can be
constructed manually via \fIesp-r\fP or by calculation via \fImrt\fP.
.sp
.TS H
box center;
l cw(3i)
l lw(3i).
Record	Description of fields
_
.TH
1	T{
Total number of bounding surfaces.
T}
2	T{
Diffuse view factor for each surface pairing (1 to 1,
1 to 2, 1 to 3, 1 to .... ; 2 to 1, 2 to 2, etc)
T}
.TE
.sp 0.5
.ce
Table 7  Contents of a zone \fIview factor\fP file.
.LP
In many applications the use of \fImrt\fP cannot be
justified since the established geometry may not accurately
represent the final design, or the positioning of zone
contents may substantially modify the longwave exchanges.
This facility should therefore only be invoked when high
accuracy is required and the zone geometry is correctly
described; for example in the modelling of a Trombe wall in
a passive solar scheme, where longwave exchanges can be a
principal heat flow path. Of course it can be routinely
invoked if a zone's geometry is carefully defined.
.bp
.SH
5.4 Zone air flow file (optional)
.LP
This file (usually named ?.air) contains infiltration
and zone-coupled air flow
data which will be used to replace the default air flow scheme
of the corresponding zone operation file. The facility is
extremely useful for program validation exercises since
measured air flow vectors can be treated as input to
eliminate the high uncertainty often associated with air
flow simulation. It also facilitates design research studies
in which a number of guesstimated air flow regimes are to be
studied in an attempt to gain performance insight and so
generate a robust design solution. Note that ESP-r offers
air flow simulation. In this case a description of the
building's leakage and pressure distribution is created via
\fIesp-r\fP and transmitted to \fIbps\fP via the system
configuration file. The results of \fIbps\fP's air flow
simulation will then supersede the default air flow scheme
of the operation file
.ul 1
and
the time-series data of the zone air flow file, should one
exist. It follows therefore that if such an air flow
simulation is requested there is little point in creating a
zone air flow file. If the air flows are mostly pressure
induced and not buoyancy driven, it is possible to offer the
leakage and pressure distribution description to \fImfs\fP
instead of \fIbps\fP. The analysis of building air flow can
then be conducted independently of the energy analysis, with
the findings located in the zone air flow file for later use
by \fIbps\fP. \fIMfs\fP can automatically transfer its
predictions to the zone file. Alternatively, the
predictions can be taken for input to the zone file via \fIesp-r\fP.
The advantage of this approach is that the
predicted air flows can be characterised and fed to \fIbps\fP
in a simplified form. This will greatly reduce the
complexity of any energy simulation and so ease the
analysis burden when \fIres\fP is
used to investigate the results from \fIbps\fP.
.LP
Table 8 lists file contents (usually named ?.air).
.sp
.TS H
box center expand;
l cw(4.5i)
l lw(4.5i).
Record	Description of fields
_
.TH
1	T{
* Air Flow File (the first line \fImust\fP be identical to this).
T}
2	T{
For first simulation time-step: zone infiltration, then air
\fIreceived\fP by zone from each zone in configuration.
T}
4 $->$	T{
Repeat record 2 for each simulation time-step.
T}
.TE
.sp 0.5
.ce
Table 8  Contents of a zone \fIair flow\fP file.
.sp 0.5
.LP
All air flows are specified in air changes per hour ($hr sup -1$)
expressed relative to the volume of the zone to which
the file relates. The zone-coupling is given in order
1 to x, 2 to x, 3 to x etc, where x is the target zone
number; obviously x to x=0. It is
important that data exists for the correct number of
time-steps as will comprise the simulation, including the
start-up period. The first data record in the file (that is
record 2) will correspond to the future time-row of the
first simulation time-step; for example 02.00 hrs for a one
hour time-step and 01.10 hrs for a ten minute time-step.
Note that \fIbps\fP commences a simulation at 01.00 hrs -
the present time-row of the first time-step on the first
start-up day.
.bp
.SH
5.5 Zone casual gain file (optional)
.LP
This file is similar in function to the preceding air flow
file but with the filed casual gain entries acting to augment
the default profiles of the zone operation file. This allows
zone casual gains to vary from time-step to time-step as a
simulation progresses: a useful facility for generating zone
energy pulses in validation studies, or for accurately representing
process heat inputs in a finely focused design study. The file can only
be created via \fIesp-r\fP.
.LP
Table 9 lists file contents (usually named ?.cgn).
.sp
.TS H
box center expand;
l cw(4.5i)
l lw(4.5i).
Record	Description of fields
_
.TH
1	T{
* Casual Gains File (the first line \fImust\fP be identical to this).
T}
2	T{
For first simulation time-step: the total sensible convective,
sensible radiant and latent heat gains (all in Watts) for the zone.
T}
3 $->$	T{
Repeat record 2 for each simulation time-step.
T}
.TE
.sp 0.5
.ce
Table 9  Contents of a zone \fIcasual gain\fP file.
.sp 0.5
.LP
As with the air flow file it is important to ensure that the
number of records is matched to the number of simulation
time-steps. Section 5.4 explains \fIbps\fP's
assumptions in this respect.
.bp
.SH
5.6 Zone convection-calculation control file (optional)
.LP
This file is used to impose control over the surface convection
calculations performed by \fIbps\fP.
Three types of control may be imposed through this file, which is
in addition to the control that can be imposed using a simulation
toggle.
.LP
\fIType 1\fP allows fixed coefficients to be specified for
each surface (interior and exterior to the building).
A list of coefficients is given for each `inside' and `outside'
zone surface.
A -1 entry for any surface indicates that the result from \fIbps\fP's
buoyancy calculations (based on the simulation toggle) will be used,
i.e. no replacement value is offered.
.LP
\fIType 2\fP allows you to specify the correlation to use for
each surface (only applicable for surfaces interior to
the building).   This could allow, for example, the use
of the Alamdari & Hammond correlations for a wall,
while using one of the Khalifa & Marshall correlations
for a window.
A number of empirical correlations and fixed values,
extracted from the following sources, are supported:
.IP
Alamdari and Hammond (1983), `Improved Data
Correlations for Buoyancy-Driven Convection in Rooms`
BSER&T, 4(3) 106-12.
.IP
Khalifa and Marshall (1990), `Validation of Heat
Transfer Coefficients on Interior Building Surfaces
Using a Real-Sized Indoor Test Cell`, Int. J. Heat
and Mass Transfer, 33 (10) 2219-2236.
.IP
Halcrow (1987), `Heat Transfer at Internal Building
Surfaces`, Report to ETSU, British Department of
Energy.
.IP
CIBSE Guide (1988), 5th Edition, Table A3.4.
.IP
CEN (1995), `Thermal Performance of Buildings, Room
Cooling Load Calculation, General Criteria for a
Simplified Calculation Method`, CEN/TC89/WG6 N.225 /
JWG-N79, Section 6.2.2.
.LP
Each correlation is identified by an index.  Refer to
/usr/esru/src/esp-r/esrubld/convect.F, subroutine
HTBUOY, where the index numbers are assigned to ICOR.
A -1 indicates that a correlation will be chosen based
on the simulation toggle. Correlations chosen for
surfaces exterior to the building will be ignored.
.LP
\fIType 3\fP allows adaptive control of the calculations (only
applicable for surfaces interior to the building).
This method allows the convection calculations to
\fIadapt\fP as the simulation progresses.  You must assign
\fIcontrol law\fP for each interior surface, which
defines how the calculations will adapt. The following
control laws are available:
.IP
Law 1: two correlations specified for each surface;
one correlation used when plant is heating zone
(radiation or convection); other correlation used when
zone is unheated. Appropriate when plant system alters
convection regime within zone.
.LP
Adaptive control is only applicable for interior
building surfaces.
Control laws specified for exterior surfaces will be ignored.
As well, a control law specified for an `outside` surface
which faces the air-point of an adjacent zone will be ignored:
the law specified in the neighbouring zone will take precedence.
Specify law `99` in these cases where adaptive control
is not applicable.
.LP
A typical day is divided into a number of
distinct time intervals.  A different control type can be
prescribed for each time interval.
The following table lists the
file contents (usually named ?.htc).
.sp
.TS H
box center expand;
l cw(4.5i)
l lw(4.5i).
Record	Description of fields
_
.TH
1	T{
Number of distinct intervals.
T}
2	T{
Number of zone surfaces, \fIN\fP (must be the same as the
corresponding entry in the zone geometry file).
T}
3	T{
For the first interval: start and finish hours.
T}
4	T{
Calculation control type (1-3)
T}
_
If \fItype 1\fP control ....
_
5	T{
For the first interval: convection coefficient for each
internal surface.
T}
6	T{
For the first interval: convection coefficient for each
external surface.
T}
_
If \fItype 2\fP control ....
_
5	T{
For the first interval: correlation indices for each
internal surface.
T}
6	T{
For the first interval: correlation indices for each
external surface.
T}
_
If \fItype 3\fP control ....
_
5 $->$ 4+N	T{
For the first interval: eight data fields/surface, one record
for each surface.  The first and fifth fields identify the control
laws for the `inside' and `outside' surfaces, respectively.
Fields two to four are the associated data for the `inside' and
fields five to eight are the associated data for the `outside':
the significance is dependent on the control law.  For \fIlaw 1\fP,
fields two and six hold the correlation index to use when the heater
is on; fields three and seven hold the correlation index to use when
the heater is off; fields four and eight are unused.
T}
6 or N+1 $->$	T{
Repeat records 3.... for each subsequent interval.
T}
.TE
.sp 0.5
.ce
Table 10 Contents of a zone \fIconvection-calculation control\fP file.
.sp 0.5
.LP
As elsewhere in ESP-r, an interval is assumed to finish
at the defined finish hour but to start at the future
time-row of the first simulation time-step.
.bp
.SH
5.7 Zone transparent multi-layered constructions file (optional)
.LP
This file holds the spectrally integrated shortwave properties
for one or more zone multi-layered constructions comprising one or
more transparent elements. For each homogeneous element the incident angle
dependent absorptance is required. Then, for the combined
multi-layered construction the overall transmittance curve
is necessary.  The file also contains control information on any
blind/shutters that are associated with the transparent
multi-layered constructions, together with the requisite replacement
optical and thermophysical properties.
.LP
If zone windows are defined in the normal way (via a zone
geometry file) then no nodes are used to represent the
window layers. This means that window conduction is calculated from
.EQ C
q sub c~=~{theta sub o~-~theta sub i} over R
.EN
.LP
where $theta$ is air temperature, o and i refer to outside and
inside respectively, and R is the overall resistance at any time
as given by
.EQ C
R~=~1 over {h sub c~+~h sub r}
.EN
.LP
where $h sub c$ is the time dependent convection coefficient and
$h sub r$ is a fixed radiation coefficient determined from the
initially specified standard U-value (but remember that if the U-value
is negated then it is treated as being time invariant).
.LP
This conductive flux is applied at the zone air point. Therefore,
unlike multi-layered constructions,
windows are treated as resistance only, with an approximate treatment
of longwave radiation. Also, because no window node is present, it
is not possible to explicitly model shortwave absorption. Instead,
a technique is used which calculates, directly, that portion of the
absorbed shortwave flux which would be transmitted inward to the zone air
point.
.LP
The \fItransparent multi-layer facility\fP allows
windows to be treated with more precision. Now \fIall\fP surfaces
(including windows) bounding a zone are entered as multi-layered constructions, with
layers being declared transparent as appropriate. This means that windows
can now be assigned a nodal scheme so that convective, conductive
and longwave radiative exchanges are handled separately and
explicitly, with solar absorption treated in an exacting manner.
.LP
The following step-by-step procedure should be followed to
make use of the transparent multi-layered construction facility.
.IP "Step 1" 8
Define zone geometry
by entering \fIall\fP bounding surfaces whether
opaque or transparent. This will probably mean defining the
zone shape as GEN (or perhaps REG). There is now no need to define windows
separately so your response should be NO in reply to the
question, 'Are there any windows ?' (unless of course you
also wish to include windows handled in the default manner).
.IP "Step 2" 8
When defining zone constructions
simply define the transparent
multi-layered construction as if it were an opaque wall. That is
by defining the $k, ~rho , ~C sub p ~and ~delta x$ values for each layer.
.IP "Step 3" 8
Remember to create a zone utility file with the appropriate
flag set to indicate the presence of a zone transparent
multi-layered constructions file.
.IP "Step 4" 8
Create the zone transparent multi-layered constructions
file. The dialogue will go like this
.IP " " 8
\fINumber of surfaces in zone ?\fP
.IP " " 8
Answer by giving the number you input to the zone
geometry file.
.IP " " 8
\fITransparent multi-layered construction index for each surface ?\fP
.IP " " 8
If a surface is not transparent, enter 0. Otherwise enter a positive
integer which defines a set of properties which have yet to be entered by you.
For example, if there are six surfaces in the zone and the 2nd and 5th
are both transparent and of the same construction, then you would
enter 0 1 0 0 1 0. Alternatively if the two transparent constructions
were of different construction you would enter 0 1 0 0 2 0. In the first
case you will be asked for one set of properties, in the second case two.
.IP " " 8
In response to the following prompts, you must now enter the 
overall transmission curve (by giving the usual data for the 
5 angles of incidence) and the absorption
curve for each construction element (called a substrate). Note that
\fIbps\fP will check to ensure that
the number of substrates in this
file, and the number of elements in the constructions file, are the same.
.IP " " 8
\fIBlind/Shutter Control ?\fP
.IP " " 8
Answer 1 if there is control, 0 if not.
.IP " " 8
If the answer is 1 (yes), the program prompts for the number of
control periods, and then, for each control period, the details
of the control and the replacement properties (see below for
further discussion).
.IP "Step 5" 8
You are now ready to simulate using \fIbps\fP (of course
you must have created your zone
operations file, the system configuration file and, perhaps,
the configuration control file).
.LP
Table 10a details file contents (usually named ?.tmc).
.sp
.TS H
box center expand;
l c
l lw(5i).
Record	Description of fields
_
.TH
1	T{
Total number of multi-layered constructions in zone.
T}
2	T{
For each construction: an index stating whether or not
it is transparent (0 opaque; >0 transparent).
T}
3	T{
Number of elements (including air gap if any) of first 
transparent multi-layer construction (TMC).
T}
4/1 $->$	T{
For first TMC: direct transmittance at
5 angles of incidence; followed by the absorptance
for each element - outside to inside - in turn and again for
the 5 angles of incidence.
T}
\ \ 4/N	
5	T{
Control flag. If flag is zero then records 3 to 5
are repeated for each TMC.  If flag is 1 then the
file contains the following records 6 and 7.
T}
6	T{
Number of distinct control periods in a day.
T}
	T{
Also the surface number of the radiation sensor (if one exists).
T}
7/1	T{
Start and finish hours for the first period.
T}
7/2	T{
Sensor type and activation point for period 1.
T}
7/3 $->$	T{
Replacement optical properties: direct transmittance at
5 angles of incidence; followed by the absorptance
for each element - outside to inside - in turn and again for
the 5 angles of incidence.
T}
\ \ 7/N	
7/N+1	T{
Index to replacement thermophysical properties (zero if no replacement).
T}
7/N+2 $->$	T{
Replacement thermophysical properties read in here if index>0.
T}
\ \ 7/M
7/M+1 $->$	T{
Repeat 7/1 to 7/M for each control period.
T}
8 $->$	T{
Repeat records 3 to 7 for each TMC.
T}
.TE
.sp 0.5
.ce
Table 10a  Contents of a zone \fItransparent multi-layered constructions\fP file.
.sp 0.5
.LP
With regard to control, each TMC can be given a replacement set 
of transmission coefficients and absorptivities 
in each control period (maximum three/day). The TMCs are controlled 
independently, with the following control options:
.IP (i)
If the control variable is set to -99, then the blind/shutter is always ON
in the control period, irrespective of radiation or temperature levels; that
is, the control is on \fItime\fP only.
.IP (ii)
If the control sensor is temperature (type 1), then the blind/shutter will be ON 
whenever the external temperature exceeds the predefined level.
.IP (iii) 
If the control sensor is for radiation (type 0), then:
.RS
.IP a) 
if the external surface number is given, then the blind/shutter will be 
ON for each TMC for which the (shaded) radiation on the
specified external surface exceeds the predefined level for that TMC. 
This will simulate the case when there is a sensor on only one external 
surface.
.IP b) 
if the external surface number is not given (set to zero), then the
blind/shutter will be ON for each TMC for which the (shaded) radiation on the
external TMC surface exceeds the predefined level for that TMC.
This will simulate the case when each external TMC surface has a sensor.
.RE
.LP
In addition, it is possible to replace the thermophysical properties 
of the TMC. For each control period, an index points to an alternative
set of thermophysical properties from a construction in the
multi-constructional database. It is important that the number of 
elements in the replacement construction is the same as for the original
construction.  The replacement values are read in and stored in this file.
If the index is zero, the thermophysical properties are unchanged. 
.LP
Some points to remember:
.IP \(bu
The standard thermophysical properties of each element in the special
multi-layered construction are specified in the zone constructions
file as before.
.IP \(bu
The index of record 2, if positive, points to the set of
shortwave properties to be associated with a given construction.
This means that, for example, more than one transparent construction
can point to the same set of properties.  In this case, it will 
also inherit the same control periods and control settings.  
Conversely each construction can be associated with a unique set.
.IP \(bu
It is possible to mix transparent constructions and ordinary
windows in the same zone; it is even possible to have an
ordinary window within a TMC. This means that some glazing
systems will be treated exactly while others are processed
at the default level.
.LP
Figure 9 shows the typical contents of a TMC file.
.KF
.sp
.ML
.so /usr/esru/esp-r/training/simple/zones/reception.tmc
.ES
.MT
.sp 0.5
.LP
Figure 9  Typical zone \fITMC\fR file listing.
.sp 0.5
.KE
.bp
.SH
5.8 Zone casual gain control file
.LP
Beginning with version #6.4b of January 1987 ESP-r has provided a 
number of control schemes for casual gains which
represent artificial lighting.  ESP-r kept track of the daylighting 
contributions from all the exterior
windows in the zone and whether or not direct sunlight was
falling on each sensor.
.LP
ESP-r has traditionally made use of sensors located
at user-specified points, calculating the daylight factors
separately for each zone window.  Shortwave illumination
is included in the algorithm and the split flux
method used to assess the internal reflected component.
This is a typical engineering approach to the problem of predicting 
daylighting when insufficient information is available to allow a more 
explicit method.
.LP  
Over time these facilities have been
expanded and from Project Manager Version 2.9a (of April 1995)
the following are offered:
.IP \(sq
The user may define up to 4 lighting zones within a thermal
zone, each with up to 9 sensors. Each lighting zone then
represents an individual lighting system.
.IP \(sq
Vertical (unobstructed) and horizontal external illuminance 
sensors are available.
.IP \(sq
In the case of multiple lighting zones within a thermal
zone, an aggregate casual gain may be
obtained by summing the contributions from individual sensor/ gain
combinations or by determining the average of all sensors
controlling one lighting system.
.IP \(sq
The illuminance from adjacent rooms is derived via
ESP-r's shortwave radiation tracking procedures.  
This process is robust enough to take into account
the effect of blind opening/ closing on the daylighting in adjacent
rooms.
.IP \(sq
Provision has been made for user supplied daylight factor data to be
included in a casual gain control file.
.IP \(sq
A new option for coupling lighting and thermal simulation has
been introduced.  This feature supports both data file based
and concurrent application coupling between ESP-r and 
some separate lighting simulation environments.  At the
present time coupling with the
Radiance lighting simulation program is available.
.LP
The following table shows the contents of the zone casual gain control 
file (usually named ?.cgc). Currently this file has to be created via
text editing facilities. The \fIproject manager\fP editing facility is under
development.
.sp
.mT
.TS H
box center expand;
l cw(5.2i)
l lw(5.2i).
Line	Description of fields
_
.TH
1	T{
Identifier (three integer type numbers) of the casual gains to be 
controlled during Weekdays, Saturdays and Sundays. Default identifier
for casual gain from artificial lighting is "2".
T}
.sp 0.1
2	T{
Number (an integer type number) of distinct casual gain control 
periods during a typical day. Maximum three control periods currently
allowed.
T}
.sp 0.1
3	T{
For each control period in turn give the start hour (0-24) and 
finish hour (two integer type numbers) on separate lines.
T}
.sp 0.1
4	T{
Number (an integer type number) of lighting zones within this 
thermal zone. Maximum of four lighting zones allowed.
T}
.sp 0.1
5	T{
For each individual lighting zone:
T}
.sp 0.1
5.1	T{
Numbers (four real type numbers) indicating respectively: reference
light level (set point) (Lux), switch-off  light level
(-), minimum dimming light output (-) and switch-off delay time (-).
T}
.sp 0.1
5.2	T{
Percentage (a real type number) of total zone controlled casual gain 
associated with this lighting zone (-), number (an integer type number)
of internal illuminance sensors and calculation type (an integer type
number 1-4): 1 ESP-r internal daylight factor preprocessor; 2 user 
supplied daylight factors; 3  external sensor; 4 coupling with lighting
simulation.
T}
.sp 0.1
5.3	T{
For each defined sensor: x, y & z coordinates (relative to zone origin) 
defining location of sensor, or
T}
	T{
for calculation type 3: surface number (external only) that the sensor 
is placed on, flag specifying vertical mounting (1.0) or 
horizontal mounting (0.0), dummy value,
T}
.sp 0.1
5.4	T{
For calculation type 2 (user supplied daylight factors) additional info:
T}
.sp 0.1
5.4.1	T{
Number (an integer type number) of windows (transparent multi-layer
construction).
T}
.sp 0.1
5.4.2	T{
For each defined window its TMC surface identification number (an
integer type number) and corresponding daylight factors for each
defined sensor (a real type numbers).
T}
.sp 0.1
5.5	T{
The control law (-1 ON regardless;  0 OFF regardless;  1 ON if sensed 
condition is below set point (otherwise OFF);  2 as 1 but with step 
down/\^up action (0%, 50%, 100%); 3 as 1 but with proportional 
action; 4 as 1 but based on the Hunt probability switching function; 
5 as 1 but with a top-up control and fixed ballast).
T}
.TE
.MT
.sp 0.5
.ce
Table 10b Contents of a zone \fIcasual gain control\fP file.
.sp 0.5
.LP
The relationships between several combinations of control law, 
sensor placement and analysis techniques are discussed below
in the worked out example.
.LP
As an example we are using a one zone model of a simple room 4m wide, 
5m deep and 3m high with a window on the south face.
The casual gain control files acts on a common operation
file which sets up a casual gain of type 2 (artificial lighting)
with 864W of radiative/ convective flux between 8h00 - 12h00
and 14h00 and 17h00 on weekdays:
.sp 0.5
.ML 
\fI 
# operations of Room defined in:
# Room.opr
nil_operations    # operation name
# control(no control of air flow  ), low & high set points
   0     0.000     0.000
     3   # no Weekday flow periods
# Wkd: start, stop, infil, ventil, source, data
   0,  7,    0.500    0.000    0    0.000
   8, 16,    2.000    0.000    0    0.000
  17, 24,    0.500    0.000    0    0.000
    1   # no Saturday flow periods
# Sat: start, stop, infil, ventil, source, data
   0, 24,    0.500    0.000    0    0.000
     1   # no Sunday flow periods
 # Sun: start, stop, infil, ventil, source, data
   0, 24,    0.500    0.000    0    0.000
     4   # no Weekday casual gains
 # Wk: typ, sta, fin, sen, lat, rad, con, pf, +/-, pwr, volt, pha
   1,  8, 11, 1890.0, 1215.0, 0.8, 0.2, 0.00, 0,    0.0,    0.0, 1
   1, 14, 16, 1890.0, 1215.0, 0.8, 0.2, 0.00, 0,    0.0,    0.0, 1
   2,  8, 11,  864.0,    0.0, 0.4, 0.6, 0.90, 1,  864.0,  240.0, 1
   2, 14, 16,  864.0,    0.0, 0.4, 0.6, 0.90, 1,  864.0,  240.0, 1
     0   # no Saturday casual gains
     0   # no Sunday casual gains
 # Labels for gain types
 Occupt Lights Equipt \fP
.ES
.MT
.LP
Consider a zone lighting system comprising two
control strategies: daylight linking and manual switching
respectively. The casual gain control file for this
control strategy is listed below:
.sp 0.5
.ML 
\fI 
2 2 2		# Casual gain type to be controlled
1		# Number of control periods
8 16		# Start and finish hour
2		# Number of lighting zones
# Information for every lighting zone
# Lighting zone 1
500 1.5 .1 1.	# Lux set point, switch-off light level, minimum dimming output, switch-off delay time
0.5 4 1		# % of casual gain, number of sensors, calculation type
2 2 .9		# x, y, z coordinates of sensor location
2 3 .9		# x, y, z coordinates of sensor location
3 2 .9		# x, y, z coordinates of sensor location
3 3 .9		# x, y, z coordinates of sensor location
3		# Control law for all control periods
# Lighting zone 2
500 1. 1. 1.	# Lux set point, switch-off light level, minimum dimming output, switch-off delay time
0.5 1 2		# % of casual gain, number of sensors, calculation type
2 4 .9		# x, y, z coordinates of sensor location
1		# Number of windows
7 .015		# TMC surface number, daylight factor
4		# Control law for all control periods \fP
.ES
.MT
.LP
Note that casual gain type "2" will be controlled during
Weekdays, Saturdays and Sundays.  Only one control period is
defined.  This is usually adequate for most lighting controls. Start and
finish hours "8 16" cover a time span from 8h00 to 17h00 when occupants are 
present and artificial lighting may be necessary.  In order to allow
for the simulation of two individual control strategies, two lighting zones
are required.
.LP
As can be seen from the information defining the first lighting zone,
a reference light level (or set point) has been set to 500 Lux.  The switch-off
light level is 150% of the reference light level 
and the minimum dimming light output is set to 10% (i.e. the dimming range is 100% - 10%).
The switch-off delay time is set to 1 which represents 60 minutes.
Note that at the present time sub-hour delay time delay times are
not possible.
.LP
The first lighting zone will control 50% of the total zone 
controlled casual gain.  The number of sensors has been set to 4 and the calculation
type to 1, which calls for ESP-r's internal daylight factor preprocessor.
Multiple lighting sensors are used to account for a variance in illuminance
within the space in terms of what ceiling mounted photocells would "see". The
average of these
sensors will be used within the simulation.  Finally, the control law
identifier is set to 3, which represents proportional (dimming) control.
.LP
The second lighting zone has a reference light level of 500 Lux, with the switch-off
light level and minimum dimming light output set to 100% which is
adequate for a simple on-off control.  For this case only one sensor is specified
and the calculation type is set to 2, which calls for user specified daylight
factors.  For this type of calculation additional data are required.
These include the number of windows (or TMCs), in this case 1, the TMC surface identifier,
here 7, and the list of daylight factors, here only one set at 1.5%.
Finally, the Hunt probability switching control function, type 4, is selected.
.LP
In order to illustrate the structure of a
casual gain control file consider the above lighting zone 2
with an external sensor.  Part of the resulting file follows:
.sp 0.5
.ML 
\fI 
# Lighting zone 2
8000 1. 1. 1.	# Lux set point, switch-off light level, minimum dimming output, switch-off delay time
0.5 1 3		# % of casual gain, number of sensors, calculation type
1 1. 0		# external surface number, sensor position, dummy value
1		# Control law for all control periods \fP
.ES
.MT
.LP
For the case of an external sensor, the x,y and z coordinates input
line has a different meaning.  The first number is the surface identifier, here 1, the
second number is the sensor position (1 meaning vertical) and the last is
not used.  Only one sensor of this type may be defined per
lighting zone.
.LP
The calculation type "4" represents a coupled lighting and thermal
simulation.  This facility is currently under testing and
so has not been released with the present version of ESP-r.
.bp
.SH
5.8.1 Diagnostics
.LP
To assist the user in verifying the description of casual gain controls
and sensor placement the ESP-r trace facility has been expanded to give
the user information before and during a simulation.  The trace 
diagnostics for several zones are reproduced below and include a
summary of sensor locations, associated windows, contributions from
outside and calculated daylight factors.
Note that the internal reflected component is calculated via the
\fIsplit flux\fP method as defined in \fIArchitects Journal, Vol.120
1954\fP. 
.LP
The diagnostics for a case with dimming and Hunt probability switching:
.sp 0.5
.ML
\fI
Subroutine INTLUM     Trace output   3     Zone  1

 Day No. =   4 (i.e.  4th of Jan.),  Time  9:00 Hours
 Light|Sens|sun |via   |daylight|visib|sun/dir|sky/dif|sensed|set  |ext vert
  zone|num.|seen|window|factor% |trnsm|contrib|contrib|lux   |point|ilum(Ev)
     1    1  no       7     6.34  0.76     0.0   132.7  132.7  500.    1047.
     1    2  no       7     3.64  0.76     0.0    76.2   76.2  500.    1047.
     1    3  no       7     5.47  0.76     0.0   114.6  114.6  500.    1047.
     1    4  no       7     3.41  0.76     0.0    71.4   71.4  500.    1047.
 Light zone 1 Prop ESP-r calc df, ZFRAC= 0.40
     2    1  no       7     1.50  0.76     0.0    31.4   31.4  500.    1047.
 Light zone 2 Hunt: ZFRAC=0.50 Occup arrival first elum(   31.) prob(0.80) r(0.00)
 Fraction of lighting "ON" FRAC=0.90

 Ext: Dir.hor.rad. W/m2(    0.0) Dif.hor.rad.(   18.0)
    : sun light lux(    0.0) sky light lux( 2093.3)
    : sun/dir efficacy (   0.00) sky/dif efficacy ( 116.30)
    : solar azi deg( 138.0) solar alt deg(   5.0)
 Subroutine MZCASI     Trace output   4     Zone  1

 Day No. =   4 (i.e.  4th of Jan.),  Time  9:00 Hours

 Casual gain summary for weekdays

               |      Radiant       |    Convection      | Fraction |
               |   Present   Future |  Present    Future | Pres Futr|
 Uncontrolled  |      0.00   1512.00|      0.00    378.00|            |
 Controlled    |      0.00    345.60|      0.00    518.40| 1.00 0.90|
 Summation     |      1823.48W    , |       845.22W      |

 Zone:    1  1
 Electrical load summary for weekdays
             Real Power          Reactive Power
           |Present|Future|    |Present|Future|
                  0.   779.           0.   377.
 Ctrld  |Unctrld|Ctrld  |Unctrld|Ctrld  |Unctrld|Ctrld  |Unctrld
      0.       0.   864.       0.     0.       0.   418.     0.\fP
.ES
.MT
.LP
Typical simulation diagnostics for case with dimming and external sensor:
.sp 0.5
.ML
\fI
 Subroutine INTLUM     Trace output   3     Zone  1

 Day No. =   4 (i.e.  4th of Jan.),  Time  9:00 Hours
 Light|Sens|sun |via   |daylight|visib|sun/dir|sky/dif|sensed|set  |ext vert
  zone|num.|seen|window|factor% |trnsm|contrib|contrib|lux   |point|ilum(Ev)
     1    1  no       7     6.34  0.76     0.0   132.7  132.7  500.    1047.
     1    2  no       7     3.64  0.76     0.0    76.2   76.2  500.    1047.
     1    3  no       7     5.47  0.76     0.0   114.6  114.6  500.    1047.
     1    4  no       7     3.41  0.76     0.0    71.4   71.4  500.    1047.
 Light zone 1 Prop ESP-r calc df, ZFRAC= 0.40
     2  1.0 N/A   N/A      1   N/A     N/A  0.0  2093.3 1046.7 8000.   N/A
 Light zone 2 ON/OFF ext sensor, ZFRAC= 0.50
 Fraction of lighting "ON" FRAC=0.90

 Ext: Dir.hor.rad. W/m2(    0.0) Dif.hor.rad.(   18.0)
    : sun light lux(    0.0) sky light lux( 2093.3)
    : sun/dir efficacy (   0.00) sky/dif efficacy ( 116.30)
    : solar azi deg( 138.0) solar alt deg(   5.0)
 Subroutine MZCASI     Trace output   4     Zone  1

 Day No. =   4 (i.e.  4th of Jan.),  Time  9:00 Hours

 Casual gain summary for weekdays

               |      Radiant       |    Convection      | Fraction |
               |   Present   Future |  Present    Future | Pres Futr|
 Uncontrolled  |      0.00   1512.00|      0.00    378.00|            |
 Controlled    |      0.00    345.60|      0.00    518.40| 1.00 0.90|
 Summation     |      1823.48W    , |       845.22W      |
 
 Zone:    1  1
 Electrical load summary for weekdays
             Real Power          Reactive Power
           |Present|Future|    |Present|Future|
                  0.   779.           0.   377.
 Ctrld  |Unctrld|Ctrld  |Unctrld|Ctrld  |Unctrld|Ctrld  |Unctrld
      0.       0.   864.      0.     0.       0.     418.     0.\fP
.ES
.MT
.SH
5.8.2 Result analysis
.LP
The results analysis module \fIres\fP provides the  possibility to analyse
the controlled casual gains and electric power consumptions (if electric data 
are given in the zone operation file) in a variety of ways.
.bp
.SH
5.9 Zone CFD Domain File (optional)
.LP
ESP-r includes a CFD solver capable of modelling indoor air 
flow in 3 dimensions.  Normally the fluid in a zone is modelled as 
a single volume (one temperature, pressure), by using the CFD 
approach the zone's fluid volume is subdivided into discrete 
volumes allowing the prediction of internal flows. 
.LP
To define a CFD domain all boundary conditions must be 
provided - ventilation and/or infiltration rates, internal surface 
temperatures, etc - via the interface in project manager file. 
Various simulation options exist, for example:
laminar or turbulent flows ($k- epsilon$ model, zero equation model etc), 
the solving with the SIMPLE algorithm or TDMA Gauss-Seidel. The differential 
equations are discretized using the hybrid scheme and the implicit 
formulation. 
.SH
5.9.1 Domain Flow Definition
.LP
The input data are provided via ESP-r's project manager
which contains instructions about domain conflation, domain geometry and grid
distribution, simulation control parameters and boundary conditions.
File contents are described in table 11a.
.sp
.mT
.TS H
box center expand;
l cw(5.2i)
l lw(5.2i).
Record	Description of fields
_
.TH
1	T{
File identifier and version
T}
.sp 0.1
2	T{
Conflation index (see section 5.9.2)
T}
.sp 0.1
3	T{
Description of model
T}
.sp 0.1
4	T{
Identifier for start of geometry description
T}
.sp 0.1
5	T{
Identifier, zone vertex numbers defining extent of domain
T}
.sp 0.1
6	T{
Identifier, number of gridding regions in each orthogonal direction Nx, Ny, Nz.
If non-orthogonal gridding is defined then the fourth data item is the number 
of regions along the east boundary (Nze).
T}
.sp 0.1
7	T{
Identifier for start of x-region gridding data.
T}
.sp 0.1
8/Nx	T{
Number of cells, length of region and power law coefficient.  One record 
for each X region.
T}
.sp 0.1
9	T{
Identifier for start of y-region gridding data.
T}
.sp 0.1
10/Ny	T{
Number of cells, length of region and power law coefficient.  One record 
for each Y region.
T}
.sp 0.1
11	T{
Identifier for start of z-region gridding data.
T}
.sp 0.1
12/Nz	T{
Number of cells, length of region and power law coefficient.  One record 
for each Z region.
T}
.sp 0.1
13	T{
Identifier for start of ze-region gridding data.
T}
.sp 0.1
14/Nze	T{
Number of cells, length of region and power law coefficient.  One record 
for each Ze region.  Note that the total number of cells must be the same 
for both Z and Ze definitions.
T}
.sp 0.1
15	T{
Boundary geometry definitions identifier; number of boundaries, NV.
T}
.sp 0.1
16/NV	T{
For each boundary: Name, Type, Start and finish cell in each orthogonal 
direction in order Is If Js Jf Ks Kf.  The boundary type is either a face 
of the volume (North, South, East, West, High, Low) or the whole volume 
(Whole, Block, Source).  The cells included in the boundary are inclusive 
and cannot overlap with other boundary definitions.
T}
.sp 0.1
17	T{
Surface boundary conditions identifier
T}
.sp 0.1
18/NS	T{
For each solid boundary (total NS): Boundary name, thermal boundary 
condition type and data.  The boundary conditions are as follows for 
a type 0 conflation:
.IP
Temp, value - Dirchlet type condition, set temperature (\(deC).
.IP
Heat, value - Neuman type condition, set heat flux (W).
.LP
For thermal conflation (types 1, 2, 4 and 5) the records also include 
the following fields:  Confl; handshaking index; building surface.  The 
text 'Confl' is an identifier, the handshaking index defining how the 
boundary is treated (Neuman, Dirchlet, Robin; which temperature 
is used - local, average etc; and which turbulence model is active), 
and the zone surface associated with the boundary.  Note that the 
handshaking index is set automatically for type 4 and 5 conflation.
T}
.sp 0.1
19	T{
Air flow boundary conditions section identifier
T}
.sp 0.1
20/NO	T{
For each air flow boundary (total NO): Boundary name; Flow rate identifier 
and value (kg/s); Temperature identifier and value (\(deC); Humidity 
identifier and value (g/hr); True opening area and value ($m sup 2 $); Flow 
angle identifier and values (\(de).
T}
.sp 0.1
21	T{
Pollutant sources section identifier
T}
.sp 0.1
22/NP	T{
For each pollutant source (total NP): Boundary name; Humidity identifier and 
value (g/hr); CO2 identifier and value (kg/s); Heat flux identifier and value (W).
T}
23	T{
Blockage section identifier
T}
.sp 0.1
24/NB	T{
For each blockage (total NB): Boundary name; Heat flux identifier and 
value (W/$m sup 2 $).
T}
.sp 0.1
25	T{
Solution methods section identifier
T}
.sp 0.1
26	T{
Turbulence identifier and type: 0=none (laminar flow); 1=k-e model; 2=fixed 
eddy viscosity; 3=MIT zero equation model; 4=fixed eddy viscosity followed by 
k-e model.  Note for type 2 and 4 an additional field is required for the 
fixed eddy viscosity, and for type 4 a limiting number of iterations is 
required to solve after which the k-e model should be used.
T}
.sp 0.1
27	T{
Buoyancy identifier and type: 0=not solved; 1=ideal gas law; 
2=Boussinesq approximation.  Note for type 2 an additional field is required 
for the reference temperature (\(deC).
T}
.sp 0.1
28	T{
Equation set up section identifier
T}
.sp 0.1
29/NEq	T{
For each equation: Identifier; initial value; relaxation type (linear under 
relaxation factor or fictitious time step) and relaxation 
value.  Equations are:
.IP 
Pressure: Continuity equation - always solved
.IP 
Vel U: Momentum in x direction - solved if gridding defined in x direction
.IP 
Vel V: Momentum in y direction - solved if gridding defined in y direction
.IP 
Vel W: Momentum in z direction - solved if gridding defined in z direction
.IP
Temp: Energy equation
.IP
Ted: Turbulent dissipation equation ($k$)
.IP
Epd: Turbulent energy equation ($epsilon$)
.IP
Conc: CO2 concentration equations
.IP
Hum: Humidity equations
.IP
Lmage: Calculate local mean age of air
T}http://www.sesg.strath.ac.uk/
.sp 0.1
30	T{
Iteration control identifier
T}
.sp 0.1
31	T{
Maximum number of iterations; Convergence criterion; Yes/No ?
T}
.sp 0.1
32	T{
Monitoring identifier; monitoring cell ID X, Y, Z; file to write monitoring 
information to.
T}
.sp 0.1
33	T{
Yes/No for re-initalising domain between timesteps (usually no)
T}
.sp 0.1
34	T{
Results writing frequency identifier and frequency.  Unused.
T}
.sp 0.1
.TE
.MT
.sp 0.5
.ce
Table 11a Contents of a zone \fICFD\fP file.
.sp 0.5
.LP
.SH
5.9.2 BSim-CFD conflation
.LP
A conflation index is specified to describe how the CFD domain should be 
integrated into the solution of the building equations.  Six options exist:
.IP 0
No conflation.  The CFD domain will be solved on its own.
.IP 1
Type 1 thermal.  The CFD domain is thermally integrated 
with the zones surfaces.  The CFD and building equations are 
solved sequentially.
.IP 2
Type 2 thermal.  The CFD domain is thermally integrated 
with the zones surfaces.  The CFD and building equations are 
solved simultaneously.
.IP 3
Air flow conflation.  The CFD domain is integrated with an 
air flow network only.
.IP 4
Type 1 addaptive.  Two CFD simulations are undertaken at each 
time step.  The initial simulation is used to configure correctly the 
domain for final solution at that time step.  Heat transfer results 
from the CFD simulation are not used in the thermal solution of the 
zone.
.IP 5
Type 2 addaptive.  As conflation type 4 but convection exchanges are used 
(after checking) in the zones thermal solution.
.LP
Type 4 conflation should be regarded as the default mechanism for an 
integrated model.
.SH
5.9.3 Geometry and gridding
.LP
To define the geometry of the domain each dimension is divided into a 
number of regions. For each region its length and the
grid distribution is defined by a cell count and power law coefficient. 
The cells are independently
distributed in each region according to a power law equation
and the parameters necessary are shown in Table 11b. 
.sp
.TS H
box center expand;
lw(1.7i) l cw(3.2i)
lw(1.7i) l lw(3.2i).
Parameter	Value	Description of fields
_
.TH
T{
Number of cells in region
T}	n>0	T{
Cells distributed over whole region.
T}
.sp 0.1
T{

T}	n<0	T{
Cells distributed symmetrically over whole region.
T}
.sp 0.1
T{
Power law coefficient
T}	c=1	T{
Uniform cell distribution.
T}
.sp 0.1
T{

T}	c>1	T{
Cell size increases from beginning to end of region if n>0.
.br
Cell size decreases from centre of region to ends if n>0.
T}
.sp 0.1
T{

T}	0<c<1	T{
Cell size decreases from beginning to end of region if n>0.
.br
Cell size increases from centre of region to ends if n>0.
T}
.sp 0.1
.TE
.sp 0.5
.ce
Table 11b Grid and geometry definition.
.sp 0.5
.SH
5.9.4 Solution equations
.LP
The user is able to define the nature of the flow (lam-
inar or turbulent, two or three-dimensional) by choosing the
equations to be solved. Energy and  concentration  equations
and  buoyancy  effect  are included or not in the simulation
depending on the problem. The z direction is assumed  to  be
vertical  (direction  of  gravity) and buoyancy is only con-
sidered in this direction. 
.SH
5.9.5 Boundary conditions
.SH
5.9.5.1 Openings
.LP
Four types of  boundary  conditions  are  available  to
represent  openings:  pressure, mass flow rate, velocity and
zero velocity gradient. They must be chosen according to the
situation (usually velocity is fixed at the inlets and pres-
sure, mass flow or zero velocity gradient at  outlets).  Six
planes,  designated "West" and "East" (normal to x), "South"
and "North" (normal to y) and "Low" and  "High"  (normal  to
z), are used to define the cell faces. The openings are then
located at one of the  six  planes  according  to  the  grid
definition in a certain number of cells. In other words, the
plane name and the indices  of  the  first  and  last  cells
inserted  in  the opening (in each direction) are specified.
The definition of the plane is only  relevant  for  velocity
and zero gradient boundary types. For pressure and mass flow
types this information becomes redundant. If an  opening  is
introduced  in a certain plane (say West) the indices of the
initial and final cells in the direction normal to the plane
(say  x-direction)  must  be the same. Additionally, the air
condition at openings must be provided in terms of mass flow
rate  (i.e. velocity boundary type flowrate is specified in kg/s) 
or pressure (Pa). In the case of velocity boundary types,
the  velocity  at the opening is based on the specified mass
flow rate, air density at the opening and  opening  area.  A
positive  mass flow rate indicates that the flow is entering
the domain and an outlet  flow  is  denoted  by  a  negative
value. 
.LP
For transient simulations where there is a coupling to an air 
flow network description the final three fields of an opening 
description represent the names of: the node representing the 
CFD domain in the network; the node outside the domain; and the 
component used for the connection between these nodes.  This is 
specified in addition to the default data.
.SH
5.9.5.2 Solid Boundaries
.LP
The boundary conditions for solid surfaces are  characterised
by  three types: fixed temperature, fixed heat flux
or symmetric plane. For the first two types,  only  temperature
or heat flux are specified and for the symmetric plane
type no condition is specified since the gradient normal  to
the plane for all variables is assumed zero. The solid boundaries
are positioned by applying the same procedure as  for
an  opening.  
.LP
For a transient simulation the name of the surface in the zone geometry 
should be specified in addition to the default data.
.SH
5.9.5.3 Sources and blockages
.LP
Solid objects, partitions, solid or non-solid  heat  or
concentration  sources can be inserted in the domain. 
Sources are characterised as a group of cells with a  cuboid
shape  and  are  defined exactly as for openings except that
the boundary planes  are  not  specified.  
.LP
Sources are assumed to be free volumes of air and blockages 
are defined as solid objects.  Thus to model a desk or a person 
a blockage would be used and to model the breath of a person a 
source would be defined in front of their head.
.SH
5.9.6 Iteration Control
.LP
The convergence  process  is  controlled  by  the  user
specified  number  of  iterations  and the maximum source of
residuals allowed. The simulation stops when  the  tolerance
of residuals or the defined number of iterations is reached,
whichever occurs first.
.LP
The user has also the control over the relaxation  factors.
Linear and fictitious time-step relaxation factors can
be selected for each of the transport variables and also a 
linear relaxation can be chosen for turbulent viscosity.  If  a
relaxation  factor  is  not  specified,  a  default value is
assumed.
.LP
Convergence is also a function of the initial values of
the  variables.  A solution can be achieved or not depending
on the values assumed at the beginning of the iteration process.
Initial values (uniform for the whole field) for each
transport variable can be selected in order to speed up  the
convergence.
.SH
5.9.8 Results
.LP
Analysis facilities exist within the ESP-r system to view 2 and 3 
dimensional figures.  There also exists several options to export 
data to third party graphing/analysis tools.
.LP
If a stand alone simulation has been undertaken the analysis facilities 
are within the simulation module.  In the case of an integrated simulation 
a separate results library for the CFD results is created and can be 
analysed via the results analysis module.
.bp
.SH
6 Fluid flow network description file (optional)
.LP
This file (usually named ?.mfn) describes a building and/or plant
fluid mass flow network. Based on this description, \fIbps\fP can
pursue mass flow simulation in tandem with the energy balance computations.
The fluid mass flow simulation assumes one-dimensional steady flow
in a building and/or plant configuration which is subjected to certain
boundary conditions. This involves calculation of mass flow through the
connections of a nodal network. The nodes of the network represent either
internal or boundary pressures; the connections represent flow paths. The
unknown fluid flows and pressures are found by an iterative mass balance
approach in which non-boundary nodal pressures are adjusted until
the mass residual of each internal node satisfies some criterion.
.br
Information on potential mass flows is given to \fIesp-r\fP
in terms of fluid type (presently only air and water are supported, but
this can easily be expanded), node descriptions, flow component
types (pipe/duct, pump, opening, crack, doorway, valve etc.), interconnections
and boundary conditions. In this way a nodal network (or perhaps several
decoupled sub-networks) of
connecting resistances is constructed. This may then be
attached, at its boundaries, to pressure coefficient sets
which represent the relationship between free-stream wind
vectors and the zone surface pressures to result.
The file to emerge is
referenced in the system configuration file for transfer,
along with the pressure coefficients file (see following
section), to \fIbps\fP.
Alternatively, the mass flow network description and pressure
coefficients files can be input to \fImfs\fP. This allows
independent mass flow studies of building and/or plant configurations which are
predominately pressure driven. \fImfs\fP \fIdoes\fP
include buoyancy effects, but against fixed nodal
temperatures. If this option is selected then the predicted
mass flows can still be transferred to \fIbps\fP via the
mechanism of the building and plant fluid mass flow file.
.KF
.sp
.TS H
box center;
lw(1i) cw(4.5i)
lw(1i) lw(4.5i).
Record	Description of fields
_
.TH
1	T{
Number of nodes, components, interconnections and wind reduction factor
T}
2	T{
A list of titles for the node data which follows
T}
3 $->$ I	T{
For each node: name/identifier, fluid, type (internal
or boundary with known, wind induced or unknown pressure), height
above datum, temperature, and up to two supplementary data items
T}
I+1	T{
A list of titles for the flow components data which follows
T}
I+2	T{
For each flow component: name/identifier, type code (for duct/pipe, pump, crack,
area, doorway, etc), number of component level supplementary data items for
that type, number of connection level supplementary data items for that type
(ie. additional node names), and short description
T}
I+3	T{
Component level supplementary data items
T}
I+4 $->$ J	T{
Repeat records I+2 and I+3 for each additional flow component in turn
T}
J+1	T{
A list of titles for the connections data which follows
T}
J+2 $->$ K	T{
For each interconnection in turn: name of node on +ve side of connection,
height of +ve linkage point relative to node on +ve side, name of node
on -ve side of connection, height of -ve linkage point relative to node
on -ve side, name of connecting component, and up to two supplementary
node names
T}
.TE
.sp 0.5
.ce
Table 11  Contents of the \fImass flow network description\fP file.
.sp 0.5
.KE
.LP
There are several important points to note when describing
a fluid mass flow network:
.IP \(bu
A mass flow network may consist of several sub-networks and is not
restricted to one fluid. However, all nodes and components
within a sub-network must be of the same fluid type. The possibilities
with respect to node type are shown in Table 12, and
the fluid mass flow component types currently on offer, are summarised
in Table 16 at the end of this section.
.KF
.sp
.TS
box center tab(:);
l l l.
Code:Type:Supplementary data
_
0:Internal; unknown pressure:None
1:Internal; known pressure:total pressure (Pa)
2:Boundary; known pressure:1) total pressure (Pa)
::2) fluid temperature flag, indicating
::   0 = node temperature is constant
::   1 = node temperature equals outside air temperature
3:Boundary; wind pressure\u*\d:1) wind pressure coefficients index
::2) surface azimuth (\(de clockwise from North)
.T&
l s s.
_
* only allowed when fluid type is air
.TE
.sp 0.5
.ce
Table 12 Mass flow network \fInode types\fP.
.sp 0.5
.KE
.IP \(bu
It is quite easy to define a mass flow network which has no unique
solution. One requirement for solution is that at least one of the node
pressures is known. A second requirement is that all nodes must be
linked, through some path, to a known pressure node.
.IP \(bu
The nodes of the network represent either internal or boundary pressures.
In this context, internal and boundary does not have to be the same as
inside and outside (a building). Internal in terms of the network means
that these nodes are subjected to the mass balance approach, whereas for
boundary nodes, a mass balance is not established.
The pressure at a node may be unknown or known; wind induced pressure
is a special case of the latter.
The defined network is then arrived at by connecting a number of
internal and boundary nodes by branches which represent
some resistance to inter-zone or intra-plant fluid flow. For
the case of use by \fIbps\fP, the established mass flow
network need not match the multi-zone and plant component network
referenced in the system configuration file to define the
building and/or plant for energy simulation. At the
time of system configuration file construction, it is
necessary, if a mass flow simulation is required, to define
the mapping between building zones and plant components on the one hand and
nodes defined as part of the mass flow network on the other hand. This
allows some
flexibility in problem description since the energy and mass
flow systems are not constrained to the same boundary
conditions. For example, it is possible to generate a partial
building and plant model, of 5 building zones and 10 plant components say,
for energy simulation purposes, and
then to deploy a greater number of nodes, say 50,
to represent an air flow network which accurately
expresses the leakage distribution of the entire building and flow
characteristics of the mechanical ventilation system.
Some of the mass flow nodes - 15 or less in this example - will correspond to
the building zones or plant components, the others are merely present
to enhance the fluid mass flow predictions. Of course the schemes can be
exactly matched if required. Within \fIbps\fP only the
temperatures of matched zones or plant components will vary with time. All other
nodes in the mass flow network will retain, throughout a
simulation, the temperatures assigned in the mass flow network description
file. Note that the temperature of a node may be defined to be equal
to the temperature of some other participating node. This is achieved
by entering the name of the other node instead of the current node's
temperature.  By this mechanism more then one mass flow network node
may be (temperature) linked to a building zone or plant component.
.IP \(bu
The node reference height is used as part of the buoyancy
calculations. It defines the mean height of the
associated building zone or plant component.
.IP \(bu
To determine wind induced pressure requires that the "free stream" wind
velocity (as read from the climate file) be mapped onto the surface as
a function of the wind's vertical velocity profile and the sheltering
effect of remote and local facade obstructions. The latter effect is
usually accounted for by a dimensionless pressure coefficient:
.EQ
C sub p,i,d ~=~ P sub i over { 1/2 rho { V sub rd } sup 2 } ~(-)
.EN
where $ C sub p,i,d $ is the pressure coefficient for a surface
location $ i $ corresponding to wind from direction $d$, $ P sub i $
is the surface pressure $( Pa )$, $rho$ is the air density $( kg /^ m sup 3 )$
and $V sub rd$ is the wind speed $( m /^ s )$ at some reference level $r$ and
from direction $d$ (expressed relative to the external surface normal vector).
The wind speed reference level is usually equal
to the building height. The ratio between this local reference wind speed and
the wind speed as read from the climate file, is called the wind speed
reduction factor. The \fImfs\fP user input module offers several
possibilities with respect to input of this reduction factor. The first
one is to input the wind speed reduction factor directly. Alternatively,
the user must supply additional data (regarding terrain roughness etc.)
so as to calculate the wind speed reduction factor from: (1) "power law"
wind profile, (2) logarithmic wind profile, or (3) LBL air infiltration
model wind profile.
.IP \(bu
For each boundary node with wind induced pressure, a reference must be
made to an appropriate pressure coefficient set as held in the pressure
coefficients file (see section 7). Any number of sets may
reside in this file, with reference codes given simply
as 1, 2, 3 and so on.  It is the pressure coefficient, appropriate to the
wind direction prevailing at any time, that dictates, as a
function of the prevailing wind speed at roof height, the generated
boundary (i.e. external surface) pressure.
.IP \(bu
For wind induced boundary pressure nodes, the azimuth is required to define the
zone's orientation relative to the building configuration.
The required response is degrees from north, clockwise
positive so that north is zero, east is 90\(de and
south is 180\(de. In the
case of an `up' or `down' zone, the azimuth has no meaning
and may be set to zero.
.IP \(bu
Connections are defined by the nodes on either side. Note that a connection
joining node A to B is different from one joining B to A. More then one
connection may exist between two nodes. The relative heights are a
convenient way of expressing the flow component inlet and outlet heights.
For example, it is quite common for
flow components in the building fabric to only differ with respect to
inlet and outlet heights relative to the zone heights.
If the flow component is part of a duct or pipe network, the relative
heights will be zero.
.IP \(bu
Some component types need additional data at the connection description
level. These supplementary items may be the names of the nodes which
play a role in the functioning of that component. Or, in case the
component is some flow controller which receives a signal from the
plant side (sensed property = 0), the data item is a pointer identifying
a plant control loop in the system configuration file. At present
supplementary items are only needed for the component types indicated
in Table 13.
.KS
.TS
box center tab(:);
l l lw(6.0c).
type:description:supplementary data
=
220:conduit ending in converging 3-leg junction:T{
name of node to which the other entrance of the junction is connected
T}
_
230:conduit starting in diverging 3-leg junction:T{
name of node to which the other exit of the junction is connected
T}
_
240:conduit ending in converging 4-leg junction:T{
name of nodes (2) to which the other entrances of the junction are connected
T}
_
250:conduit starting in diverging 4-leg junction:T{
name of nodes (2) to which the other exits of the junction are connected
T}
_
410:general flow corrector:T{
in case of a flow controller which receives a signal from the plant
side (sensed property = 0), the data item is a pointer identifying a
plant control loop in the system configuration file;
.br
and the supplementary node names are: in case of a temperature or
pressure sensor
the name of the referenced node, and in case of a temperature difference,
pressure difference or mass flow rate sensor the names of two
referenced nodes
T}
420:flow corrector with polynomial resistance:\^
450:ideal open/shut flow controller:\^
460:fixed flow rates controller:\^
.TE
.sp 0.5
.ce 2
Table 13 Component types and requirements for supplementary
node names and data items.
.sp 0.5
.KE
.KF
.sp
.ps 7
.vs 8
.TS
box center tab(:);
 r  r  r  c  l  s  s s
lb rb rb cb cb cb lb s
 l  r  r  n  n  n  l s.
11:12:15:0.438:(nodes, components, connections, wind reduction)
Node:Fld.:Type:Height:Temperature:Data_1:Data_2
living:1:0:1.5000:21.000:0.:0.
kitche:1:0:1.5000:20.800:0.:0.
w_ctl:1:0:1.5000:20.800:0.:0.
bed:1:0:4.5000:21.000:0.:0.
bath:1:0:4.5000:21.000:0.:0.
south:1:3:1.5000:0.:18.000:180.00
north:1:3:1.5000:0.:18.000:0.
roof:1:3:7.0000:0.:20.000:0.
t_junc:1:0:5.0000:21.000:0.:0.
fan_in:1:0:6.0000:21.000:0.:0.
fan_ou:1:0:6.0000:21.000:0.:0.
.T&
lb rb rb rb lb  s  s s
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
Comp:Type:C+:L+:Description
crack:120:3:0:Specific air flow crack             m = rho.f(W,L,dP)
1.00:3.000E-03:5.000::::
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
stairs:110:2:0:Specific air flow opening           m = rho.f(A,dP)
1.000:1.000:::::
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
door:130:5:0:Specific air flow door              m = rho.f(W,H,dP)
1.000:2.000:2.100:1.500:0.920::
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
window:40:3:0:Common orifice vol. flow rate comp. m = rho.f(Cd,A,rho,dP)
1.000:1.000:0.650::::
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
grl_ex:40:3:0:Power law vol. flow component       m = rho.a.dP^b
1.000:0.020:0.700::::
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
grl_in:10:3:0:Power law vol. flow component       m = rho.a.dP^b
1.000:5.000:0.500::::
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
fan:310:7:0:General flow inducer component      dP= a0+Sai(m/rho)^i
1.000:0.:1.000E-01:125.000:0.:-12500.0:0.
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
duct_1:220:13:1:Conduit ending in converging 3-leg junction & Ccp = f(q/qc)
1.000:0.125:1.227E-02:2.500:1.500E-04:18.000:7.853E-03
1.000E-02:0.:0.:1.500:-0.970:0.:
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
duct_2:220:13:1:Conduit ending in converging 3-leg junction & Ccp = f(q/qc)
1.000:0.1250:1.227E-02:2.000:1.500E-04:36.00:7.853E-03
-0.8000:2.970:-1.090:0.:0.:0.:
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
duct_3:210:6:0:General flow conduit component      m = rho.f(D,A,L,k,SCi)
1.000:0.125:1.227E-02:1.500:1.500E-04:0.2500:
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  l s.
duct_4:210:6:0:General flow conduit component      m = rho.f(D,A,L,k,SCi)
1.000:0.1250:1.227E-02:2.000:1.500E-04:2.900:
.T&
 l  r  r  r  l  s  s s
 c  c  c  c  c  c  c c.
w_ctl:450:8:2:Ideal (frictionless) open/shut flow controller
1.000:7.000:16.000:20.000:0.:2.000:20.000:0.
.T&
lb cb lb cb lb lb lb s
 l  n  l  n  l  l  l s.
+Node:dHght:-Node:dHght:Comp:Snod1:Snod2
living:0.000:kitche:0.000:door::
living:1.500:bed:-1.500:stairs::
bed:-1.000:bath:-1.000:grl_in::
south:-1.300:living:-1.300:crack::
south:1.300:living:1.300:grl_ex::
south:3.500:bed:0.500:grl_ex::
bath:0.500:north:3.500:crack::
kitche:1.200:north:1.200:crack::
kitche:0.000:w_ctl:0.000:w_ctl:kitche:north
w_ctl:0.500:north:0.500:window::
kitche:0.500:t_junc:0.000:duct_1:bath:
bath:0.500:t_junc:0.000:duct_2:kitche:
t_junc:0.000:fan_in:0.000:duct_3::
fan_in:0.000:fan_ou:0.000:fan::
fan_ou:0.000:roof:0.000:duct_4::
.TE
.ps
.vs
.MT
.sp 0.5
.ce
Table 14  Example of a \fImass flow network description\fP file.
.sp 0.5
.KE
.IP \(bu
Like \fImfs\fP, \fIesp-r\fP is endowed with interactive node, component
and connection definition and editing facilities. If a node or component
name does not correspond to a name already specified then a
new entry is created. Otherwise it is assumed that an
existing entry is to be edited. During connection
definition, the connected nodes are referenced; if the
connection already exists then it can be edited or an additional
connection created.
.IP \(bu
For most mass flow component types, uni-directional fluid flow will result
(in either direction). However, some component types - for example in case
of a doorway due to
the action of small density variations over the height - may show
bi-directional fluid movement.
.IP \(bu
During results analysis, the time-dependent mass flows
through each connection may be recalled from a mass flow results
file generated by \fIbps\fP or \fImfs\fP. As an example, a piece of
a mass flow results file is shown in Table 15. This file holds
for each time step: climate data, number of iterations (It), indication
of iteration process success (OK), node and connection data and results.
The node results comprise pressure (Pa), mass flow residual (kg/s) and
the sum of the absolute values of all node coupled mass flows (kg/s).
The connection results comprise total pressure difference across the
connection (Pa), pressure difference due to stack effect (Pa) and one
or two mass flows (a positive value indicates that the flow is from
the node defined as positive towards the node defined as negative).
.KS
.sp
.ps 7
.vs 8
.TS
box center tab(@);
 l  s  s  s  s  s  s  s  s
lb rb rb cb cb cb cb cb  c
 l  r  r  n  n  n  n  n  n.
Date: 9/ 1/1967  12.00     Dryb= -1.0  Wdir= 345.  Wvel=  1.4     It=   7 OK=1
Node@Fld@Type@Temp@Hght@Pressure@Residual@Sabs(Flw) 
living@1@0@21.0@1.5@-23.150@ 0.51258E-06@0.42086@
kitche@1@0@20.8@1.5@-23.154@-0.52800E-07@0.40522@
w_ctl@1@0@20.8@1.5@-18.796@0.@0.@
bed@1@0@21.0@4.5@-57.997@-0.15738E-03@0.39116E-01@
bath@1@0@21.0@4.5@-57.997@ 0.46190E-07@0.48436E-01@
south@1@3@-1.0@1.5@-19.835@-0.45106E-01@0.45106E-01@
north@1@3@-1.0@1.5@-18.331@-0.12443E-01@0.12443E-01@
roof@1@3@-1.0@7.0@-88.818@ 0.57706E-01@0.57706E-01@
t_junc@1@0@21.0@5.0@-124.63@-0.71409E-06@0.11541@
fan_in@1@0@21.0@6.0@-141.52@ 0.64808E-06@0.11541@
fan_ou@1@0@21.0@6.0@-46.206@-0.17658E-06@0.11541@
.T&
lb lb lb lb cb cb cb cb cb
 l  l  l  l  n  n  n  n  n.
From@To@Comp@Typ@Fld@Pi-Pj@Pstack@Flw 1@Flw 2
living@kitche@door@130@1.@0.39953E-02@0.@0.19456@-0.16930
living@bed@stairs@110@1.@34.847@-34.847@0.20067E-01@0.
bed@bath@grl_in@10@1.@0.11370E-04@0.@0.19963E-01@0.
south@living@crack@120@1.@3.9248@1.4580@0.10021E-01@0.
south@living@grl_ex@40@1.@3.9248@-1.4580@0.35434E-01@0.
south@bed@grl_ex@40@1.@38.772@-38.772@-0.23101E-03@0.
bath@north@crack@120@1.@-40.119@38.772@-0.42940E-02@0.
kitche@north@crack@120@1.@-5.2753@1.3363@-0.82791E-02@0.
kitche@w_ctl@w_ctl@450@1.@-4.7185@0.@0.@0.
w_ctl@north@window@40@1.@-0.55680@0.55680@0.@0.
kitche@t_junc@duct_1@220@1.@101.67@-40.682@0.33541E-01@0.
bath@t_junc@duct_2@220@1.@66.823@-5.8078@0.24256E-01@0.
t_junc@fan_in@duct_3@210@1.@16.905@-11.616@0.57797E-01@0.
fan_in@fan_ou@fan@310@1.@-95.216@0.@0.57797E-01@0.
fan_ou@roof@duct_4@210@1.@42.710@-11.616@0.57797E-01@0.
.TE
.ps
.vs
.MT
.sp 0.5
.ce
Table 15  Example of some \fImass flow network results\fP
.sp 0.5
.KE
.sp 2
.\".nr Ps \n(PS
.\".nr Vs \n(VS
.ps     8
.nr PS  8
.vs    10
.nr VS 10
.TS H
box expand tab(@);
r l l l.
.sp
.ps +2
type@description@"formula"@supplementary data\u\s-2(1)\s0\d
.ps
=
.TH
.sp 0.5
10@Power law volume flow resistance@$m dot~=~rho~a DELTA P sup b$@2. coefficient $a$
@component@@3. exponent $b$
_
.sp 0.5
15@Power law mass flow resistance@$m dot~=~a DELTA P sup b$@2. coefficient $a$
@component@@3. exponent $b$
_
.sp 0.5
17@Power law mass flow resistance@$m dot~=~a sqrt rho^DELTA P sup b$@2. coefficient $a$
@component@@3. exponent $b$
_
.sp 0.5
20@Quadratic law volume flow resistance@$DELTA P~=~a m dot / rho~+~b ( m dot / rho ) sup 2$@2. coefficient $a$
@component@\^@3. coefficient $b$
_
.sp 0.5
25@Quadratic law mass flow resistance@$DELTA P~=~ a^m dot~+~b^m dot sup 2$@2. coefficient $a$
@component@@3. coefficient $b$
_
.sp 0.5
30@Constant volume flow rate component@$m dot~=~rho^a$@2. volume flow rate $a$
_
.sp 0.5
35@Constant mass flow rate component@$m dot~=~a$@2. mass flow rate $a$
_
.sp 0.5
40@Common orifice flow component@$m dot~=~rho~f ( Cd^A^rho^DELTA P )$@2. opening area $A$
@@@3. discharge factor $Cd$
_
.sp 0.5
50@Laminar pipe flow component@$m dot~=~rho~f ( L^R^mu^DELTA P )$@2. length of flow path $L$
@@@3. radius of opening $R$
_
.sp 0.5
110@Specific air flow opening\u\s-2(2)\s0\d@$m dot~=~rho~f ( A^DELTA P )$@2. area $A$
_
.sp 0.5
120@Specific air flow crack@$m dot~=~rho~f ( W^L^DELTA P )$@2. crack width $W$
@@@3. crack length $L$
_
.sp 0.5
130@Specific air flow door@$m dot~=~rho~f ( W^H^Hr^Cd^DELTA P )$@2. door width $W$
@@@3. door height $H$
@@@4. reference height $Hr$\u\s-2(3)\s0\d
@@@5. discharge factor $Cd$\u\s-2(4)\s0\d
_
.sp 0.5
210@General flow conduit (duct or pipe)@$m dot~=~rho~f ( D sub h ^A^L^k^SIGMA C sub i nu^DELTA P )$@2. hydraulic diameter $D sub h$
@@@3. cross-sectional area $A$
@@@4. conduit length $L$
@@@5. wall roughness $k$
@@@6. sum of local dynamic
@@@\0\0loss factors $SIGMA C sub i$
_
.sp 0.5
220@Flow conduit ending in@$m dot~=~rho~f ( D sub h ^A^L^k^SIGMA C sub i nu^DELTA P )$@2-6. see type 210
@converging 3-leg junction\u\s-2(5)\s0\d@@7. cross-sectional area $A sub c$
@@@\0\0of common section
@@$C sub {c,^p}~=~f(a sub 0-5 ,{q sub p over q sub c},{q sub p' over q sub c})$\u\s-2(6)\s0\d@8. coefficient $a sub 0$
@@\^@9. coefficient $a sub 1$
@@\^@10. coefficient $a sub 2$
@@\^@11. coefficient $a sub 3$
@@\^@12. coefficient $a sub 4$
@@\^@13. coefficient $a sub 5$
_
.sp 0.5
230@Flow conduit starting in@$m dot~=~rho~f ( D sub h ^A^L^k^SIGMA C sub i nu^DELTA P )$@2-6. see type 210
@diverging 3-leg junction\u\s-2(5)\s0\d@@7. cross-sectional area $A sub c$
@@@\0\0of common section
@@$C sub {c,^p}~=~f(a sub 0-5 ,{q sub p over q sub c},{q sub p' over q sub c})$\u\s-2(6)\s0\d@8. coefficient $a sub 0$
@@\^@9. coefficient $a sub 1$
@@\^@10. coefficient $a sub 2$
@@\^@11. coefficient $a sub 3$
@@\^@12. coefficient $a sub 4$
@@\^@13. coefficient $a sub 5$
.bp
.sp 1.5
240@Flow conduit ending in@$m dot~=~rho~f ( D sub h ^A^L^k^SIGMA C sub i nu^DELTA P )$@2-6. see type 210
@converging 4-leg junction\u\s-2(5)\s0\d@@7. cross-sectional area $A sub c$
@@@\0\0of common section
@@$C sub {c,^p}~=~f(a sub 0-9 ,{q sub p over q sub c},{q sub p' over q sub c},{q sub p\" over q sub c})$\u\s-2(7)\s0\d@8. coefficient $a sub 0$
@@\^@9. coefficient $a sub 1$
@@\^@10. coefficient $a sub 2$
@@\^@11. coefficient $a sub 3$
@@\^@12. coefficient $a sub 4$
@@\^@13. coefficient $a sub 5$
@@\^@14. coefficient $a sub 6$
@@\^@15. coefficient $a sub 7$
@@\^@16. coefficient $a sub 8$
@@\^@17. coefficient $a sub 9$
_
.sp 0.5
250@Flow conduit starting in@$m dot~=~rho~f ( D sub h ^A^L^k^SIGMA C sub i nu^DELTA P )$@2-6. see type 210
@diverging 4-leg junction\u\s-2(5)\s0\d@@7. cross-sectional area $A sub c$
@@@\0\0of common section
@@$C sub {c,^p}~=~f(a sub 0-9 ,{q sub p over q sub c},{q sub p' over q sub c},{q sub p\" over q sub c})$\u\s-2(7)\s0\d@8. coefficient $a sub 0$
@@\^@9. coefficient $a sub 1$
@@\^@10. coefficient $a sub 2$
@@\^@11. coefficient $a sub 3$
@@\^@12. coefficient $a sub 4$
@@\^@13. coefficient $a sub 5$
@@\^@14. coefficient $a sub 6$
@@\^@15. coefficient $a sub 7$
@@\^@16. coefficient $a sub 8$
@@\^@17. coefficient $a sub 9$
_
.sp 0.5
310@General flow inducer (pump or fan)@$DELTA P~=~sum from i=0 to 3 a sub i ( m dot / rho ) sup i$@2. min. volume flow $q dot sub min$
@@\^@3. max. volume flow $q dot sub max$
@@$q dot sub min~<=~m dot / rho~<=~q dot sub max$@4. coefficient $a sub 0$
@@\^@5. coefficient $a sub 1$
@@\^@6. coefficient $a sub 2$
@@\^@7. coefficient $a sub 3$
_
.sp 0.5
410@General flow corrector\u\s-2(5,8)\s0\d@$m dot ~=~ rho^f( rho sub 0^DELTA P sub 0^k sub vs^k sub v0^k sub vr^H / H sub 100 )$@2. standard density $rho sub 0$
@@@3. standard pressure $DELTA P sub 0$
@@@4. index for characteristic
@@@5. vol. flow if fully-open $k sub vs$
@@@6. theor. flow if closed $k sub v0$ (%)
@@@7. min. flow for charac. $k sub vr$ (%)
@@$H / H sub 100 ~=~ f(day^time^S sub l^H sub l^S sub u^H sub u )$@8. control period day type index
@@@9. control period start hour
@@@10. control period finish hour
@@@11. $H / H sub 100$ outside period (%)
@@@12. sensed property index
@@@13. signal lower limit $S sub l$
@@@14. $H / H sub 100$ at $S sub l$ (%)
@@@15. signal upper limit $S sub u$
@@@16. $H / H sub 100$ at $S sub u$ (%)
@@@17. $DELTA S$ to overcome hysteresis
_
.sp 0.5
420@Flow corrector with polynomial@$m dot ~=~f( rho A ^DELTA P^C)$@2. area $A$ of section
@flow resistance\u\s-2(5,8)\s0\d@@\0\0containing corrector
@@@3. coefficient $a sub 0$
@@$C~=~sum from i=0 to 3 a sub i ( H / H sub 100 ) sup i$@4. coefficient $a sub 1$
@@\^@5. coefficient $a sub 2$
@@\^@6. coefficient $a sub 3$
@@$H / H sub 100 ~=~ f(day^time^S sub l^H sub l^S sub u^H sub u )$@7. control period day type index
@@@8. control period start hour
@@@9. control period finish hour
@@@10. $H / H sub 100$ outside period (%)
@@@11. sensed property index
@@@12. signal lower limit $S sub l$
@@@13. $H / H sub 100$ at $S sub l$ (%)
@@@14. signal upper limit $S sub u$
@@@15. $H / H sub 100$ at $S sub u$ (%)
@@@16. $DELTA S$ to overcome hysteresis
_
.sp 0.5
450@Ideal (frictionless) open/shut\u\s-2(5,8)\s0\d@$m dot ~=~ 0$ or $ DELTA P ~=~ 0$@2. control period day type index
@flow controller@@3. control period start hour
@@@4. control period finish hour
@@@5. open(1)/shut(0) outside control period
@@@6. sensed property index
@@@7. signal set point $S sub sp$
@@@8. open(1)/shut(0) when $S ~>=~ S sub sp$
_
.sp 0.5
460@Fixed flow rates controller\u\s-2(5,8)\s0\d@$m dot /^ rho ~=~ q dot sub 0$ or $ ~=~ q dot sub l$ or $ ~=~ q dot sub u$@2. control period day type index
@flow controller@@3. control period start hour
@@@4. control period finish hour
@@@5. volume flow rate outside control period ($q dot sub 0$)
@@@6. sensed property index
@@@7. signal set point $S sub sp$
@@@8. volume flow rate ($q dot sub 0$) when $S ~<~ S sub sp$
@@@9. volume flow rate ($q dot sub 0$) when $S ~>=~ S sub sp$
.TE
.ps
.vs
\fI\s+2Notes\s0\fP
.nr Ti \w'(1) 'u
.in +\n(Tiu
.ti -\n(Tiu
(1) first supplementary data item is always fluid type (1 = air, 2 = water);
unless indicated otherwise, all data is expressed in SI (derived)
units, ie. s, m, kg, N
.ti -\n(Tiu
(2) identical to type 40 with $Cd~=~0.65~[ - ]$
.ti -\n(Tiu
(3) often set to: $Hr~=~1.50~[ m ]$
.ti -\n(Tiu
(4) often set to: $Cd~=~0.92~[ - ]$
.ti -\n(Tiu
(5) this component also needs supplementary data at the connection description
level
.ti -\n(Tiu
(6) $C sub {c,^p}$ is the local loss factor representing the dynamic losses
due to the junction. Subscript $c$ indicates common flow path. Subscript $p$
refers to the
junction's section which is connected to the conduit being described and
indicates either straight or branch flow path; subscript $p'$ then indicates
the other entrance/exit of the junction. $p'$ is defined by the first
supplementary data item at the connection description level. The expression
for the local dynamic loss factor is:
.EQ I
C sub {c,^p}
 ~=~ a sub 0
   ~+~ a sub 1 left ( {q dot sub p} over {q dot sub c} right )
   ~+~ a sub 2 left ( {q dot sub p} over {q dot sub c} right ) sup 2
   ~+~ a sub 3 left ( {q dot sub p'} over {q dot sub c} right )
   ~+~ a sub 4 left ( {q dot sub p'} over {q dot sub c} right ) sup 2
   ~+~ a sub 5 left ( {{q dot sub p} over {q dot sub c}} cdot
                      {{q dot sub p'} over {q dot sub c}} right )
   ~~~( - )
.EN
.ti -\n(Tiu
(7) $C sub {c,^p}$ is the local loss factor representing the dynamic losses
due to the junction. Subscript $c$ indicates common flow path. Subscript $p$
refers to the
junction's section which is connected to the conduit being described and
indicates either straight or branch flow path; subscripts $p'$ and $p\"$
then indicate the other entrances/exits of the junction. $p'$ is defined
by the first supplementary data item at the connection description level,
and $p\"$ is defined by the second supplementary data item. The expression
for the local dynamic loss factor is:
.KS
.EQ I
C sub {c,^p}
 ~=~ a sub 0
   mark ~+~ a sub 1 left ( {q dot sub p} over {q dot sub c} right )
        ~+~ a sub 2 left ( {q dot sub p} over {q dot sub c} right ) sup 2
        ~+~ a sub 3 left ( {q dot sub p'} over {q dot sub c} right )
        ~+~ a sub 4 left ( {q dot sub p'} over {q dot sub c} right ) sup 2
        ~+~ a sub 5 left ( {{q dot sub p} over {q dot sub c}} cdot
                           {{q dot sub p'} over {q dot sub c}} right )
.EN
.EQ I
 lineup ~+~ a sub 6 left ( {q dot sub p\"} over {q dot sub c} right ) 
        ~+~ a sub 7 left ( {q dot sub p\"} over {q dot sub c} right ) sup 2 
        ~+~ a sub 8 left ( {{q dot sub p} over {q dot sub c}} cdot 
                           {{q dot sub p\"} over {q dot sub c}} right ) 
        ~+~ a sub 9 left ( {{q dot sub p'} over {q dot sub c}} cdot 
                           {{q dot sub p\"} over {q dot sub c}} right ) 
        ~~~( - )
.EN
.KE
.ti -\n(Tiu
(8) "standard" here refers to conditions implicit
in $k sub vs ,~k sub v0 ,~k sub vr$
.br
index for characteristic: 1 = linear behaviour; 2 = logarithmic behaviour
.br
$H / H sub 100$ denotes the percentage valve position ($H$, ie. stem
displacement or blade angle) relative to fully open position $H sub 100$
.in +2.0c
.ti -2.0c
day type index:
1\ weekdays only; 2\ Saturday only; 3\ Sunday only; 4\ Saturday+Sunday;
5\ weekdays+Saturday; 6\ weekdays+Sunday; 7\ every day
.ti -2.0c
sensed property index:
0\ sensor defined in configuration control file;
1\ nodal temperature $T sub n1$ ($\(deC$)\u\s-2(5)\s0\d;
2\ signed nodal temperature difference $T sub n1~-~T sub n2$ ($K$) \u\s-2(5)\s0\d;
3\ absolute nodal temperature difference $| T sub n1~-~T sub n2 |$ ($K$) \u\s-2(5)\s0\d;
4\ nodal pressure $P sub n1$ ($Pa$) \u\s-2(5)\s0\d;
5\ signed nodal pressure difference $P sub n1~-~P sub n2$ ($Pa$) \u\s-2(5)\s0\d;
6\ absolute nodal pressure difference $| P sub n1~-~P sub n2 |$ ($Pa$) \u\s-2(5)\s0\d;
7\ signed mass flow rate ($kg / s$) in the connection from node $n1$ to $n2$\u\s-2(5)\s0\d;
8\ absolute mass flow rate ($kg / s$) in the connection from node $n1$ to $n2$\u\s-2(5)\s0\d;
9\ wind speed ($m / s$);
10\ wind direction (degrees clockwise from North);
11\ diffuse horizontal solar radiation ($W / m sup 2$);
12\ direct normal solar radiation ($W / m sup 2$);
13\ relative humidity of outdoor air (%)
.in -2.0c
when $S sub l <^S^<^S sub u $, $ H / H sub 100$ is found by linear interpolation
between $H sub l$ and $H sub u$ and taking into account the hysteresis
.in -\n(Tiu
.\" draw horizontal line and restore point size and vertical spacing
.ce
========================================================================
.ps
.vs
.MT
.\".ps \n(Ps
.\".vs \n(Vs
.sp 0.5
.ce
Table 16 Currently supported \fIfluid flow component types\fP.
.bp
.MT
.SH
7 Pressure coefficients file (optional)
.LP
Prior to creating a description of a building's
leakage distribution, it is necessary to
ensure that a number of pressure coefficient sets are
available to represent the relationship between free stream
wind velocities and the pressures generated on the various
building surfaces. A coefficient set is comprised of 16
values, each corresponding to wind approaching within a
22.5\(de compass sector. An individual pressure
coefficient then gives the surface pressure generated by
wind approaching from a given direction in terms of any
intervening site obstructions:
.EQ C
C sub id~=~ {P sub id} over {half rho V sub f sup 2}
.EN
.LP
where $C sub id$ is the pressure coefficient for some
surface location i and corresponding to wind from
direction d, $P sub id$ is the surface pressure ($N m sup -2$),
$rho$ the air density ($kg m sup -3$) and $V sub f$ the
free stream wind speed for direction d ($m s sup -1$).
.LP
The following table summarises the contents of the pressure
coefficients file. If the pressure coefficient for an
external surface is independent of wind direction - as in
the case of an unobstructed horizontal roof - then 16 equal
values must be entered.
.sp
.TS H
box center expand;
l cw(4i)
l lw(4i).
Record	Description of fields
_
.TH
1	T{
Number of coefficient sets held.
T}
2	T{
For first set: pressure coefficient for 16 compass
directions.
T}
3 $->$	T{
Repeat record 2 for each additional set.
T}
.TE
.sp 0.5
.ce
Table 17  Contents of a \fIpressure coefficients\fP file.
.sp 0.5
.LP
The 16 compass directions are expressed relative to the
external surface normal vector. The first coefficient
therefore corresponds to wind impinging normally on the
surface, with the following values corresponding to
22.5\(de, 45\(de, 67.5\(de, 90\(de, 112.5\(de,
135\(de, 157.5\(de, 180\(de,
202.5\(de, 225\(de, 247.5\(de, 270\(de,
292.5\(de, 315\(de and
337.5\(de progressing clockwise in plan from above.
A coefficient set can therefore be used for more than one
surface, if appropriate, since it is independent of absolute
surface orientation.
.LP
A standard pressure coefficients collection is available with ESP-r
and is called \fBpressc.db1\fP. The following table shows the
29 sets.
.ps 8
.vs 9
.TS H
box center;
c c
c c
c l.
Database	The pressure coefficient sets
Reference	of the file pressc.db1
_
.TH
1	 0.700  0.525  0.350 -0.075 -0.500 -0.450 -0.400 -0.300 -0.200 -0.300 -0.400 -0.450 -0.500 -0.075  0.350  0.525
2	-0.800 -0.750 -0.700 -0.650 -0.600 -0.550 -0.500 -0.450 -0.400 -0.450 -0.500 -0.550 -0.600 -0.650 -0.700 -0.750
3	-0.400 -0.450 -0.500 -0.550 -0.600 -0.550 -0.500 -0.450 -0.400 -0.450 -0.500 -0.550 -0.600 -0.550 -0.500 -0.450
4	 0.300 -0.050 -0.400 -0.500 -0.600 -0.500 -0.400 -0.450 -0.500 -0.450 -0.400 -0.500 -0.600 -0.500 -0.400 -0.050
5	 0.400  0.250  0.100 -0.100 -0.300 -0.325 -0.350 -0.275 -0.200 -0.275 -0.350 -0.325 -0.300 -0.100  0.100  0.250
6	-0.600 -0.550 -0.500 -0.450 -0.400 -0.450 -0.500 -0.550 -0.600 -0.550 -0.500 -0.450 -0.400 -0.450 -0.500 -0.550
7	-0.350 -0.400 -0.450 -0.500 -0.550 -0.500 -0.450 -0.400 -0.350 -0.400 -0.450 -0.500 -0.550 -0.500 -0.450 -0.400
8	 0.300 -0.100 -0.500 -0.550 -0.600 -0.550 -0.500 -0.500 -0.500 -0.500 -0.500 -0.550 -0.600 -0.550 -0.500 -0.100
9	 0.200  0.125  0.050 -0.100 -0.250 -0.275 -0.300 -0.275 -0.250 -0.275 -0.300 -0.275 -0.250 -0.100  0.050  0.125
10	-0.500 -0.500 -0.500 -0.450 -0.400 -0.450 -0.500 -0.500 -0.500 -0.500 -0.500 -0.450 -0.400 -0.450 -0.500 -0.500
11	-0.300 -0.350 -0.400 -0.450 -0.500 -0.450 -0.400 -0.350 -0.300 -0.350 -0.400 -0.450 -0.500 -0.450 -0.400 -0.350
12	 0.250 -0.025 -0.300 -0.400 -0.500 -0.400 -0.300 -0.350 -0.400 -0.350 -0.300 -0.400 -0.500 -0.400 -0.300 -0.025
13	 0.500  0.375  0.250 -0.125 -0.500 -0.650 -0.800 -0.750 -0.700 -0.750 -0.800 -0.650 -0.500 -0.125  0.250  0.375
14	 0.600  0.400  0.200 -0.350 -0.900 -0.750 -0.600 -0.475 -0.350 -0.475 -0.600 -0.750 -0.900 -0.350  0.200  0.400
15	-0.700 -0.700 -0.700 -0.750 -0.800 -0.750 -0.700 -0.700 -0.700 -0.700 -0.700 -0.750 -0.800 -0.750 -0.700 -0.700
16	-0.700 -0.700 -0.700 -0.700 -0.700 -0.650 -0.600 -0.550 -0.500 -0.550 -0.600 -0.650 -0.700 -0.700 -0.700 -0.700
17	 0.250  0.125  0.000 -0.300 -0.600 -0.750 -0.900 -0.850 -0.800 -0.850 -0.900 -0.750 -0.600 -0.300  0.000  0.125
18	 0.250  0.150  0.060 -0.150 -0.350 -0.470 -0.600 -0.550 -0.500 -0.550 -0.600 -0.470 -0.350 -0.150  0.060  0.160
19	 0.400  0.300  0.200 -0.200 -0.600 -0.550 -0.500 -0.400 -0.300 -0.400 -0.500 -0.550 -0.600 -0.200  0.200  0.300
20	-0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600 -0.600
21	-0.600 -0.600 -0.600 -0.580 -0.550 -0.550 -0.550 -0.500 -0.450 -0.500 -0.550 -0.550 -0.550 -0.580 -0.600 -0.600
22	 0.150  0.035 -0.080 -0.240 -0.400 -0.575 -0.750 -0.675 -0.600 -0.675 -0.750 -0.575 -0.400 -0.240 -0.080  0.035
23	 0.060 -0.030 -0.120 -0.160 -0.200 -0.290 -0.380 -0.340 -0.300 -0.340 -0.380 -0.290 -0.200 -0.160 -0.120 -0.030
24	 0.180  0.165  0.150 -0.075 -0.300 -0.310 -0.320 -0.260 -0.200 -0.260 -0.320 -0.310 -0.300 -0.075  0.150  0.165
25	-0.490 -0.475 -0.460 -0.435 -0.410 -0.435 -0.460 -0.475 -0.490 -0.475 -0.460 -0.435 -0.410 -0.435 -0.460 -0.475
26	-0.490 -0.475 -0.460 -0.435 -0.410 -0.435 -0.460 -0.430 -0.400 -0.430 -0.460 -0.435 -0.410 -0.435 -0.460 -0.475
27	 0.060 -0.045 -0.150 -0.190 -0.230 -0.420 -0.600 -0.510 -0.420 -0.510 -0.600 -0.420 -0.230 -0.190 -0.150 -0.045
28	 0.900  0.700  0.500  0.200 -0.100 -0.100 -0.200 -0.200 -0.200 -0.200 -0.200 -0.100 -0.100  0.200  0.500  0.700
29	-0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100 -0.100
.TE
.MT
.ps
.vs
.sp 0.5
Table 18  Pressure coefficient sets of the \fIpressc.db1\fR database.
.sp 0.5
.LP
The collection is comprised of 29 coefficient sets.
The first 27 are taken from a publication of the IEA's Air Infiltration
and Ventilation Centre (\fIAir Infiltration Calculation Techniques - An
Applications Guide\fP). These sets
can be used (with care) for low-rise buildings (up to 3 storeys).
.LP
The following table describes each coefficient set in terms of surface
aspect, dimensions and exposure.
.ps 8
.vs 9
.TS H
box center;
cb cb cb cb
cb cb cb cb
c l c l.
Database	Facade	Length to width	Exposure
Reference	Description	Ratio
_
.TH
1	Wall	1:1	Exposed
2	Roof, pitch > 10 deg	1:1	Exposed
3	Roof, pitch 10-30 deg	1:1	Exposed
4	Roof, pitch > 30 deg	1:1	Exposed
5	Wall	1:1	Semi-Exposed
6	Roof, pitch < 10 deg	1:1	Semi-Exposed
7	Roof, pitch 10-30 deg	1:1	Semi-Exposed
8	Roof, pitch > 30 deg	1:1	Semi-Exposed
9	Wall	1:1	Sheltered
10	Roof, pitch < 10 deg	1:1	Sheltered
11	Roof, pitch 10-30 deg	1:1	Sheltered
12	Roof, pitch > 30 deg	1:1	Sheltered
13	Long Wall	2:1	Exposed
14	Short Wall	1:2	Exposed
15	Roof, pitch < 10 deg	2:1	Exposed
16	Roof, pitch 10-30 deg	2:1	Exposed
17	Roof, pitch > 30 deg	2:1	Exposed
18	Long Wall	2:1	Semi-Exposed
19	Short Wall	1:2	Semi-Exposed
20	Roof, pitch < 10 deg	2:1	Semi-Exposed
21	Roof, pitch 10-30 deg	2:1	Semi-Exposed
22	Roof, pitch > 30 deg	2:1	Semi-Exposed
23	Long Wall	2:1	Sheltered
24	Short Wall	1:2	Sheltered
25	Roof, pitch < 10 deg	2:1	Sheltered
26	Roof, pitch 10-30 deg	2:1	Sheltered
27	Roof, pitch > 30 deg	2:1	Sheltered
28	Wall	1:1	Exposed
29	Roof, no pitch	1:1	Exposed
.TE
.ps
.vs
.bp
.MT
.SH
8 System configuration file (mandatory)
.LP
This is the file which is passed to \fBbps\fP, along with
the configuration control file if one exists, to define the
building and/or plant problem for simulation processing. The
file contains site details, a reference to the various zone
files which define the building problem, a reference to the
plant components which comprise the plant network, and
information on how the building zones and plant components
interlock. The following table summarises file contents.
.sp
.ps -2
.vs -2
.TS H
box center;
l cw(4.5i)
l lw(4.5i).
Record	Description of fields
_
.TH
1	T{
Configuration type (1, 2 or 3) defining a building only,
plant only or building/plant simulation.
T}
2	T{
Site latitude and longitude difference.
T}
3/1	T{
Site exposure type and ground reflectivity.
T}
3/2	T{
If exposure type=8, three user specified view factors are
held; in order: buildings, sky and ground.
T}
_
.T&
l s.
T{
Then if a building simulation is required .....
T}
_
.T&
l lw(4.5i).
4	*\0Building (this record may be omitted)
5	T{
Title of building configuration.
T}
6	T{
Number of zones.
T}
7	T{
For first zone: code number.
T}
8	T{
For first zone: operation file name.
T}
9	T{
For first zone: geometry file name.
T}
10	T{
For first zone: construction file name.
T}
11	T{
For first zone: utilities file index.
T}
12	T{
For first zone: utilities file name if the record 11 index is
1.
T}
13 $->$ I	T{
Repeat records 7 through 12 for each additional zone in
turn.
T}
I+1	T{
Total number of zone bounding surfaces in building
configuration.
T}
I+2 $->$ J	T{
For each bounding surface: zone number, surface number,
connection type (1-5), supplementary data (2 items).
T}
J+1 $->$ K	T{
Sets of ground temperature profiles if indicated by
the supplementary data for type 4 connections.
T}
K+1	T{
Air flow simulation index (0 or 1). If 0, no building air flow
simulation is performed. If index 1, the following 4 records
are entered.
T}
K+2	T{
Configuration mass (=air) flow network description file name.
T}
K+3	T{
Wind pressure coefficients file.
T}
K+4	T{
Name of mass flow results file.
T}
K+5	T{
For each building zone, an air flow node is referenced by
name or number
T}
_
.T&
l s.
T{
Then if a plant simulation is required .....
T}
_
.T&
l lw(4.5i).
K+2 or K+6, say L	*\0Plant (this record may be omitted)
L+1	T{
Name of plant components' database;
\fBplantc.db1\fP.
T}
L+2	T{
Plant configuration title.
T}
L+3	T{
Number of plant components,
required matrix type (1/energy only; 2/energy & first phase mass;
3/energy & second phase mass).
T}
L+4	T{
For first component: code number, database reference code.
T}
L+5	T{
For first component: number of controlled variables and
associated data array for each.
T}
L+6 $->$ M	T{
Repeat records L+4 and L+5 for each plant component.
T}
M+1	T{
Number of component inter-connections.
T}
M+2 $->$ N	T{
For each inter-connection receiving node: component number,
node number, connector type, supplementary data (2 items),
mass diversion ratio.
T}
N+1	T{
Number of plant containments.
T}
N+2 $->$ P-1	T{
For each containment: component number, containment type,
supplementary data (3 items).
T}
P	T{
Plant fluid flow simulation index (0 or 1). If 1 and building
air flow index equal to 0, the following 4 records are entered.
If 1 and building air flow index equal to 1, enter record Q only.
T}
P+1	T{
Configuration mass flow network description file name.
T}
P+2	T{
Wind pressure coefficients file name.
T}
P+3	T{
Name of mass flow results file.
T}
P+4 or Q	T{
For each plant component inter-connection receiving node, a
mass flow network \fIconnection\fP is referenced by number
T}
.TE
.ps
.vs
.sp 0.5
.ce
Table 19 Contents of the \fIsystem configuration\fP file.
.sp 0.5
.LP
A number of important points are now discussed in relation
to describing a configuration.
.IP \(bu
By simply changing the configuration type, from 3 to 1 for
example, the same file can be used to describe a combined
building/plant configuration and a building only
configuration. This would allow a study of the performance
of several building design elements prior to the
introduction of mechanical control.
.IP \(bu
Site latitude is +ve if north of the equator, -ve if south.
The longitude difference is the
.ul 1
difference
between the site longitude and some reference longitude
located within the time zone. It is used to determine the
difference between local mean time and solar time. If the
Greenwich meridian is used as the reference, then the
longitude difference becomes the absolute longitude. \fBSites
to the east of the reference longitude are assigned a +ve
difference, sites to the west a -ve difference\fP.
.IP \(bu
The site exposure type is used to determine the appropriate
surroundings, sky and ground view factors to be used in external
longwave radiation calculations. The following types are
active
.IP
\fB1\fP: city centre, normal case / \fB2\fP: urban site,
normal case / \fB3\fP: rural site, normal case / \fB4:\fP
city centre, normal exposure / \fB5\fP: city centre,
sheltered exposure / \fB6\fP: isolated rural site / \fB7\fP:
totally enclosed configuration / \fB8\fP: user specified
view factors.
.IP \(bu
When specifying the zone files it is recommended that the full file
address, including sub-directory paths, be given so that simulations
can be initiated from another disk area.
.IP \(bu
The information of records I+1 through J define zone
interlocking. For each zone bounding surface a connection
type is defined as follows
.IP
\fB0\fP: defines the surface as external. No supplementary
data is required.
.IP
\fB1\fP: the surface is connected to a zone which is not
participating in the configuration but which is
environmentally identical to the zone to which the surface
belongs. No supplementary data is required.
.IP
\fB2\fP: the surface is connected to a zone which is not
participating in the configuration but whose environmental
conditions are known and constant. The 2 supplementary data
items are used to define the constant temperature ($ \(de C $) of
this zone and to provide an estimate of any radiation ($W m sup -2$)
absorbed by the outermost boundary of the surface
in question.
.IP
\fB3\fP: the surface connects to another participating zone.
The 2 supplementary data items then define the coupled zone
and the surface therein which abuts the surface in question
(remember at this point only geometric zone skeletons are
being interlocked).
.IP
\fB4\fP: the surface is in contact with the ground. In this case, the
first supplementary data item is a positive integer or zero.
.IP
If the former, then it points to one of a set of temperature profiles
already installed in \fBbps\fP. Each of these represents the annual
variation in ground temperature, month-by-month, for different
geographical locations. Figure 14 shows these temperature sets. The
second supplementary data item is then zero.
.sp 0.5
.ps 8
.vs 9
.TS H
box center;
c c c
l l l.
Profile	Mean Monthly Temperature (\(deC)	Description
_
.TH
1	T{
7.28 6.5 6.56 7.33 9.06 11.39 13.5 14.33 14.11 11.72 10.72 8.67
T}	T{
Typical UK: level open terrain at 1.3m depth.
T}
2	T{
6.0 8.0 10.0 12.0 13.0 14.0 15.0 14.0 13.0 12.0 10.0 8.0
T}	T{
Characteristic step-wise variation of 6-15\(deC.
T}
3	T{
4.9 4.4 4.1 6.4 9.0 12.9 15.5 15.5 16.4 15.2 9.4 8.7
T}	T{
Temperatures set at previous month average: data from Kew 1967.
T}
4	T{
3.5 3.61 5.22 8.11 11.39 14.61 16.22 15.78 13.39 10.22 6.72 4.78
T}	T{
12km from Glasgow at 32.2m altitude, 0.305m depth beneath a short
grass surface measured at 9h00 each day.
T}
5	T{
6.72 6.11 6.28 7.39 9.28 11.39 13.11 13.72 13.28 11.78 9.72 7.89
T}	T{
12km from Glasgow at 32.2m altitude, 1.219m depth beneath a short
grass surface measured at 9h00 each day.
T}
.TE
.ps
.vs
.sp 0.5
.ce
Figure 14  Ground temperature sets.
.sp 0.5
.IP
If the latter, then a user-specified ground temperature profile
will be used by \fBbps\fP. In this case the second supplementary data
item is a positive integer which refers to one of (perhaps) several
user-specified profiles. After all connections have been specified,
the temperature profiles are entered.
.IP
\fB5\fP: the surface is adiabatic.
.\" .IP
.\" \fB6\fP: the surface is part of a zone which is contained by another
.\" zone. This is the appropriate choice when modelling building contents
.\" or capacity features such as electrical storage units.  The first of the
.\" two supplementary data items specifies the containing zone, the second
.\" item is zero.  Note that any zone capacity so defined will not receive
.\" any direct shortwave solar energy penetrating the containing zone. It
.\" will merely act to dampen the fluctuations in the zone temperatures by
.\" exchanging energy convectively and by longwave radiation.  If such a
.\" capacity/ solar coupling is desired it will be necessary to enter the
.\" capacity as part of the containing zone's geometry definition.
.IP \(bu
If air flow simulation is to be performed by the incorporated version
of \fBmfs\fP, the air flow simulation index of record K+1 has to be set
to 1. In that case, record K+2 identifies the mass flow network
description file, and record K+3 identifies the file holding the wind
pressure coefficients. After a \fBbps\fP run, the mass (=air) flow
results file of record K+4 will hold all time dependent mass flows for
each network branch.  These results supplement those of the simulation
results file also produced by \fBbps\fP for analysis via \fBres\fP. The
mass flow results file can be inspected by terminal/printer listing or,
if tables and graphs are required, via the output facilities of
\fBmfs\fP.  The data of record K+5 defines the relationship between
building zones and the nodes established for mass flow simulation
purposes. The building zones and the mass flow network nodes may or may
not match. If a building zone does not have an mass flow network
counterpart then a \fB0\fP is entered. In this event, the default air
flow profiles of the zone operation file, or the time-series air flows
of the zone air flow file should one exist, will be assumed.
.IP \(bu
If a plant network is to participate in the simulation, it is necessary
to decide on the number of components.  For example, a simple air
conditioning system may be comprised of a mixing box, humidifier,
supply fan, cooler and heater. Or it may be considered necessary to
append a return air plenum and several duct lengths to represent the
distribution system. Once a decision has been made \fBpdb\fP must be
used to examine ESP-r's plant components' database
(\fBplantc.db1\fP) to determine if the required components are on
offer. Should a component be missing, a mathematical model must be
created and installed in ESP-r. Note that since ESP-r's plant
models are not confined to the steady state, this procedure may not be
a trivial one. Section 5 details the formulation and installation of a
dynamic component model.
.IP \(bu
At this stage an index is entered to specify
the type of simulation required as
follows
.IP
\fB1\fP: indicates that an energy only simulation is
required. This is an appropriate option for all simulations
in which circuit mass flow rates can be prescribed.
.IP
\fB2\fP: indicates that an energy plus one phase mass
balance is required. This option is appropriate for a
simulation in which a single phase fluid (eg water) is to be
controlled on the basis of the predicted temperature at some
point in the plant network. In this case two matrices are
established for the plant network; one to represent energy
balance, the other to represent mass balance.
.IP
\fB3\fP: indicates that an energy plus two phase mass
balance is required. This is an appropriate choice in the
case of air conditioning systems, for example, where it is
necessary to control the water vapour level within the air
stream. In this case three matrices are established for the
plant network; one for energy balance, and one for each of the two
phase mass balances.
.IP
Of course, the installed mathematical models
must be capable of generating the
information required by the requested matrix type. For
example, it is possible to install an energy only model in
\fBbps\fP and then to request a mass balance for that
component. Such a
mis-match would be detected and disallowed by \fBesp-r\fP.
.IP \(bu
For each plant component a code number is given
and the component is then defined by a coded reference to
its entry in the plant components' database.
.IP \(bu
When a component model is formulated, the author must define
which variables
.UL may
be subjected to control action. For example, in a gas-fired
water boiler model, the heat flux injected to the combustion
chamber may be an elected control variable. When the
configuration control file is established (see section 9), a
control loop may then be assigned to determine this variable
on the basis of some sensed condition and active control
law. In the event that such a loop is not established, each
control variable associated with a component must be
assigned a realistic value.
Record L+5
does this. Consider the case of an air conditioning cooling coil. In a
simple component model, the heat flux extracted from the air stream by
the coolant may be treated as a control variable. A control loop is
then established, which in terms of some control system behaviour, acts
to determine the required flux exchange to achieve some stable off-coil
condition. If such a control loop is not set up, then the flux exchange
will remain constant at the value assigned in the system configuration
file as the default.
.IP \(bu
The plant components are now inter-connected, similar to
the building zone coupling. Note, however,
that connections are only defined for
.UL receiving
nodes. Each plant
component is referenced in terms of its code number and its
connected node, then a connection type is given
followed by supplementary data to define the connections:
.IP
\fB1\fP: the node is connected to a component which
is not participating in the configuration but which is environmentally
identical to the component to which the node belongs. No supplementary
data is required.
.IP
\fB2\fP: the node is connected to a component which is not
participating in the configuration but whose environmental conditions
are known and constant. The 2 supplementary data items are used to
define the constant temperature (expressed in $0.1~\(de C$) and
constant humidity ratio (in $10 sup -4~kg /^ kg$) of this component.
.IP
\fB3\fP: the node connects to another participating component.
The 2 supplementary data items then define the coupled component
and the node therein.
.IP
\fB4\fP: the node is connected to a building zone air point. The
1st supplementary data item defines the connected building zone.
.IP
The 3rd supplementary data item always defines the mass diversion ratio
(ie the ratio between mass flow originating from connected node and
total mass flow leaving that node). Note that in case of mass flow
network simulation this data will be obsolete.
.IP \(bu
The containment information of record N+2 is optional and
is used to define
the immediate boundary condition of a plant component. With
many components, the exchange of heat energy with the
surroundings is negligible relative to the internal energy
processes. For these components no containment information
is required and no environmental interaction will take
place. With other components a containment type can be entered
as follows:
.IP
\fB0\fP: outside air temperature is used and the 1st supplementary
data item defines the variation from this value (de- or increment)
.IP
\fB1\fP: containment is at temperature of a specified plant node.
The 3 supplementary data items define the component, the node
and some constant temperature shift (de- or increment) respectively.
The self containment case can be identified by setting the first 2
items equal to 0.
.IP
\fB2\fP: containment is at a constant temperature, the value of which
is in the 1st supplementary data item.
.IP
\fB3\fP: containment is a building zone where the 3 supplementary data
items define the building zone, the surface number and the node number
therein (counting from `outside') respectively. If the latter two are
both zero then the zone air temperature is used. In case only the
last item is zero, then the surface node temperature is used.
.TS
box center;
lb.
T{
Note that the connection between building zones and plant
components - in terms of delivered plant energy - is
specified as part of the zone control function as explained
in the following sub-section.
T}
.TE
.IP \(bu
The mass flow simulation index of record P, indicates whether or not
mass flow simulation will be performed by the incorporated version of
\fBmfs\fP. If not, the mass flow balance will be based on mass
diversion ratios of record M+2. In case the air flow simulation index
of record K+1 is zero, records P+1 to P+3 identify the mass flow
problem description files and the mass flow results file respectively.
After a \fBbps\fP run, the mass flow results file of record K+4 or P+3
will hold all time dependent fluid mass flows for each network branch.
These results supplement those of the simulation results file also
produced by \fBbps\fP for analysis via \fBres\fP. The mass flow results
file can be inspected by terminal/printer listing or, if tables and
graphs are required, via the output facilities of \fBmfs\fP.
.br
If the mass flow index of record P is 1, then the data of record P+4 or
Q defines the relationship between the \fIreceiving nodes\fP of the
\fIplant component\fP inter-connections and the \fIconnections\fP
established for the mass flow network.  In contrast to the building
zones, each plant component inter-connection receiving node \fImust\fP
be assigned a mass flow network counterpart.
.IP \(bu
It should be noted that it is quite easy to define a mass flow
network which has no unique solution. One requirement for solution is
that at least one of the node pressures is known. A second
requirement is that all nodes must be linked, through some path, to
a known pressure node. It is advised to first examine a mass
flow network with \fBmfs\fP, to see if it is solvable, before it
is linked to the building and/or plant configuration.
.sp
.LP
Figure 15 shows some example building/plant system
configurations and some alternative system configuration
files that could result from an \fBesp-r\fP session.  Figure 16
shows a typical configuration file listing (here for a simple one zone
problem).
.KF
.sp
.ML
.so /usr/esru/esp-r/training/simple/cfg/bld_simple.cfg
.ES
.MT
.sp 0.5
.LP
Figure 16  Example system configuration file
.sp 0.5
.KE
.bp
.SH
9 Configuration control file (optional but usually
required)
.LP
All building and plant control details are held in one file
- the
.ul 1
configuration control file.
This holds details on all sensor and actuator locations and
defines the time dependent operation of the active
controllers which link a sensor and actuator throughout a
simulation.
.LP
The building's control strategy is comprised of one or more
.ul 1
control functions.
These are then associated with building
zones to define the time dependent control objectives. A plant system,
if active, is governed by one or more
.ul 1
control loops.
In essence, control functions and loops are the same, differing only
in the types of control laws used to link the sensor and actuator. 
.LP
The following table summarises the contents of the configuration control
file (usually named ?.ctl).
.sp
.ps 8
.TS H
box center expand;
l cw(4.5i)
l lw(4.5i).
Record	Description of Fields
_
.TH
1	T{
Identifying character string for overall control ($<=$ 12 characters).
T}
_
.T&
l s.
T{
Then if building control functions exist .....
T}
.T&
l lw(4.5i).
_
2	T{
* Building (if no functions, go directly to record 13).
T}
3	T{
Identifying character string for building control regime ($<=$ 12 characters).
T}
4	T{
Number of control functions.
T}
_
.T&
l s.
T{
For each control function cycle to record 12  .....
T}
.T&
l lw(4.5i).
_
5	T{
* Control Function
T}
6	T{
Sensor location (3 data items).
T}
7	T{
Actuator location (3 data items).
T}
8	T{
Number of control day types.
T}
_
.T&
l s.
T{
For each day type cycle to record 12 .....
T}
.T&
l lw(4.5i).
_
9	T{
Start and finish
dates of validity (year day numbers, January 1st = day 1).
T}
10	T{
Number of distinct
control periods.
T}
_
.T&
l s.
T{
For each control period cycle to record 12 .....
T}
.T&
l lw(4.5i).
_
11	T{
Controller type, control law, period start time.
T}
12	T{
Number of data items associated with the control law, then data values.
T}
13	T{
List of associated control functions for each zone in
system configuration.
T}
_
.T&
l s.
T{
Then if plant control loops exist .....
T}
.T&
l lw(4.5i).
_
14	T{
* Plant
T}
15	T{
Identifying character string for plant control regime ($<=$ 12 characters).
T}
16	T{
Number of plant control loops.
T}
.T&
l s.
_
T{
For each control loop cycle to record 24  .....
T}
.T&
l lw(4.5i).
_
17	T{
* Control loop
T}
18	T{
Sensor location (3 data items).
T}
19	T{
Actuator location (3 data items).
T}
20	T{
Number of control day types.
T}
.T&
l s.
_
T{
Then for each day type cycle to record 24 .....
T}
.T&
l lw(4.5i).
_
21	T{
Start and finish dates of validity.
T}
22	T{
Number of distinct control periods.
T}
.T&
l s.
_
T{
Then for each control period cycle to record 24 .....
T}
.T&
l lw(4.5i).
_
23	T{
Controller type, control law, period start time.
T}
24	T{
Number of data items associated with the control law, then data values.
T}
.TE
.ps
.sp 0.5
.ce
Table 20 Contents of the \fIconfiguration control\fP file.
.sp 0.5
.LP
Several important points should be noted.
.IP \(bu
A configuration control file may contain any number of control functions,
some of which may be referenced to dictate zone conditions.
This matching is undertaken by the user within \fIbps\fP at runtime. All
specified control loops will act on the defined plant network. Of course,
if a plant network is not defined (in the system configuration file), then
any defined control loops will be ignored by \fIbps\fP.
.IP \(bu
If no configuration control file is offered to \fIbps\fP then the entire
system configuration as defined will `free-float' throughout the
simulation period. In the same way, any building
zone or plant component not assigned a control function or loop will
`free-float' under the influence of the other zones and components active
in the simulation.
.IP \(bu
A sensor exists to measure some control variable for transmission to
the control law representing some active controller.
Sensors location is defined by four data items $I sub 1$, $I sub 2$,
$I sub 3$ and $I sub 4$ assigned the following meanings.
.sp
.ps 7
.TS H
box center expand;
cb s cb s cb s cb s
c cw(1i) c cw(1i) c cw(2i) c cw(2i)
lb cw(1i) lb cw(1i) lb cw(2i) lb cw(2i).
$I sub 1$	$I sub 2$	$I sub 3$	$I sub 4$
Value	Description	Value	Description	Value	Description	Value	Description
_
.TH
>0	T{
Sensor measuring a zone-side temperature. Numerical value defines
zone.
T}	=0	T{
Zone air temperature sensed.
T}	=0	T{
ie not used.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
>0		>0	T{
Indicates that the sensor is located at a surface or within
a construction.
T}	=0	T{
Sensor measuring surface $I sub 2$ temperature.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
>0		>0		>0	T{
Sensor measuring internal construction state. $I sub 3$ defines
location: position 1 is outermost surface, 2 is centre plane of
outermost homogeneous element, 3 is at boundary between two outermost
homogeneous elements, 4 is at centre plane of next to outermost
homogeneous element, and so on.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=0	T{
Sensor measuring air temperature of whichever zone the control function
is associated with at simulation time.
T}	=0	T{
ie not used
T}	=0	T{
ie not used
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
-1	T{
Sensor measuring the temperature of a plant component node.
T}	>0	T{
$I sub 2$ identifies the plant component.
T}	>0	T{
$I sub 3$ identifies the location (node) within the component.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
-2	T{
Sensor measuring a mix of zone air and mean radiant temperature.
T}	>0	T{
$I sub 2$ identifies the zone.
T}	>0	T{
$I sub 3$ is the convective weighting factor (percent), say \fIC\fP. The
sensed temperature is then determined from:
$size 7 {theta sub s~=~{{theta sub a~ C} over 100}~+~{{theta sub r~(100-C)} over 100}}$;
where $theta$ is temperature
and s, a and r indicate sensed, air and mean radiant values
respectively.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=-3	T{
Sensor measuring ambient conditions
T}	=0	T{
Dry bulb temperature.
T}	=0	T{
ie not used.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=-3		=1	T{
Sol-air temperature.
T}	=0	T{
ie not used.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=-3		=2	T{
Wind velocity.
T}	=0	T{
ie not used.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=-3		=3	T{
Wind direction.
T}	=0	T{
ie not used.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=-3		=4	T{
Diffuse horizontal radiation.
T}	=0	T{
ie not used.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=-3		=5	T{
Direct normal radiation.
T}	=0	T{
ie not used.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=-3		=6	T{
Relative humidity.
T}	=0	T{
ie not used.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
_
=-99	T{
Multi-layered construction thermo-physical
property substitution mode.
T}	>0	T{
Zone air temperature value above which substitution
is required.
T}	>0	T{
Zone air temperature value below which substitution
is required.
T}	T{
$=>$ 0
T}	T{
Supplementary or nested control function (0 means none).
T}
.TE
.ps
.sp 0.5
.ce
Table 21 Sensor location definition.
.sp 0.5
.IP
Thus 0,0,0,0 would indicate control on the air temperature of whichever
zone was assigned the corresponding control function (no nested control function);
5,0,0,4 would indicate zone 5 air temperature control with control function 4
nested (that is called after the current control function); 3,5,0,0
would indicate zone 3, construction 5 surface temperature control and
no nested control function; 2,6,1,0 would
indicate zone 2, construction 6, outermost surface temperature control and
no nested control function;
-1,15,3,1 would indicate plant component 15, node 3 temperature control with
control function 1 nested;
-2,7,65,0 would indicate zone 7 mixed temperature control with a 65 percent air
temperature weighting, 35 percent mean radiant temperature weighting and
no nested control function; and
-99,25,10,0 would indicate that the associated zone should have up to
three of its constructions substituted if the zone air temperature
rises above 25\(deC or falls below 10\(deC.
.IP
The 0,?,?,? sensor location allows the same control function to
be used for more than one zone. This will greatly reduce the size
and complexity of the configuration control file in the case of
large multizone problems.
.IP \(bu
Actuators exist to transmit the output of a controller to some building zone or
plant component, usually to reduce the deviation of the sensed control variable
from some user-specified value (or set point).
Like the sensor, actuator location is defined by 3 data items (say $J sub 1$,
$J sub 2$ and $J sub 3$). Note however that actuators cannot be placed
external to the building.
.sp
.ps 7
.TS H
box center expand;
cb s cb s cb s
c cw(1i) c cw(1i) c cw(2i)
lb cw(1i) lb cw(1i) lb cw(2i).
$J sub 1$	$J sub 2$	$J sub 3$
Value	Description	Value	Description	Value	Description
_
.TH
>0	T{
Actuator located in zone. Numerical value defines
zone.
T}	=0	T{
Zone air point.
T}	=0	T{
ie not used.
T}
_
>0		>0	T{
Indicates that the actuator is located at a surface or within
a construction.
T}	=0	T{
Actuator located at surface $J sub 2$.
T}
_
>0		>0		>0	T{
Actuator located inside a construction. $J sub 3$ defines
location: position is specified analogous to that for a sensor.
T}
_
>0		>0		>0	T{
Alternatively this definition, when used in conjunction with a
type -99,?,?,? sensor, defines the three multi-layered constructions
for thermo-physical property substitution throughout a simulation.
Either or both of the $J sub 3$ and $J sub 3$ definitions may
be zero if only one or two constructions are to be substituted.
T}
_
=0	T{
Actuator is located at the air point of whichever zone the control
function is associated with at simulation time.
T}	=0	T{
ie not used.
T}	=0	T{
ie not used.
T}
_
-1	T{
Actuator located within a plant component.
T}	>0	T{
$J sub 2$ identifies the plant component.
T}	>0	T{
$J sub 3$ identifies the location (node) within the component.
T}
_
-2	T{
Actuator is a special type which will input a convective and radiant flux
to a zone.
T}	>0	T{
$J sub 2$ identifies the zone.
T}	>0	T{
$J sub 3$ is the convective weighting factor (percent), say \fIC\fP. The
injected convective flux to the air point is then determined
from: $size 7 {q sub c~=~{q sub cl~ C} over 100}$
and the injected radiant flux to the zone surfaces
is given by $size 7 {q sub r~=~{q sub cl~(1-C)} over 100}$; where q is flux
and c and r indicate convective and radiant fluxes 
respectively and $q sub cl$ is some flux quantity produced by an
active control law in response to the sensed control variable.
T}
.TE
.ps
.sp 0.5
.ce
Table 22 Actuator location definition.
.sp 0.5
.IP
Again the 0,?,? option permits the same control function to be
associated with a number of different zones.
.IP \(bu
The actual property sensed by the sensor and actuated at the actuator
is controlled by the controller
.ul 1
type
of records 11 and 23. The following possibilities exist:
.sp
.TS H
box center tab(@);
c l l
n l l.
Index@Sensed property@Actuated property
_
.TH
0@temperature@heat flux
1@temperature@flow rate
2@enthalpy@heat flux
3@enthalpy@flow rate
4@1st phase mass flow rate@heat flux
5@1st phase mass flow rate@flow rate
6@2nd phase mass flow rate@heat flux
7@2nd phase mass flow rate@flow rate
8@additional plant output@heat flux
9@additional plant output@flow rate
10@temperature@variable expecting numerical value
11@enthalpy@variable expecting numerical value
12@1st phase mass flow rate@variable expecting numerical value
13@2nd phase mass flow rate@variable expecting numerical value
14@additional plant output\u\(dg\d@variable expecting numerical value
.TE
.sp 0.5
.ce
Table 23 Active controller types.
.sp 0.5
.FS \u\(dg\d
Type 14 is also the appropriate choice in case of a sensor type -3
and sensed variable other than temperature or enthalpy
.FE
.IP \(bu
Control day types are days during which some specified control regime
is in force. Any number of day types can be specified in terms of a start
and finish date. This allows many control possibilities: seasonal requiring
4 day types, monthly requiring 12, weekly requiring 52, summer and winter
with holidays treated differently from both, daily requiring 365!, and so on.
If the number of day type is given as 0 then this implies the special case
of Weekday/Saturday/Sunday control in which only 3 day types are active
corresponding to weekdays, Saturdays and Sundays.
.IP \(bu
Day types are then subdivided into distinct periods during which the
control action is fixed. For each period a control type is specified
as defined in the foregoing table. Reference is then made to a control
law. This defines a control algorithm which, throughout the period, will
represent the logic of some controller (real or imaginary). ESP-r allows
the insertion of new control laws. The procedure to be followed is detailed
in section 5. The following tables lists the control laws currently on
offer for use within building control functions and plant control loops.
In each case the required data values of records 12 and 24 are
also given.
.sp
.ps 8
.TS H
box center expand;
cb cb
c lw(5i).
Control law	Description
_
.TH
1	T{
Ideal control offering different heating and cooling set points.  When
invoked will cause the sensed condition to attain the specified set point.
Heating and cooling capacities can be restricted so that the set points
may not be attainable.  Suitable for use only with a type 0 controller.
T}
	T{
6 required data items:
T}
	T{
1; maximum heating capacity (W)/
2; minimum heating capacity (W)/
3; maximum cooling capacity (W)/
4; minimum cooling capacity (W)/
5; heating set point for control variable (\(deC)/
6; cooling set point for control variable (\(deC).
T}
_
2	T{
A free-float controller imposing no control action.
T}
	T{
No required data items.
T}
_
3	T{
An ideal pre-heat or pre-cool algorithm.  When activated, the control
variable will evolve, exponentially, towards some given set point, arriving
there by the end of the period for which this control action is defined.
Suitable for use only with a type 0 controller.
T}
	T{
6 required data items:
T}
	T{
1; maximum heating capacity (W)/
2; minimum heating capacity (W)/
3; maximum cooling capacity (W)/
4; minimum cooling capacity (W)/
5; heating set point for control variable (\(deC)/
6; cooling set point for control variable (\(deC).
T}
_
4	T{
Ideal fixed heat injection or extraction.
If the sensed temperature falls below the user-specified
heating actuation point or rises above the cooling
actuation point, then the specified flux is added or extracted
convectively.  Suitable for use only with a type 0 controller.
T}
	T{
4 required data items:
T}
	T{
1; heating flux (W)/
2; cooling flux (W)/
3; actuation temperature for heating (\(deC)/
4; actuation temperature for cooling (\(deC).
T}
_
5	T{
Proportional+integral+derivative (PID) control action suitable for 
use with a type 0 controller.
T}
	T{
Care must be taken in the selection of the maximum and minimum heating
and cooling capacities.  For example, if the maximum capacity is too large, then
the controlled temperature will remain at or above the upper limit.
T}
	T{
9 required data items if P only control;
10 required data items if PI or PD control;
11 required data items if PID control.
T}
	T{
1; control mode: 1 if P control; 2 if PI;3 for PD control;4 for PID./
2; maximum heating capacity (W)/
3; minimum heating capacity (W)/
4; set point temperature for heating (\(deC)/
5; throttling range for heating (\(deC)/
6; maximum cooling capacity (W)/
7; minimum cooling capacity (W)/
8; set point temperature for cooling (\(deC)/
9; throttling range for cooling (\(deC).
  If control mode = 2:
10; integral action time.
  If control mode = 3:
10; derivative action time.
  If control mode = 4:
10; integral action time,
11; derivative action time.
T}
_
6	T{
Determines the flux connection between the zone and a user-specified
plant component.  Suitable for use only with a type 0 controller.
T}
	T{
5 misc. data items (note: 7 misc. data items required if `Control Point' 
option required in 'res').
T}
	T{
1; coupled plant component identifier/
2; node location within this component/
3; an index specifying type of flux coupling calculation. 1 means an
$m C sub p ( theta sub s~-~ theta sub a )$ calculation; 2 means plant
component model calculated heat exchange based on prevailing building
zone conditions. This heat flux is 'picked up' by this control law
and transferred to the building zone according to any actuator type.
.\" 3 means a $h sub r A ( theta sub s~-~ theta sub a )$ calculation.
No other indices are active at present./
4; maximum heating flux permitted (W)/
5; maximum cooling flux permitted (W)/
If `Control Point' option required in `res', then two other data items 
are required:
6; controlled plant component identifier/
7; control variable for the controlled plant component.
T}
_
7	T{
A multi-stage controller with hysteresis.  Suitable for use only
with a type 0 controller.
T}
	T{
12 required data items:
T}
	T{
1; heating supplied when unit off - base load stage 0 (W)/
2; heating supplied at stage 1 - must be $>=$ stage 0 (W)/
3; heating supplied at stage 2 - must be $>=$ stage 1 (W)/
4; heating supplied at stage 3 - must be $>=$ stage 2 (W)/
5; cooling supplied when unit off - base load stage 0 (W)/
6; cooling supplied at stage 1 - must be $>=$ stage 0 (W)/
7; cooling supplied at stage 2 - must be $>=$ stage 1 (W)/
8; cooling supplied at stage 3 - must be $>=$ stage 2 (W)/
9; heating set point temperature (\(deC)/
10; heating dead band (\(deC), ($>=$ 0)/
11; cooling set point temperature (\(deC)/
12; cooling dead band (\(deC), ($>=$ 0).
T}
_
8	T{
A variable supply temperature system
with limit constraints.  Suitable for use only
with a type 0 controller.
T}
	T{
6 required data items:
T}
	T{
1; maximum supply air temperature (\(deC)/
2; minimum supply air temperature (\(deC)/
3; air volume flow rate ($m sup 3 s sup -1$)/
4; heating set point temperature (\(deC)/
5; cooling set point temperature (\(deC)/
6; cooling availability index (0 - cooling, 1 - no cooling).
T}
_
9	T{
A heat pipe model which operates by transferring heat from
some outermost construction node to some innermost construction
node.  The algorithm iterates until the two nodes are within
the stated temperature difference tolerance and the flux required
to achieve this is within the flux difference tolerance
relative to that flux calculated from a U $delta t$ model which
represents the heat pipe physics.  Convergence may require small
simulation time-steps.  Suitable for use only with a
type 0 controller.
T}
	T{
9 required data items:
T}
	T{
1; an iteration index (0 - no iterate, 1 - iterate) usually 1/
2; construction containing the heat pipe/
3; outermost heat pipe node/
4; innermost heat pipe node/
5; critical temperature (\(deC)/
6; maximum number of iterations/
7; temperature difference tolerance/
8; flux difference tolerance (W)/
9; trace flag (0 - no trace, 1 - trace).
T}
_
10	T{
Allows separate flux ON and flux OFF set points to
be specified for both heating and cooling.  During the
ON periods the maximum specified flux is injected.  After
the OFF condition the flux input is not reactivated until
ON condition is reached.  Care must be taken in the setting
of the input flux. Suitable for use only with a
type 0 controller.
T}
	T{
6 required data items:
T}
	T{
1; maximum heating capacity (W)/
2; maximum cooling capacity (W)/
3; heating ON set point temperature (\(deC)/
4; heating OFF set point temperature (\(deC)/
5; cooling ON set point temperature (\(deC)/
6; cooling OFF set point temperature (\(deC).
T}
_
11	T{
This multi-sensor ideal controller will bring the temperature of the
associated zone to the greatest/lowest/mean/weighted value
of the auxiliary sensor(s). Heating and cooling flux constraints 
are permitted. Suitable for use only with a type 0 controller.
T}
	T{
Up to 16 required data items:
T}
	T{
1; max heating flux capacity (W)/
2; min cooling flux capacity (W)/
3; max cooling flux capacity (W)/
4; min cooling flux capacity (W)/
5; number of auxiliary sensors for control function/
6; sensor 'mode of operation' flag:-
   = 1: (ref sensor)-(greatest value of auxiliary sensors);
   = 2: (ref sensor)-(least value of auxiliary sensors);
   = 3: (ref sensor)-(mean value of auxiliary sensors);
   = 4: (ref sensor)-(weighting of auxiliary sensors)./
7-10; sensor details for 1st auxiliary sensors (as Table 21)./
11-14; sensor details for 2nd auxiliary sensors (as Table 21)./
If type 4 sensor mode;
15,16;sensor percentage weightings for the two auxiliary sensors 
      (note: these weightings must sum to 100.0, e.g, 40 60).
T}
_
12	T{
This multi-sensor on-off controller will attempt to bring the 
temperature of the associated zone to the 
greatest/lowest/mean/weighted value of the auxiliary sensor(s).
Heating and cooling flux constraints are permitted. 
Suitable for use only with a type 0 controller.
T}
	T{
Up to 16 required data items:
T}
	T{
1; max heating flux capacity (W)/
2; min cooling flux capacity (W)/
3; max cooling flux capacity (W)/
4; min cooling flux capacity (W)/
5; number of auxiliary sensors for control function/
6; sensor 'mode of operation' flag:-
   = 1: (ref sensor)-(greatest value of auxiliary sensors);
   = 2: (ref sensor)-(least value of auxiliary sensors);
   = 3: (ref sensor)-(mean value of auxiliary sensors);
   = 4: (ref sensor)-(weighting of auxiliary sensors)./
7-10; sensor details for 1st auxiliary sensors (as Table 21)./
11-14; sensor details for 2nd auxiliary sensors (as Table 21)./
If type 4 sensor mode;
15,16; sensor percentage weightings for the two auxiliary sensors 
       (note: these weightings must sum to 100.0, e.g, 40 60).
T}
_
13 	T{
This is a time-proportioning on/off controller.
It is suitable for use with a type 0 controller.
Heating and cooling restrictions are allowed.
T}
	T{
12 required data items:
T}
	T{
1; max heating capacity (W)/
2; max cooling capacity (W)/
3; heating ON set point temp. (deg.C)/
4; heating OFF set point temp. (deg.C)/
5; cooling ON set point temp. (deg.C)/
6; cooling OFF set point temp. (deg.C)/
7; total heating cycle period (minutes)/
8; minimum heating ON cycle time (minutes)/
9; minimum heating OFF cycle time (minutes)/
10; total cooling cycle period (minutes)/
11; ;minimum cooling ON cycle time (minutes)/
12; minimum cooling OFF cycle time (minutes)/
T}
_
14 	T{
This is a floating action ('three-position') controller.
It is suitable for use with a type 0 controller.
Heating and cooling restrictions are allowed.
T}
	T{
14 required data items:
T}
	T{
1; heating set-point (deg.C)/
2; heating deadband (deg.C)/
3; heating "shut switch" differential (deg.C)/
4; heating "open switch" differential (deg.C)/
5; cooling set-point (deg.C)/
6; cooling deadband (deg.C)/
7; cooling "open switch" differential (deg.C)/
8; cooling "shut switch" differential (deg.C)/
9; maximum heating flux (W)/
10; minimum heating flux (W)/
11; rate of change of heater actuator (time-steps)/
12; maximum cooling flux (W)/
13; minimum cooling flux (W)/
14; rate of change of cooling actuator (time-steps)/
T}
_
99	T{
Multi-layered construction thermo-physical property
substitution mode.  At the specified times, the
references multi-layered constructions will be
substituted by the specified new constructions as
a function of tests applied to the zone air temperature.
Up to three zone constructions can be substituted.
Since the associated controller type has no meaning,
any value may be input (usually 0).
T}
	T{
4 required data items:
T}
	T{
1; flag to indicate whether substitution is required (o, no; 1, yes)/
2; multi-layered database construction reference for first construction
for substitution (as defined by the actuator's $J sub 1$ value/
3; multi-layered database construction reference for second construction
(if actuator's $J sub 2$ value not zero)/
4; multi-layered database construction reference for third construction
(if actuator's $J sub 3$ value not zero).
T}
.TE
.sp 0.5
.ce
Table 23a Active control laws for use as part of a building control function.
.sp 0.5
.IP
The data of record 13 of Table 19 allocates control functions to building
zones.  For example, if 3 control functions have been defined then
for a three zone problem "1 2 3" would indicate that zone 1 was to
be allocated control function 1,
zone 2 control function 2 and so on; "1 2 0" would indicate that
zone three was to be uncontrolled; while "1 0 1" would indicate that zones
1 and 3 would share the same control function, while zone 2 would
be uncontrolled.  Clearly the defined control functions
can be arbitrarily allocated to zones - for example "1 0 0 4 0 2 0 0 0 3"
is allocated each of 4 control functions to some of 10 zones as required.
A special case exists with control function 99 which cannot be
directly allocated to a building zone.  Instead it is referenced by (or
nested within) another control function.  This ensured that the
system control action precedes the construction substitution.  Thus, if
5 control functions have been defined, with the fifth relating to
construction substitution (a "-99 ? ?" sensor) then a 5 zone control
function allocation of "1 2 3 4 0" (or any other permutation) would be
legal while "1 2 3 4 5" (or any other permutation including the use of 5)
would not.  Instead, control function 5 should be nested within
control functions 1 through 4 as required (this is done via
the $I sub 4$ sensor data item of control function 1 through 4).
To indicate that control function nesting is active the
affected control function should be negated.  Thus, if some of the
zone three constructions were to be substituted, then "1 2 3 4 0"
would become "1 2 -3 4 0", with control function 5 referenced
from control function 3.
.sp
.TS H
box expand tab(@);
cb cb 
c lw(5.0i).
Index@Control law description
_
.TH
0@T{
All plant component control variables set to zero. This would also be the
appropriate choice in case of a control loop which is set up to define sensor
location and sensor type for a mass flow corrector component.
T}
@T{
No required data items.
T}
_
1@T{
PID control action for use with a type of controller which
actuates heat flux.
T}
@T{
Number of data items depends on PID algorithm selected.
T}
@T{
1: PID algorithm types:-
T}
@T{
         1 for heating - Non-recursive Positional P, PI, PD, or PID.
T}
@T{
         2 for heating - Recursive Positional P, PI, PD, or PID.
T}
@T{
         3 for heating - Recursive Velocity PI  [rectangular integration].
T}
@T{
         4 for heating - Recursive Velocity PID [rectangular integration].
T}
@T{
         5 for heating - Recursive Velocity PID [trapezoidal integration].
T}
@T{
        -1 for cooling - Non-recursive Positional P, PI, PD, or PID.
T}
@T{
        -2 for cooling - Recursive Positional P, PI, PD, or PID.
T}
@T{
        -3 for cooling - Recursive Velocity PI  [rectangular integration].
T}
@T{
        -4 for cooling - Recursive Velocity PID [rectangular integration].
T}
@T{
        -5 for cooling - Recursive Velocity PID [trapezoidal integration].
T}
@T{
2: maximum flux ($W$)/
3: minimum flux ($W$)/
4: set point for control variable ($SU$)/
5: throttling range for heating ($SU$)/
T}
@T{
If PID algorithm selected is type 1, -1, 2, or -2, then: 
T}
@T{
6: integral action flag (flag = 1 if integral action required; 0 otherwise).
T}
@T{
If integral action flag is 1, then;   
7: integral action time($Ssecs$);
8: derivative action flag, and if this flag is set to 1 then; 
9: derivative action time. 
T}
@T{
However, if integral action flag is 0: 
7: derivative action flag, 8: derivative action time (if flag set to 1).
T}
@T{
If derivative action flag is 1: 
8: derivative action time
T}
@T{
Else if PID algorithm selected is type 3 or -3 then: 
T}
@T{
6: integral action time($Ssecs$).
T}
@T{
Else if PID algorithm selected is type 4, -4, 5, or -5, then: 
T}
@T{
6: integral action time($Ssecs$);
7: derivative action time($Ssecs$).
T}
_
2@T{
PID control action for use with a type of controller which
actuates flow rate.
T}
@T{
Number of data items depends on PID algorithm selected.
T}
@T{
1: PID algorithm types:-
T}
@T{
         1 for heating - Non-recursive Positional P, PI, PD, or PID.
T}
@T{
         2 for heating - Recursive Positional P, PI, PD, or PID.
T}
@T{
         3 for heating - Recursive Velocity PI  [rectangular integration].
T}
@T{
         4 for heating - Recursive Velocity PID [rectangular integration].
T}
@T{
         5 for heating - Recursive Velocity PID [trapezoidal integration].
T}
@T{
        -1 for cooling - Non-recursive Positional P, PI, PD, or PID.
T}
@T{
        -2 for cooling - Recursive Positional P, PI, PD, or PID.
T}
@T{
        -3 for cooling - Recursive Velocity PI  [rectangular integration].
T}
@T{
        -4 for cooling - Recursive Velocity PID [rectangular integration].
T}
@T{
        -5 for cooling - Recursive Velocity PID [trapezoidal integration].
T}
@T{
2: maximum flux ($W$)/
3: minimum flux ($W$)/
4: set point for control variable ($SU$)/
5: throttling range for heating ($SU$)/
T}
@T{
If PID algorithm selected is type 1, -1, 2, or -2, then: 
T}
@T{
6: integral action flag (flag = 1 if integral action required; 0 otherwise).
T}
@T{
If integral action flag is 1, then: 
7: integral action time($Ssecs$);
8: derivative action flag, and if this is set to 1; 
9: derivative action time.
T}
@T{
However, if integral action flag is 0: 
7: derivative action flag, 8: derivative action time (if flag set to 1).
T}
@T{
Else if PID algorithm selected is type 3 or -3 then: 
T}
@T{
6: integral action time($Ssecs$).
T}
@T{
Else if PID algorithm selected is type 4, -4, 5, or -5, then: 
T}
@T{
6: integral action time($Ssecs$);
7: derivative action time($Ssecs$).
T}
_
3@T{
Basic proportional numerical value generator for use with a type of
controller acting on a variable which expects such a signal
T}
@T{
5 required data items:
T}
@T{
1: output $O sub u$ when $S~>=~S sub u$ (-)/
2: output $O sub l$ when $S~<=~S sub l$ (-)/
3: upper set point for control variable $S sub u$ ($SU$)/
4: lower set point for control variable $S sub l$ ($SU$)/
5: $DELTA S$ to overcome controller's hysteresis ($SU$)
T}
_
4@T{
Optimum start controller generating either \s-2ON\s0 (ie. 1) signal or heating
flux, when time is past the optimum start time necessary to reach desired 
temperature level at a specified time\u\s-2\(dg\s0\d
T}
@T{
5 required data items:
T}
@T{
1: output, ie. either "1" or heating flux ($W$)/
2: time when desired temperature should be reached ($hour$)/
3: desired temperature level $theta sub 0 ~~(\(de C$)/
4: coefficient $a sub 0 ~~( s $)/
5: coefficient $a sub 1 ~~( s / K )$/
T}
=
\(**@T{
For control laws 1. and 2. the upper set point equals the set point
plus half the throttling range, and the lower set point equals the set
point minus half the throttling range.
T}
@T{
The recursive algorithms should be selected in the case of (direct) digital 
microprocessor-based PID control. The choice between positional or velocity PID 
controllers is determined by the form of actuator: positional for 
analog actuators (e.g., pneumatic devices); velocity for 
incremental types (e.g., stepper motors).
T}
@T{
Integral action is added to proportional action to reduce sustained 
deviation from the set point. Derivative action is added to reduce the 
effects of system time-lags. The values for the integral and/or derivative 
action time constants (together with the maximum and minimum flux/flow 
values) must be selected ('tuned') with care. Typically for 
building services plant the integral action time will have a value 
of about 200 seconds, and the derivative action time constant a 
value of up to 500 seconds.
T}
\(**@T{
$SU$ stands for \fISensor Units\fP indicating that the
units are assumed to correspond to the sensor
T}
\(**@T{
Behaviour of control law 3. is similar to relationship sketched in
Figure ....
T}
.TE
.ps
.sp 0.5
.ce
Table 23b Active control laws for use as part of a plant control loops.
.sp 0.5
.LP
Figure 17 shows an example configuration control file.
.sp 0.5
.ML
.ps 6
.vs 7
.so /usr/esru/esp-r/training/simple/ctl/bld_simple.ctl
.ps
.vs
.ES
.MT
.sp 0.5
.LP
Figure 17  Example configuration control file
.sp 2
.LP
From ESP-r Version 8 Series it is also possible to impose
control on a fluid flow network.  The procedure is
similar to that outlined above for the building and
plant, with the defining information appended to the
configuration control file.  Using the facility,
a connection or set of connections of the same type
(i.e. defined by the same component model)
can be assigned a time varying control
schedule.
.LP
\fISensor Location\fR
.LP
The sensor can be placed anywhere in the model to
sense building, plant or flow network conditions.
For the building- and plant-side, the sensor
definitions given previously are valid.  In
addition, the sensor can be located within
the flow network as follows.
.DS
 i      j      k

 |      |      |
 |      |      |_______________  Identifying number of the second node
 |      |                        (when sensing property differences).
 |      |
 |      |______________________  Identifying number of the node or connection.
 |
 |_____________________________ -4  Sensing property of any node or connection
                                    in the network depending on controller type.

Examples:

 1      2      0

 |      |      |
 |      |      |____________ undefined
 |      |___________________ sensor located in surface 2.
 |__________________________ sensor located in zone 1.

-4      5      0

 |      |      |
 |      |      |____________ undefined
 |      |___________________ node or connection number of sensing property.
 |__________________________ sensing property of a node or connection in network.
.DE
.LP
\fIActuator Location\fR
.LP
Two actuator types are possible: one acting on a specified flow connection,
the other acting on a specified flow component which is used to
define one or more connections.  In the latter
case, it is possible to actuate all the connections defined by the controlled
component or to restrict the action to a sub-set.  Supported definitions are as follows.
.DS
 i      j      k
 |      |      |____________ if 'i=' -3 - Undefined
 |      |                            -4 - Number of connections associated
 |      |                                 to the component to be actuated.
 |      |
 |      |___________________ if 'i=' -3 - Connection number to be actuated.
 |                                   -4 - Component number to be actuated.
 |
 |__________________________ '-3' - Actuating in a connection
                             '-4' - Actuating in a component

Examples:

-3      5      0

 |      |      |_______________ undefined
 |      |______________________ mass flow connection number '5'.
 |_____________________________ actuating a connection.

-4      5      3

 |      |      |_______________ 3 connections related to component 5
 |      |______________________ mass flow component number '5'.
 |_____________________________ actuating a component.
.DE
.LP
Note that it is not possible to apply control to component types 220, 230,
240 and 250 when actuating a component. Instead the control action must be
applied to a connection.
.LP
\fIController types\fR
.LP
The following controller types are available for flow control.
.DS
index         Sensed property			Actuated property
  1             temperature				flow rate
  3             enthalpy				flow rate
  5             1st phase				flow rate
  7             2nd phase				flow rate
  9             additional plt output			flow rate
 11             relative humidity			flow rate
 24             temperature difference  		flow rate
 25             absolute temperature difference		flow rate
 26             pressure				flow rate
 27             pressure difference			flow rate
 28             absolute pressure difference		flow rate
 29             absolute mass flow rate			flow rate
 30             wind speed				flow rate
 31             wind direction				flow rate
 32             diffuse horizontal solar radiation	flow rate
 33             direct normal solar radiation		flow rate
 34             relative humidity of outdoor air	flow rate
.DE
.LP
\fIControl Laws\fR
.LP
The following control laws are available for selection.
.DS
 Law          Definition
-------------------------------------------------------------------
 0           ON/OFF controller.
             It can be used with any mass flow component in order
             to open or shut it. If sensing value is greater than
             set point open it otherwise close it.

             Supplementary data
             1 - Signal set point
             2 - =1 direct control =-1 inverted control
-------------------------------------------------------------------
 1           LINEAR controller with hysteresis.
             Generally for using in conjunction with components
            type 410 and 420.

             Supplementary data
             1 - signal lower limit Sl (?)
             2 - relative position H/H100 at Sl (-)
             3 - signal upper limit Su (?)
             4 - relative position H/H100 at Su (-)
             5 - dS to overcome hysteresis (?)
-------------------------------------------------------------------
.DE
.bp
.SH
10 Site obstructions file (optional)
.LP
Before \fIish\fP can be used to predict time-series shading for
transfer to a zone shading/insolation file for use by \fIbps\fP, it
is first necessary to establish, within \fIesp-r\fP, a description
of the various site and facade obstructions which will cause the shading.
This description is held in the site obstructions file. This is the
file which is transferred to \fIish\fP in addition to a zone geometry
file. The following table details file contents.
.sp
.TS H
box center;
l cw(4i)
l lw(4i).
Record	Description of fields
_
.TH
1	T{
Site latitude and longitude difference.
T}
2	T{
Total number of site obstruction blocks.
T}
3 $->$ I	T{
For each obstruction block in turn: x, y and z coordinates of
block origin, block length,
width and height, and orientation angle.
T}
I+1	T{
Opaque surface x and z grid interval, transparent surface x and z
grid interval.
T}
.TE
.sp 0.5
.ce
Table 24 Contents of the \fIsite obstructions\fP file.
.sp 0.5
.LP
Important points to note include:
.IP \(bu
Site latitude is +ve if north, -ve if south of the equator. Longitude
difference is relative to some local time zone and is +ve if east, -ve
if west of the reference meridian.
.IP \(bu
Site obstructions are restricted to the REC shape type defined in
section 2. This means that complex obstructions will require
decomposition prior to geometry specification. The requested data have
the same meaning as set out for zone geometry definition.
.IP \(bu
Note that the geometry specification
.ul 1
must
be expressed relative to the same coordinate system as used for
zone description.
.IP \(bu
The record I+1 entry allows the user to control the accuracy level
of \fIish\fP's predictions by allowing the user to specify the
grid sizes for opaque and transparent surfaces.
Specifying 20,20,10,10, for example, will result in 400 opaque surface
grid cells and 100 grid cells for each window. Accuracy levels will
then be high but at the expense of \fIish\fP computing time. \fIIsh\fP
has a minimum acceptable grid corresponding to a record I+1 entry of
5,5,4,4.
.IP \(bu
Note that \fIish\fP is equipped to perform shading prediction
for individual windows subjected to overhangs and side fins. In this
case no site obstruction file is required.
.LP
Figure 18 shows an example site obstructions file.
.sp
.ML
.so /usr/esru/esp-r/training/simple/zones/reception.obs
.ES
.MT
.LP
Figure 18  Example site obstructions file listing.
.sp 0.5
.bp
.SH
11 Operation of esp-r.
.LP
\fIesp-r\fP employs interactive dialogue techniques to prompt a
user for information, applying range checks to each reply. Many data
items have defaults invoked by simply selecting the appropriate
button.  In some cases a repeat facility is active. This
allows previously entered data to be recalled for current use. For example,
if a construction is the same as the previous one. The default and repeat facilities are
signalled when active.
.LP
\fIesp-r\fP also offers a range of editing options to permit
interactive modifications to any previously generated disk file. In
most cases two editing levels exists. The first allows global changes
to a file; for example respecifying all window dimensions in a zone
geometry file or all constructions in a zone constructions file. The second
facilitates specific file modification; to respecify one window for example
or change a zone's orientation. It is left to the user to decide on
the target file corresponding to each design modification. For example:
the system configuration can be relocated geographically, zones
or plant components repositioned,
or zones earth banked by editing the system configuration file;
zone shape and window specifications can be changed by editing the
zone geometry file; thermophysical properties can be redefined via
the zone constructions file; zone operation via the zone operations
file; shading altered by changing the shading/insolation file;
leakage via the leakage distribution file or air flow directly via
the zone operations file or air flow file; and so on.
.LP
Sub-section 4.2 details the operational features of \fIesp-r\fP.
.bp
.SH
12 Adaptive Gridding
.SH
12.1 Linear Thermal Conductivity
.LP
Via this option, the thermal conductivity 
of any layer of any surface, except air gaps,
can be defined to be linear function of temperature and/ or moisture 
content. All the required data for such a definition will be provided 
by the primitive construction database to the zone construction file 
without any additional effort by the user.  Note that you should take
particular care in defining the layers within
partitions, otherwise the scheme will warn the user of mis-matching 
linear thermal conductivity definitions.  These thermal definitions will 
remain in effect until exiting from the Simulator, (re)loading a configuration 
file, or changing them via this option.
.SH
12.2 Nonlinear Thermophysical Properties
.LP
This option can be used to define the thermophysical properties 
of layers (except air gaps), to be polynomial functions of temperature. 
There are two ways of specifying these functions:  the
user may enter the required information within the Simulator or
supply a "system thermal configuration file".  The latter may be
created after entering data manually and is useful if multiple
simulations are anticipated. The following table details 
the contents of the system thermal configuration file .
.sp
.ce
Table 3.20 contents of the system thermal configuration file
.TS H
box tab (/) expand ;
lw(0.5i) c
n a .
Record/Description of Fields
_
.TH
1/Number of thermal functions
_
.T&
l s .
For each thermal function cycle to record .... 5
_
.T&
n a .
2/Thermal function number
3/Thermal actuator location
4/Number of thermal equations
_
.T&
l s .
For each thermal equation cycle to record .... 5
_
.T&
n a .
5/Thermal equation number, thermal property type, lower and higher
\^/mean temperatures ,and eight thermal coefficients,
\^/( A, a, B, b, C, c, D, d ), respectively .
.TE
.LP
Important points to note include;
.IP \(bu
Each thermal function contains one thermal actuator location 
and up to nine thermal equations.
.IP \(bu
Thermal actuator location: indices to zone, surface and 
layer. If any of these are zero 
then it means all the selections available at its level (i.e. 
1  3   0  means all the layers in the  3rd surface of the 1st 
zone).
.IP \(bu
The thermal equation describes the change in thermal 
property value by the following equation:
.EQ
       size 12 italic { DELTA P~ =~~ A ~ DELTA T sup a~ +
 ~ B ~ DELTA T sup b ~+~~ C ~ DELTA T sup c ~+~ ~D ~ DELTA T sup d }
.EN
.IP \(bu
Thermal property type is used to define the thermophysical property 
whose value changes as a function of temperature will be estimated 
by the associated coefficients in the thermal equation.The following 
types are active: 1-thermal conductivity, 2-density, 3-heat capacity.
.IP \(bu
Each thermal equation is valid for the layers, defined by thermal actuator 
location, whose mean temperature is equal to or higher than the lower temperature 
range, and lower than higher temperature range .
.IP \(bu
This type is also equipped with a code for detecting the illegal statements
such as mis-matching definitions of partitions from each sides, un-acceptable 
temperature range, ... etc.
.IP  \(bu
if thermal conductivity of any layer is defined by both types of 
thermal definitions the linear thermal conductivity is assumed for 
that layer because of the more flexibility available at the linear 
conductivity menu for defining the types of layer's materials ; 
however the other two properties will not be affected .
.IP  \(bu
The thermal equations can be save in a thermal equations data file 
(an example is shown below) as a data base from which the user 
can pull as many equation as required for completing thermal 
functions which in turn make up the system thermal configuration .
.sp
.DS
 2         # TOTAL THERMAL FUNCTIONS
 1         # thermal function No.
 1  4  2   # thermal actuator location 
 2         # Total thermal equations
# No T  MIN(Temp.)MAX      A        a       B        b       C        c       D        d
  1  1  -30.00   25.00  0.001000   1.00  0.000034   2.00  0.000000   0.00  0.000000   0.00
  2  1   25.00  100.00  0.000100   1.00  0.000008   2.25  0.000000   0.00  0.000000   0.00
 2         # thermal function No.
 2  1  1   # thermal actuator location 
 2         # Total thermal equations
# No T  MIN(Temp.)MAX      A        a       B        b       C        c       D        d
  1  1  -20.00  125.00  0.001000   1.00  0.000600   2.09  0.000005   3.00  0.000000   0.00
  2  2  -80.00  200.00  0.000010   1.20  0.000003   2.07  0.000000   0.00  0.000000   0.00
.sp 1
Figure 3.16  System thermal configuration file
.sp 5
# cement block conductivity 
  1  1  -30.00   35.00  0.001040   1.00  0.000034   2.00  0.000000   0.00  0.000000   0.00 
# cement block conductivity 
  2  1   35.00  100.00  0.000100   1.03  0.000028   2.20  0.000000   0.00  0.000000   0.00 
# cement block density 
  3  2  -45.00  100.00  0.000004   1.00  0.000002   2.00  0.000000   0.00  0.000000   0.00
# cement block heat capacity
  4  3  -40.00   75.00  0.000035   1.00  0.000005   2.03  0.000000   0.00  0.000000   0.00
.sp
Figure 3.17  Thermal equations data file
.DE
.bp
.LP
\ 
.sp 5
.ce
\fI\s+5Appendix\s0\fP
.sp 8
.ce
\fI\s+5Representative data for building\s0\fP
.sp 0.5
.ce
\fI\s+5energy analysis\s0\fP
.bp
.ps
.vs
.ce
Table A1 Casual gains.
.TS
box center;
lb s s s s s
c c c s c c
c c c c c c
l l r r r r.
From people .....
Degree of	Typical	$W person sup -1$	Radiant	Convective
activity	application	Sensible	Latent	portion	portion
_
Sedentary	Offices	95	45	0.2	0.8
	Restaurant
Light work	Factory	125	100	0.2	0.8
Heavy work	Factory	180	255	0.2	0.8
_
.T&
lb s s s s s
c c c s c c
c c c c c c
l n c r r r.
From lights .....
Type	Illumination	$W m sup -2$	Radiant	Convective
	lux	Sensible		portion	portion
_
Tungsten	200	25-35		0.8	0.2
	400	50-80		0.8	0.2
Fluorescent	200	10		0.6	0.4
65W white	400	15-20		0.6	0.4
	1000	35-55		0.6	0.4
Fluorescent	200	15-20		0.6	0.4
65W deluxe	400	30-45		0.6	0.4
_
.T&
lb s s s s s
c c c c c c
c c c c c c
l r r r r r.
From other sources [see IHVE (now CIBSE) Guide Book A 1970, section A7] .....
Source				Radiant	Convective
				portion	portion
_
High temp.				0.8	0.2
Medium temp.				0.4	0.6
Low temp.				0.2	0.8
.TE
.sp 1
.TS
box center;
lb s
c c
l c.
Miscellaneous .....
Source	$W m sup -2$ (of net useful area)
_
General office areas	25
Word processing	45
Computer rooms >200$m sup 2$	550
Computer rooms <200$m sup 2$	350-550
Classrooms	10-25
Terminal rooms 50-250
Copying	175
Vending	20
Mailrooms	20
Conference rooms	10
Storage areas	5
_
.T&
c c
l c.
	$m sup 2 person sup -1$
_
General office	10
Managers office	14
Secretary office	7
Terminal room	9
Word processing	10
Cafeteria	3
Conference rooms	2
Laboratory	25
Classrooms	2
Store areas	100
.TE
.bp
.ce
Table A2 Overall resistances of cavities.
.TS
box center;
lb s s s
c c c s
c c c c
n l c c.
Unventilated cavities .....
Thickness		Surface Resistance ($m sup 2 \(deC/W$) for heat flow ..
(mm)	emissivity	Down	Up or horiz.
.sp 1
5	high	0.11	0.11
	low	0.18	0.18
20	high	0.21	0.18
	low	1.06	0.35
.T&
l s c c.
High emissivity planes and corrugated	0.11	0.09
sheets in contact.
Low emissivity multiple foil insulation	1.76	0.62
with air space on one side.
.T&
lb s s s
l s c s.
.sp 1
Ventilated cavities 20mm minimum .....
.sp 1
Airspace in cavity wall.	0.18
As previous but with high emissivity	0.11
surfaces.
Airspace between high emissivity surfaces,	0.88
one corrugated with unsealed joints.
As previous but with plane surface of	0.26
low emissivity.
Airspace behind tiles on tile-hung wall.	0.12
Airspace between tiles and roofing felt	0.12
on pitched roof.
Loftspace between flat ceiling and	0.11
unsealed pitched tile roof.
As previous but with sealed roof.	0.18
Loftspace between flat ceiling and sealed	0.25
pitched roof, surfaces of high emissivity.
.TE
.bp
.ce
Table A3 Thermophysical properties of materials.
.ps 8
.TS H
box center;
cb cb cb cb cb cb
cb cb cb cb cb cb
cb cb cb cb cb cb
l r r r r r.
Material	Conductivity	Density	Specific	Emiss.	Solar
	($W/m\(deC$)	($kg/ m sup 3$)	heat		absorptivity
			($J/kg\(deC$)
_
.TH
.sp 1
ASBESTOS
Cement	0.36	1500.00	1000.00	0.90	0.60
Sheet	0.36	700.00	1050.00	0.96	0.60
ASPHALT & BITUMEN
Asphalt	0.50	1700.00	1000.00	0.90	0.90
Bitumen felt	0.50	1700.00	1000.00	0.90	0.90
Roofing felt	0.19	960.00	837.00	0.90	0.90
Asphalt mastic	1.15	2325.00	837.00	0.90	0.90
BRICK
Outer leaf	0.84	1700.00	800.00	0.93	0.70
Inner leaf	0.62	1700.00	837.00	0.93	0.70
Insulating	0.27	700.00	837.00	0.93	0.70
CARPET
Wilton	0.06	183.00	1360.00	0.90	0.60
Felt underlay	0.04	160.00	1360.00	0.90	0.65
Rubber underlay	0.10	400.00	1360.00	0.90	0.65
CONCRETE
Heavy	1.40	2100.00	653.00	0.90	0.65
Light	0.38	1200.00	653.00	0.90	0.65
Aerated	0.16	500.00	840.00	0.90	0.65
Aerated block	0.24	750.00	1000.00	0.90	0.65
Refactory insulating	0.25	10.00	837.00	0.90	0.65
Vermiculite aggregate	0.17	450.00	837.00	0.90	0.65
INSULATION
Fibreboard	0.06	300.00	1000.00	0.90	0.50
Woodwool	0.10	500.00	1000.00	0.90	0.50
Glasswool	0.04	250.00	840.00	0.90	0.30
Urea Formaldehyde	0.03	30.00	1764.00	0.90	0.50
Thermalite	0.19	753.00	837.00	0.90	0.70
Polyurethane board	0.03	30.00	837.00	0.90	0.50
Polystyrene	0.03	25.00	1000.00	0.90	0.30
Siporex	0.12	550.00	1004.00	0.90	0.40
METAL
Copper	200.00	8900.00	418.00	0.72	0.65
Aluminium	160.0	2800.00	896.00	0.22	0.20
Steel	50.00	7800.00	502.00	0.12	0.20
PLASTER
Dense	0.50	1300.00	1000.00	0.91	0.50
Light	0.16	600.00	1000.00	0.91	0.50
Gypsum	0.42	1200.00	837.00	0.91	0.50
Perlite	0.08	400.00	837.00	0.91	0.50
Vermiculite	0.20	720.00	837.00	0.91	0.50
Gypsum board	0.16	950.00	840.00	0.91	0.50
Perlite board	0.18	800.00	837.00	0.91	0.60
SCREEDS & RENDERS
Light concrete	0.41	1200.00	840.00	0.90	0.80
Cast concrete	1.28	2100.00	1007.00	0.90	0.65
Granolithic	0.87	2085.00	837.00	0.90	0.65
White render	0.50	1300.00	1000.00	0.91	0.50
STONE
Sandstone	1.83	2200.00	712.00	0.90	0.60
Red granite	2.90	2650.00	900.00	0.90	0.55
White marble	2.77	2600.00	802.00	0.90	0.45
TILES
Clay	0.85	1900.00	837.00	0.90	0.60
Concrete	1.10	2100.00	837.00	0.90	0.65
Slate	2.00	2700.00	753.00	0.85	0.85
Plastic	0.50	1050.00	837.00	0.90	0.40
Rubber	0.30	1600.00	2000.00	0.94	0.82
Cork	0.08	530.00	1800.00	0.90	0.60
Asphalt/asbestos	0.55	1900.00	837.00	0.90	0.70
PVC/asbestos	0.85	2000.00	837.00	0.90	0.60
WOOD
Block	0.16	800.00	2093.00	0.90	0.65
Flooring	0.14	600.00	1210.00	0.91	0.65
Hardboard (medium)	0.08	600.00	2000.00	0.91	0.70
Hardboard (standard)	0.13	900.00	2000.00	0.91	0.70
Cork board	0.04	160.00	1888.00	0.90	0.60
Chip board	0.15	800.00	2093.00	0.91	0.65
Oak (radial)	0.19	700.00	2390.00	0.90	0.65
Weatherboard	0.14	650.00	2000.00	0.91	0.65
Fir (20 perc moist)	0.14	419.00	2720.00	0.90	0.65
.TE
.ps
.LP
These are the materials held in the \fIprimitive constructions' database\fP.
Note that the reference codes are not given here since these will
change as new materials are added. Current database contents, and the active
reference codes, can be listed via \fIcon\fP.
.bp
.ce
Table A4 Properties of selected window arrangements.*1
.ps 8
.nr PS 8
.TS H
box center expand;
cb cb cb cb cb cb
cb cb cb cb cb cb
l l r r r r.
Window arrangement	Thickness & type	Light	Direct	Total	U-value
	(mm)	transmittance*2	transmittance*2	transmittance	($W m sup -2 \(deC sup -1$)
_
.TH
SINGLE GLAZING
without blinds:
.sp 1
Clear float	4	0.89	0.82	0.86	5.4
	6	0.87	0.78	0.83	5.4
	10	0.84	0.70	0.78	5.3
	12	0.82	0.67	0.76	5.2
Spectrafloat	6 bronze	0.51	0.54	0.66	5.4
Antisun	6 green	0.72	0.46	0.62	5.4
	6 blue	0.54	0.46	0.62	5.4
	4 bronze	0.61	0.58	0.70	5.4
	6 bronze	0.50	0.46	0.62	5.4
	10 bronze	0.33	0.29	0.51	5.3
	12 bronze	0.27	0.23	0.47	5.2
	4 grey	0.55	0.55	0.68	5.4
	6 grey	0.42	0.42	0.60	5.4
	10 grey	0.25	0.25	0.49	5.3
	12 grey	0.19	0.19	0.45	5.2
Reflectafloat	6 silver	0.33	0.43	0.53	5.4
.sp 1
with internal venetian blinds:
.sp 1
Clear float	6		0.09	0.47
	12		0.08	0.46
Spectrafloat	6 bronze		0.06	0.43
Antisun	6 green		0.05	0.42
	6 blue		0.05	0.42
	6 grey		0.05	0.43
	10 grey		0.03	0.39
	12 grey		0.02	0.38
	6 bronze		0.05	0.42
	10 bronze		0.03	0.40
	12 bronze		0.03	0.39
Reflectafloat	6 silver		0.06	0.37
_
.sp 1
DOUBLE GLAZING
without blinds:
.sp 1
6mm clear inner pane:
.sp 1
Clear float	4 (+4mm inner)	0.80	0.67	0.75	2.8
	6	0.76	0.61	0.72	2.8
	10	0.73	0.55	0.66	2.7
Spectrafloat	6 bronze	0.45	0.42	0.54	2.8
Antisun	6 bronze	0.44	0.36	0.49	2.8
	10 bronze	0.29	0.23	0.38	2.7
	6 grey	0.37	0.33	0.46	2.8
Insulight HP	6	0.44	0.24	0.33	1.6
	10	0.42	0.22	0.31	1.6
.sp 1
6mm Kappafloat 
(Champagne) inner pane:
.sp 1
Clear float	4 (+4mm inner)	0.63	0.50	0.66	1.9
	6	0.60	0.46	0.63	1.9
	10	0.57	0.41	0.58	1.8
.sp 1
6mm Kappafloat 
(Neutral) inner pane:
.sp 1
Clear float	4 (+4mm inner)	0.76	0.52	0.65	1.8
	6	0.74	0.50	0.62	1.8
	10	0.72	0.45	0.57	1.8
.sp 1
with venetian blinds 
between panes
+ 6mm clear inner:
.sp 1
Clear float	6		0.07	0.25
Spectrafloat	6 bronze		0.05	0.23
Antisun	6 bronze		0.04	0.23
.sp 1
with internal venetian blinds
+ 6mm clear float inner:
.sp 1
Clear float	6		0.07	0.47
Spectrafloat	6 bronze		0.05	0.38
_
.T&
l s s s s s.
T{
*1 Data from: Glass and Transmission Properties of Windows, 7th
Edition, Pilkington Environmental Advisory Service,
February 1988.
T}
*2 For normal incidence.
.TE
.ps 10
.nr PS 10
.sp 3
.LP
ESP-r requires the direct and total transmittance for
each of 5 angles of incidence: 0\(de (normal),
40\(de, 55\(de, 70\(de and 80\(de. These
data can be obtained from \fIwin\fP on input of
the normal incidence values as given in the previous
table. The following table gives
values for some typical window arrangements.  A reasonable
estimate of the effect of angle of incidence of any 
particular glass can be made by substituting the tabulated
values of direct and total transmittance for the values
at normal incidence, and calculating values at other
incidence angles using ratios obtained from the following table.
.KS
.sp 1
.ce
Table A5 Window properties as a function of incidence angle.
.ps 8
.TS
box center;
lb lb s s s s lb s s s s
c c c c c c c c c c c
l r r r r r r r r r r.
Window arrangement	T{
Direct transmittance for .....
T}	T{
Total transmittance for .....
T}
	0\(de	40\(de	55\(de	70\(de	80\(de	0\(de	40\(de	55\(de	T{
70\(de
T}	80\(de
_
4mm clear float	0.82	0.81	0.75	0.59	0.36	0.86	T{
0.85
T}	0.80	0.65	0.42
6mm clear float	0.78	0.76	0.72	0.58	0.35	0.83	T{
0.81
T}	0.77	0.64	0.40
6mm Antisun (green)	0.46	0.44	0.40	0.30	0.16	T{
0.62
T}	0.61	0.57	0.47	0.31
6mm clear float	0.09	0.08	0.08	0.07	0.04	0.47	T{
0.43
T}	0.40	0.33	0.23
+ internal blind
6mm clear float	0.61	0.58	0.54	0.38	0.17	0.72	T{
0.70
T}	0.66	0.50	0.25
+ 6mm clear float
6mm Antisun (grey)	0.33	0.30	0.26	0.18	0.09	T{
0.46
T}	0.43	0.38	0.28	0.16
+ 6mm clear float
6mm Antisun (bronze)	0.04	0.04	0.04	0.04	0.03	T{
0.35
T}	0.33	0.32	0.28	0.20
+ 6mm clear float
+ internal blind
6mm clear float	0.07	0.06	0.06	0.05	0.03	0.25	T{
0.23
T}	0.21	0.17	0.11
+ 6mm clear float
+ blind between panes
.TE
.KE
